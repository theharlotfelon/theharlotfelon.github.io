/*! For license information please see client.min.js.LICENSE.txt */
(function(){var __webpack_modules__={388:function(n,t,i){var e;!function(r,o){"use strict";var a="function",u="undefined",s="object",c="model",f="name",l="type",d="vendor",h="version",v="architecture",p="console",g="mobile",m="tablet",_="smarttv",w="wearable",y={extend:function(n,t){var i={};for(var e in n)t[e]&&t[e].length%2==0?i[e]=t[e].concat(n[e]):i[e]=n[e];return i},has:function(n,t){return"string"==typeof n&&-1!==t.toLowerCase().indexOf(n.toLowerCase())},lowerize:function(n){return n.toLowerCase()},major:function(n){return"string"==typeof n?n.replace(/[^\d\.]/g,"").split(".")[0]:o},trim:function(n){return n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},E={rgx:function(n,t){for(var i,e,r,u,c,f,l=0;l<t.length&&!c;){var d=t[l],h=t[l+1];for(i=e=0;i<d.length&&!c;)if(c=d[i++].exec(n))for(r=0;r<h.length;r++)f=c[++e],typeof(u=h[r])===s&&u.length>0?2==u.length?typeof u[1]==a?this[u[0]]=u[1].call(this,f):this[u[0]]=u[1]:3==u.length?typeof u[1]!==a||u[1].exec&&u[1].test?this[u[0]]=f?f.replace(u[1],u[2]):o:this[u[0]]=f?u[1].call(this,f,u[2]):o:4==u.length&&(this[u[0]]=f?u[3].call(this,f.replace(u[1],u[2])):o):this[u]=f||o;l+=2}},str:function(n,t){for(var i in t)if(typeof t[i]===s&&t[i].length>0){for(var e=0;e<t[i].length;e++)if(y.has(t[i][e],n))return"?"===i?o:i}else if(y.has(t[i],n))return"?"===i?o:i;return n}},b={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},I={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6}).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[f,h],[/(opios)[\/\s]+([\w\.]+)/i],[[f,"Opera Mini"],h],[/\s(opr)\/([\w\.]+)/i],[[f,"Opera"],h],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[f,h],[/(konqueror)\/([\w\.]+)/i],[[f,"Konqueror"],h],[/(trident).+rv[:\s]([\w\.]{1,9}).+like\sgecko/i],[[f,"IE"],h],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[f,"Edge"],h],[/(yabrowser)\/([\w\.]+)/i],[[f,"Yandex"],h],[/(Avast)\/([\w\.]+)/i],[[f,"Avast Secure Browser"],h],[/(AVG)\/([\w\.]+)/i],[[f,"AVG Secure Browser"],h],[/(puffin)\/([\w\.]+)/i],[[f,"Puffin"],h],[/(focus)\/([\w\.]+)/i],[[f,"Firefox Focus"],h],[/(opt)\/([\w\.]+)/i],[[f,"Opera Touch"],h],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[f,"UCBrowser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],h],[/(windowswechat qbcore)\/([\w\.]+)/i],[[f,"WeChat(Win) Desktop"],h],[/(micromessenger)\/([\w\.]+)/i],[[f,"WeChat"],h],[/(brave)\/([\w\.]+)/i],[[f,"Brave"],h],[/(whale)\/([\w\.]+)/i],[[f,"Whale"],h],[/(qqbrowserlite)\/([\w\.]+)/i],[f,h],[/(QQ)\/([\d\.]+)/i],[f,h],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[f,h],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[f,h],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[f,h],[/(MetaSr)[\/\s]?([\w\.]+)/i],[f],[/(LBBROWSER)/i],[f],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[h,[f,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[h,[f,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[f,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[f,h],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[h,[f,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[f,/(.+)/,"$1 WebView"],h],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[f,/(.+(?:g|us))(.+)/,"$1 $2"],h],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[h,[f,"Android Browser"]],[/(coc_coc_browser)\/([\w\.]+)/i],[[f,"Coc Coc"],h],[/(sailfishbrowser)\/([\w\.]+)/i],[[f,"Sailfish Browser"],h],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[f,h],[/(dolfin)\/([\w\.]+)/i],[[f,"Dolphin"],h],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[f,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[f,"Chrome"],h],[/(coast)\/([\w\.]+)/i],[[f,"Opera Coast"],h],[/fxios\/([\w\.-]+)/i],[h,[f,"Firefox"]],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[h,[f,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[h,f],[/webkit.+?(gsa)\/([\w\.]+)\s.*(mobile\s?safari|safari)(\/[\w\.]+)/i],[[f,"GSA"],h],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[f,[h,E.str,b.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[f,h],[/(navigator|netscape)\/([\w\.-]+)/i],[[f,"Netscape"],h],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[f,h]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[v,"amd64"]],[/(ia32(?=;))/i],[[v,y.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[v,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[v,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[v,/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[[v,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[v,y.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[c,d,[l,m]],[/applecoremedia\/[\w\.]+ \((ipad)/],[c,[d,"Apple"],[l,m]],[/(apple\s{0,1}tv)/i],[[c,"Apple TV"],[d,"Apple"],[l,_]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[d,c,[l,m]],[/(kf[A-z]+)(\sbuild\/|\)).+silk\//i],[c,[d,"Amazon"],[l,m]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[c,E.str,b.device.amazon.model],[d,"Amazon"],[l,g]],[/android.+aft([\w])(\sbuild\/|\))/i],[c,[d,"Amazon"],[l,_]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[c,d,[l,g]],[/\((ip[honed|\s\w*]+);/i],[c,[d,"Apple"],[l,g]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[d,c,[l,g]],[/\(bb10;\s(\w+)/i],[c,[d,"BlackBerry"],[l,g]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[c,[d,"Asus"],[l,m]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[d,"Sony"],[c,"Xperia Tablet"],[l,m]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[d,"Sony"],[l,g]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[d,c,[l,p]],[/android.+;\s(shield)\sbuild/i],[c,[d,"Nvidia"],[l,p]],[/(playstation\s[34portablevi]+)/i],[c,[d,"Sony"],[l,p]],[/(sprint\s(\w+))/i],[[d,E.str,b.device.sprint.vendor],[c,E.str,b.device.sprint.model],[l,g]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[d,[c,/_/g," "],[l,g]],[/(nexus\s9)/i],[c,[d,"HTC"],[l,m]],[/d\/huawei([\w\s-]+)[;\)]/i,/android.+\s(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?)/i],[c,[d,"Huawei"],[l,g]],[/android.+(bah2?-a?[lw]\d{2})/i],[c,[d,"Huawei"],[l,m]],[/(microsoft);\s(lumia[\s\w]+)/i],[d,c,[l,g]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[c,[d,"Microsoft"],[l,p]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[d,"Microsoft"],[l,g]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[c,[d,"Motorola"],[l,g]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[c,[d,"Motorola"],[l,m]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[d,y.trim],[c,y.trim],[l,_]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[d,"Samsung"],[l,_]],[/\(dtv[\);].+(aquos)/i],[c,[d,"Sharp"],[l,_]],[/android.+((sch-i[89]0\d|shw-m380s|SM-P605|SM-P610|SM-P587|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[d,"Samsung"],c,[l,m]],[/smart-tv.+(samsung)/i],[d,[l,_],c],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[d,"Samsung"],c,[l,g]],[/sie-(\w*)/i],[c,[d,"Siemens"],[l,g]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[d,"Nokia"],c,[l,g]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[c,[d,"Acer"],[l,m]],[/android.+([vl]k\-?\d{3})\s+build/i],[c,[d,"LG"],[l,m]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[d,"LG"],c,[l,m]],[/linux;\snetcast.+smarttv/i,/lg\snetcast\.tv-201\d/i],[[d,"LG"],c,[l,_]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[c,[d,"LG"],[l,g]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[d,c,[l,m]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[c,[d,"Lenovo"],[l,m]],[/(lenovo)[_\s-]?([\w-]+)/i],[d,c,[l,g]],[/linux;.+((jolla));/i],[d,c,[l,g]],[/((pebble))app\/[\d\.]+\s/i],[d,c,[l,w]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[d,c,[l,g]],[/crkey/i],[[c,"Chromecast"],[d,"Google"],[l,_]],[/android.+;\s(glass)\s\d/i],[c,[d,"Google"],[l,w]],[/android.+;\s(pixel c)[\s)]/i],[c,[d,"Google"],[l,m]],[/android.+;\s(pixel( [2-9]a?)?( xl)?)[\s)]/i],[c,[d,"Google"],[l,g]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/android.+(redmi[\s\-_]?(?:note|k)?(?:[\s_]?[\w\s]+))(?:\sbuild|\))/i,/android.+(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[c,/_/g," "],[d,"Xiaomi"],[l,g]],[/android.+(mi[\s\-_]?(?:pad)(?:[\s_]?[\w\s]+))(?:\sbuild|\))/i],[[c,/_/g," "],[d,"Xiaomi"],[l,m]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[c,[d,"Meizu"],[l,g]],[/(mz)-([\w-]{2,})/i],[[d,"Meizu"],c,[l,g]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[c,[d,"OnePlus"],[l,g]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[c,[d,"RCA"],[l,m]],[/android.+[;\/\s](Venue[\d\s]{2,7})\s+build/i],[c,[d,"Dell"],[l,m]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[c,[d,"Verizon"],[l,m]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(\S(?:.*\S)?)\s+build/i],[[d,"Barnes & Noble"],c,[l,m]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[c,[d,"NuVision"],[l,m]],[/android.+;\s(k88)\sbuild/i],[c,[d,"ZTE"],[l,m]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[c,[d,"Swiss"],[l,g]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[c,[d,"Swiss"],[l,m]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[c,[d,"Zeki"],[l,m]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[d,"Dragon Touch"],c,[l,m]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[c,[d,"Insignia"],[l,m]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[c,[d,"NextBook"],[l,m]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[d,"Voice"],c,[l,g]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[d,"LvTel"],c,[l,g]],[/android.+;\s(PH-1)\s/i],[c,[d,"Essential"],[l,g]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[c,[d,"Envizen"],[l,m]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[d,c,[l,m]],[/android.+[;\/]\s*(Trio[\s\w\-\.]+)\s+build/i],[c,[d,"MachSpeed"],[l,m]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[d,c,[l,m]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[c,[d,"Rotor"],[l,m]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[d,c,[l,m]],[/android .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[c,[l,g]],[/android .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[c,[l,m]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[l,y.lowerize],d,c],[/[\s\/\(](smart-?tv)[;\)]/i],[[l,_]],[/(android[\w\.\s\-]{0,9});.+build/i],[c,[d,"Generic"]],[/(phone)/i],[[l,g]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[h,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[f,h],[/rv\:([\w\.]{1,9}).+(gecko)/i],[h,f]],os:[[/(xbox);\s+xbox\s([^\);]+)/i,/microsoft\s(windows)\s(vista|xp)/i],[f,h],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[f,[h,E.str,b.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[f,"Windows"],[h,E.str,b.os.windows.version]],[/\((bb)(10);/i],[[f,"BlackBerry"],h],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[f,h],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[f,"Symbian"],h],[/\((series40);/i],[f],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[f,"Firefox OS"],h],[/crkey\/([\d\.]+)/i],[h,[f,"Chromecast"]],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[f,h],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[f,"Chromium OS"],h],[/(sunos)\s?([\w\.\d]*)/i],[[f,"Solaris"],h],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[f,h],[/(haiku)\s(\w+)/i],[f,h],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[h,/_/g,"."],[f,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[f,"Mac OS"],[h,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[f,h]]},A=function(n,t){if("object"==typeof n&&(t=n,n=o),!(this instanceof A))return new A(n,t).getResult();var i=n||(r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),e=t?y.extend(I,t):I;return this.getBrowser=function(){var n={name:o,version:o};return E.rgx.call(n,i,e.browser),n.major=y.major(n.version),n},this.getCPU=function(){var n={architecture:o};return E.rgx.call(n,i,e.cpu),n},this.getDevice=function(){var n={vendor:o,model:o,type:o};return E.rgx.call(n,i,e.device),n},this.getEngine=function(){var n={name:o,version:o};return E.rgx.call(n,i,e.engine),n},this.getOS=function(){var n={name:o,version:o};return E.rgx.call(n,i,e.os),n},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(n){return i=n,this},this};A.VERSION="0.7.24",A.BROWSER={NAME:f,MAJOR:"major",VERSION:h},A.CPU={ARCHITECTURE:v},A.DEVICE={MODEL:c,VENDOR:d,TYPE:l,CONSOLE:p,MOBILE:g,SMARTTV:_,TABLET:m,WEARABLE:w,EMBEDDED:"embedded"},A.ENGINE={NAME:f,VERSION:h},A.OS={NAME:f,VERSION:h},typeof t!==u?(n.exports&&(t=n.exports=A),t.UAParser=A):(e=function(){return A}.call(t,i,t,n))===o||(n.exports=e)}("object"==typeof window?window:this)},7871:function(n,t,i){var e=i(2920)(),r=i(3322);n.exports=function(n,t){function i(t){if(!(this instanceof i))return new i(t);try{throw new Error(t)}catch(o){o.name=n,this.stack=o.stack}e&&this.stack&&(this.stack=r(this.stack,n,t)),this.message=t||"",this.name=n}return i.prototype=new(t||Error),i.prototype.constructor=i,i.prototype.inspect=function(){return this.message?"["+n+": "+this.message+"]":"["+n+"]"},i.prototype.name=n,i}},3322:function(n){"use strict";n.exports=function(n,t,i){var e=t;return i&&(e+=": "+i),n=e+n.slice(n.indexOf("\n"))}},2920:function(n){"use strict";n.exports=function(){var n=new Error("yep");return!!n.stack&&"Error: yep\n"===n.stack.substr(0,11)}},9755:function(n,t,i){n.exports=function(){"use strict";function n(n){return"function"==typeof n||"object"==typeof n&&null!==n}function t(n){return"function"==typeof n}undefined;var e=Array.isArray?Array.isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)},r=0,o=undefined,a=undefined,u=function(n,t){y[r]=n,y[r+1]=t,2===(r+=2)&&(a?a(E):I())};function s(n){a=n}function c(n){u=n}var f="undefined"!=typeof window?window:undefined,l=f||{},d=l.MutationObserver||l.WebKitMutationObserver,h="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),v="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){return function(){return process.nextTick(E)}}function g(){return void 0!==o?function(){o(E)}:w()}function m(){var n=0,t=new d(E),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=n=++n%2}}function _(){var n=new MessageChannel;return n.port1.onmessage=E,function(){return n.port2.postMessage(0)}}function w(){var n=setTimeout;return function(){return n(E,1)}}var y=new Array(1e3);function E(){for(var n=0;n<r;n+=2)(0,y[n])(y[n+1]),y[n]=undefined,y[n+1]=undefined;r=0}function b(){try{undefined;var n=i(8206);return o=n.runOnLoop||n.runOnContext,g()}catch(t){return w()}}var I=undefined;function A(n,t){var i=arguments,e=this,r=new this.constructor(R);r[S]===undefined&&Q(r);var o,a=e._state;return a?(o=i[a-1],u((function(){return $(a,r,o,e._result)}))):j(e,r,n,t),r}function T(n){var t=this;if(n&&"object"==typeof n&&n.constructor===t)return n;var i=new t(R);return U(i,n),i}I=h?p():d?m():v?_():f===undefined?b():w();var S=Math.random().toString(36).substring(16);function R(){}var k=void 0,N=1,D=2,C=new H;function O(){return new TypeError("You cannot resolve a promise with itself")}function x(){return new TypeError("A promises callback cannot return that same promise.")}function P(n){try{return n.then}catch(t){return C.error=t,C}}function M(n,t,i,e){try{n.call(t,i,e)}catch(r){return r}}function L(n,t,i){u((function(n){var e=!1,r=M(i,t,(function(i){e||(e=!0,t!==i?U(n,i):B(n,i))}),(function(t){e||(e=!0,G(n,t))}),"Settle: "+(n._label||" unknown promise"));!e&&r&&(e=!0,G(n,r))}),n)}function V(n,t){t._state===N?B(n,t._result):t._state===D?G(n,t._result):j(t,undefined,(function(t){return U(n,t)}),(function(t){return G(n,t)}))}function F(n,i,e){i.constructor===n.constructor&&e===A&&i.constructor.resolve===T?V(n,i):e===C?(G(n,C.error),C.error=null):e===undefined?B(n,i):t(e)?L(n,i,e):B(n,i)}function U(t,i){t===i?G(t,O()):n(i)?F(t,i,P(i)):B(t,i)}function z(n){n._onerror&&n._onerror(n._result),q(n)}function B(n,t){n._state===k&&(n._result=t,n._state=N,0!==n._subscribers.length&&u(q,n))}function G(n,t){n._state===k&&(n._state=D,n._result=t,u(z,n))}function j(n,t,i,e){var r=n._subscribers,o=r.length;n._onerror=null,r[o]=t,r[o+N]=i,r[o+D]=e,0===o&&n._state&&u(q,n)}function q(n){var t=n._subscribers,i=n._state;if(0!==t.length){for(var e=undefined,r=undefined,o=n._result,a=0;a<t.length;a+=3)e=t[a],r=t[a+i],e?$(i,e,r,o):r(o);n._subscribers.length=0}}function H(){this.error=null}var Y=new H;function K(n,t){try{return n(t)}catch(i){return Y.error=i,Y}}function $(n,i,e,r){var o=t(e),a=undefined,u=undefined,s=undefined,c=undefined;if(o){if((a=K(e,r))===Y?(c=!0,u=a.error,a.error=null):s=!0,i===a)return void G(i,x())}else a=r,s=!0;i._state!==k||(o&&s?U(i,a):c?G(i,u):n===N?B(i,a):n===D&&G(i,a))}function W(n,t){try{t((function(t){U(n,t)}),(function(t){G(n,t)}))}catch(i){G(n,i)}}var X=0;function J(){return X++}function Q(n){n[S]=X++,n._state=undefined,n._result=undefined,n._subscribers=[]}function Z(n,t){this._instanceConstructor=n,this.promise=new n(R),this.promise[S]||Q(this.promise),e(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?B(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&B(this.promise,this._result))):G(this.promise,nn())}function nn(){return new Error("Array Methods must be provided an Array")}function tn(n){return new Z(this,n).promise}function en(n){var t=this;return e(n)?new t((function(i,e){for(var r=n.length,o=0;o<r;o++)t.resolve(n[o]).then(i,e)})):new t((function(n,t){return t(new TypeError("You must pass an array to race."))}))}function rn(n){var t=new this(R);return G(t,n),t}function on(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function an(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function un(n){this[S]=J(),this._result=this._state=undefined,this._subscribers=[],R!==n&&("function"!=typeof n&&on(),this instanceof un?W(this,n):an())}function sn(){var n=undefined;if("undefined"!=typeof i.g)n=i.g;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(r){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=n.Promise;if(t){var e=null;try{e=Object.prototype.toString.call(t.resolve())}catch(r){}if("[object Promise]"===e&&!t.cast)return}n.Promise=un}return Z.prototype._enumerate=function(){for(var n=this.length,t=this._input,i=0;this._state===k&&i<n;i++)this._eachEntry(t[i],i)},Z.prototype._eachEntry=function(n,t){var i=this._instanceConstructor,e=i.resolve;if(e===T){var r=P(n);if(r===A&&n._state!==k)this._settledAt(n._state,t,n._result);else if("function"!=typeof r)this._remaining--,this._result[t]=n;else if(i===un){var o=new i(R);F(o,n,r),this._willSettleAt(o,t)}else this._willSettleAt(new i((function(t){return t(n)})),t)}else this._willSettleAt(e(n),t)},Z.prototype._settledAt=function(n,t,i){var e=this.promise;e._state===k&&(this._remaining--,n===D?G(e,i):this._result[t]=i),0===this._remaining&&B(e,this._result)},Z.prototype._willSettleAt=function(n,t){var i=this;j(n,undefined,(function(n){return i._settledAt(N,t,n)}),(function(n){return i._settledAt(D,t,n)}))},un.all=tn,un.race=en,un.resolve=T,un.reject=rn,un._setScheduler=s,un._setAsap=c,un._asap=u,un.prototype={constructor:un,then:A,"catch":function(n){return this.then(null,n)}},un.polyfill=sn,un.Promise=un,un}()},1575:function(n){"use strict";n.exports=function(n){var t,i={};if(!(n instanceof Object)||Array.isArray(n))throw new Error("keyMirror(...): Argument must be an object.");for(t in n)n.hasOwnProperty(t)&&(i[t]=t);return i}},8994:function(n){"use strict";n.exports=function(n,t,i,e){Object.defineProperty(n,t,{get:function(){var n=i.call(this);return Object.defineProperty(this,t,{value:n,enumerable:!!e,writable:!0}),n},set:function(n){return Object.defineProperty(this,t,{value:n,enumerable:!!e,writable:!0}),n},enumerable:!!e,configurable:!0})}},4840:function(n){"use strict";var t=Element.prototype,i=t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;n.exports=function(n,t){if(i)return i.call(n,t);for(var e=n.parentNode.querySelectorAll(t),r=0;r<e.length;r++)if(e[r]==n)return!0;return!1}},145:function(n){!function(){function t(n,t){var i,e,r,o,a,u,s,c;for(i=3&n.length,e=n.length-i,r=t,a=3432918353,u=461845907,c=0;c<e;)s=255&n.charCodeAt(c)|(255&n.charCodeAt(++c))<<8|(255&n.charCodeAt(++c))<<16|(255&n.charCodeAt(++c))<<24,++c,r=27492+(65535&(o=5*(65535&(r=(r^=s=(65535&(s=(s=(65535&s)*a+(((s>>>16)*a&65535)<<16)&4294967295)<<15|s>>>17))*u+(((s>>>16)*u&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(s=0,i){case 3:s^=(255&n.charCodeAt(c+2))<<16;case 2:s^=(255&n.charCodeAt(c+1))<<8;case 1:r^=s=(65535&(s=(s=(65535&(s^=255&n.charCodeAt(c)))*a+(((s>>>16)*a&65535)<<16)&4294967295)<<15|s>>>17))*u+(((s>>>16)*u&65535)<<16)&4294967295}return r^=n.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}var i=t;i.v2=function(n,t){for(var i,e=n.length,r=t^e,o=0;e>=4;)i=1540483477*(65535&(i=255&n.charCodeAt(o)|(255&n.charCodeAt(++o))<<8|(255&n.charCodeAt(++o))<<16|(255&n.charCodeAt(++o))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),e-=4,++o;switch(e){case 3:r^=(255&n.charCodeAt(o+2))<<16;case 2:r^=(255&n.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&n.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0},i.v3=t,n.exports=i}()},2138:function(n,t,i){n=i.nmd(n),function(){var e,r="Expected a function",o="__lodash_hash_undefined__",a=9007199254740991,u="[object Arguments]",s="[object Array]",c="[object Boolean]",f="[object Date]",l="[object Error]",d="[object Function]",h="[object GeneratorFunction]",v="[object Map]",p="[object Number]",g="[object Object]",m="[object RegExp]",_="[object Set]",w="[object String]",y="[object Symbol]",E="[object WeakMap]",b="[object ArrayBuffer]",I="[object Float32Array]",A="[object Float64Array]",T="[object Int8Array]",S="[object Int16Array]",R="[object Int32Array]",k="[object Uint8Array]",N="[object Uint8ClampedArray]",D="[object Uint16Array]",C="[object Uint32Array]",O=/[&<>"'`]/g,x=RegExp(O.source),P=/\w*$/,M=/^\[object .+?Constructor\]$/,L=/^(?:0|[1-9]\d*)$/,V={};V[I]=V[A]=V[T]=V[S]=V[R]=V[k]=V[N]=V[D]=V[C]=!0,V[u]=V[s]=V[b]=V[c]=V[f]=V[l]=V[d]=V[v]=V[p]=V[g]=V[m]=V[_]=V[w]=V[E]=!1;var F={};F[u]=F[s]=F[b]=F[c]=F[f]=F[I]=F[A]=F[T]=F[S]=F[R]=F[v]=F[p]=F[g]=F[m]=F[_]=F[w]=F[y]=F[k]=F[N]=F[D]=F[C]=!0,F[l]=F[d]=F[E]=!1;var U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},z={"function":!0,object:!0},B=z[typeof t]&&t&&!t.nodeType?t:e,G=z.object&&n&&!n.nodeType?n:e,j=G&&G.exports===B?B:e,q=on(B&&G&&"object"==typeof i.g&&i.g),H=on(z[typeof self]&&self),Y=on(z[typeof window]&&window),K=on(z[typeof this]&&this),$=q||Y!==(K&&K.window)&&Y||H||K||Function("return this")();function W(n,t){return n.set(t[0],t[1]),n}function X(n,t){return n.add(t),n}function J(n,t){return nn(It(n),Ai)}function Q(n,t){return!!n.length&&en(n,t,0)>-1}function Z(n,t,i){for(var e=-1,r=n.length;++e<r;)if(i(t,n[e]))return!0;return!1}function nn(n,t){for(var i=-1,e=t.length,r=n.length;++i<e;)n[r+i]=t[i];return n}function tn(n,t,i){for(var r=-1,o=n.length;++r<o;){var a=n[r],u=t(a);if(null!=u&&(s===e?u==u:i(u,s)))var s=u,c=a}return c}function en(n,t,i){if(t!=t)return function(n,t,i){var e=n.length,r=t+(i?0:-1);for(;i?r--:++r<e;){var o=n[r];if(o!=o)return r}return-1}(n,i);for(var e=i-1,r=n.length;++e<r;)if(n[e]===t)return e;return-1}function rn(n,t,i,e,r){return r(n,(function(n,r,o){i=e?(e=!1,n):t(i,n,r,o)})),i}function on(n){return n&&n.Object===Object?n:null}function an(n){return U[n]}function un(n){var t=!1;if(null!=n&&"function"!=typeof n.toString)try{t=!!(n+"")}catch(i){}return t}function sn(n,t){return n="number"==typeof n||L.test(n)?+n:-1,t=null==t?a:t,n>-1&&n%1==0&&n<t}var cn=Array.prototype,fn=Object.prototype,ln=Function.prototype.toString,dn=fn.hasOwnProperty,hn=0,vn=ln.call(Object),pn=fn.toString,gn=$._,mn=RegExp("^"+ln.call(dn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_n=$.Reflect,wn=$.Symbol,yn=$.Uint8Array,En=_n?_n.enumerate:e,bn=Object.getPrototypeOf,In=Object.getOwnPropertySymbols,An=Object.create,Tn=fn.propertyIsEnumerable,Sn=cn.splice,Rn=$.isFinite,kn=Object.keys,Nn=Math.max,Dn=Ot($,"Map"),Cn=Ot($,"Set"),On=Ot($,"WeakMap"),xn=Ot(Object,"create"),Pn=Dn?ln.call(Dn):"",Mn=Cn?ln.call(Cn):"",Ln=On?ln.call(On):"",Vn=wn?wn.prototype:e,Fn=Vn?Vn.valueOf:e;function Un(n){if(ui(n)&&!Zt(n)){if(n instanceof zn)return n;if(dn.call(n,"__wrapped__"))return function(n){var t=new zn(n.u,n.l);return t.m=It(n.m),t}(n)}return new zn(n)}function zn(n,t){this.u=n,this.m=[],this.l=!!t}function Bn(){}function Gn(n,t){return xn?n[t]!==e:dn.call(n,t)}function jn(n){var t=-1,i=n?n.length:0;for(this.clear();++t<i;){var e=n[t];this.set(e[0],e[1])}}function qn(n){var t=-1,i=n?n.length:0;for(this.I=new jn;++t<i;)this.push(n[t])}function Hn(n,t){var i=n.I;if(Lt(t)){var e=i.I;return("string"==typeof t?e.string:e.hash)[t]===o}return i.has(t)}function Yn(n){var t=-1,i=n?n.length:0;for(this.clear();++t<i;){var e=n[t];this.set(e[0],e[1])}}function Kn(n,t){var i=Xn(n,t);return!(i<0)&&(i==n.length-1?n.pop():Sn.call(n,i,1),!0)}function $n(n,t){var i=Xn(n,t);return i<0?e:n[i][1]}function Wn(n,t){return Xn(n,t)>-1}function Xn(n,t){for(var i=n.length;i--;)if(Xt(n[i][0],t))return i;return-1}function Jn(n,t,i){var e=Xn(n,t);e<0?n.push([t,i]):n[e][1]=i}function Qn(n,t,i,r){return n===e||Xt(n,fn[i])&&!dn.call(r,i)?t:n}function Zn(n,t,i){(i!==e&&!Xt(n[t],i)||"number"==typeof t&&i===e&&!(t in n))&&(n[t]=i)}function nt(n,t,i){var r=n[t];dn.call(n,t)&&Xt(r,i)&&(i!==e||t in n)||(n[t]=i)}function tt(n){return"function"==typeof n?n:Ti}function it(n,t,i,r,o,a,s){var l;if(r&&(l=a?r(n,o,a,s):r(n)),l!==e)return l;if(!ai(n))return n;var E=Zt(n);if(E){if(l=function(n){var t=n.length,i=n.constructor(t);t&&"string"==typeof n[0]&&dn.call(n,"index")&&(i.index=n.index,i.input=n.input);return i}(n),!t)return It(n)}else{var O=Pt(n),x=O==d||O==h;if(ei(n))return function(n,t){if(t)return n.slice();var i=new n.constructor(n.length);return n.copy(i),i}(n,t);if(O==g||O==u||x&&!a){if(un(n))return a?n:{};if(l=function(n){return"function"!=typeof n.constructor||Vt(n)?{}:et(bn(n))}(x?{}:n),!t)return l=function(n,t){return n&&St(t,wi(t),n)}(l,n),i?kt(n,l):l}else{if(!F[O])return a?n:{};l=function(n,t,i){var e=n.constructor;switch(t){case b:return Tt(n);case c:case f:return new e(+n);case I:case A:case T:case S:case R:case k:case N:case D:case C:return function(n,t){var i=t?Tt(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.length)}(n,i);case v:return function(n){return jt(function(n){var t=-1,i=Array(n.size);return n.forEach((function(n,e){i[++t]=[e,n]})),i}(n),W,new n.constructor)}(n);case p:case w:return new e(n);case m:return function(n){var t=new n.constructor(n.source,P.exec(n));return t.lastIndex=n.lastIndex,t}(n);case _:return jt(function(n){var t=-1,i=Array(n.size);return n.forEach((function(n){i[++t]=n})),i}(o=n),X,new o.constructor);case y:return r=n,Fn?Object(Fn.call(r)):{}}var r;var o}(n,O,t)}}s||(s=new Yn);var M=s.get(n);return M||(s.set(n,l),(E?ut:lt)(n,(function(e,o){nt(l,o,it(e,t,i,r,o,n,s))})),i&&!E?kt(n,l):l)}function et(n){return ai(n)?An(n):{}}function rt(n,t,i){if("function"!=typeof n)throw new TypeError(r);return setTimeout((function(){n.apply(e,i)}),t)}var ot,at,ut=(ot=lt,function(n,t){if(null==n)return n;if(!ni(n))return ot(n,t);for(var i=n.length,e=at?i:-1,r=Object(n);(at?e--:++e<i)&&!1!==t(r[e],e,r););return n});function st(n,t){var i=[];return ut(n,(function(n,e,r){t(n,e,r)&&i.push(n)})),i}function ct(n,t,i,e){e||(e=[]);for(var r=-1,o=n.length;++r<o;){var a=n[r];t>0&&ti(a)&&(i||Zt(a)||Qt(a))?t>1?ct(a,t-1,i,e):nn(e,a):i||(e[e.length]=a)}return e}var ft=function(n){return function(t,i,e){for(var r=-1,o=Object(t),a=e(t),u=a.length;u--;){var s=a[n?u:++r];if(!1===i(o[s],s,o))break}return t}}();function lt(n,t){return n&&ft(n,t,wi)}function dt(n,t){return st(t,(function(t){return ri(n[t])}))}function ht(n,t,i,r,o){return n===t||(null==n||null==t||!ai(n)&&!ui(t)?n!=n&&t!=t:function(n,t,i,r,o,a){var d=Zt(n),h=Zt(t),v=s,_=s;d||(v=(v=pn.call(n))==u?g:v);h||(_=(_=pn.call(t))==u?g:_);var y=v==g&&!un(n),E=_==g&&!un(t),b=v==_;a||(a=[]);var I=Bt(a,(function(t){return t[0]===n}));if(I&&I[1])return I[1]==t;if(a.push([n,t]),b&&!y){var A=d||fi(n)?function(n,t,i,r,o,a){var u=-1,s=2&o,c=1&o,f=n.length,l=t.length;if(f!=l&&!(s&&l>f))return!1;var d=!0;for(;++u<f;){var h,v=n[u],p=t[u];if(h!==e){if(h)continue;d=!1;break}if(c){if(!At(t,(function(n){return v===n||i(v,n,r,o,a)}))){d=!1;break}}else if(v!==p&&!i(v,p,r,o,a)){d=!1;break}}return d}(n,t,i,r,o,a):function(n,t,i,e,r,o,a){switch(i){case c:case f:return+n==+t;case l:return n.name==t.name&&n.message==t.message;case p:return n!=+n?t!=+t:n==+t;case m:case w:return n==t+""}return!1}(n,t,v);return a.pop(),A}if(!(2&o)){var T=y&&dn.call(n,"__wrapped__"),S=E&&dn.call(t,"__wrapped__");if(T||S){A=i(T?n.value():n,S?t.value():t,r,o,a);return a.pop(),A}}if(!b)return!1;A=function(n,t,i,r,o,a){var u=2&o,s=wi(n),c=s.length,f=wi(t).length;if(c!=f&&!u)return!1;var l=c;for(;l--;){var d=s[l];if(!(u?d in t:dn.call(t,d)))return!1}var h=!0,v=u;for(;++l<c;){var p,g=n[d=s[l]],m=t[d];if(!(p===e?g===m||i(g,m,r,o,a):p)){h=!1;break}v||(v="constructor"==d)}if(h&&!v){var _=n.constructor,w=t.constructor;_==w||!("constructor"in n)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w||(h=!1)}return h}(n,t,i,r,o,a);return a.pop(),A}(n,t,ht,i,r,o))}function vt(n){var t=typeof n;return"function"==t?n:null==n?Ti:("object"==t?mt:Et)(n)}function pt(n){n=null==n?n:Object(n);var t=[];for(var i in n)t.push(i);return t}function gt(n,t){var i=-1,e=ni(n)?Array(n.length):[];return ut(n,(function(n,r,o){e[++i]=t(n,r,o)})),e}function mt(n){var t=wi(n);return function(i){var r=t.length;if(null==i)return!r;for(i=Object(i);r--;){var o=t[r];if(!(o in i)||!ht(n[o],i[o],e,3))return!1}return!0}}function _t(n,t,i,r,o){if(n!==t){var a=Zt(t)||fi(t)?e:yi(t);ut(a||t,(function(u,s){if(a&&(u=t[s=u]),ai(u))o||(o=new Yn),function(n,t,i,r,o,a,u){var s=n[i],c=t[i],f=u.get(c);if(f)return void Zn(n,i,f);var l=a?a(s,c,i+"",n,t,u):e,d=l===e;d&&(l=c,Zt(c)||fi(c)?Zt(s)?l=s:ti(s)?l=It(s):(d=!1,l=it(c,!a)):function(n){if(!ui(n)||pn.call(n)!=g||un(n))return!1;var t=bn(n);if(null===t)return!0;var i=t.constructor;return"function"==typeof i&&i instanceof i&&ln.call(i)==vn}(c)||Qt(c)?Qt(s)?l=St(h=s,yi(h)):!ai(s)||r&&ri(s)?(d=!1,l=it(c,!a)):l=s:d=!1);var h;u.set(c,l),d&&o(l,c,r,a,u);u["delete"](c),Zn(n,i,l)}(n,t,s,i,_t,r,o);else{var c=r?r(n[s],u,s+"",n,t,o):e;c===e&&(c=u),Zn(n,s,c)}}))}}function wt(n,t){return n=Object(n),jt(t,(function(t,i){return i in n&&(t[i]=n[i]),t}),{})}function yt(n,t){var i={};return function(n,t){null==n||ft(n,t,yi)}(n,(function(n,e){t(n,e)&&(i[e]=n)})),i}function Et(n){return function(t){return null==t?e:t[n]}}function bt(n,t,i){var e=-1,r=n.length;t<0&&(t=-t>r?0:r+t),(i=i>r?r:i)<0&&(i+=r),r=t>i?0:i-t>>>0,t>>>=0;for(var o=Array(r);++e<r;)o[e]=n[e+t];return o}function It(n){return bt(n,0,n.length)}function At(n,t){var i;return ut(n,(function(n,e,r){return!(i=t(n,e,r))})),!!i}function Tt(n){var t=new n.constructor(n.byteLength);return new yn(t).set(new yn(n)),t}En&&!Tn.call({valueOf:1},"valueOf")&&(pt=function(n){return function(n){for(var t,i=[];!(t=n.next()).done;)i.push(t.value);return i}(En(n))});var St=Rt;function Rt(n,t,i,e){i||(i={});for(var r=-1,o=t.length;++r<o;){var a=t[r];nt(i,a,e?e(i[a],n[a],a,i,n):n[a])}return i}function kt(n,t){return St(n,xt(n),t)}function Nt(n){return Wt((function(t,i){var r=-1,o=i.length,a=o>1?i[o-1]:e;for(a="function"==typeof a?(o--,a):e,t=Object(t);++r<o;){var u=i[r];u&&n(t,u,r,a)}return t}))}function Dt(n,t,i,e){if("function"!=typeof n)throw new TypeError(r);var o=1&t,a=function(n){return function(){var t=arguments,i=et(n.prototype),e=n.apply(i,t);return ai(e)?e:i}}(n);return function u(){for(var t=-1,r=arguments.length,s=-1,c=e.length,f=Array(c+r),l=this&&this!==$&&this instanceof u?a:n;++s<c;)f[s]=e[s];for(;r--;)f[s++]=arguments[++t];return l.apply(o?i:this,f)}}var Ct=Et("length");function Ot(n,t){var i=n[t];return function(n){if(null==n)return!1;if(ri(n))return mn.test(ln.call(n));return ui(n)&&(un(n)?mn:M).test(n)}(i)?i:e}var xt=In||function(){return[]};function Pt(n){return pn.call(n)}function Mt(n){var t=n?n.length:e;return oi(t)&&(Zt(n)||ci(n)||Qt(n))?function(n,t){for(var i=-1,e=Array(n);++i<n;)e[i]=t(i);return e}(t,String):null}function Lt(n){var t=typeof n;return"number"==t||"boolean"==t||"string"==t&&"__proto__"!=n||null==n}function Vt(n){var t=n&&n.constructor;return n===("function"==typeof t&&t.prototype||fn)}(Dn&&Pt(new Dn)!=v||Cn&&Pt(new Cn)!=_||On&&Pt(new On)!=E)&&(Pt=function(n){var t=pn.call(n),i=t==g?n.constructor:null,e="function"==typeof i?ln.call(i):"";if(e)switch(e){case Pn:return v;case Mn:return _;case Ln:return E}return t});var Ft=Wt((function(n,t){return Zt(n)||(n=null==n?[]:[Object(n)]),t=ct(t,1),J(n)}));function Ut(n){return n?n[0]:e}function zt(n){var t=Un(n);return t.l=!0,t}function Bt(n,t){return function(n,t,i,e){var r;return i(n,(function(n,i,o){if(t(n,i,o))return r=e?i:n,!1})),r}(n,vt(t),ut)}function Gt(n,t){return ut(n,tt(t))}function jt(n,t,i){return rn(n,vt(t),i,arguments.length<3,ut)}function qt(n,t){var i;if("function"!=typeof t)throw new TypeError(r);return n=di(n),function(){return--n>0&&(i=t.apply(this,arguments)),n<=1&&(t=e),i}}var Ht=Wt((function(n,t,i){return Dt(n,33,t,i)})),Yt=Wt((function(n,t){return rt(n,1,t)})),Kt=Wt((function(n,t,i){return rt(n,hi(t)||0,i)}));var $t=Wt((function(n,t){return Dt(n,32,e,t)}));function Wt(n,t){if("function"!=typeof n)throw new TypeError(r);return t=Nn(t===e?n.length-1:di(t),0),function(){for(var i=arguments,e=-1,r=Nn(i.length-t,0),o=Array(r);++e<r;)o[e]=i[t+e];var a=Array(t+1);for(e=-1;++e<t;)a[e]=i[e];return a[t]=o,n.apply(this,a)}}function Xt(n,t){return n===t||n!=n&&t!=t}function Jt(n,t){return n>t}function Qt(n){return ti(n)&&dn.call(n,"callee")&&(!Tn.call(n,"callee")||pn.call(n)==u)}var Zt=Array.isArray;function ni(n){return null!=n&&oi(Ct(n))&&!ri(n)}function ti(n){return ui(n)&&ni(n)}var ii,ei=(ii=!1,function(){return ii});function ri(n){var t=ai(n)?pn.call(n):"";return t==d||t==h}function oi(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=a}function ai(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function ui(n){return!!n&&"object"==typeof n}function si(n){return"number"==typeof n||ui(n)&&pn.call(n)==p}function ci(n){return"string"==typeof n||!Zt(n)&&ui(n)&&pn.call(n)==w}function fi(n){return ui(n)&&oi(n.length)&&!!V[pn.call(n)]}function li(n,t){return n<t}var di=Number,hi=Number;function vi(n){return"string"==typeof n?n:null==n?"":n+""}var pi=Nt((function(n,t){St(t,wi(t),n)})),gi=Nt((function(n,t){St(t,yi(t),n)})),mi=Nt((function(n,t,i,e){Rt(t,yi(t),n,e)}));var _i=Wt((function(n){return n.push(e,Qn),mi.apply(e,n)}));function wi(n){var t=Vt(n);if(!t&&!ni(n))return function(n){return kn(Object(n))}(n);var i=Mt(n),e=!!i,r=i||[],o=r.length;for(var a in n)!dn.call(n,a)||e&&("length"==a||sn(a,o))||t&&"constructor"==a||r.push(a);return r}function yi(n){for(var t=-1,i=Vt(n),e=pt(n),r=e.length,o=Mt(n),a=!!o,u=o||[],s=u.length;++t<r;){var c=e[t];a&&("length"==c||sn(c,s))||"constructor"==c&&(i||!dn.call(n,c))||u.push(c)}return u}var Ei=Nt((function(n,t,i){_t(n,t,i)})),bi=Wt((function(n,t){return null==n?{}:(t=gt(ct(t,1),String),wt(n,function(n,t,i,e){var r,o=-1,a=Q,u=!0,s=n.length,c=[],f=t.length;if(!s)return c;i&&(t=gt(t,(r=i,function(n){return r(n)}))),e?(a=Z,u=!1):t.length>=200&&(a=Hn,u=!1,t=new qn(t));n:for(;++o<s;){var l=n[o],d=i?i(l):l;if(u&&d==d){for(var h=f;h--;)if(t[h]===d)continue n;c.push(l)}else a(t,d,e)||c.push(l)}return c}(yi(n),t)))}));var Ii=Wt((function(n,t){return null==n?{}:wt(n,ct(t,1))}));function Ai(n){return n?function(n,t){return gt(t,(function(t){return n[t]}))}(n,wi(n)):[]}function Ti(n){return n}var Si,Ri=vt;function ki(n,t,i){var e=wi(t),r=dt(t,e);null!=i||ai(t)&&(r.length||!e.length)||(i=t,t=n,n=this,r=dt(t,wi(t)));var o=!ai(i)||!("chain"in i)||i.chain,a=ri(n);return ut(r,(function(i){var e=t[i];n[i]=e,a&&(n.prototype[i]=function(){var t=this.l;if(o||t){var i=n(this.u),r=i.m=It(this.m);return r.push({func:e,args:arguments,thisArg:n}),i.l=t,i}return e.apply(n,nn([this.value()],arguments))})})),n}zn.prototype=et(Un.prototype),zn.prototype.constructor=zn,Bn.prototype=xn?xn(null):fn,jn.prototype.clear=function(){this.I={hash:new Bn,map:Dn?new Dn:[],string:new Bn}},jn.prototype["delete"]=function(n){var t=this.I;return Lt(n)?function(n,t){return Gn(n,t)&&delete n[t]}("string"==typeof n?t.string:t.hash,n):Dn?t.map["delete"](n):Kn(t.map,n)},jn.prototype.get=function(n){var t=this.I;return Lt(n)?function(n,t){if(xn){var i=n[t];return i===o?e:i}return dn.call(n,t)?n[t]:e}("string"==typeof n?t.string:t.hash,n):Dn?t.map.get(n):$n(t.map,n)},jn.prototype.has=function(n){var t=this.I;return Lt(n)?Gn("string"==typeof n?t.string:t.hash,n):Dn?t.map.has(n):Wn(t.map,n)},jn.prototype.set=function(n,t){var i=this.I;return Lt(n)?function(n,t,i){n[t]=xn&&i===e?o:i}("string"==typeof n?i.string:i.hash,n,t):Dn?i.map.set(n,t):Jn(i.map,n,t),this},qn.prototype.push=function(n){var t=this.I;if(Lt(n)){var i=t.I;("string"==typeof n?i.string:i.hash)[n]=o}else t.set(n,o)},Yn.prototype.clear=function(){this.I={array:[],map:null}},Yn.prototype["delete"]=function(n){var t=this.I,i=t.array;return i?Kn(i,n):t.map["delete"](n)},Yn.prototype.get=function(n){var t=this.I,i=t.array;return i?$n(i,n):t.map.get(n)},Yn.prototype.has=function(n){var t=this.I,i=t.array;return i?Wn(i,n):t.map.has(n)},Yn.prototype.set=function(n,t){var i=this.I,e=i.array;e&&(e.length<199?Jn(e,n,t):(i.array=null,i.map=new jn(e)));var r=i.map;return r&&r.set(n,t),this},Un.assign=pi,Un.assignIn=gi,Un.before=qt,Un.bind=Ht,Un.chain=zt,Un.compact=function(n){return st(n,Boolean)},Un.concat=Ft,Un.create=function(n,t){var i=et(n);return t?pi(i,t):i},Un.defaults=_i,Un.defer=Yt,Un.delay=Kt,Un.filter=function(n,t){return st(n,vt(t))},Un.flatten=function(n){return(n?n.length:0)?ct(n,1):[]},Un.flattenDeep=function(n){return(n?n.length:0)?ct(n,Infinity):[]},Un.iteratee=Ri,Un.keys=wi,Un.map=function(n,t){return gt(n,vt(t))},Un.mapValues=function(n,t){var i={};return t=vt(t),lt(n,(function(n,e,r){i[e]=t(n,e,r)})),i},Un.matches=function(n){return mt(pi({},n))},Un.merge=Ei,Un.mixin=ki,Un.negate=function(n){if("function"!=typeof n)throw new TypeError(r);return function(){return!n.apply(this,arguments)}},Un.omit=bi,Un.omitBy=function(n,t){return t=vt(t),yt(n,(function(n,i){return!t(n,i)}))},Un.once=function(n){return qt(2,n)},Un.partial=$t,Un.pick=Ii,Un.pickBy=function(n,t){return null==n?{}:yt(n,vt(t))},Un.slice=function(n,t,i){var r=n?n.length:0;return t=null==t?0:+t,i=i===e?r:+i,r?bt(n,t,i):[]},Un.sortBy=function(n,t){var i=0;return t=vt(t),gt(gt(n,(function(n,e,r){return{value:n,index:i++,criteria:t(n,e,r)}})).sort((function(n,t){return function(n,t){if(n!==t){var i=null===n,r=n===e,o=n==n,a=null===t,u=t===e,s=t==t;if(n>t&&!a||!o||i&&!u&&s||r&&s)return 1;if(n<t&&!i||!s||a&&!r&&o||u&&o)return-1}return 0}(n.criteria,t.criteria)||n.index-t.index})),Et("value"))},Un.tap=function(n,t){return t(n),n},Un.thru=function(n,t){return t(n)},Un.toArray=function(n){return ni(n)?n.length?It(n):[]:Ai(n)},Un.values=Ai,Un.extend=gi,ki(Un,Un),Un.clone=function(n){return ai(n)?Zt(n)?It(n):St(n,wi(n)):n},Un.cloneDeep=function(n){return it(n,!0,!0)},Un.escape=function(n){return(n=vi(n))&&x.test(n)?n.replace(O,an):n},Un.every=function(n,t,i){return function(n,t){var i=!0;return ut(n,(function(n,e,r){return i=!!t(n,e,r)})),i}(n,vt(t=i?e:t))},Un.find=Bt,Un.findIndex=function(n,t){return n&&n.length?function(n,t,i){for(var e=n.length,r=i?e:-1;i?r--:++r<e;)if(t(n[r],r,n))return r;return-1}(n,vt(t)):-1},Un.forEach=Gt,Un.forOwn=function(n,t){return n&&lt(n,tt(t))},Un.has=function(n,t){return null!=n&&dn.call(n,t)},Un.head=Ut,Un.identity=Ti,Un.includes=function(n,t,i,e){n=ni(n)?n:Ai(n),i=i&&!e?di(i):0;var r=n.length;return i<0&&(i=Nn(r+i,0)),ci(n)?i<=r&&n.indexOf(t,i)>-1:!!r&&en(n,t,i)>-1},Un.indexOf=function(n,t,i){for(var e=n?n.length:0,r=((i="number"==typeof i?i<0?Nn(e+i,0):i:0)||0)-1,o=t==t;++r<e;){var a=n[r];if(o?a===t:a!=a)return r}return-1},Un.isArguments=Qt,Un.isArray=Zt,Un.isBoolean=function(n){return!0===n||!1===n||ui(n)&&pn.call(n)==c},Un.isDate=function(n){return ui(n)&&pn.call(n)==f},Un.isEmpty=function(n){if(ni(n)&&(Zt(n)||ci(n)||ri(n.splice)||Qt(n)))return!n.length;for(var t in n)if(dn.call(n,t))return!1;return!0},Un.isEqual=function(n,t){return ht(n,t)},Un.isFinite=function(n){return"number"==typeof n&&Rn(n)},Un.isFunction=ri,Un.isNaN=function(n){return si(n)&&n!=+n},Un.isNull=function(n){return null===n},Un.isNumber=si,Un.isObject=ai,Un.isRegExp=function(n){return ai(n)&&pn.call(n)==m},Un.isString=ci,Un.isUndefined=function(n){return n===e},Un.last=function(n){var t=n?n.length:0;return t?n[t-1]:e},Un.max=function(n){return n&&n.length?tn(n,Ti,Jt):e},Un.min=function(n){return n&&n.length?tn(n,Ti,li):e},Un.noConflict=function(){return $._===this&&($._=gn),this},Un.noop=function(){},Un.reduce=jt,Un.result=function(n,t,i){var r=null==n?e:n[t];return r===e&&(r=i),ri(r)?r.call(n):r},Un.size=function(n){return null==n?0:(n=ni(n)?n:wi(n)).length},Un.some=function(n,t,i){return At(n,vt(t=i?e:t))},Un.uniqueId=function(n){var t=++hn;return vi(n)+t},Un.each=Gt,Un.first=Ut,ki(Un,(Si={},lt(Un,(function(n,t){dn.call(Un.prototype,t)||(Si[t]=n)})),Si),{chain:!1}),Un.VERSION="4.6.1",ut(["pop","join","replace","reverse","split","push","shift","sort","splice","unshift"],(function(n){var t=(/^(?:replace|split)$/.test(n)?String.prototype:cn)[n],i=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:pop|join|replace|shift)$/.test(n);Un.prototype[n]=function(){var n=arguments;return e&&!this.l?t.apply(this.value(),n):this[i]((function(i){return t.apply(i,n)}))}})),Un.prototype.toJSON=Un.prototype.valueOf=Un.prototype.value=function(){return n=this.u,jt(this.m,(function(n,t){return t.func.apply(t.thisArg,nn([n],t.args))}),n);var n},(Y||H||{})._=Un,B&&G&&(j&&((G.exports=Un)._=Un),B._=Un)}.call(this)},3232:function(n,t,i){n.exports=i(2138)._.noConflict()},4447:function(n,t,i){var e=i(145).v3,r=Math.pow(2,32),o=function(n,t){return(e(n,t)>>>0)/r};n.exports={Seed:{IGNORING:0,BUCKETING:1,FALLBACK:2,HOLDBACK:3,BEHAVIOR_EVENT:2716770798},hashToHex:function(n,t){var i=e(n,t);return(i>>>16).toString(16)+(65535&i).toString(16)},hashToInt:function(n,t,i){return Math.floor(o(n,t)*i)},hashToReal:o,toByteString:function(n){var t=String.fromCharCode;return n.replace(/[\S\s]/gi,(function(n){n=n.charCodeAt(0);var i=t(255&n);return n>255&&(i=t(n>>>8&255)+i),n>65535&&(i=t(n>>>16)+i),i}))}}},5662:function(n,t){t.generate=function i(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,i)}},6274:function(n,t,i){var e=i(3232),r=i(9350).get("stores/audience_data"),o=i(5562),a=i(4630),u=i(3685),s=i(3626);function c(n){var t=["type","selector","attributes","value"],i=e.extend({},n);return i.changeSet=e.map(n.changeSet,(function(n){return e.pick(s.dereferenceChangeId(n),t)})),i}t.emitLayerDecided=function(n){var t=n.decisionTicket?n.decisionTicket.audienceIds:[],i=e.map(t,(function(n){return{id:n,name:r.get(n).name}})),u={type:a.TYPES.LIFECYCLE,name:"layerDecided",data:e.extend(n,{audiences:i})},c=s.translateLayerEventToCampaignEvent(u);o.emit(u),o.emit(c)},t.emitViewActivated=function(n){var t={type:a.TYPES.LIFECYCLE,name:"viewActivated",data:n},i=s.translateViewActivatedToPageActivated(t);o.emit(t),o.emit(i)},t.emitViewsActivated=function(n){var t={type:a.TYPES.LIFECYCLE,name:"viewsActivated",data:n};o.emit(t)},t.emitPageDeactivated=function(n){var t={type:a.TYPES.LIFECYCLE,name:"pageDeactivated",data:n};o.emit(t)},t.emitActivateEvent=function(){o.emit({type:a.TYPES.LIFECYCLE,name:"activate"},!0)},t.emitActivatedEvent=function(){o.emit({type:a.TYPES.LIFECYCLE,name:"activated"})},t.emitInitializedEvent=function(){var n={type:a.TYPES.LIFECYCLE,name:"initialized"};window.optimizely&&(window.optimizely.initialized=!0),o.emit(n)},t.emitOriginsSyncedEvent=function(){var n={type:a.TYPES.LIFECYCLE,name:"originsSynced"};o.emit(n)},t.emitActionAppliedEvent=function(n){var t={type:n.type,campaignId:n.layerId,pageId:n.pageId,experimentId:n.experimentId,variationId:n.variationId};u.defineProperty(t,"changes",(function(){return c(n).changeSet}),"actionAppliedEvent");var i={type:a.TYPES.ACTION,name:"applied",data:t};o.emit(i)},t.emitActionsForDecisionAppliedEvent=function(n,t){var i={decision:n};u.defineProperty(i,"actions",(function(){return e.map(t,c)}),"appliedAllForDecisionEvent");var r={type:a.TYPES.ACTION,name:"appliedAllForDecision",data:i};o.emit(r)},t.emitSendEvents=function(){var n={type:a.TYPES.ANALYTICS,name:"sendEvents"};o.emit(n)},t.emitHoldEvents=function(){var n={type:a.TYPES.ANALYTICS,name:"holdEvents"};o.emit(n)}},9086:function(n,t,i){var e=i(3232),r=i(6349),o=i(3685),a=i(3626),u=i(5293),s=i(6371);function c(n,t,i,r){var o=n.getLayerState(r),a=t.get(r),s=i.get();if(!o||!a)return s?{layer:{name:s.layerName,id:s.layerId,policy:s.layerPolicy,integrationStringVersion:s.integrationStringVersion},experiment:{name:s.experimentName,id:s.experimentId},variation:{name:s.variationName,id:s.variationId},isLayerHoldback:!1}:null;if(u.isSingleExperimentPolicy(a.policy)&&o.decision.isLayerHoldback)return null;var c,f,l=o.decision.experimentId,d=o.decision.variationId;return l&&d&&(c=e.find(a.experiments,{id:l}))&&(f=e.find(c.variations,{id:d}))?{layer:{name:a.name,id:a.id,policy:a.policy,integrationStringVersion:a.integrationStringVersion},experiment:{name:c.name,id:c.id},variation:{name:f.name,id:f.id},isLayerHoldback:o.decision.isLayerHoldback}:null}function f(n,t,i,r,o,a){var c=[],f=n.getLayerStates();a.onlySingleExperiments&&(f=e.filter(f,(function(n){var i=t.get(n.layerId);return i&&u.isSingleExperimentPolicy(i.policy)})));var l=e.map(f,(function(n){var t=!!n.decision.variationId,i=n.decisionActivationId&&n.decisionActivationId===r.getActivationId(),o=s.getExperimentAndVariation(),a=o?o.variationId:null,u=t&&n.decision.variationId===a;return e.extend(n,{isActive:t&&i||u,visitorRedirected:u})})),d=o?e.filter(l,o):l;return e.each(d,(function(n){var r=function(n,t,i,r){var o,a,u=n.layerId,s=t.get(u)||{},c=e.map(s.experiments,(function(n){return e.pick(n,["id","name"])}));if(!r&&s.decisionMetadata&&s.decisionMetadata.offerConsistency)return;var f={id:u,campaignName:s.name||null,experiment:null,allExperiments:c,variation:null,reason:n.decision.reason,isActive:!!n.isActive,visitorRedirected:n.visitorRedirected,isInCampaignHoldback:n.decision.isLayerHoldback};n.decision&&n.decision.experimentId&&(o=e.find(s.experiments,{id:n.decision.experimentId})),o&&(f.experiment=e.pick(o,["id","name","campaignName"])),o&&n.decision.variationId&&(a=e.find(o.variations,{id:n.decision.variationId})),a&&(f.variation=e.pick(a,["id","name"]));var l=e.map(n.decisionTicket.audienceIds,(function(n){return e.pick(i.get(n),["id","name"])}));return f.audiences=l,s.decisionMetadata&&s.decisionMetadata.offerConsistency&&(f.pageId=n.pageId),f}(n,t,i,a.includeOfferConsistency);r&&c.push(r)})),c}t.data=["stores/audience_data","stores/client_metadata","stores/event_data","stores/layer_data","stores/view_data","stores/group_data","stores/interest_group","stores/tag_group","stores/global",function(n,t,i,r,u,s,c,f,l){var d={},h={},v={},p={audiences:n.getAudiencesMap(),events:i.getEventsMap(),campaigns:d,pages:u.getPagesMap(),experiments:h,variations:v,projectId:l.getProjectId(),snippetId:l.getSnippetId(),accountId:l.getAccountId(),dcpServiceId:l.getDCPServiceId(),revision:l.getRevision(),clientName:t.getClientName(),clientVersion:t.getClientVersion()},g=a.dereferenceChangeId;return e.each(r.getAll(),(function(n){o.defineProperty(d,n.id,(function(){var t=e.extend({},n);return o.defineProperty(t,"changes",(function(){return e.map(n.changes,g)}),"campaign"),o.defineProperty(t,"experiments",(function(){return e.map(n.experiments,(function(n){return h[n.id]}))}),"campaign"),t}),"campaignMap","byId"),e.each(n.experiments,(function(n){o.defineProperty(h,n.id,(function(){var t=e.extend({},n);return o.defineProperty(t,"changes",(function(){return e.map(n.changes,g)}),"experiment"),o.defineProperty(t,"variations",(function(){return e.map(n.variations,(function(n){return v[n.id]}))}),"experiment"),t}),"experimentMap","byId"),e.each(n.variations,(function(n){o.defineProperty(v,n.id,(function(){var t=e.extend({},n);return o.defineProperty(t,"actions",(function(){return e.map(n.actions,(function(n){return e.extend({},n,{changes:e.map(n.changes,g)})}))}),"variation"),t}),"variationMap","byId")}))}))})),p.groups=s.getGroupsMap(),p}],t.visitor=["stores/visitor",function(n){return e.cloneDeep(n.getVisitorProfile())}],t.visitor_id=["stores/visitor_id",function(n){return{randomId:n.getRandomId()}}],t.state=["stores/audience_data","stores/layer_data","stores/layer","stores/view_data","stores/view","stores/global","stores/observed_redirect",function(n,t,i,o,a,l,d){return{getCampaignStates:function(r){var o={},a=f(i,t,n,l,r,{includeOfferConsistency:!1});return e.each(a,(function(n){o[n.id]=n})),o},getExperimentStates:function(r){var o=f(i,t,n,l,r,{includeOfferConsistency:!1,onlySingleExperiments:!0}),a=["audiences","variation","reason","visitorRedirected","isActive"];return e.reduce(o,(function(n,t){var i=t.allExperiments[0];return n[i.id]=e.extend({},e.pick(t,a),{id:i.id,experimentName:i.name,isInExperimentHoldback:t.isInCampaignHoldback}),n}),{})},getCampaignStateLists:function(r){var o={},a=f(i,t,n,l,r,{includeOfferConsistency:!0});return e.each(a,(function(n){var t=n.id;o[t]||(o[t]=[]),o[t].push(n)})),o},getPageStates:function(n){var t=a.getAll(),i=e.reduce(t,(function(n,t){var i=o.get(t.id);return n[t.id]=e.extend({},e.pick(i,["id","name","apiName","category","staticConditions","tags"]),e.pick(t,["isActive","metadata"])),n[t.id].isActive=!!n[t.id].isActive,n}),{});return n?e.pickBy(i,n):i},isGlobalHoldback:function(){return l.isGlobalHoldback()},getActivationId:function(){return l.getActivationId()},getVariationMap:function(){var n=i.getLayerStates(),r={};return e.each(n,(function(n){var i=t.get(n.layerId);if(n.decision&&n.decision.experimentId&&(r[n.decision.experimentId]={id:n.decision.variationId,name:null,index:null},i)){var o=e.find(i.experiments,{id:n.decision.experimentId});if(o&&n.decision.variationId)var a=e.find(o.variations,{id:n.decision.variationId}),u=e.findIndex(o.variations,{id:n.decision.variationId});a&&(r[n.decision.experimentId]={id:n.decision.variationId,name:a.name,index:u})}})),r},getActiveExperimentIds:function(){var n={};return e.each(this.getCampaignStateLists({isActive:!0}),(function(t){e.each(t,(function(t){n[t.experiment.id]=!0}))})),e.keys(n)},getRedirectInfo:function(){var n=s.getExperimentAndVariation();return n&&(n.referrer=s.getReferrer()),n},getDecisionString:function(n){if(!n)throw new Error("Must pass a config to getDecisionString");n=e.extend({maxLength:255,shouldCleanString:!1},n);var o=c(i,t,d,n.campaignId);return o?r.generateAnalyticsString(o.layer,o.experiment,o.variation,o.isLayerHoldback,n.maxLength,n.shouldCleanString):null},getDecisionObject:function(n){if(!n)throw new Error("Must pass a config to getDecisionObject");n=e.extend({maxLength:255,shouldCleanString:!1},n);var o=c(i,t,d,n.campaignId);if(!o)return null;var a=r.formatNamesAndIdsForAnalytics(o.layer,o.experiment,o.variation,n.shouldCleanString),s=e.mapValues(a.names,(function(t,i){return r.combineAndTruncateIdAndName(t,a.idStrings[i],n.maxLength)})),f={experiment:s.experiment,variation:s.variation};return u.isSingleExperimentPolicy(o.layer.policy)||e.extend(f,{campaign:s.layer,holdback:o.isLayerHoldback}),f}}}],t.utils=i(6365).create(),t.jquery=["env/jquery",function(n){return n}],t.event_emitter=i(7444)},644:function(n,t,i){var e=i(3308),r=i(7082),o="optimizelyDataApi";t.registerFunction=function(n,t){var i=r.getGlobal(o);i||(i={},r.setGlobal(o,i)),i[n]||(i[n]=t)},t.unregisterFunction=function(n){var t=r.getGlobal(o);t&&t[n]&&(t[n]=function(){e.log('Ignoring attempt to call "'+o+"."+n+'" which has been unregistered.')})},t.getFunction=function(n){return r.getGlobal(o)[n]}},9414:function(n,t,i){var e=i(3232),r=i(3308),o=i(9086),a=i(9350),u=a.get("stores/plugins"),s=i(9653),c=i(2425),f=i(9358),l=[i(7724),i(4305),i(9081)],d=["clientMetadata","cookieDomain","disable","load","optOut","rum"];t.push=function(n,t){var i,o,a,u;if(!e.isArray(n)&&e.isObject(n))u=e.isUndefined(n.version)?1:n.version,i=n.type,a=[n];else if(e.isArray(n))u=0,i=n[0],a=n.slice(1);else{if(!e.isString(n))return r.warn("API / Ignoring non-array/object/string argument:",n),!1;u=0,i=n,a=[]}if(l[u]&&(o=l[u][i]),t&&-1===d.indexOf(i))return r.debug("API / Ignoring non high priority function:",i,a),!1;if(!o)return r.warn('API / No function found for "'+i+'" (v'+u+") with arguments:",a),!1;r.log('API / Executing: "'+i,'" with arguments:',a);try{o.apply(null,a),f.dispatch(s.RECORD_API_USAGE,{methodName:u?"v"+u+"."+i:i})}catch(c){r.error(c)}return!0},t.get=function(n){r.log('API / Getting module: "'+n+'"');var t=o[n];if(t?e.isArray(t)&&(t=a.evaluate(t)):t=u.getPlugin(c.PluginTypes.apiModules,n),t)return f.dispatch(s.RECORD_API_USAGE,{methodName:"get."+n}),t;r.warn('Module "'+n+'" not found.')}},3685:function(n,t,i){var e=i(8994),r=i(9653),o=i(9358),a=i(3308);t.defineProperty=function(n,t,i,u,s){e(n,t,(function(){var n=["prop",u,s||t].join(".");return a.debug('Evaluating getter: "'+n+'"'),o.dispatch(r.RECORD_API_USAGE,{methodName:n}),i()}),!0)}},7724:function(n,t,i){var e=i(3232),r=i(4305);function o(n){var t,i={};if(n)if(a(n))t=Number(n);else{if("object"!=typeof n)throw new Error("tracker: Revenue argument "+n+"not a number.");if("revenue"in(i=e.extend({},n))){if(!a(i.revenue))throw new Error("tracker: Revenue value "+i.revenue+"not a number.");t=Number(i.revenue),delete i.revenue}}return e.isUndefined(t)||(i.revenue=t),i}function a(n){return e.isNumber(n)||e.isString(n)&&Number(n)==n}t.activateGeoDelayedExperiments=function(n,t){t||(t=n.lists?"odds":"cdn3"),r.dataFromSource({data:n,source:t})},t.activateSiteCatalyst=function(n){n&&n.sVariable&&r.integrationSettings({id:"adobe_analytics",settings:{sVariableReference:n.sVariable}})},t.bucketUser=t.bucketVisitor=function(n,t){if(n&&t){var i={experimentId:String(n)};t>256?i.variationId=String(t):i.variationIndex=String(t),r.bucketVisitor(i)}},t.disable=function(n){r.disable({scope:n})},t.log=function(n){e.isUndefined(n)&&(n=!0),r.log({level:n?"INFO":"OFF"})},t.optOut=function(n){e.isUndefined(n)&&(n=!0),r.optOut({isOptOut:n})},t.setCookieDomain=function(n){r.cookieDomain({cookieDomain:n})},t.setCookieExpiration=function(n){r.cookieExpiration({cookieExpirationDays:n})},t.setDimensionValue=function(n,t){var i={};i[n]=t,r.user({attributes:i})},t.setUserId=function(n){r.user({userId:n})},t.storeThirdPartyData=function(n,t){r.dataFromSource({source:n,data:t})},t.trackEvent=function(n,t){r.event({eventName:n,tags:o(t)})}},3626:function(n,t,i){var e=i(3232),r=i(9350),o=i(9739),a=i(3685),u=r.get("stores/change_data");t.translateDecisionToCampaignDecision=function(n){return s(e.cloneDeep(n),{layerId:"campaignId",isLayerHoldback:"isCampaignHoldback"})},t.translateLayerEventToCampaignEvent=function(n){var i={};return a.defineProperty(i,"campaign",(function(){return function(n){var i=e.cloneDeep(n);return i.changes&&(i.changes=e.map(i.changes,t.dereferenceChangeId)),i.experiments&&e.each(i.experiments,(function(n){n.changes&&(n.changes=e.map(n.changes,t.dereferenceChangeId)),n.variations&&e.each(n.variations,(function(n){n.actions&&e.each(n.actions,(function(n){n.changes&&(n.changes=e.map(n.changes,t.dereferenceChangeId))}))}))})),i}(n.data.layer)}),"campaignEvent"),i.decisionTicket=n.data.decisionTicket,i.decision=this.translateDecisionToCampaignDecision(n.data.decision),i.audiences=n.data.audiences,{type:"lifecycle",name:"campaignDecided",data:i}},t.translateViewActivatedToPageActivated=function(n){return{type:"lifecycle",name:"pageActivated",data:{page:n.data.view}}},t.dereferenceChangeId=function(n){var t=u.getChange(n);return t?o.safeReference(t):n};var s=function(n,t){var i=e.omit(n,e.keys(t));return e.each(t,(function(t,e){i[t]=n[e]})),i}},6365:function(n,t,i){var e=i(4702).Promise,r=i(8276).t,o=i(8761).poll,a=i(1901).b,u=i(816).A;t.create=function(){return{observeSelector:r,poll:o,Promise:e,waitForElement:a,waitUntil:u}}},2144:function(n){n.exports={DEFAULT_INTERVAL:20}},8276:function(n,t,i){var e=i(3232),r=(i(9653),i(9350)),o=r.get("stores/directive"),a=i(1596),u=(i(2425),i(9358),i(5662).generate),s=i(8761),c=i(7082),f=(r.get("stores/rum"),{once:!1,onTimeout:null,timeout:null}),l={},d=function(n){d=function(){if(!o.shouldObserveChangesIndefinitely())return function(n){var t=s.poll(e.partial(v,n));l[n].cancelObservation=function(){t(),delete l[n]}};var n={attributes:!0,childList:!0,subtree:!0,characterData:!0},t=a.getDocumentElement(),i=new MutationObserver((function(){this.disconnect(),e.each(e.keys(l),v),this.observe(t,n)}));return function(r){var o=l[r];i.observe(t,n),o.cancelObservation=function(){delete l[r],e.isEmpty(l)&&i.disconnect()}}}(),d(n)};function h(n){var t=l[n];t&&t.cancelObservation&&t.cancelObservation()}function v(n){if(l[n]){if(function(n){var t=n.options.timeout;if(null!==t)if("function"==typeof t)try{return t()}catch(i){}else if(Date.now()-n.startTime>t)return!0;return!1}(l[n]))return 0===l[n].matchedCount&&e.isFunction(l[n].options.onTimeout)&&l[n].options.onTimeout(),void h(n);var t=a.querySelectorAll(l[n].selector);t.length&&(e.each(t,(function(t){t.T&&t.T[n]||l[n].callbackQueue.push(t)})),function(n){for(;l[n]&&l[n].callbackQueue.length;){var t=l[n].callbackQueue.shift();if(p(t,n),l[n].matchedCount=l[n].matchedCount+1,l[n].callback(t),l[n]&&l[n].options.once)return void h(n)}}(n))}}function p(n,t){n.T||(n.T={}),n.T[t]=!0}t.t=function(n,t,i){if(!function(n){try{a.querySelector(n)}catch(t){return!1}return!0}(n))throw new Error("observeSelector expects a valid css selector as its first argument");if(!e.isFunction(t))throw new Error("observeSelector expects a function as its second argument");if(i&&(!e.isObject(i)||e.isFunction(i)))throw new Error("observeSelector expects an object as its third argument");var r=u();return i=e.assign({},f,i||{}),l[r]={callback:t,callbackQueue:[],matchedCount:0,options:i,selector:n,startTime:Date.now()},d(r),c.setTimeout(e.bind(v,null,r),0),e.partial(h,r)}},8761:function(n,t,i){var e=i(3232),r=(i(9653),i(9350)),o=(i(2425),i(9358),i(5662).generate),a=i(7082),u=i(2144).DEFAULT_INTERVAL,s=(r.get("stores/rum"),{});function c(n){s[n]&&e.each(s[n].callbacks,(function(n){n.call(null)}))}function f(n,t){s[t]&&s[t].callbacks[n]&&(delete s[t].callbacks[n],e.some(s[t].callbacks)||(clearInterval(s[t].id),delete s[t]))}t.poll=function(n,t){e.isNumber(t)||(t=u),s[t]||(s[t]={callbacks:{},id:a.setInterval(e.partial(c,t),t)});var i=o();return s[t].callbacks[i]=n,e.partial(f,i,t)},t.cancelAll=function(){e.each(s,(function(n,t){clearInterval(n.id),delete s[t]}))}},1901:function(n,t,i){var e=i(4702).Promise,r=i(8276).t;t.b=function(n){return new e((function(t,i){r(n,t,{once:!0})}))}},816:function(n,t,i){var e=i(4702).Promise,r=i(8761).poll;t.A=function(n){return new e((function(t,i){if(n())t();else var e=r((function(){n()&&(e(),t())}))}))}},4305:function(n,t,i){var e=i(3232),r=i(9653),o=i(9414),a=i(9086),u=i(4773),s=i(2425),c=i(8317),f=i(6274),l=i(1115),d=i(8235).U,h=i(1217),v=i(474),p=(i(6236),i(6426)),g=i(5562),m=i(9358),_=i(6898),w=i(406),y=i(3308),E=i(2498),b=(i(5840),i(4247)),I=i(7324),A=i(9350),T=A.get("stores/dimension_data"),S=A.get("stores/view"),R=A.get("stores/view_data"),k=A.get("stores/visitor_id"),N=A.get("stores/layer_data"),D=A.get("stores/directive"),C=!1,O=t.ApiListenerError=d("ApiListenerError");t.event=function(n){var t;switch(n.eventType){case"click":t=function(n){var t;return n.eventData&&(t=p.create(n.eventData.id,n.eventData.apiName,"click",n.eventData)),function(){var n=c.trackClickEvent(t);n?y.log("API / Tracking click event:",n):y.log("API / Not tracking click event:",n)}}(n);break;case"decision":t=function(n){var t=n.eventData,i=w.createLayerState(t.layerId,t.experimentId,t.variationId,t.isLayerHoldback),e=w.createSingle(t.layerId,t.experimentId,t.variationId);return function(){w.recordLayerDecision(i.layerId,i.decisionTicket,i.decision),y.log("API / Tracking decision event:",i),c.trackDecisionEvent(i.decision,i.decisionTicket,e)}}(n);break;case"pageview":t=function(n){var t=b.create(n.eventData.id,n.eventData.apiName),i=b.createState(t.id);return function(){var n=c.trackViewActivation(t,i);n?y.log("API / Tracking pageview event:",n):y.log("API / Not tracking pageview event:",n)}}(n);break;default:t=function(n){var t;return n.eventId&&(t=p.create(n.eventId,n.eventName,"custom")),b.updateAllViewTags(),function(){c.trackCustomEvent(n.eventName,n.tags,t)?y.log("API / Tracking custom event:",n.eventName,n.tags):y.log("API / Not tracking custom event:",n.eventName)}}(n)}k.getBucketingId()?t():m.dispatch(r.ADD_CLEANUP_FN,{lifecycle:s.Lifecycle.postActivate,cleanupFn:t})},t.clientMetadata=function(n){C},t.priorRedirectString=function(n){},t.microsnippetError=function(n){},t.rum=function(n){m.dispatch(r.SET_RUM_DATA,n.eventData)},t.initialViewStates=function(n){var t=e.map(n.states,(function(n,t){return{id:t,isActive:n}}));b.registerViews(t)},t.page=function(n){var t=R.getByApiName(n.pageName);if(!t)throw new Error('Unknown page "'+n.pageName+'"');var i=!n.hasOwnProperty("isActive")||n.isActive,e=function(){i?b.activateViaAPI(t,n.tags):(b.deactivate(t),y.log("API / Deactivated Page",b.description(t)))};k.getBucketingId()?e():m.dispatch(r.ADD_CLEANUP_FN,{lifecycle:s.Lifecycle.postViewsActivated,cleanupFn:e})},t.tags=function(n){b.setGlobalTags(n.tags)},t.user=function(n){y.log("API / Setting visitor custom attributes:",n.attributes),e.each(n.attributes,(function(n,t){var i,e,r=t,o=T.getById(t)||T.getByApiName(t);o&&(r=o.id,i=o.apiName,e=o.segmentId||o.id);var a={id:e,value:n};i&&(a.name=i),x(r,a,!0)}))};var x=function(n,t,i){var e=[{key:i?["custom",n]:[n],value:t,metadata:{lastModified:h.now()}}],o=function(){m.dispatch(r.SET_VISITOR_ATTRIBUTES,{attributes:e})};k.getBucketingId()?o():m.dispatch(r.ADD_CLEANUP_FN,{lifecycle:s.Lifecycle.postVisitorProfileLoad,cleanupFn:o})};t.optOut=function(n){var t=!n.hasOwnProperty("isOptOut")||n.isOptOut;v.setOptOut(t)},t.cookieExpiration=function(n){var t=n.cookieExpirationDays;t<90&&(y.error('Argument "cookieExpirationDays"=',t,"less than minimum days:",90,", setting to minimum."),t=90),y.log("API / Setting cookie age to",t,"days."),m.dispatch(r.SET_COOKIE_AGE,86400*t)},t.extendCookieLifetime=function(n){n=e.extend({isEnabled:!0},n),y.log("API / Setting cookie automatic lifetime extension to",n.isEnabled),m.dispatch(r.SET_COOKIE_AUTO_REFRESH,n.isEnabled)},t.cookieDomain=function(n){y.log("API / Setting cookie domain to",n.cookieDomain),m.dispatch(r.SET_COOKIE_DOMAIN,n.cookieDomain)},t.disable=function(n){if(n.scope){if("tracking"!==n.scope)throw new Error('Unknown "scope" for disable: '+n.scope);y.log("API / Disabling tracking"),m.dispatch(r.LOAD_DIRECTIVE,{trackingDisabled:!0})}else y.log("API / Disabling everything"),m.dispatch(r.LOAD_DIRECTIVE,{disabled:!0})},t.log=function(n){var t=n.level,i=n.match;e.isUndefined(t)&&(t="INFO"),e.isUndefined(i)&&(i=""),y.setLogMatcher(i),y.setLogLevel(t)},t.registerModule=function(n){var t="custom/"+n.moduleName;if(a[t]||o.get(t))throw new Error('Module name "'+t+'" is reserved. Will not be registered as plugin.');E.registerApiModule(t,n.module)},t.dataFromSource=function(n){var t=n.source;l.makeAsyncRequest(t),l.resolveRequest(t,n.data)},t.addListener=function(n){if(!e.isFunction(n.handler))throw new Error("A handler function must be supplied");(n=e.omit(n,"type")).publicOnly=!0,n.emitErrors=!0;var t=n.handler;n.handler=function(n){try{return t(n)}catch(i){throw new O(i)}},g.on(n)},t.removeListener=function(n){if(!n.token)throw new Error("Must supply a token to removeListener");g.off(n.token)},t.load=function(n){n.data=e.extend({},n.data),u.normalizeClientData(n.data),m.dispatch(r.DATA_LOADED,{data:n.data})},t.integrationSettings=function(n){if(!n.id)throw new Error("id is required");if(!n.settings)throw new Error("settings is required");m.dispatch(r.SET_INTEGRATION_SETTINGS,e.extend({},n.settings,{id:n.id}))},t.bucketVisitor=function(n){if(!n.variationId&&e.isUndefined(n.variationIndex)||n.variationId&&n.variationIndex)throw new Error("One of a variationId or a variationIndex is required.");if(!n.experimentId)throw new Error("An experimentId is required.");var t,i,r=n.campaignId;if(r){if(!(t=N.get(r)))throw new Error("Could not find layer "+r)}else if(!(r=(t=N.getLayerByExperimentId(n.experimentId)).id))throw new Error("Could not find layer for experiment "+n.experimentId);if(!(i=e.find(t.experiments,{id:n.experimentId})))throw new Error("Could not find experiment "+n.experimentId+" in layer "+r);var o=n.variationId;if(e.isUndefined(n.variationIndex)){if(!e.find(i.variations,{id:o}))throw new Error("Cound not find variation "+o+" in experiment "+n.experimentId)}else if(!(o=i.variations[n.variationIndex].id))throw new Error("Could not find variation at index "+n.variationIndex+" in experiment "+n.experimentId);I.updateVariationIdMap(r,n.experimentId,o),k.getBucketingId()&&I.persistVariationIdMap()},t.waitForOriginSync=function(n){if(!e.isArray(n.canonicalOrigins))throw new Error("canonicalOrigins must be an array. Got: "+_.stringify(n.canonicalOrigins));e.each(n.canonicalOrigins,(function(n){if(!e.isString(n))throw new Error("Each item in canonicalOrigins must be a string. Found type "+(void 0===n?"undefined":(t=n)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t));var t})),m.dispatch(r.XDOMAIN_SET_CANONICAL_ORIGINS,{canonicalOrigins:n.canonicalOrigins})},t.disableCrossOrigin=function(){y.log("API / cross origin tracking is DISABLED"),m.dispatch(r.XDOMAIN_SET_DISABLED,{disabled:!0})},t.activate=function(){D.shouldActivate()?(e.forEach(S.getActiveViewStates(),(function(n){b.deactivate(R.get(n.id))})),m.dispatch(r.RESET_VIEW_STATES),f.emitActivateEvent()):y.debug("Not activating.")},t.sendEvents=function(){f.emitSendEvents()},t.holdEvents=function(){f.emitHoldEvents()}},9081:function(){},4714:function(n,t,i){var e=i(3232),r=i(8235).U,o=t.ActivationCodeError=r("ActivationCodeError"),a=t.ProjectJSError=r("ProjectJSError"),u=i(978),s=i(9653),c=i(8317),f=i(6274),l=i(8798),d=i(1826),h=i(4773),v=i(1217),p=i(6280),g=i(9350),m=i(474),_=i(1596),w=i(2425),y=i(5562),E=i(4630),b=i(3209),I=i(9358),A=i(7356),T=i(406),S=i(7075).mM,R=i(3308),k=i(8492),N=i(5519),D=i(2498),C=i(5969),O=i(4702).Promise,x=i(2819),P=i(5840),M=i(2798),L=i(6974),V=i(4247),F=i(7324),U=i(7082),z=(g=i(9350)).get("stores/session"),B=g.get("stores/audience_data"),G=g.get("stores/action_data"),j=g.get("stores/cleanup"),q=g.get("stores/directive"),H=g.get("stores/global"),Y=g.get("stores/group_data"),K=g.get("stores/layer_data"),$=g.get("stores/layer"),W=g.get("stores/pending_events"),X=g.get("stores/plugins"),J=g.get("stores/rum"),Q=g.get("stores/visitor"),Z=g.get("stores/view_data"),nn=g.get("stores/view"),tn=g.get("stores/visitor_id"),en=g.get("stores/visitor_bucketing"),rn=g.get("stores/xdomain"),on=i(9414),an=i(6236),un=i(5715),sn=t;function cn(){var n=null;e.isNumber(n)&&0===K.getCount()?(R.log("Activating after delay of",n,"ms because no Experiments are running"),I.dispatch(s.SET_RUM_DATA,{data:{activateDfd:!0}}),U.setTimeout(f.emitActivateEvent,n)):f.emitActivateEvent()}function fn(n){an.handleError(n.data.error,n.data.metadata)}function ln(n,t){I.dispatch(s.SET_RUM_DATA,{data:{extras:{xdAttempt:n,xdError:t?t.toString():void 0}}})}function dn(n,t,i){n=n||[];var r=X.getAllPlugins(w.PluginTypes.visitorProfileProviders),o=H.getGlobalHoldbackThreshold(),a=Q.getVisitorProfile();F.populateLazyVisitorData(r,a);var u=tn.getBucketingId();if(!u)throw new Error("bucketingId not set");var s,c=Q.getVisitorProfile();t&&(s=en.getVariationIdMap()[t.id]);var f={bucketingId:u,visitorProfile:c,audiences:n,globalHoldback:o,preferredVariationMap:s,layer:t};return t&&i&&p.isPageIdRelevant(t)?e.map(i,(function(n){return p.createTicket(e.extend({},f,{pageId:n}))})):[p.createTicket(f)]}function hn(n,i,r,o){try{var a=function(n){return{bucketingId:tn.getBucketingId(),preferredLayerId:en.getPreferredLayerMap()[n.id]}}(o),u=p.decideGroup(o,a);if(u.reason)return R.debug("Not activating Group",A.description(o),"; reason:",u.reason),J.getSampleRum()&&I.dispatch(s.RECORD_LAYER_FEATURE_USAGE,{feature:"mutex",entityId:o.id}),O.resolve();var c=K.get(u.layerId);if(!c)return R.debug("Visitor was bucketed into a Campaign ("+u.layerId+") which is not in this snippet"),O.resolve();var f=e.filter(c.pageIds,e.partial(e.includes,r));return e.isEmpty(f)?(R.debug("Not activating Group",A.description(o),"; reason: visitor was bucketed into a Campaign/Experiment not related to the currently-activating Page(s)"),O.resolve()):(J.getSampleRum()&&I.dispatch(s.RECORD_LAYER_FEATURE_USAGE,{feature:"mutex",entityId:o.id}),t.decideAndExecuteLayerASAP(n,i,f,c))}catch(l){return R.error("Error getting decision for Group",A.description(o),"; ",l),O.reject(l)}}function vn(n,t){var i={};return e.each(n,(function(n){e.isArray(n)?e.extend(i,vn(n,t)):e.isObject(n)&&t[n.type]&&(i[n.type]=!0)})),i}function pn(n){var t=[];return e.each(n,(function(n){t.push(n.name,n)})),t}function gn(n){var t=j.getCleanupFns(n);if(t.length>0){for(;t.length>0;)t.shift()();I.dispatch(s.CLEAR_CLEANUP_FN,{lifecycle:n})}}t.initialize=function(n){return this.initGlobalStore(n.clientData),this.initializePlugins(n.plugins)},t.initGlobalStore=function(n){n=n;h.normalizeClientData(n),y.on({filter:{type:"error"},handler:fn}),I.dispatch(s.DATA_LOADED,{data:n}),R.log("Initialized with DATA:",n)},t.initializePlugins=function(n){if(e.isArray(window.optimizely)&&(window.optimizely=e.filter(window.optimizely,(function(n){var t=!0;return!on.push(n,t)}))),m.setOptOut(q.shouldOptOut()),!q.isDisabled()&&!q.shouldOptOut()){un.queueBeacons(),_.isReady()?I.dispatch(s.SET_DOMCONTENTLOADED):_.addReadyHandler((function(){I.dispatch(s.SET_DOMCONTENTLOADED)})),N.time("projectJS");var i=H.getProjectJS();if(e.isFunction(i))try{b.apply(i)}catch(h){R.error("Error while executing projectJS: ",h),d.emitError(new a(h))}N.timeEnd("projectJS"),e.each(n||[],(function(n){try{n(D)}catch(h){d.emitInternalError(h)}})),e.each(H.getPlugins()||[],(function(n){try{b.apply(n,[D])}catch(h){d.emitError(h)}})),P.load();var r=y.on({filter:{type:"lifecycle",name:"activated"},handler:function(){Q.observe(F.persistVisitorProfile),$.observe(F.persistLayerStates),z.observe(F.persistSessionState),W.observe(k.persistPendingEvents),en.observe(F.persistVisitorBucketingStore),y.off(r)}});y.on({filter:{type:"lifecycle",name:"viewsActivated"},handler:t.onViewsActivated}),y.on({filter:{type:"lifecycle",name:"pageDeactivated"},handler:t.onPageDeactivated}),t.initializeApi();var o=k.getPendingEvents();if(o&&(I.dispatch(s.LOAD_PENDING_EVENTS,{events:o}),k.retryPendingEvents(o)),y.on({filter:{type:"lifecycle",name:"activate"},handler:t.activate}),f.emitInitializedEvent(),!q.shouldActivate())return O.resolve();var u=[];if(rn.isDisabled())cn();else{var c=t.initializeXDomainStorage();if(u.push(c),Boolean(rn.getCanonicalOrigins())){var l=M.makeTimeoutPromise(1e3);O.race([c,l])["catch"]((function(n){R.error("Failed to initialize xDomain storage: ",n)})).then(cn)["catch"](an.handleError)}else cn()}return O.all(u)}R.log("Controller / Is disabled")},t.activate=function(){try{var n=[];R.log("Activated client"),gn(w.Lifecycle.preActivate);var t=v.now();I.dispatch(s.ACTIVATE,{activationId:String(t),activationTimestamp:t});var i=Z.getAll();V.registerViews(i),F.setId(F.getOrGenerateId()),n.push(c.trackPostRedirectDecisionEvent()),I.dispatch(s.MERGE_VARIATION_ID_MAP,{variationIdMap:F.getVariationIdMap()}),I.dispatch(s.MERGE_PREFERRED_LAYER_MAP,{preferredLayerMap:F.getPreferredLayerMap()}),gn(w.Lifecycle.postVisitorProfileLoad),n.push((h=X.getAllPlugins(w.PluginTypes.visitorProfileProviders),g=Q.getVisitorProfile(),F.populateEagerVisitorData(h,g)).then((function(){R.log("Populated visitor profile")})));var r=dn(),o=p.decideGlobal(r);R.log("Made global decision",r,"->",o),I.dispatch(s.RECORD_GLOBAL_DECISION,o);var a=c.trackClientActivation();a?R.log("Tracked activation event",a):R.log("Not tracking activation event");var u=sn.setUpViewActivation(i),l=[];return e.each(u,(function(n){l=l.concat(V.activateMultiple([n]))})),gn(w.Lifecycle.postViewsActivated),gn(w.Lifecycle.postActivate),f.emitActivatedEvent(),O.all(n).then((function(){y.emit({type:E.TYPES.LIFECYCLE,name:"activateDeferredDone"}),R.log("All immediate effects of activation resolved")}),d.emitError)}catch(m){return d.emitError(m),O.reject(m)}var h,g},sn.setUpViewActivation=function(n){var t=[];return e.each(n,(function(n){e.isBoolean(nn.getViewState(n.id).isActive)&&V.isActivationTypeImmediate(n.activationType)?R.debug("Skipping page: already evaluated, presumably at the edge",V.description(n)):V.shouldTriggerImmediately(n.activationType)?t.push(n):n.activationType===w.ViewActivationTypes.callback?(R.debug("Setting up conditional activation for Page",V.description(n)),sn.activateViewOnCallback(n)):n.activationType===w.ViewActivationTypes.polling?(R.debug("Setting up polling activation for Page",V.description(n)),C.pollFor(e.partial(b.apply,n.activationCode),null,e.partial(L.isTimedOut,v.now())).then((function(){V.activateMultiple([n])}))["catch"]((function(t){R.warn("Failed to activate view ",n,t)}))):n.activationType!==w.ViewActivationTypes.manual&&d.emitError(new Error("Unknown view activationType: "+n.activationType))})),t},sn.activateViewOnCallback=function(n){var t={pageId:n.id};Object.defineProperty(t,"isActive",{get:function(){return nn.isViewActive(n.id)}});try{b.apply(n.activationCode,[function(t){var i=e.extend({},t,{pageName:n.apiName,type:"page"});on.push(i)},t])}catch(r){var i=new o("("+r.toString()+") in activationCode for "+V.description(n));d.emitError(i,{originalError:r,userError:!0})}},t.onViewsActivated=function(n){var i,r=n.data.views,o=e.map(r,"id");try{if(!tn.getBucketingId())throw new Error("View activated with no visitorId set");var a=function(n){var i=K.getAllByPageIds(n),r=q.getForceVariationIds(),o=q.getForceAudienceIds(),a=!e.isEmpty(r);a&&R.log("Force variations are in use. Disabling mutual exclusivity.");var u=a?{individual:i}:e.reduce(i,(function(n,t){return t.groupId?n.groups[t.groupId]||(n.groups[t.groupId]=Y.get(t.groupId)):n.individual.push(t),n}),{groups:{},individual:[]});R.log("Deciding Campaigns/Experiments for Page(s)",n);var s=e.map(u.groups,A.description).join(", ");R.log("Groups:",s);var c=e.map(u.individual,T.description).join(", ");R.log("Campaigns/Experiments not in Groups (by Campaign id):",c);var f=e.map(u.groups,e.partial(hn,r,o,n))||[],l=e.map(u.individual,(function(i){var a=e.filter(i.pageIds,e.partial(e.includes,n));return t.decideAndExecuteLayerASAP(r,o,a,i)})),d=f.concat(l);return O.all(d).then((function(t){var i=e.filter(t,(function(n){return!!n}));return R.log("All Campaigns/Experiments for Page(s) (by Campaign id)",n,"resolved:",e.map(i,T.description).join(", ")),i}))}(o)["catch"](d.emitError);return i=O.all(e.map(r,(function(n){var t=function(){V.parseViewTags(n);var t=c.trackViewActivation(n);t?R.log("Tracked activation for Page",V.description(n),t):R.log("Not Tracking activation for Page",V.description(n))};return _.isReady()?O.resolve(t()):C.pollFor(_.isReady,1e3).then(t)}))),O.all([a,i])}catch(u){d.emitError(u)}},t.onPageDeactivated=function(n){var t=n.data.page,i=G.getAllActionIdsByPageId(t.id);e.each(i,(function(n){var i=G.getActionState(n);i&&(e.each(i,(function(n,i){if(n.cancel)try{n.cancel(),R.debug("Controller / Canceled change",i,"observation due to deactivation of page:",t)}catch(e){R.error("Controller / Error canceling change",i,"observation upon deactivation of page.",e)}if(t.undoOnDeactivation&&n.undo)try{n.undo(),R.debug("Controller / Undid change",i,"due to deactivation of page:",t)}catch(r){R.error("Controller / Error undoing change upon deactivation of page.",r)}})),I.dispatch(s.REMOVE_ACTION_STATE,{actionId:n}),R.debug("Controller / Undid changes and/or canceled change observation due to deactivation of page:",t,n))}))},t.initializeApi=function(){var n={push:on.push};n.get=on.get;var t=window.optimizely;e.isArray(t)&&e.each(t,(function(t){n.push(t)})),n.data={note:"Obsolete, use optimizely.get('data') instead"},n.state={},window.optimizely=n},t.persistItemsWithId=function(n){return e.each(n,(function(n,t){F.checkKeyForVisitorId(t)&&S.setItem(t,n)})),n},t.initializeXDomainStorage=function(){var n=i(5762),r=!!F.getCurrentId(),o=!!r&&F.hasSomeData();r?o?R.log("xd / Existing visitor; has data on this origin"):R.log("xd / Existing visitor; new to this origin"):R.log("xd / New visitor");var a=H.getAccountId(),u="https://a2900460605.cdn.optimizely.com".replace("__SUBDOMAIN__","a"+a+"."),c="/client_storage/a"+a+".html";n.subscribe((function(n,t){F.checkKeyForVisitorId(n)&&S.setItem(n,t)}));var l=n.fetchAll().then((function(t){if(!tn.getVisitorIdLocator()){var i=rn.getCanonicalOrigins();if(i){var e=n.getXDomainUserId(t,i);e&&(R.log("Syncing cross-origin visitor randomId:",e),F.maybePersistVisitorId({randomId:e}))}}return F.deleteOldForeignData(),t})).then(t.persistItemsWithId).then((function(n){if(F.loadForeignData(),r&&!o){var t=!e.isEmpty(n);R.debug("xd / Loaded foreign data? ",t),ln(t)}R.log("Loaded visitor data from foreign origins"),f.emitOriginsSyncedEvent()}),(function(n){throw r&&!o&&(R.debug("xd / Failed to load foreign data:",n),ln(!1,n)),n}));return O.all([n.load(u,c)["catch"]((function(n){throw R.debug("xd / Failed to load iframe:",n),r&&!o&&ln(!1,n),n})),l["catch"]((function(n){R.debug("xd / Ignored error syncing foreign data (expected if waitForOriginSync used):",n.message),R.debug("xd / Enqueuing sync to happen after visitorId set."),I.dispatch(s.ADD_CLEANUP_FN,{lifecycle:w.Lifecycle.postVisitorProfileLoad,cleanupFn:f.emitOriginsSyncedEvent})}))])},t.decideAndExecuteLayerASAP=function(n,i,r,o){return new O((function(a,d){try{!function(n,t,i,r,o){if(t.length||i.length)return void o(dn([],void 0,r));var a=T.relatedAudienceIds(n),u=e.reduce(a,(function(n,t){var i=B.get(t);return!i||n.push(i),n}),[]),c=X.getAllPlugins(w.PluginTypes.audienceMatchers);if(J.getSampleRum()){var f={};if(e.each(u,(function(n){e.extend(f,vn(n.conditions,c))})),!e.isEmpty(f)){var d=e.keys(f);I.dispatch(s.RECORD_AUDIENCE_USAGE,{audienceTypes:d,layerId:n.id})}}!function(n,t,i,r){var o=e.reduce(n,(function(n,i){return e.extend(n,l.requiredAudienceFieldsForConditions(i.conditions,t))}),{}),a=e.reduce(o,(function(n,t){if(e.isUndefined(F.getAttribute(t))){var i=F.getPendingAttributeValue(t);e.isUndefined(i)||n.push(i)}return n}),[]);if(0===a.length)return r();var u=[].concat(n),s=x.firstToResolve(e.map(a,(function(n){return O.resolve(n).then((function(){var n=Q.getVisitorProfile();if(u=e.filter(u,(function(i){return e.isUndefined(l.isInAudience(n,i,t))})),!e.isEmpty(u))throw new Error("At least one audience is still pending")}))})));O.race([s,new O((function(n,t){U.setTimeout(t,i)}))]).then((function(){R.log("Activating Campaign after pending Audiences resolved",n),r()}),(function(){R.log("Activating Campaign after timeout on Audiences",n),r()}))}(u,c,T.getActivationTimeout(n),(function(){var t=dn(u,n,r);e.map(t,(function(t){!function(n,t,i){var r=e.map(n.audienceIds,e.bind(B.get,B)),o=e.filter(t,(function(t){return!e.includes(n.audienceIds,t.id)}));R.log("When deciding Campaign",T.description(i),"visitor is in audiences:",pn(r),"and not in audiences:",pn(o))}(t,u,n)})),o(t)}))}(o,n,i,r,(function(l){e.each(l,(function(a){var l=a.pageId?[a.pageId]:r;R.debug("Deciding layer: ",o,"with decisionTicket: ",a,"and actionViewIds: ",l),function(n,i,r,o,a){var l=T.description(n);R.log("Activating Campaign",l,"on Page(s)",o),r.length&&(R.log("Applying force audienceIds:",r,"to Campaign",l),(a=e.cloneDeep(a)).audienceIds=r);var d=t.decideLayer(n,a,i),h=!(!i.length&&!r.length),v=t.getActionsForDecision(n,d,h),g=function(n,t){return e.filter(n,(function(n){return e.isUndefined(n.pageId)||e.includes(t,n.pageId)}))}(v.actions,o);if(v.maybeExecute&&function(n,t,i,r){var o=T.description(t);R.log("Preparing actions",n,"for Campaign",o,"on Page(s)",r),e.forEach(n,u.prepareAction)}(g,n,0,o),e.forEach(o,(function(){c.trackDecisionEvent(d,a)})),f.emitLayerDecided({layer:n,decisionTicket:a,decision:d}),d.error)throw d.error;if(J.getSampleRum()){I.dispatch(s.RECORD_LAYER_POLICY_USAGE,{policy:n.policy,layerId:n.id});var m=function(n){var t={};return e.each(n,(function(n){e.each(n.changeSet,(function(n){t[n.type]||(t[n.type]=!0)}))})),t}(v.actions);I.dispatch(s.RECORD_CHANGE_TYPE_USAGE,{changeTypes:e.keys(m),layerId:n.id}),e.isEmpty(n.integrationSettings)||I.dispatch(s.RECORD_INTEGRATION_USAGE,{integrations:T.getIntegrationTypes(n),layerId:n.id})}if(!p.isInCohort(d))return void R.log("Not activating Campaign: "+T.description(n)+"; not in the cohort because:",d.reason);v.maybeExecute&&function(n,t,i,r){var o=T.description(t);R.log("Executing actions",n,"for Campaign",o,"on Page(s)",r),O.all(e.map(n,(function(n){return u.executePreparedAction(n).then(e.partial(f.emitActionAppliedEvent,n))}))).then((function(){R.log("All page actions for",i,"applied:",n),f.emitActionsForDecisionAppliedEvent(i,n)}))["catch"]((function(n){R.warn("Error evaluating page actions for decision",i,"because:",n)}))}(g,n,d,o)}(o,n,i,l,a)})),a(o)}))}catch(h){R.error("Error getting decision for Campaign: "+T.description(o),h),d(h)}}))},t.decideLayer=function(n,t,i){var e;var r=T.description(n);e=i.length?p.getDummyLayerDecision(n,i):p.decideLayer(n,t),R.log("Recording decision for Campaign",r,t,"->",e),T.recordLayerDecision(n.id,t,e),e.variationId&&e.experimentId&&F.updateVariationIdMap(n.id,e.experimentId,e.variationId),n.groupId&&F.updatePreferredLayerMap(n.groupId,n.id);return e},t.getActionsForDecision=function(n,t,i){var e=T.description(n),r="NOT applying changes for Campaign",o={actions:[],maybeExecute:!1};if(o.actions=[].concat(G.getLayerActions(t.layerId)||[],G.getExperimentActions(t.experimentId)||[],G.getExperimentVariationActions(t.experimentId,t.variationId)||[]),!i&&H.isGlobalHoldback())return R.log(r,e,"(visitor is in global holdback)"),o;if(t.isLayerHoldback)return R.log(r,e,"(visitor is in layer holdback)"),o;if(!t.experimentId||!t.variationId)return R.log(r,e,"(visitor is not eligible for any Experiments)"),o;return o.maybeExecute=!0,R.log("Got Actions for Campaign:",e,o.actions),o}},7565:function(n,t,i){var e=i(9755).Promise,r=i(1217),o=i(9350).get("stores/plugins"),a=i(2425),u=i(3308);t.create=function(n,t,i){var s={identifier:n.id,action:t,startTime:i||r.now()};try{var c=o.getPlugin(a.PluginTypes.changeAppliers,n.type);if(!c)throw new Error("Unrecognized change type "+n.type);return new c(n,s)}catch(f){return u.error("Change applier was never properly constructed:",f),{apply:function(){return e.reject(f)}}}}},1729:function(n){n.exports={SELECTOR_POLLING_MAX_TIME:2e3,CHANGE_DATA_KEY:"optimizelyChangeData",CHANGE_ID_ATTRIBUTE_PREFIX:"data-optly-"}},4944:function(n,t,i){var e=i(3232),r=i(1729).CHANGE_DATA_KEY;function o(n,t){return[n,t].join("_")}t.getData=function(n,t,i){var e=o(t,i);return n[r]&&n[r][e]?n[r][e]:null},t.hasData=function(n){return Boolean(n&&n[r]&&!e.isEmpty(n[r]))},t.removeData=function(n,t,i){n[r]&&delete n[r][o(t,i)]},t.setData=function(n,t,i,e){if("object"!=typeof e)throw new Error("setData expects an object");n[r]||(n[r]={}),n[r][o(t,i)]=e}},5934:function(n,t,i){var e=i(1575);n.exports={changeType:{CUSTOM_CODE:"custom_code",ATTRIBUTE:"attribute",APPEND:"append",REARRANGE:"rearrange",REDIRECT:"redirect",WIDGET:"widget"},DOMInsertionType:{AFTER:"after",APPEND:"append",BEFORE:"before",PREPEND:"prepend"},insertAdjacentHTMLType:{AFTER_BEGIN:"afterbegin",AFTER_END:"afterend",BEFORE_BEGIN:"beforebegin",BEFORE_END:"beforeend"},selectorChangeType:{CLASS:"class",HTML:"html",HREF:"href",SRC:"src",STYLE:"style",TEXT:"text",HIDE:"hide",REMOVE:"remove"},changeApplierState:e({APPLIED:null,APPLYING:null,UNAPPLIED:null,UNDOING:null}),changeState:e({BLOCKED:null,UNAPPLIED:null,APPLIED:null,APPLYING:null,UNDOING:null,TIMED_OUT:null,IGNORED:null,ERROR:null})}},978:function(n,t,i){var e=i(3232),r=i(9653),o=i(1826),a=i(1115),u=i(8235).U,s=i(1217),c=i(9350),f=i(9358),l=i(3308),d=i(4702).Promise,h=i(4452),v=c.get("stores/global"),p=c.get("stores/action_data"),g=c.get("stores/change_data"),m=c.get("stores/session"),_=i(7565);i(6974).initialize();var w=u("ActionError");function y(n,t,i){if(p.getActionState(t.id)){var o=p.getChangeApplier(n.id,t.id);if(e.isUndefined(o)){var a={changeId:n.id,actionId:t.id,changeApplier:_.create(n,t,i)};f.dispatch(r.SET_CHANGE_APPLIER,a)}else l.warn("Action / Attempted to prepare a change which is already being applied: ",n)}else l.warn("Action / Attempted to prepare change for inactive action: ",t)}function E(n,t,i,r){if(!e.includes(r,t)){if(!n[t]){var u=g.getChange(t);if(!u){var c="Change with id "+t+" is absent";return r.length&&(c+=" but listed as a dependency for "+r[r.length-1]),void l.warn(c)}n[t]=new d((function(c){var f=e.map(u.dependencies||[],(function(e){return E(n,e,i,r.concat([t]))}));if(u.src){var v="change_"+u.src,m=a.makeAsyncRequest(v,(function(){return h.addScriptAsync("https://cdn.optimizely.com/public/2900460605/data"+u.src,(function(){a.resolveRequest(v)}))})).then((function(){var n=g.getChange(u.id);n||o.emitError(new w("Failed to load async change from src: "+u.src)),y(n,i,s.now())}));f.push(m)}d.all(f).then((function(){var n=s.now(),e=p.getChangeApplier(t,i.id);return e?(l.debug("Action / Applying change:",u),e.apply().then((function(t){t?l.log(t):l.debug("Action / Applied change for the first time in "+(s.now()-n)+"ms:",u),c()}))):(l.debug("Action / Not applying change ",t," - No changeApplier found."),void c())}))["catch"]((function(n){l.error("Action / Failed to apply change:",u,n),c()}))}))}return n[t]}l.error("Change with id "+t+" has circular dependencies: "+r.concat(t))}t.prepareAction=function(n){l.debug("Action / Preparing:",n),f.dispatch(r.ACTION_EXECUTED,{actionId:n.id,sessionId:m.getSessionId(),layerId:n.layerId,pageId:n.pageId,timestamp:s.now(),activationId:v.getActivationId()});var t=s.now();e.forEach(n.changeSet,(function(i){var o=e.isObject(i)?i.id:i,a=g.getChange(o);a||(f.dispatch(r.ADD_CHANGE,i),a=g.getChange(i.id)),a.src||y(a,n,t)}))},t.executePreparedAction=function(n){l.debug("Action / Executing:",n);var t={},i=e.map(n.changeSet,(function(i){var r=e.isObject(i)?i.id:i;return E(t,r,n,[])}));return d.all(i).then((function(){l.debug("changes for action id="+n.id+" applied")}))}},6974:function(n,t,i){var e=i(1729),r=i(9350).get("stores/directive");function o(){("interactive"===document.readyState||"complete"===document.readyState)&&(t.domReadyTime=Date.now())}t.domReadyTime=null,t.initialize=function(){o(),document.addEventListener("readystatechange",o,!0)},t.isTimedOut=function(n){var i=Date.now();if(!t.domReadyTime||!n)return!1;var o=Math.max(n,t.domReadyTime);return r.isEditor()&&(o=t.domReadyTime),!(i-o<e.SELECTOR_POLLING_MAX_TIME)}},8317:function(n,t,i){var e=i(3232),r=i(9653),o=i(1826),a=i(7201),u=i(1217),s=i(8127),c=i(9350),f=i(1596),l=i(2425),d=i(582),h=i(5562),v=i(4630),p=i(1069),g=i(9358),m=i(406),_=i(3308),w=(i(5519),i(4702).Promise),y=i(6371),E=i(5840),b=i(2798),I=i(6822),A=i(5662),T=c.get("stores/client_metadata"),S=c.get("stores/global"),R=c.get("stores/session"),k=c.get("stores/view"),N=c.get("stores/plugins"),D=c.get("stores/layer"),C=c.get("stores/layer_data"),O=c.get("stores/observed_redirect"),x=c.get("stores/pending_redirect"),P=c.get("stores/visitor"),M=c.get("stores/directive"),L=c.get("stores/event_data"),V=c.get("stores/visitor_id");function F(n,t){return e.extend({},n,{isLayerHoldback:t,isGlobalHoldback:!1,clientName:e.isNull(n.clientName)?s.NAME:n.clientName,integrationStringVersion:e.isNull(n.integrationStringVersion)?1:n.integrationStringVersion,anonymizeIP:e.isNull(S.getAnonymizeIP())?void 0:S.getAnonymizeIP(),activationId:S.getActivationId(),decisionTicketAudienceIds:[],sessionId:R.getSessionId(),activeViewStates:[],userFeatures:B(P.getVisitorProfile()),layerStates:D.getLayerStatesForAnalytics()})}function U(n){var t=y.getReferrer()||f.getReferrer();return{eventId:A.generate(),timestamp:u.now(),revision:S.getRevision(),clientName:T.getClientName(),clientVersion:T.getClientVersion(),projectId:S.getProjectId(),accountId:S.getAccountId(),activationId:S.getActivationId(),sessionId:R.getSessionId(),isGlobalHoldback:S.isGlobalHoldback(),namespace:S.getNamespace(),referrer:t,visitorId:V.getRandomId(),activeViewStates:n.activeViewStates,layerStates:n.layerStates,userFeatures:B(n.visitorProfile)}}function z(n){var t,i;return n.pageId?(t=n.pageId,(i=k.getViewState(t))&&i.isActive?i.metadata:{}):{}}function B(n){var t=N.getAllPlugins(l.PluginTypes.visitorProfileProviders),i=e.filter(t,{shouldTrack:!0}),r={id:null,type:null,name:"",value:null,shouldIndex:!0};return e.reduce(i,(function(t,i){try{var o=i.provides,a=n[o],u=[];if(!e.isUndefined(a)){e.isObject(a)?u=e.map(a,(function(n,t){var i=e.isObject(n)?n:{value:n};return e.extend({},{type:o,name:t},i)})):u.push({type:o,value:a});var s=e(u).map((function(n){return e.pick(e.extend({},r,n),e.keys(r))})).filter((function(n){return!!n.value})).value();t=t.concat(s)}}catch(c){_.warn("Error evaluating userFeature against visitorProfile:",c)}return t}),[])}function G(n,t,i){var r=function(n,t){var i=[];return e.each(N.getAllPlugins(l.PluginTypes.analyticsTrackers),(function(e,r){if(e[n]&&(!t||!e[t]))try{i.push({name:r,hookFn:c.evaluate(e[n])})}catch(o){_.error(o)}})),i}(n,i);_.debug("Found "+r.length+" analytics integrations defining a "+n+" hook"),_.debug("Calling each with data: ",t),e.each(r,(function(n){try{_.debug("Calling plugin: "+n.name),n.hookFn(t),_.debug("Called plugin: "+n.name)}catch(i){_.error(i)}}))}function j(n,t,i){var r=function(n,t){0;var i=[];return e.each(N.getAllPlugins(l.PluginTypes.analyticsTrackers),(function(r,o){e.includes(t,r[n])&&i.push({name:o,hookFn:r.trackLayerDecision})})),i}(n,t);_.debug("Found "+r.length+" analytics integrations  defining a trackLayerDecision "+n+" timing of "+t.join("|")),_.debug("Calling each with data: ",i),e.each(r,(function(n){try{_.debug("Calling plugin: "+n.name),n.hookFn(i),_.debug("Called plugin: "+n.name)}catch(t){_.error(t)}}))}t.trackClientActivation=function(){if(M.shouldSendTrackingData()){var n,t=(n=U({activeViewStates:[],visitorProfile:P.getVisitorProfile(),layerStates:D.getLayerStatesForAnalytics()}),e.extend(n,{eventTags:{}}));return G("onClientActivation",t),t}},t.trackCustomEvent=function(n,t,i){t=t||{},i||(i=L.getByApiName(n));var r=function(n,t,i){var r=U({activeViewStates:k.getActiveViewStates(),visitorProfile:P.getVisitorProfile(),layerStates:D.getLayerStatesForAnalytics()}),o=i&&i.pageId?z(i):k.getActiveViewTags(),a=e.extend({},o,t),u=i&&i.category?i.category:d.OTHER;return e.extend(r,{eventEntityId:i&&i.id,eventApiName:n,eventCategory:u,eventTags:a})}(n,t,i),u={name:n,type:p.CUSTOM,category:r.eventCategory,tags:e.omit(r.eventTags,"revenue")};if(e.isUndefined(t.revenue)||(u.revenue=t.revenue),o.emitAnalyticsEvent({name:i?i.name||i.apiName:n,apiName:i?i.apiName:void 0,type:p.CUSTOM,tags:e.omit(r.eventTags,"revenue"),category:r.eventCategory,metrics:u.revenue?{revenue:u.revenue}:{}},!M.shouldSendTrackingData()),M.shouldSendTrackingData())return a.addEvent(u),G("onCustomEvent",r),r},t.trackDecisionEvent=function(n,t,i){i||(i=C.get(n.layerId));var o=A.generate();g.dispatch(r.RECORD_LAYER_DECISION_EVENT_ID,{layerId:n.layerId,pageId:t.pageId,decisionId:o});var a=function(n,t,i,r){var o=null,a=null,s=null;if(t.experimentId){var c=e.find(r.experiments,{id:t.experimentId});if(c&&(o=c.name||null,s=c.integrationSettings,t.variationId)){var l=e.find(c.variations,{id:t.variationId});l&&(a=l.name||null)}}var d=y.getReferrer()||f.getReferrer();return{sessionId:R.getSessionId(),decisionTicketAudienceIds:i.audienceIds,visitorId:V.getRandomId(),decisionId:n,activationId:S.getActivationId(),namespace:S.getNamespace(),timestamp:u.now(),pageId:i.pageId||null,variationId:t.variationId,variationName:a,experimentId:t.experimentId,experimentName:o,layerId:t.layerId,layerName:r.name,layerPolicy:r.policy,accountId:S.getAccountId(),projectId:S.getProjectId(),revision:String(S.getRevision()),clientName:T.getClientName(),clientVersion:T.getClientVersion(),referrer:d,integrationStringVersion:r.integrationStringVersion||1,integrationSettings:e.extend({},r.integrationSettings,s)}}(o,n,t,i),s=x.isExpectingRedirect(),c=x.getLayerId(),l=m.description(i);if(s&&c===i.id&&(E.persist(a,"COOKIE"),_.log("Relaying decision for redirect Campaign",l)),M.shouldSendTrackingData()){var d=F(a,n.isLayerHoldback);if(s&&c===i.id){var h=I.TrackLayerDecisionTimingFlags.preRedirectPolicy;d.timing=h,j(h,[I.PreRedirectPolicies.PERSIST_BEFORE_AND_TRACK_DURING_REDIRECT],d),_.log("Called trackLayerDecision for redirect Campaign",l,d)}else{h=I.TrackLayerDecisionTimingFlags.nonRedirectPolicy;d.timing=h,j(h,[I.NonRedirectPolicies.TRACK_IMMEDIATELY],d),_.log("Called trackLayerDecision for non-redirect Campaign",l,d)}}else _.log("Analytics / Not tracking decision for Campaign",m.description(i))},t.trackPostRedirectDecisionEvent=function(){if(!M.shouldSendTrackingData()||O.hasTracked())return w.resolve();var n=O.get();if(!n)return w.resolve();var t=F(n,!1),i=I.TrackLayerDecisionTimingFlags.postRedirectPolicy;t.timing=i,j(i,[I.PostRedirectPolicies.TRACK_IMMEDIATELY],t);var e=new w((function(n){var t=h.on({filter:{type:v.TYPES.LIFECYCLE,name:"originsSynced"},handler:function(){n(),h.off(t)}})})),o=b.makeTimeoutPromise(1e3);return w.race([e,o]).then((function(){_.log("Calling trackers after successful sync")}),(function(n){_.warn("Calling trackers after failed sync:",n)})).then((function(){(t=F(n,!1)).timing=I.TrackLayerDecisionTimingFlags.postRedirectPolicy,j(I.TrackLayerDecisionTimingFlags.postRedirectPolicy,[I.PostRedirectPolicies.TRACK_AFTER_SYNC],t),g.dispatch(r.REGISTER_TRACKED_REDIRECT_DATA)}))["catch"]((function(n){_.error("Error when calling trackers after sync:",n)}))},t.trackClickEvent=function(n){var t=function(n){var t=U({activeViewStates:k.getActiveViewStates(),visitorProfile:P.getVisitorProfile(),layerStates:D.getLayerStatesForAnalytics()}),i=n.config&&n.config.selector?n.config.selector:n.eventFilter.selector,r=n.apiName,o=n.category||d.OTHER,a=n.id,u=z(n);return e.extend(t,{eventApiName:r,eventCategory:o,eventEntityId:a,eventTags:u,pageId:n.pageId,selector:i})}(n),i={name:n.apiName,type:n.eventType,category:t.eventCategory,tags:t.eventTags};if(o.emitAnalyticsEvent({name:n.name||n.apiName,apiName:n?n.apiName:void 0,type:n.eventType,category:t.eventCategory,tags:t.eventTags,metrics:{}},!M.shouldSendTrackingData()),M.shouldSendTrackingData())return a.addEvent(i),G("onClickEvent",t),t},t.trackViewActivation=function(n,t){if(t||(t=k.getViewState(n.id)),t.isActive){var i=function(n,t){var i=U({activeViewStates:k.getActiveViewStates(),visitorProfile:P.getVisitorProfile(),layerStates:D.getLayerStatesForAnalytics()});return e.extend(i,{pageId:n.id,pageApiName:n.apiName,viewCategory:n.category,eventTags:t.metadata})}(n,t);if(o.emitAnalyticsEvent({name:n.name||i.pageApiName,apiName:i.pageApiName,type:p.PAGEVIEW,category:i.viewCategory,tags:i.eventTags,metrics:{}},!M.shouldSendTrackingData()),M.shouldSendTrackingData())return a.addEvent({name:i.pageApiName,type:p.PAGEVIEW,category:i.viewCategory,tags:i.eventTags}),g.dispatch(r.TRACK_VIEW_ACTIVATED_EVENT,{pageId:n.id,eventData:i}),G("onPageActivated",i),i}else _.debug("Inactive view passed to `trackViewActivation`")}},5840:function(n,t,i){var e=i(3232),r=i(9653),o=i(6491),a=i(1826),u=i(9350),s=i(2425),c=i(9358),f=i(3308),l=i(6822),d=u.get("stores/plugins"),h=".",v=[{name:"sessionId",relayName:"s"},{name:"decisionTicketAudienceIds",relayName:"as",valueToValueString:function(n){return e.map(n,encodeURIComponent).join(",")},encodeValueString:e.identity,decodeValueString:e.identity,valueFromValueString:function(n){return e.map(n.split(","),o.safeDecodeURIComponent)}},{name:"decisionId",relayName:"d"},{name:"activationId",relayName:"aId"},{name:"pageId",relayName:"vId",isNullable:!0},{name:"variationId",relayName:"v",isNullable:!0},{name:"referrer",relayName:"r"},{name:"timestamp",relayName:"t",valueFromValueString:Number},{name:"visitorId",relayName:"i"},{name:"projectId",relayName:"p"},{name:"revision",relayName:"n"},{name:"clientName",relayName:"cN",isNullable:!0},{name:"clientVersion",relayName:"cV"},{name:"namespace",relayName:"ns"},{name:"accountId",relayName:"a"},{name:"layerId",relayName:"l"},{name:"layerName",relayName:"lN",isNullable:!0},{name:"layerPolicy",relayName:"lP"},{name:"experimentId",relayName:"x",isNullable:!0},{name:"experimentName",relayName:"xN",isNullable:!0},{name:"variationName",relayName:"vN",isNullable:!0},{name:"integrationStringVersion",relayName:"isv",valueFromValueString:Number,isNullable:!0},{name:"integrationSettings",relayName:"iS",isMulti:!0,valueToValueString:function(n,t){var i=null;if(n){var r=d.getPlugin(s.PluginTypes.analyticsTrackers,t);if(r&&e.isFunction(r.serializeSettings))try{i=r.serializeSettings(n)}catch(o){f.warn("Analytics / Failed to persist integrationSettings for plugin:",t,o)}}return i},valueFromValueString:function(n,t){var i=null,r=d.getPlugin(s.PluginTypes.analyticsTrackers,t);if(r&&e.isFunction(r.deserializeSettings))try{i=r.deserializeSettings(n)}catch(o){f.warn("Analytics / Failed to persist integrationSettings for plugin:",t,o)}return i},isNullable:!0}],p={},g={};e.forEach(v,(function(n){p[n.name]=n,g[n.relayName]=n})),t.persist=function(n,t){t===l.RedirectRelayMedia.COOKIE?function(n){try{var t=function(n){var t=[],i=e.reduce(n,(function(n,i,r){var o=p[r];return o?(o.isMulti?e.forEach(i,(function(t,i){t=o.valueToValueString?o.valueToValueString(t,i):String(t),e.isNull(t)||(t=(o.encodeValueString||encodeURIComponent)(t),n.push(encodeURIComponent(o.relayName+h+i)+"="+t))})):e.isNull(i)||(i=(o.valueToValueString||String)(i),i=(o.encodeValueString||encodeURIComponent)(i),n.push(o.relayName+"="+i)),n):(t.push(r),n)}),[]);if(t.length)throw new Error("Relay / Don't know how to relay some fields: "+t);return i.sort(),i.join("&")}(n)}catch(i){return f.error("Relay / Error computing redirect relay cookie: ",i),void a.emitError(i)}f.debug("Relay / Setting redirect relay cookie:",t);try{o.set(s.COOKIES.REDIRECT,t,{maxAge:5,encodeValue:!1})}catch(r){f.error("Relay / Failed to set redirect relay cookie",r),a.emitError(r)}}(n):f.error("Relay / Unsupported redirect relay medium: "+t)},t.load=function(n){if(n||(n=function(){var n=o.get(s.COOKIES.REDIRECT,!1);if(n)return f.log("Relay / Found redirect cookie:",n),n}()),n){var t=function(n){var t={},i=n.split("&");return e.forEach(i,(function(n){var i=n.split("=");if(2===i.length){var r=o.safeDecodeURIComponent(i[0]),u=g[r];if(u||(u=e.find(v,(function(n){return n.isMulti&&0===r.indexOf(n.relayName+h)})))){var s=i[1];try{if(u.isMulti){t[u.name]=t[u.name]||{};var c=r.substring(u.relayName.length+h.length);s=(u.decodeValueString||o.safeDecodeURIComponent)(s),s=(u.valueFromValueString||e.identity)(s,c),t[u.name][c]=s}else s=(u.decodeValueString||o.safeDecodeURIComponent)(s),s=(u.valueFromValueString||e.identity)(s),t[u.name]=s}catch(l){return f.warn("Relay / Skipping segment due to decode or parse error:",n,l),void a.emitError(l)}}else f.warn("Relay / Skipping segment with unknown field identifier:",n,r)}else f.warn("Relay / Skipping invalid segment:",n)})),t}(n);if(t){var i=[];if(e.forEach(v,(function(n){(e.isNull(t[n.name])||e.isUndefined(t[n.name]))&&(n.isNullable?t[n.name]=null:(delete t[n.name],i.push(n.name)))})),!i.length)return c.dispatch(r.LOAD_REDIRECT_DATA,t),c.dispatch(r.ADD_CLEANUP_FN,{lifecycle:s.Lifecycle.postVisitorProfileLoad,cleanupFn:function(){var n,i;i=(n=t).pageId||void 0,c.dispatch(r.RECORD_LAYER_DECISION,{layerId:n.layerId,decision:{layerId:n.layerId,experimentId:n.experimentId,variationId:n.variationId,isLayerHoldback:!1},decisionTicket:{audienceIds:n.decisionTicketAudienceIds,bucketingId:n.visitorId,globalHoldback:0,preferredVariationMap:void 0,pageId:i,activationId:n.activationId},sessionId:n.sessionId,activationId:n.activationId,timestamp:n.timestamp,revision:n.revision,namespace:n.namespace,pageId:i}),c.dispatch(r.RECORD_LAYER_DECISION_EVENT_ID,{layerId:n.layerId,pageId:i,decisionId:n.decisionId}),c.dispatch(r.ACTION_EXECUTED,{sessionId:n.sessionId,layerId:n.layerId,pageId:n.pageId,timestamp:n.timestamp,activationId:n.activationId})}}),t;f.error("Relay / Observed redirect data with missing fields:",i)}}}},1826:function(n,t,i){var e=i(5562);t.emitError=function(n,t,i){e.emit({type:"error",name:n.name||"Error",data:{error:n,metadata:t}},i||!1,!0)},t.emitInternalError=function(n,i){t.emitError(n,i,!0)},t.emitAnalyticsEvent=function(n,t){var i={type:"analytics",name:"trackEvent",data:n};e.emit(i,t)}},8798:function(n,t,i){var e=i(3232),r=i(2813),o=i(5210),a=i(3308),u=i(7324);function s(n,t){var i="function"==typeof n?n(t):n;return e.isString(i)&&(i=[i]),e.isArray(i)?i:(a.warn("Couldn't determine fieldsNeeded for matcher; assuming []"),[])}function c(n){return n.name?n.name+" ("+n.id+")":n.id}t.isInAudience=function(n,t,i){var u,f=function(n,t){return function(i){var r=i.type,u=t[r];if(!u)throw new Error("Audience / No matcher found for type="+r);if(u.fieldsNeeded)for(var c=s(u.fieldsNeeded,i),f=0;f<c.length;f++){var l=c[f],d=o.getFieldValue(n,l);if(e.isUndefined(d))return void a.debug("Audience / Required field",l,"for type",r,"has no value")}a.debug("Matching condition:",i,"to values:",n);var h=u.match(n,i);if(!e.isUndefined(h))return!!h}}(n,i);a.groupCollapsed("Checking audience",t.name,t.id,t),a.debug("Visitor Profile:",n);try{var l=r.evaluate(t.conditions,f)}catch(d){u=d,l=!1}return a.groupEnd(),u&&a.error("Audience / Error evaluating audience",c(t),":",u),a.log("Is "+(l?"in":"NOT in")+" audience:",c(t)),l},t.requiredAudienceFieldsForConditions=function f(n,t){var i={};return e.each(n,(function(n){if(e.isArray(n))e.extend(i,f(n,t));else if(e.isObject(n)){var r=t[n.type];if(r){var o=s(r.fieldsNeeded,n);e.each(o,(function(n){i[u.serializeFieldKey(n)]=n}))}}})),i}},2460:function(n,t){t.FIELDS={NAME:"n",TIME:"t",TYPE:"y",CATEGORY:"c",REVENUE:"r",SESSION_ID:"s",OPTIONS:"o",SESSION_INDEX:"si"},t.FIELDS_V0_2={name:t.FIELDS.NAME,time:t.FIELDS.TIME,type:t.FIELDS.TYPE,category:t.FIELDS.CATEGORY,tags:t.FIELDS.OPTIONS,session_index:t.FIELDS.SESSION_INDEX}},6200:function(n,t,i){var e=i(3232),r=i(2460),o=i(5210).getFieldValue,a=i(4447);function u(n,t,i,o,a){this[r.FIELDS.NAME]=n,this[r.FIELDS.TYPE]=t,e.isString(i)&&i.trim().length>0&&(this[r.FIELDS.CATEGORY]=i),o&&e.keys(o).length>0&&(this[r.FIELDS.OPTIONS]=o),e.isUndefined(a)||(this[r.FIELDS.REVENUE]=a)}function s(n,t,i,o){this.eventBase=n,this[r.FIELDS.TIME]=t,e.isUndefined(i)||(this[r.FIELDS.SESSION_ID]=i),e.isUndefined(o)||(this[r.FIELDS.SESSION_INDEX]=o)}t.x=u,u.prototype.digest=function(){var n=function(n,t){return encodeURIComponent(n)+"="+encodeURIComponent(t)},t=[];if(t.push(n(r.FIELDS.NAME,this[r.FIELDS.NAME])),t.push(n(r.FIELDS.TYPE,this[r.FIELDS.TYPE])),this[r.FIELDS.CATEGORY]&&t.push(n(r.FIELDS.CATEGORY,this[r.FIELDS.CATEGORY])),this[r.FIELDS.REVENUE]&&t.push(n(r.FIELDS.REVENUE,this[r.FIELDS.REVENUE])),!this[r.FIELDS.OPTIONS])return t.join("&");var i=this[r.FIELDS.OPTIONS]||{},o=e.filter(e.keys(i),(function(n){return i.hasOwnProperty(n)}));o=o.sort();for(var a=0;a<o.length;a++)t.push(n(o[a],i[o[a]]));return t.join("&")},u.prototype.hash=function(){return this.hash_||(this.hash_=a.hashToHex(a.toByteString(this.digest()),a.Seed.BEHAVIOR_EVENT)),this.hash_},u.prototype.setHash=function(n){this.hash_=n},u.prototype.reHash=function(){this.hash_=null,this.hash()},u.prototype.equals=function(n){if(this.hash()!==n.hash()||this[r.FIELDS.NAME]!==n[r.FIELDS.NAME]||this[r.FIELDS.TYPE]!==n[r.FIELDS.TYPE]||this[r.FIELDS.CATEGORY]!==n[r.FIELDS.CATEGORY]||this[r.FIELDS.REVENUE]!==n[r.FIELDS.REVENUE])return!1;var t=this[r.FIELDS.OPTIONS]||{},i=n[r.FIELDS.OPTIONS]||{},o=e.filter(e.keys(t),(function(n){return t.hasOwnProperty(n)})),a=e.filter(e.keys(i),(function(n){return i.hasOwnProperty(n)}));if(o.length!==a.length)return!1;for(var u=0;u<o.length;u++){var s=o[u];if(!i.hasOwnProperty(s)||t[s]!==i[s])return!1}return!0},u.prototype.getValueOrDefault=function(n,t){var i=o(this,n);return e.isUndefined(i)?t:i},u.prototype.setFieldValue=function(n,t){n!==r.FIELDS.NAME&&n!==r.FIELDS.TYPE&&n!==r.FIELDS.CATEGORY&&n!==r.FIELDS.REVENUE&&n!==r.FIELDS.OPTIONS||(this[n]=t,this.reHash())},t.j=s,s.prototype.getValueOrDefault=function(n,t){if(0===n.length)return this;var i={};i[r.FIELDS.TIME]=this[r.FIELDS.TIME],i[r.FIELDS.SESSION_ID]=this[r.FIELDS.SESSION_ID],i[r.FIELDS.SESSION_INDEX]=this[r.FIELDS.SESSION_INDEX];var a=o(i,n);return e.isUndefined(a)?this.eventBase.getValueOrDefault(n,t):a},s.prototype.setFieldValue=function(n,t){n===r.FIELDS.TIME||n===r.FIELDS.SESSION_ID||n===r.FIELDS.SESSION_INDEX?this[n]=t:this.eventBase.setFieldValue(n,t)};var c={n:"name",y:"type",c:"category",r:"revenue",s:"session_id",o:"tags",si:"session_index"};s.prototype.readableEvent=function(){var n,t,i=function(n){return e.isString(n)?'"'+n+'"':n},o=this,a=[];e.each([r.FIELDS.NAME,r.FIELDS.TYPE,r.FIELDS.CATEGORY,r.FIELDS.REVENUE,r.FIELDS.SESSION_ID],(function(r){n=c[r],t=o.getValueOrDefault([r]),e.isUndefined(t)||a.push(n+": "+i(t))}));var u=[];if(n=c[r.FIELDS.OPTIONS],t=o.getValueOrDefault([r.FIELDS.OPTIONS]),e.isUndefined(t)||(e.each(t,(function(n,t){u.push(t+": "+String(i(n)))})),a.push(n+": {\n\t\t"+u.join(",\n\t\t")+"\n\t}")),t=o.getValueOrDefault([r.FIELDS.TIME]),e.isNumber(t)&&(t=i(new Date(t).toString())),!e.isUndefined(t)){a.push("timestamp: "+t)}return"{\n\t"+a.join(",\n\t")+"\n}"},s.prototype.toObject=function(n){var t,i,o={},a=this;e.each([r.FIELDS.NAME,r.FIELDS.TYPE,r.FIELDS.CATEGORY,r.FIELDS.REVENUE,r.FIELDS.OPTIONS,r.FIELDS.SESSION_INDEX],(function(n){t=c[n],i=a.getValueOrDefault([n],n===r.FIELDS.OPTIONS?{}:void 0),e.isUndefined(i)||(o[t]=i)}));var u=c[r.FIELDS.OPTIONS],s=c[r.FIELDS.REVENUE];if(n&&n.revenueAsTag&&o[s]&&(o[u]=o[u]||{},o[u][s]=o[s],delete o[s]),i=a.getValueOrDefault([r.FIELDS.TIME]),e.isNumber(i))if(n&&n.timeAsTimestamp){o.timestamp=new Date(i)}else{o.time=i}return o}},7201:function(n,t,i){var e=i(405);t.initializeStore=e.initialize,t.addEvent=e.addEvent,t.getEvents=e.getEvents,t.getEventCount=e.getEventCount},2611:function(n,t,i){var e=i(6200).j,r=i(1217),o=i(2460),a=i(6200).x;t.CURRENT_SESSION_INDEX=0;var u=18e5;function s(n,i){var e;e=t.isInSameSession(n,i)?n.getValueOrDefault([o.FIELDS.SESSION_ID]):i.getValueOrDefault([o.FIELDS.TIME]),i.setFieldValue(o.FIELDS.SESSION_ID,e)}function c(n,i,e){var r,a=n.getValueOrDefault([o.FIELDS.SESSION_INDEX]);r=t.isInSameSession(i,n)?a:e?a+1:a-1,i.setFieldValue(o.FIELDS.SESSION_INDEX,r)}t.isInSameSession=function(n,t){var i=n.getValueOrDefault([o.FIELDS.TIME],0),e=t.getValueOrDefault([o.FIELDS.TIME],0);return Math.abs(i-e)<u},t.updateSessionId=function(n,t){if(n){var i=n.getValueOrDefault([o.FIELDS.TIME]),r=n.getValueOrDefault([o.FIELDS.SESSION_ID]),u=t.getValueOrDefault([o.FIELDS.TIME]);i="number"!=typeof i?u-36e5:i,r="number"!=typeof r?i:r,s(n=new e(new a("",""),i,r),t)}else t.setFieldValue(o.FIELDS.SESSION_ID,t.getValueOrDefault([o.FIELDS.TIME]))},t.updateSessionIndex=function(n,t){if(n){var i=n.getValueOrDefault([o.FIELDS.TIME]),r=n.getValueOrDefault([o.FIELDS.SESSION_INDEX]),u=t.getValueOrDefault([o.FIELDS.TIME]),s=n.getValueOrDefault([o.FIELDS.SESSION_ID]);i="number"!=typeof i?u-36e5:i,r="number"!=typeof r?0:r,s="number"!=typeof s?i:s,c(n=new e(new a("",""),i,s,r),t,!1)}else t.setFieldValue(o.FIELDS.SESSION_INDEX,0)},t.sessionize=function(n){var i=n.length;if(0!==i){n[0].setFieldValue(o.FIELDS.SESSION_ID,n[0].getValueOrDefault([o.FIELDS.TIME]));for(var e=1;e<i;e++)s(n[e-1],n[e]);var a=t.CURRENT_SESSION_INDEX,f=n[i-1].getValueOrDefault([o.FIELDS.TIME]);r.now()-f>u&&(a+=1),n[i-1].setFieldValue(o.FIELDS.SESSION_INDEX,a);for(e=i-1;e>0;e--)c(n[e],n[e-1],!0)}},t.reindexIfNecessary=function(n,t,i){var e=function(n){for(var t=0;t<n.length;t++){var i=n[t].getValueOrDefault([o.FIELDS.SESSION_INDEX]);n[t].setFieldValue(o.FIELDS.SESSION_INDEX,i+1)}};-1===n.getValueOrDefault([o.FIELDS.SESSION_INDEX])&&(e(t),e(i))},t.sessionSortPredicate=function(n,t){return n[o.FIELDS.TIME]-t[o.FIELDS.TIME]},t.applyMigrations=function(n){return!1}},405:function(n,t,i){var e=i(3232),r=i(9653),o=i(1217),a=i(582),u=i(9358),s=i(3308),c=i(7324),f=t,l=i(6200).j,d=i(2460),h=i(6200).x,v=i(2611),p=i(9350),g=p.get("stores/visitor_events"),m=p.get("stores/visitor_events_manager"),_={EVENTBASE:"eb",HASH:"h",TIMEBASE:"tb",TIMESTAMPS:"ts",DELTA:"d",INDEX:"i"};function w(n){u.dispatch(r.SET_VISITOR_EVENTS,n)}function y(n){u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"baseMap",value:n})}function E(n){u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"eventQueue",value:n})}function b(n){u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"lastEvent",value:n})}function I(){return g.getEvents()}function A(){return m.getBaseMap()}function T(){return m.getEventQueue()}function S(){return m.getLastEvent()}function R(){var n=I().concat(T()),t=!1;return n.length>1e3&&(n=n.slice(-1e3),t=!0),w(n),E([]),t}t.initialize=function(n,t){if(!m.getInitialized()){f.S(n,t);var i=I();i.length>0&&b(i[i.length-1]);var e=T();e.length>0&&b(e[e.length-1]),u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"initialized",value:!0})}},t.addEvent=function(n){s.debug("Behavior store: adding event",n);var t=f.R(n);b(t),E(T().concat(t)),v.reindexIfNecessary(S(),I(),T()),f.k(T())},t.getEvents=function(){return T().length>0&&(R()&&v.sessionize(I()),f.N(I()),f.k(T())),I()},t.getEventCount=function(){return T().length+I().length},f.S=function(n,t){f.D(n,t)&&(f.N(I()),f.k(T())),v.sessionize(I())},f.D=function(n,t){if(0===n.length&&0===t.length)return w([]),E([]),!1;var i=!1,e=n[0]||t[0];return _.EVENTBASE in e?(w(f.C(n)),E(f.C(t))):(i=!0,w(f.O(n)),E(f.O(t))),T().length>0&&(R(),i=!0),w(f._updateBaseMapAndMaybeDedupe(I())),f._migrateEventBasesAndUpdateStore()&&(i=!0),i},f.O=function(n){for(var t=[],i=0;i<n.length;i++){var e=n[i],r=f.P(e);t[i]=new l(r,e[d.FIELDS.TIME])}return t},f._migrateEventBasesAndUpdateStore=function(){var n=!1,t=f.M();return v.applyMigrations(t)&&(n=!0,y({}),w(f._updateBaseMapAndMaybeDedupe(I())),E(f._updateBaseMapAndMaybeDedupe(T()))),n},f.L=function(){return o.now()},f.R=function(n){var t,i=n.name,e=n.type||"default",r=n.category||a.OTHER,o=n.tags||{};n.revenue&&(t=n.revenue);var u=new h(i,e,r,o,t);u=f.V(u);var s=f.L(),c=new l(u,s,-1);return v.updateSessionId(S(),c),v.updateSessionIndex(S(),c),c},f._updateBaseMapAndMaybeDedupe=function(n){for(var t=0;t<n.length;t++)n[t].eventBase=f.V(n[t].eventBase);return n},f.N=function(n){var t=f.F(n);c.persistBehaviorEvents(t)},f.k=function(n){var t=f.F(n);c.persistBehaviorEventQueue(t)},f.B=function(){var n;m.getCleared()||(w([]),E([]),f.N(I()),f.k(T()),y({}),b(null),n=!0,u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"cleared",value:n}))},f.V=function(n){var t=n.hash(),i=A(),r=i[t];if(e.isUndefined(r))return i[t]=[n],y(i),n;for(var o=0;o<r.length;o++)if(n.equals(r[o]))return r[o];return r.push(n),y(i),n},f.M=function(){var n=[],t=A();for(var i in t)!t.hasOwnProperty(i)||(n=n.concat(t[i]));return n},f.F=function(n){for(var t=function(n){var t={};t[d.FIELDS.NAME]=n.getValueOrDefault([d.FIELDS.NAME]),t[d.FIELDS.TYPE]=n.getValueOrDefault([d.FIELDS.TYPE]);var i=n.getValueOrDefault([d.FIELDS.CATEGORY]);e.isUndefined(i)||(t[d.FIELDS.CATEGORY]=i);var r=n.getValueOrDefault([d.FIELDS.REVENUE]);e.isUndefined(r)||(t[d.FIELDS.REVENUE]=r);var o=n.getValueOrDefault([d.FIELDS.OPTIONS]);return e.isUndefined(o)||(t[d.FIELDS.OPTIONS]=o),t},i=_,r=[],o="_idx_",a=0;a<n.length;a++){var u,s,c=n[a],f=c.eventBase;if(f.hasOwnProperty(o)){u=r[f._idx_];var l=c[d.FIELDS.TIME]-(u[i.TIMEBASE]||0);(s={})[i.DELTA]=l,s[i.INDEX]=a,u[i.TIMESTAMPS].push(s)}else(u={})[i.EVENTBASE]=t(c),u[i.HASH]=f.hash(),u[i.TIMEBASE]=c[d.FIELDS.TIME],(s={})[i.DELTA]=0,s[i.INDEX]=a,u[i.TIMESTAMPS]=[s],r.push(u),f._idx_=r.length-1}for(a=0;a<n.length;a++)delete n[a].eventBase._idx_;return r},f.P=function(n,t){var i=new h(n[d.FIELDS.NAME],n[d.FIELDS.TYPE],n[d.FIELDS.CATEGORY],n[d.FIELDS.OPTIONS],n[d.FIELDS.REVENUE]);return e.isUndefined(t)||i.setHash(t),i},f.C=function(n){for(var t=_,i=[],e=0;e<n.length;e++)for(var r=n[e],o=f.P(r[t.EVENTBASE],r[t.HASH]),a=r[t.TIMEBASE],u=r[t.TIMESTAMPS],s=0;s<u.length;s++){var c=u[s],d=new l(o,a+c[t.DELTA]);i[c[t.INDEX]]=d}return i},t.deserialize=function(n){return f.C(n)},t.mergeAllEvents=function(n){var t=[].concat.apply([],n);return t.sort(v.sessionSortPredicate),v.sessionize(t),t}},9653:function(n,t,i){var e=i(1575);n.exports=e({LOG:null,SET_LOGLEVEL:null,INITIALIZE_STATE:null,SET_DOMCONTENTLOADED:null,ACTIVATE:null,UPDATE_BEHAVIOR_STORE:null,DATA_LOADED:null,SET_CLIENT_NAME:null,SET_CLIENT_VERSION:null,LOAD_PERSISTED_LAYER_STATES:null,RECORD_GLOBAL_DECISION:null,RECORD_LAYER_DECISION:null,ENSURE_ORIGINAL_PUSHSTATE:null,ENSURE_ORIGINAL_REPLACESTATE:null,SET_VISITOR_ATTRIBUTES:null,SET_VISITOR_ATTRIBUTE_PENDING:null,LOAD_EXISTING_VISITOR_PROFILE:null,SET_VISITOR_EVENTS:null,SET_FOREIGN_VISITOR_EVENTS:null,SET_FOREIGN_VISITOR_EVENT_QUEUE:null,SET_VISITOR_ID:null,SET_VISITOR_ID_VIA_API:null,REFRESH_SESSION:null,LOAD_SESSION_STATE:null,UPDATE_VARIATION_ID_MAP:null,MERGE_VARIATION_ID_MAP:null,UPDATE_PREFERRED_LAYER_MAP:null,MERGE_PREFERRED_LAYER_MAP:null,RECORD_LAYER_DECISION_EVENT_ID:null,TRACK_VIEW_ACTIVATED_EVENT:null,REGISTER_ASYNC_DEFERRED:null,RESOLVE_DEFERRED:null,REJECT_DEFERRED:null,REGISTER_PLUGIN:null,ADD_CLEANUP_FN:null,CLEAR_CLEANUP_FN:null,ACTION_EXECUTED:null,REGISTER_ACTION:null,SET_VIEW_ACTIVE_STATE:null,UPDATE_PARSED_VIEW_METADATA:null,UPDATE_USER_SUPPLIED_METADATA:null,REGISTER_VIEWS:null,SET_GLOBAL_TAGS:null,SET_VIEW_BATCHING:null,RESET_VIEW_STATES:null,ATTACH_EVENT_STREAM_PUBLISHERS:null,DETACH_EVENT_STREAM_PUBLISHERS:null,LOAD_DIRECTIVE:null,SET_COOKIE_AGE:null,SET_COOKIE_DOMAIN:null,SET_COOKIE_AUTO_REFRESH:null,XDOMAIN_SET_DEFAULT_FRAME:null,XDOMAIN_ADD_FRAME:null,XDOMAIN_SET_MESSAGE:null,XDOMAIN_ADD_SUBSCRIBER:null,XDOMAIN_SET_CANONICAL_ORIGINS:null,XDOMAIN_SET_DISABLED:null,ADD_EMITTER_HANDLER:null,REMOVE_EMITTER_HANDLER:null,SET_INTEGRATION_SETTINGS:null,ADD_CHANGE:null,SET_CHANGE_APPLIER:null,REMOVE_ACTION_STATE:null,ANNOUNCE_PENDING_REDIRECT:null,LOAD_REDIRECT_DATA:null,REGISTER_TRACKED_REDIRECT_DATA:null,SET_PENDING_EVENT:null,REMOVE_PENDING_EVENT:null,LOAD_PENDING_EVENTS:null,SANDBOXED_FUNCTIONS_ADDED:null,SET_RUM_DATA:null,RECORD_API_USAGE:null,INITIALIZE_CHANGE_METRICS:null,RECORD_ACTIVATION_TYPE_USAGE:null,RECORD_AUDIENCE_USAGE:null,RECORD_CHANGE_MACROTASK_RATE:null,RECORD_CHANGE_OVERHEATED:null,RECORD_CHANGE_TYPE_USAGE:null,RECORD_DOM_OBSERVATION_OCCURENCE:null,RECORD_INTEGRATION_USAGE:null,RECORD_LAYER_FEATURE_USAGE:null,RECORD_LAYER_POLICY_USAGE:null,RECORD_RECOMMENDATIONS_USAGE:null,RECORD_VIEW_FEATURE_USAGE:null,RECORD_VIEWS_INITIALLY_ACTIVATED_COUNT:null,RECORD_VISITOR_ID_LOCATOR_USAGE:null,RECORD_VISITOR_ID_ERROR:null,RECORD_STICKY_BUCKETING_FEATURE:null,SET_PERFORMANCE_MARKS_DATA:null,FINALIZE_BATCH_SNAPSHOT:null,REGISTER_PREVIOUS_BATCH:null,REGISTER_TRACKER_VISITOR:null,REGISTER_TRACKER_EVENT:null,REGISTER_TRACKER_DECISION:null,RESET_TRACKER_EVENTS:null,RESET_TRACKER_PREVIOUS_BATCHES:null,RESET_TRACKER_STORE:null,SET_TRACKER_POLLING:null,SET_TRACKER_BATCHING:null,SET_TRACKER_SEND_EVENTS:null,SET_TRACKER_PERSISTABLE_STATE:null,SET_TRACKER_DIRTY:null,UPDATE_TRACKER_VISITOR_ATTRIBUTES:null,SET_UA_DATA:null})},2425:function(n,t,i){var e=i(3232),r=i(1575);t.COOKIES={OPT_OUT:"optimizelyOptOut",PREVIEW:"optimizelyPreview",REDIRECT:"optimizelyRedirectData",SESSION_STATE:"optimizelySessionState",TOKEN:"optimizelyToken",VISITOR_ID:"optimizelyEndUserId",VISITOR_UUID:"optimizelyPPID"},t.LayerActivationTypes={CONDITIONAL:"conditional",IMMEDIATE:"immediate",MANUAL:"manual",READY:"ready",TIMEOUT:"timeout"},t.LogLevel={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},t.Lifecycle=r({preActivate:null,postVisitorProfileLoad:null,postViewsActivated:null,postActivate:null}),t.ViewActivationTypes={immediate:"immediate",manual:"manual",callback:"callback",polling:"polling",URLChanged:"url_changed",DOMChanged:"dom_changed"},t.StorageKeys={PENDING_EVENTS:"pending_events",RELAYED_EVENTS:"relayed_events"},t.PluginTypes=r({visitorProfileProviders:null,viewProviders:null,audienceMatchers:null,viewMatchers:null,analyticsTrackers:null,viewTagLocators:null,userFeatureDefs:null,apiModules:null,changeAppliers:null,deciders:null,eventImplementations:null,viewTriggers:null}),t.ResourceTimingAttributes=r({connectStart:null,connectEnd:null,decodedBodySize:null,domainLookupStart:null,domainLookupEnd:null,duration:null,encodedBodySize:null,fetchStart:null,requestStart:null,responseStart:null,responseEnd:null,secureConnectionStart:null,startTime:null,transferSize:null,serverTiming:null}),t.RUMPerformanceTimingAttributes=r({blockTime:null}),t.AttributionTypes=r({FIRST_TOUCH:null,LAST_TOUCH:null}),t.SandboxedFunctions=r({XMLHttpRequest:null}),t.PerformanceData=r({performance_marks:null,resource_timing:null,performance_timing:null}),t.PerformanceCounters=r({mutation_observer_invocation:null,polling_invocation:null,match_selector_invocation:null}),t.VisitorStorageKeys={EVENTS:"events",EVENT_QUEUE:"event_queue",LAYER_MAP:"layer_map",LAYER_STATES:"layer_states",SESSION_STATE:"session_state",VISITOR_PROFILE:"visitor_profile",VARIATION_MAP:"variation_map",TRACKER_OPTIMIZELY:"tracker_optimizely"},t.AllStorageKeys=e.assign({},t.StorageKeys,t.VisitorStorageKeys),t.ListTargetingKeyTypes={COOKIE:"c",QUERY:"q",JS_VARIABLE:"j"},t.VisitorIdLocatorType={COOKIE:"cookie",JS_VARIABLE:"js",LOCALSTORAGE:"localStorage",QUERY:"query"}},582:function(n){n.exports={OTHER:"other"}},4630:function(n,t){t.TYPES={ACTION:"action",ANALYTICS:"analytics",EDITOR:"editor",LIFECYCLE:"lifecycle"}},1069:function(n){n.exports={CLICK:"click",CUSTOM:"custom",ENGAGEMENT:"engagement",PAGEVIEW:"pageview"}},6822:function(n,t,i){var e=i(1575);t.TrackLayerDecisionTimingFlags=e({preRedirectPolicy:null,postRedirectPolicy:null,nonRedirectPolicy:null}),t.PreRedirectPolicies=e({PERSIST_BEFORE_AND_TRACK_DURING_REDIRECT:null,PERSIST_BEFORE_REDIRECT:null}),t.PostRedirectPolicies=e({TRACK_IMMEDIATELY:null,TRACK_AFTER_SYNC:null}),t.NonRedirectPolicies=e({TRACK_IMMEDIATELY:null}),t.RedirectRelayMedia=e({COOKIE:null})},6416:function(n,t,i){var e=i(4447),r=t.TOTAL_POINTS=1e4;t.bucketingNumber=function(n,t,i){return e.hashToInt(n+t,i,r)},t.isHoldback=function(n,i){return t.bucketingNumber(n,i.id,e.Seed.IGNORING)<(i.holdback||0)},t.chooseWeightedCandidate=function(n,i,r){for(var o=t.bucketingNumber(n,i,e.Seed.BUCKETING),a=0;a<r.length;a++)if(r[a].endOfRange>o)return r[a].entityId;throw new Error("Unable to choose candidate")}},7929:function(n,t,i){var e=i(3232),r=i(9653),o=i(6416),a=i(2813),u=i(3529).E,s=i(9358),c=i(3308);t.isValidExperiment=function(n,t){var i,r=e.partial(e.includes,n);return c.groupCollapsed("Decision / Evaluating audiences for experiment:",t,n),i=!t.audienceIds||a.evaluate(t.audienceIds,r),c.groupEnd(),c.debug("Decision / Experiment",t,"is valid?",i),i},t.selectVariation=function(n,t,i,a,f){if(!n.variations||0===n.variations.length)throw new u('No variations in selected experiment "'+n.id+'"');if(!n.weightDistributions&&n.variations.length>1)throw new u('On selected experiment "'+n.id+'", weightDistributions must be defined if # variations > 1');var l;if(n.bucketingStrategy&&"impression"===n.bucketingStrategy)if(1===n.variations.length)l=n.variations[0].id;else{var d=a;l=o.chooseWeightedCandidate(i+d,n.id,n.weightDistributions)}else if(l=1===n.variations.length?n.variations[0].id:o.chooseWeightedCandidate(i,n.id,n.weightDistributions),f&&f[n.id]){c.debug("Decision / Using preferredVariationMap to select variation for experiment:",n.id);var h=f[n.id];if(!e.find(n.variations,{id:h}))return s.dispatch(r.RECORD_STICKY_BUCKETING_FEATURE,{feature:"stoppedVariation",id:n.id}),c.debug("Decision / Preferred variation:",h,"not found on experiment:",n.id,". Visitor not bucketed."),null;h!==l&&(s.dispatch(r.RECORD_STICKY_BUCKETING_FEATURE,{feature:"preferredVariation",id:n.id}),l=h)}var v=e.find(n.variations,{id:l});if(v)return c.debug("Decision / Selected variation:",v),v;throw new u('Unable to find selected variation: "'+l+'".')},t.getExperimentById=function(n,t){var i=e.find(n.experiments,{id:t});if(i)return i;throw new u("Unable to find selected experiment.")},t.hasVariationActionsOnView=function(n,t){return c.debug("Decision / Checking variation:",n,"for actions on pageId:",t),!!e.find(n.actions,(function(n){return n.pageId===t&&!e.isEmpty(n.changes)}))}},3529:function(n,t){function i(n){this.message=n}i.prototype=new Error,t.E=i},6280:function(n,t,i){var e=i(3232),r=i(9653),o=i(1826),a=i(8798),u=i(6416),s=i(7929),c=i(3529).E,f=i(9350),l=i(2425),d=i(9358),h=i(7356),v=i(406),p=i(3308),g=i(5293),m=f.get("stores/plugins"),_=f.get("stores/global"),w=f.get("stores/layer_data");function y(n){var t=m.getPlugin(l.PluginTypes.deciders,n);if(e.isEmpty(t))throw new Error("No deciders found for policy: "+n);return t}t.isPageIdRelevant=function(n){if(!n)return!1;var t=y(n.policy);return e.isFunction(t.includePageIdInDecisionTicket)?t.includePageIdInDecisionTicket(n):!0===t.includePageIdInDecisionTicket},t.createTicket=function(n){var t,i,r,o=e.pick(n,["bucketingId","globalHoldback","preferredVariationMap","pageId"]);return e.extend(o,{audienceIds:(t=n.visitorProfile,i=n.audiences,r=m.getAllPlugins(l.PluginTypes.audienceMatchers),e.reduce(i,(function(n,i){return a.isInAudience(t,i,r)&&n.push(i.id),n}),[])),activationId:_.getActivationId()}),o},t.decideGlobal=function(n){return{isGlobalHoldback:u.isHoldback(n.bucketingId,{id:null,holdback:n.globalHoldback})}},t.decideGroup=function(n,t){p.debug("Decision / Deciding layer for group: ",h.description(n));var i,o,a=t.preferredLayerId,s=!!a;try{(i=u.chooseWeightedCandidate(t.bucketingId,n.id,n.weightDistributions))&&"None"!==i||(o='Group traffic allocation. Visitor maps to a "hole" in the bucket space left by an experiment or campaign that\'s since been removed from the group')}catch(l){o="Group traffic allocation. Visitor maps to a point in the bucket space which has never been covered by any experiment or campaign."}if(s&&(p.debug("Decision / Using preferredLayerMap to select layer for group:",h.description(n)),a!==i&&(d.dispatch(r.RECORD_STICKY_BUCKETING_FEATURE,{feature:"preferredLayer",id:n.id}),i=a)),o)return{layerId:null,reason:o};if(!e.find(n.weightDistributions,{entityId:i})){var f="Visitor was"+(s?" sticky-":" non-sticky ")+"bucketed into a campaign ("+i+") which is not in the group";if(!s)throw new c(f);return{layerId:null,reason:f}}return{layerId:i}},t.decideLayer=function(n,t){var i,r;p.debug("Deciding: ",n,t);var a,f,l=y(n.policy),d={layerId:n.id,experimentId:null,variationId:null,isLayerHoldback:u.isHoldback(t.bucketingId,n)};if(e.isEmpty(n.experiments))throw new c("No experiments in layer.");try{if(l.decideLayer){p.debug("Decision / Using decider's custom decideLayer.");var h=l.decideLayer(n,t);i=h.experiment,r=h.variation}else p.debug("Decision / Using default decideLayer behavior."),i=l.selectExperiment(n,t.audienceIds,t.bucketingId),r=s.selectVariation(i,t.audienceIds,t.bucketingId,t.activationId,t.preferredVariationMap)}catch(v){a=v,(null!=(f=c)&&"undefined"!=typeof Symbol&&f[Symbol.hasInstance]?f[Symbol.hasInstance](a):a instanceof f)?d.reason=v.message:d.error=v}return d.experimentId=i?i.id:null,d.variationId=r?r.id:null,d.error&&(d.error.name="DecisionEngineError",o.emitError(d.error)),d},t.getDummyLayerDecision=function(n,t){var i,e=function(n,t){for(var i=0;i<n.experiments.length;i++)for(var e=0;e<n.experiments[i].variations.length;e++)if(t.indexOf(n.experiments[i].variations[e].id)>-1)return{experimentId:n.experiments[i].id,variationId:n.experiments[i].variations[e].id};return null}(n,t);return e?(p.log("Decision / Applying force variation:",e.variationId,"to Campaign",v.description(n)),i={layerId:n.id,variationId:e.variationId,experimentId:e.experimentId,isLayerHoldback:!1,reason:"force"}):(p.log("No variation matches ids:",t,"in Campaign",v.description(n)),i={layerId:n.id,variationId:null,experimentId:null,isLayerHoldback:!1,reason:"force"}),i},t.isInCohort=function(n){if(!n.experimentId||!n.variationId)return!1;var t=w.get(n.layerId);return!(g.isSingleExperimentPolicy(t.policy)&&n.isLayerHoldback)}},9350:function(n,t,i){var e=i(3232),r=i(3599),o=i(9358),a=i(5168),u=r.create(),s={action_data:i(3264),async_request:i(7402),audience_data:i(1139),change_data:i(4410),cleanup:i(9247),client_metadata:i(4599),cookie_options:i(7283),event_data:i(6391),event_emitter:i(4021),dimension_data:i(5),directive:i(4911),global:i(6033),history:i(8858),integration_settings:i(9627),layer:i(8347),layer_data:i(3831),log:i(1066),observed_redirect:i(8592),pending_events:i(2492),performance:i(703),plugins:i(1043),provider_status:i(6858),pending_redirect:i(493),rum:i(2981),sandbox:i(2709),session:i(5053),tracker_optimizely:i(1755),ua_data:i(557),view:i(3523),view_data:i(6107),visitor:i(2975),visitor_attribute_entity:i(7947),visitor_events:i(1325),visitor_events_manager:i(98),visitor_id:i(6950),visitor_bucketing:i(6018),xdomain:i(2775)};s.group_data=i(1647),o.registerStores(s),e.forOwn(s,(function(n,t){u.register("stores/"+t,o.getStore(t))})),u.register("core/plugins/matchers/key_value",a),n.exports=u},474:function(n,t,i){var e=i(3232),r=i(9653),o=i(1826),a=i(6491),u=i(8235).U,s=i(2425),c=i(9358),f=i(3308),l=t.JSONParseError=u("JSONParseError"),d=i(2052),h=i(6898),v=i(7082),p="optimizely_show_preview",g="optimizely_disable",m="optimizely_editor",_="optimizely_p13n",w="optimizely_x_audiences",y="optimizely_x",E="optimizely_show_preview",b="optimizely_opt_out",I="optimizely_token",A="optimizely_force_tracking";t.populateDirectiveData=function(){var n,t,i,u,T,S,R,k;!function(){var n="OFF",t=d.getQueryParamValue("optimizely_log");if(t){var i=t.split(":");""!==i[0]&&(n=String(i[0]).toUpperCase()),void 0!==i[1]&&f.setLogMatch(i[1])}f.setLogLevel(n)}(),function(){var n=v.getUserAgent()||"";if(!e.isString(n))return void f.warn("Directive / userAgent not a string");n=n.toLowerCase();var t=["googlebot","yahoo! slurp","bingbot","bingpreview","msnbot","keynote","ktxn","khte","gomezagent","alertsite","yottaamonitor","pingdom.com_bot","aihitbot","baiduspider","adsbot-google","mediapartners-google","applebot","catchpoint","phantomjs","moatbot","facebookexternalhit"],i=function(t){if(e.includes(n,t))return f.warn("Directive / Matches bot:",t),!0};e.some(t,i)&&(f.log("Directive / Disabling tracking"),c.dispatch(r.LOAD_DIRECTIVE,{trackingDisabled:!0}))}(),n=Boolean(e.result(window.optimizely,"initialized")),c.dispatch(r.LOAD_DIRECTIVE,{alreadyInitialized:n}),c.dispatch(r.LOAD_DIRECTIVE,{mutationObserverAPISupported:v.isMutationObserverAPISupported()}),function(){var n=a.get(s.COOKIES.OPT_OUT),t=d.getQueryParamValue(b),i="You have successfully opted out of Optimizely for this domain.",e="You are NOT opted out of Optimizely for this domain.";if("true"===t||"false"===t){var o="true"===t;c.dispatch(r.LOAD_DIRECTIVE,{shouldOptOut:o}),v.alert(o?i:e)}else n&&c.dispatch(r.LOAD_DIRECTIVE,{shouldOptOut:"true"===n})}(),function(){var n=!1,t=[p,g];t.push(m);for(var i=0;i<t.length;i++)if("true"===d.getQueryParamValue(t[i])){f.warn("Directive / Not activating because "+t[i]+" is set."),n=!0;break}c.dispatch(r.LOAD_DIRECTIVE,{disabled:n})}(),c.dispatch(r.LOAD_DIRECTIVE,{isEditor:!1}),c.dispatch(r.LOAD_DIRECTIVE,{isPreview:!1}),(t=d.getQueryParamValue(E))&&f.log("Directive / Is legacy preview mode"),c.dispatch(r.LOAD_DIRECTIVE,{isLegacyPreview:!!t}),c.dispatch(r.LOAD_DIRECTIVE,{isSlave:!1}),i=v.getGlobal("optlyDesktop"),(u=!(!i||e.isUndefined(i.p13nInner)))&&f.log("Directive / Is running in desktop app editor"),c.dispatch(r.LOAD_DIRECTIVE,{isRunningInDesktopApp:u}),(T="true"===d.getQueryParamValue(_))&&f.log("Directive / Is running in editor"),c.dispatch(r.LOAD_DIRECTIVE,{isRunningInV2Editor:T}),S=a.get(s.COOKIES.TOKEN)||null,R=d.getQueryParamValue(I)||S,c.dispatch(r.LOAD_DIRECTIVE,{projectToken:R}),function(){var n=a.get(s.COOKIES.PREVIEW),t=[],i=d.getQueryParamValue(w);if(i)t=a.safeDecodeURIComponent(i).split(",");else if(n)try{t=h.parse(n).forceAudienceIds}catch(v){var e=new l("Failed to parse previewCookie in registerForceAudienceIds: "+n),u={originalMessage:v.message,userError:!0};o.emitError(e,u)}t.length&&(f.log("Directive / Force Audience IDs:",t),c.dispatch(r.LOAD_DIRECTIVE,{forceAudienceIds:t}))}(),function(){var n=a.get(s.COOKIES.PREVIEW),t=[],i=d.getQueryParamValue(y);if(i)t=a.safeDecodeURIComponent(i).split(",");else if(n)try{t=h.parse(n).forceVariationIds}catch(v){var e=new l("Failed to parse previewCookie in registerForceVariationIds: "+n),u={originalMessage:v.message,userError:!0};o.emitError(e,u)}t.length&&(f.log("Directive / Force Variation IDs:",t),c.dispatch(r.LOAD_DIRECTIVE,{forceVariationIds:t}))}(),(k=d.getQueryParamValue(A))&&c.dispatch(r.LOAD_DIRECTIVE,{forceTracking:k})};t.setOptOut=function(n){n?(f.warn("Directive / Opting out"),a.set(s.COOKIES.OPT_OUT,"true",{maxAge:31536e4},!0)):a.remove(s.COOKIES.OPT_OUT),c.dispatch(r.LOAD_DIRECTIVE,{shouldOptOut:n})}},1217:function(n,t){t.now=function(){return+new Date}},8127:function(n,t){t.VERSION="0.176.0",t.NAME="js"},1596:function(n,t,i){var e=i(9350).get("stores/global");t.getDocumentElement=function(){return document.documentElement},t.getCookieString=function(){return document.cookie||""},t.setCookie=function(n){document.cookie=n},t.querySelector=function(n){return document.querySelector(n)},t.querySelectorAll=function(n){return document.querySelectorAll(n)},t.parseUri=function(n){var i=t.createElement("a");return i.href=n,i},t.childrenOf=function(n){return Array.prototype.slice.call(n.querySelectorAll("*"))},t.createElement=function(n){return document.createElement(n)},t.isReady=function(){return e.domContentLoadedHasFired()||"interactive"===document.readyState||"complete"===document.readyState},t.isLoaded=function(){return"complete"===document.readyState},t.addReadyHandler=function(n){return document.addEventListener("DOMContentLoaded",n),function(){t.removeReadyHandler(n)}},t.removeReadyHandler=function(n){return function(){document.removeEventListener("DOMContentLoaded",n)}},t.getReferrer=function(){return document.referrer},t.getReadyState=function(){return document.readyState},t.write=function(n){if("loading"!==t.getReadyState())throw new Error("Aborting attempt to write to already-loaded document");document.write(n)},t.appendToHead=function(n){return t.appendTo(document.head,n)},t.appendTo=function(n,t){n.appendChild(t)},t.addEventListener=function(n,t,i){return document.addEventListener(n,t,i),function(){document.removeEventListener(n,t,i)}},t.getCurrentScript=function(){if(document.currentScript)return document.currentScript},t.parentElement=function(n){for(var t=n.parentNode;t.nodeType!==Node.ELEMENT_NODE;)t=t.parentNode;return t}},7075:function(n,t,i){var e,r,o="optimizely_data",a=i(8235).U,u=i(4015),s=i(7082),c=a("StorageError");try{r=s.getGlobal("localStorage")}catch(f){throw new c("Unable to read localStorage: "+f.toString())}if(!r)throw new c("localStorage is undefined");e=u.create(r,o),t.mM=e},1016:function(n,t){t.create=function(n){return new MutationObserver(n)},t.observe=function(n,t,i){n.observe(t,i)}},4593:function(n,t,i){var e=i(4702).Promise,r=i(7082);t.estimateStorage=function(){var n=r.getGlobal("navigator");try{return n.storage.estimate()}catch(t){return e.resolve({usage:null,quota:null})}}},5519:function(n,t,i){var e=i(9653),r=i(8235).U,o=i(1217),a=i(9358),u=i(7082),s=i(9350).get("stores/rum"),c="optimizely:",f=t.Error=r("PerformanceError");function l(){return u.getGlobal("performance")}t.time=function(n){if(s.getSampleRum()){var t=l();if(t&&t.mark){var i=c+n;t.clearMarks(i+"Begin"),t.mark(i+"Begin")}}},t.timeEnd=function(n){if(s.getSampleRum()){var t=l();if(t&&t.mark){var i=c+n,r=t.getEntriesByName(i+"Begin");if(0===r.length)throw new f("Called timeEnd without matching time: "+n);t.clearMarks(i+"End"),t.mark(i+"End");var o=n+"Time",u=t.getEntriesByName(i+"End")[0].startTime-r[0].startTime;a.dispatch(e.SET_PERFORMANCE_MARKS_DATA,{name:o,data:{startTime:Math.round(1e3*r[0].startTime)/1e3,duration:Math.round(1e3*u)/1e3}})}}},t.now=function(){var n=l();return n?n.now():o.now()}},7082:function(n,t,i){var e=i(3232),r=i(3308);t.getUserAgent=function(){return window.navigator.userAgent},t.getLocationSearch=function(){return window.location.search},t.getNavigatorLanguage=function(){return window.navigator.language||window.navigator.userLanguage},t.getHref=function(){return window.location.href},t.getLocation=function(){return window.location},t.setLocation=function(n){window.location.replace(n)},t.setGlobal=function(n,t){window[n]=t},t.getGlobal=function(n){return window[n]},t.getGlobalByPath=function(n){for(var t=n.split("."),i=window;t.length;)try{i=i[t.shift()]}catch(e){throw r.error("Attempted to access nonexistent property. Path ",n),new Error("Attempted to access nonexistent property. Path "+n)}return i},t.addEventListener=function(){return window.addEventListener.apply(window,arguments)},t.removeEventListener=function(){return window.removeEventListener.apply(window,arguments)},t.isMutationObserverAPISupported=function(){return!e.isUndefined(window.MutationObserver)},t.alert=function(n){alert(n)},t.setTimeout=function(n,t){return setTimeout((function(){try{n()}catch(t){r.warn("Deferred function threw error:",t)}}),t)},t.setInterval=function(n,t){return setInterval((function(){try{n()}catch(t){r.warn("Polling function threw error:",t)}}),t)}},6426:function(n,t,i){var e=i(3232);t.create=function(n,t,i,r){return e.extend({category:"other"},r,{id:n,apiName:t,eventType:i})}},5562:function(n,t,i){var e=i(3232),r=i(5662),o=i(9653),a=i(1826),u=i(9350),s=i(9358),c=i(3308),f=u.get("stores/event_emitter");t.on=function(n){return n.token||(n.token=r.generate()),s.dispatch(o.ADD_EMITTER_HANDLER,n),n.token},t.off=function(n){s.dispatch(o.REMOVE_EMITTER_HANDLER,{token:n})},t.emit=function(n,t,i){var r=f.getHandlers(n,t);e.each(r,(function(e){try{e.handler.call({$di:u},n)}catch(r){!i&&e.emitErrors?(c.error("Error in handler for event:",n,r),a.emitError(r,null,t)):c.warn("Suppressed error in handler for event:",n,r)}}))}},7444:function(n,t,i){var e=i(5562);t.on=function(n){return n.publicOnly=!0,e.on(n)},t.off=e.off,t.emit=function(n){e.emit(n)}},3209:function(__unused_webpack_module,exports,__webpack_require__){var createError=__webpack_require__(7871),di=__webpack_require__(9350),Logger=__webpack_require__(3308),CSP_MODE=!1,EXEC_WITH_JQUERY=!0,ExecError=exports.Error=createError("ExecError");exports.apply=function(n,t){t=t||[],EXEC_WITH_JQUERY&&(t=t.concat(di.get("env/jquery")));try{return n.apply(void 0,t)}catch(i){throw Logger.warn("Error applying function",n,"with args:",t,i),new ExecError(i)}},exports.eval=function(str){if(CSP_MODE)throw new ExecError("eval is not supported in CSP mode");try{return EXEC_WITH_JQUERY&&(str="var $ = optimizely.get('jquery');"+str),eval(str)}catch(e){throw Logger.warn("Error executing JS:",str,e),new ExecError(e)}}},9358:function(n,t,i){var e=i(8060);n.exports=e.create()},7356:function(n,t,i){var e=i(3232);t.description=function(n){var t=!!n.name?'"'+n.name+'" ':"",i=function(n){return e.map(n.weightDistributions,"entityId")}(n).join(", ");return t+"(id "+n.id+", campaigns: "+i+")"}},406:function(n,t,i){var e=i(3232),r=i(9653),o=i(1217),a=i(9350),u=i(9358),s=a.get("stores/global"),c=a.get("stores/session");t.recordLayerDecision=function(n,t,i){return u.dispatch(r.RECORD_LAYER_DECISION,{layerId:n,decision:i,decisionTicket:t,sessionId:c.getSessionId(),activationId:s.getActivationId(),timestamp:o.now(),revision:s.getRevision(),namespace:s.getNamespace(),pageId:t.pageId}),i},t.relatedAudienceIds=function(n){var t={},i=["and","or","not"];return e.each(n.experiments,(function(n){e.each(e.flattenDeep(n.audienceIds),(function(n){e.includes(i,n)||(t[n]=!0)}))})),e.keys(t)},t.getActivationTimeout=function(n){var t=n.activation;return t&&null!==t.timeout&&void 0!==t.timeout?t.timeout:2e3},t.description=function(n){return(n.name?'"'+n.name+'" ':"")+"("+n.id+")"},t.createSingle=function(n,t,i){return{id:n,policy:"single_experiment",holdback:0,experiments:[{id:t||"",variations:[{id:i||"",actions:[]}]}],integrationStringVersion:1}},t.createLayerState=function(n,t,i,e){return{layerId:n,decision:{layerId:n,experimentId:t,variationId:i,isLayerHoldback:e||!1},decisionTicket:{audienceIds:[]}}},t.getIntegrationTypes=function(n){return e.keys(e.reduce(e.keys(n.integrationSettings),(function(n,t){return e.isNaN(Number(t))||(t="custom"),n[t]=1,n}),{}))}},4855:function(n,t,i){var e=i(3232);t.y=function(n,t){if(!t)return 0;for(var i=t.toString().split("."),r=n.toString().split("."),o=0;o<i.length;o++){if(e.isUndefined(r[o]))return-1;if(isNaN(Number(r[o]))){if(r[o]!==i[o])return-1}else{if(Number(r[o])<Number(i[o]))return-1;if(Number(r[o])>Number(i[o]))return 1}}return 0}},2813:function(n,t,i){var e=i(3232),r=i(6898),o=i(3308),a="or",u="not";var s={};function c(n,t){var i;if(e.isArray(n)){var u,c;n[0]in s?(u=n[0],c=n.slice(1)):(u=a,c=n),o.groupCollapsed('Condition / Applying operator "'+u+'" with args',r.stringify(c));try{i=s[u](c,t),o.debug("Condition / Result:",i)}finally{o.groupEnd()}return i}return i=t(n),o.debug("Condition / Evaluated:",r.stringify(n),":",i),i}s["and"]=function(n,t){for(var i,r,o=0;o<n.length;o++){if(!1===(i=c(n[o],t)))return!1;e.isUndefined(i)&&(r=!0)}if(!r)return!0},s[a]=function(n,t){for(var i,r=!1,o=0;o<n.length;o++){if(!0===(i=c(n[o],t)))return!0;e.isUndefined(i)&&(r=!0)}if(!r)return!1},s[u]=function(n,t){if(1!==n.length)return!1;var i=c(n[0],t);return e.isUndefined(i)?void 0:!i},n.exports={evaluate:c}},260:function(n,t,i){var e=i(3232),r=i(388);function o(n){if((n=(n||"").toLowerCase())in s)return n;var t=e.keys(s);return e.find(t,(function(t){var i=s[t];return e.includes(i,n)}))||"unknown"}function a(n,t,i){return t||("unknown"===n?"unknown":i?"mobile":"desktop_laptop")}t.parseUA=function(n){var t=new r(n),i=t.getBrowser(),e=t.getOS(),s=t.getDevice(),f=(e.name||"unknown").toLowerCase(),l=(i.name||"unknown").toLowerCase(),d=u(s.type,l,f);return{browser:{id:o(i.name),version:i.version},platform:{name:f,version:e.version},device:{model:c[s.model]||"unknown",type:a(l,s.type,d),isMobile:d}}};var u=function(n,t,i){if(e.includes(["mobile","tablet"],n)||e.includes(["opera mini"],t))return!0;return!!e.includes(["android","blackberry","ios","windows phone"],i)},s={gc:["chrome","chromium","silk","yandex","maxthon","chrome webview"],edge:["edge"],ie:["internet explorer","iemobile"],ff:["firefox","iceweasel"],opera:["opera","opera mini","opera tablet"],safari:["safari","mobile safari","webkit"],ucbrowser:["uc browser"]},c={iPhone:"iphone",iPad:"ipad"}},3599:function(n,t,i){var e=i(3232);function r(){this.q={}}r.prototype.register=function(n,t){if(1!==arguments.length){if(this.q[n])throw new Error("Module already registered for: "+n);this.q[n]=t}else{var i=this;e.each(n,(function(n,t){i.register(t,n)}))}},r.prototype.get=function(n){return this.q[n]},r.prototype.getModuleKeys=function(){var n=this.q;return e.keys(n)},r.prototype.evaluate=function(n){var t=n.length,i=n.slice(0,t-1),r=n[t-1];if("function"!=typeof r)throw new Error("Evaluate must take a function as last element in array");var o=e.map(i,e.bind(this.get,this));return r.apply(null,o)},r.prototype.reset=function(){this.q={}},n.exports={create:function(){return new r}}},1146:function(n,t,i){var e=i(3232);function r(n,t,i){this.H=n,this.Y=t,this.K=0,this.$=!1,this.W={},e.extend(this,i),this.X={},this.initialize&&this.initialize()}r.prototype.J=function(n,t){var i=this.W[n];i&&"function"==typeof i&&i.call(this,t,n)},r.prototype.Z=function(){return e.cloneDeep(this.X)},r.prototype.on=function(n,t){this.W[n]=e.bind(t,this)},r.prototype.observe=function(n){return this.Y.nn(this.H,n)},r.prototype.emitChange=function(){this.$=!0,this.K++},r.prototype.hasChanges=function(){return this.$},r.prototype.resetChange=function(){this.$=!1},r.prototype.getStateId=function(){return this.K},r.prototype.tn=function(){this.reset&&"function"==typeof this.reset&&this.reset(),this.initialize()},n.exports=r},8060:function(n,t,i){var e=i(3232),r=i(1146);function o(n){n=n||{},this.en={},this.rn={},this.an=0,this.un=[],this.sn=[]}function a(n,t){return function(){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}o.prototype.registerStores=function(n){e.forOwn(n,e.bind((function(n,t){this.en[t]=new r(t,this,n)}),this))},o.prototype.getStore=function(n){return this.en[n]},o.prototype.dispatch=function(n,t){this.dispatchId++,e.each(this.un,e.bind((function(i){i.call(this,n,t)}),this)),e.forOwn(this.en,(function(i){i.J(n,t)})),e.each(this.sn,e.bind((function(i){i.call(this,n,t)}),this)),e.forOwn(this.en,e.bind((function(n,t){n.hasChanges()&&this.rn[t]&&(n.resetChange(),e.each(this.rn[t],(function(t){t(n)})))}),this))},o.prototype.reset=function(){this.rn={},e.forOwn(this.en,(function(n,t){n.tn()}))},o.prototype.getState=function(){var n={};return e.forOwn(this.en,(function(t,i){n[i]=t.Z()})),n},o.prototype.onPreAction=function(n){var t=this.un;return t.push(n),a(t,n)},o.prototype.onPostAction=function(n){var t=this.sn;return t.push(n),a(t,n)},o.prototype.nn=function(n,t){return this.rn[n]||(this.rn[n]=[]),this.rn[n].push(t),a(this.rn[n],t)},n.exports={create:function(n){return new o(n)}}},6898:function(n,t,i){var e=i(3232);function r(n){var t,i,r=[Array.prototype],o=[];e.each(r,(function(n){e.isUndefined(n.toJSON)||(o.push(n.toJSON),delete n.toJSON)}));try{t=n()}catch(a){i=a}finally{e.each(o,(function(n,t){r[t].toJSON=n}))}if(i)throw i;return t}t.stringify=function(){return r(e.bind((function(){return JSON.stringify.apply(null,this)}),arguments))},t.parse=JSON.parse},894:function(n,t,i){var e=i(3232);t.hasMatch=function(n,t,i){var r=!e.isUndefined(i)&&null!==i,o=!e.isUndefined(n)&&null!==n;switch(t||(o?"exact":"exists")){case"exists":return r;case"exact":return r&&String(i)===n;case"substring":return r&&String(i).indexOf(n)>-1;case"regex":try{return!(!o||!r)&&new RegExp(n).test(String(i))}catch(f){}return!1;case"range":var a=n.split(":"),u=parseFloat(a[0]),s=parseFloat(a[1]),c=parseFloat(i);return c>=u&&c<=s;default:return!1}}},4702:function(n,t,i){n.exports=i(9755)},4015:function(n,t,i){var e=i(3232),r=i(3308);function o(n,t){this.cn=n,this.fn=t}o.prototype.ln=function(n){return[this.fn,n].join("$$")},o.prototype.dn=function(n){return n.replace(this.fn+"$$","")},o.prototype.setItem=function(n,t){try{this.cn.setItem(this.ln(n),t)}catch(i){r.warn("Failed to save",n,"to localStorage:",i)}},o.prototype.removeItem=function(n){this.cn.removeItem(this.ln(n))},o.prototype.getItem=function(n){var t=null;try{t=this.cn.getItem(this.ln(n))}catch(i){}return t},o.prototype.keys=function(){var n=e.keys(this.cn);return e.map(e.filter(n,e.bind((function(n){return e.includes(n,this.fn)}),this)),e.bind(this.dn,this))},o.prototype.allKeys=function(){return e.keys(this.cn)},o.prototype.allValues=function(){return e.values(this.cn)},n.exports={create:function(n,t){return new o(n,t)},mockStorage:{keys:function(){},getItem:function(n){},removeItem:function(n){},setItem:function(n,t){}}}},8818:function(n,t,i){var e=i(1596),r=i(5562),o=i(1016);t.createDOMChangedObserver=function(){var n=e.getDocumentElement(),t={type:"viewTrigger",name:"DOMChanged"},i=o.create((function(){r.emit(t,!0)}));o.observe(i,n,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}},8492:function(n,t,i){var e=i(3232),r=i(1826),o=i(2425),a=i(6898),u=i(7075).mM,s=i(3308),c=i(4755),f=i(9350).get("stores/pending_events"),l=o.StorageKeys.PENDING_EVENTS;t.persistPendingEvents=function(){try{var n=f.getEventsString();u.setItem(l,n),i(5762).setItem(l,n)}catch(t){s.warn("PendingEvents / Unable to set localStorage key, error was: ",t),r.emitInternalError(t)}},t.getPendingEvents=function(){try{return a.parse(u.getItem(l))}catch(n){return null}},t.retryPendingEvents=function(n){e.forOwn(n,(function(n,t){c.retryableRequest(n.data,t,n.retryCount)})),e.isEmpty(n)||s.log("Retried pending events: ",n)}},2498:function(n,t,i){var e=i(3232),r=i(9653),o=i(9350),a=i(2425),u=i(5562),s=i(9358);t.registerApiModule=function(n,t){e.isArray(t)&&(t=o.evaluate(t)),s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.apiModules,name:n,plugin:t})},t.registerDependency=function(n,t){o.get(n)||o.register(n,t)},t.registerVisitorProfileProvider=function(n){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.visitorProfileProviders,name:n.provides,plugin:n})},t.registerViewProvider=function(n){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.viewProviders,name:n.provides,plugin:n})},t.registerAudienceMatcher=function(n,t){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.audienceMatchers,name:n,plugin:t})},t.registerViewMatcher=function(n,t){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.viewMatchers,name:n,plugin:t})},t.registerAnalyticsTracker=function(n,t){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.analyticsTrackers,name:n,plugin:t})},t.registerViewTagLocator=function(n,t){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.viewTagLocators,name:n,plugin:t})},t.registerAudiencePlugin=function(n){n.dependencies&&e.each(n.dependencies,(function(n,i){t.registerDependency(i,n)}));var i,r,a="vendor."+n.vendor;i=e.isString(n.provider)?o.get(n.provider)(n.vendor):e.isFunction(n.provider)?n.provider(n.vendor):e.cloneDeep(n.provider),t.registerVisitorProfileProvider(e.extend(i,{provides:a})),r=e.isString(n.matcher)?o.get(n.matcher):n.matcher;var u={fieldsNeeded:[a],match:function(n,t){return r(n[a],t)}};t.registerAudienceMatcher(a,u)},t.registerWidget=function(n){return e.isArray(n)&&(n=o.evaluate(n)),{showToken:u.on({filter:{type:"showWidget",name:n.widgetId},handler:n.showFn}),hideToken:u.on({filter:{type:"hideWidget",name:n.widgetId},handler:n.hideFn})}},t.registerChangeApplier=function(n,t){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.changeAppliers,name:n,plugin:t})},t.registerDecider=function(n,t){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.deciders,name:n,plugin:t})},t.registerEventImplementation=function(n,t){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.eventImplementations,name:n,plugin:t})},t.registerViewTrigger=function(n,t){s.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.viewTriggers,name:n,plugin:t})}},6349:function(n,t,i){var e=i(3232),r=i(9350),o=":",a="holdback",u="treatment",s="",c=i(3308),f=i(5293);function l(n){return n.replace(/[^a-zA-Z0-9\.\~\!\*\(\)\']+/g,"_")}t.formatNamesAndIdsForAnalytics=function(n,t,i,o){var a={layer:n.name||s,experiment:t.name||s,variation:i.name||s};o&&(a=e.mapValues(a,l));var u,c=!n.integrationStringVersion||1===n.integrationStringVersion;if(a.experiment===s&&c)if(u=t.audienceIds,!e.isEmpty(u)&&e.includes(["and","or","not"],u[0]))a.experiment="Exp";else{var f=r.get("stores/audience_data");a.experiment=function(n,t){return e.isEmpty(t)?"everyone_else":e.reduce(t,(function(t,i){var e=n.get(i);return e?t+l(e.name?e.name:e.id)+",":t}),"").slice(0,-1)}(f,t.audienceIds)}return{names:a,idStrings:{layer:"("+l(n.id)+")",experiment:"("+l(t.id)+")",variation:"("+l(i.id)+")"}}},t.combineAndTruncateIdAndName=function(n,t,i){var e=i-t.length;if(e<0&&(c.warn("maxLength must be at least long enough to fit the entity ID, which is length"+t.length+". Defaulting to only use entity ID as name."),n=s),n===s)return t;if(n.length>e){var r=Math.min(n.length,e);return(n=n.substring(0,r))+t}return n+" "+t},t.generateAnalyticsString=function(n,i,r,s,c,l){return n.integrationStringVersion&&2===n.integrationStringVersion?function(n,i,r,u,s,c){if(f.isSingleExperimentPolicy(n.policy)&&u)return;var l=!f.isSingleExperimentPolicy(n.policy)&&u,d=t.formatNamesAndIdsForAnalytics(n,i,r,c),h=[d.names.experiment,d.names.variation],v=[d.idStrings.experiment,d.idStrings.variation];f.isSingleExperimentPolicy(n.policy)||(h.unshift(d.names.layer),v.unshift(d.idStrings.layer));var p=e.reduce(v,(function(n,t){return n+t.length}),0),g=h.length-1+(l?1:0),m=p+g*o.length;if(l&&(m+=a.length),m>s)throw new Error("The analytics string size is too low to send the entity IDs.");for(var _=s-m,w=h.length,y=[],E=h.length-1;E>=0;E--){var b=h[E],I=Math.min(b.length,Math.floor(_/w));_-=I,w--,y.unshift(b.substring(0,I))}var A=e.map(y,(function(n,t){return n+v[t]}));return l&&A.push(a),A.join(o)}(n,i,r,s,c,l):function(n,i,r,s,c,l){var d=s?a:u,h=3*o.length,v=t.formatNamesAndIdsForAnalytics(n,i,r,l),p=v.names,g=v.idStrings,m=e.reduce(g,(function(n,t){return n+t.length}),0);if(m+h+d.length>c)throw new Error("The analytics string size is too low to send the campaign, experiment, and variation IDs.");var _=c-m-h-d.length,w={};w.variation=Math.min(p.variation.length,Math.floor(_/3)),_-=w.variation,w.experiment=Math.min(p.experiment.length,Math.floor(_/2)),_-=w.experiment,w.layer=_;var y={};e.each(p,(function(n,t){y[t]=n.substring(0,w[t])}));var E=[];return f.isSingleExperimentPolicy(n.policy)||E.push(y.layer+g.layer),(E=E.concat([y.experiment+g.experiment,y.variation+g.variation,d])).join(o)}(n,i,r,s,c,l)}},2554:function(n,t,i){var e=i(3232);n.exports=function(n,t){n=function(n){var t=n.split("?");if(t[1]){var i=t[1].split("#"),r=i[0],a=i[1],u=r.split("&"),s=[];return e.each(u,(function(n){0!==n.indexOf(o)&&s.push(n)})),t[1]="",s.length>0&&(t[1]="?"+s.join("&")),a&&(t[1]+="#"+a),t.join("")}return n}(n);var i=t.value;switch(t.match){case"exact":return(n=s(n))===s(i);case"regex":try{return Boolean(n.match(i))}catch(r){}return!1;case"simple":return(n=u(n))===(i=u(i));case"substring":return n=s(n,!0),i=s(i,!0),-1!==n.indexOf(i);default:return!1}};var r=["www."],o="optimizely_",a=["https?://.*?.?optimizelyedit.(com|test)/","https?://.*.?optimizelypreview.(com|test)/","https?://(edit|preview)(-hrd|-devel)?.optimizely.(com|test)/","https?://.*?.?optimizelyedit(-hrd)?.appspot.com/","https?://"];function u(n){return s(function(n){var t=n.indexOf("?");return-1!==t&&(n=n.substring(0,t)),-1!==(t=n.indexOf("#"))&&(n=n.substring(0,t)),n}(n))}function s(n,t){n=(n=n.replace("/?","?")).toLowerCase().replace(/[/&?]+$/,"");var i=a.slice(0);t||(i=i.concat(r));for(var e=i.length,o=0;o<e;o++){var u=i[o],s=new RegExp("^"+u);n=n.replace(s,"")}return n}},5168:function(n,t,i){var e=i(3232),r=i(5210).getFieldValue,o=i(894);n.exports=function(n,t){var i=r(n,t.name.split("."));return e.isArray(i)?e.some(i,e.partial(o.hasMatch,t.value,t.match)):o.hasMatch(t.value,t.match,i)}},3264:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739),a=i(3308);n.exports={initialize:function(){this.X={actions:{},actionState:{}},this.on(r.DATA_LOADED,this.hn),this.on(r.ACTION_EXECUTED,this.vn),this.on(r.SET_CHANGE_APPLIER,this.pn),this.on(r.REMOVE_ACTION_STATE,this.gn)},hn:function(n){var t=this;e.isEmpty(n.data.layers)||(e.each(n.data.layers,(function(n){var i;if(n.changes){var r="layerId:"+n.id;i={id:r,layerId:n.id,changeSet:n.changes,type:"layer"},o.deepFreeze(i),t.X.actions[r]=i}e.each(n.experiments,(function(r){if(r.changes){var a="experimentId:"+r.id;i={id:a,layerId:n.id,experimentId:r.id,changeSet:r.changes,type:"experiment"},o.deepFreeze(i),t.X.actions[a]=i}e.each(r.variations,(function(a){e.each(a.actions,(function(e){var u=e.pageId||e.viewId,s=r.id+":"+a.id+":"+u;i={id:s,layerId:n.id,experimentId:r.id,variationId:a.id,pageId:u,changeSet:e.changes,type:"variation"},o.deepFreeze(i),t.X.actions[s]=i}))}))}))})),this.emitChange())},vn:function(n){var t=n.actionId;e.isUndefined(t)||this.X.actionState[t]||(this.X.actionState[t]={})},pn:function(n){var t=n.actionId,i=n.changeId;this.X.actionState[t]?this.X.actionState[t][i]=n.changeApplier:a.warn("Action Data / Attempted to set changeApplier for inactive action: ",t)},gn:function(n){delete this.X.actionState[n.actionId]},get:function(n){return o.safeReference(this.X.actions[n])},getActionState:function(n){return o.safeReference(this.X.actionState[n])},getByChangeId:function(n){return e.find(this.X.actions,{changeSet:[{id:n}]})},getAllActionIdsByPageId:function(n){return e.map(e.filter(this.X.actions,{pageId:n}),"id")},getChangeApplier:function(n,t){var i=this.X.actionState[t];if(i)return i[n]},getExperimentVariationActions:function(n,t){return o.safeReference(e.filter(this.X.actions,{experimentId:n,variationId:t}))},getLayerActions:function(n){return o.safeReference(e.filter(this.X.actions,{id:"layerId:"+n}))},getExperimentActions:function(n){return o.safeReference(e.filter(this.X.actions,{id:"experimentId:"+n}))},getAll:function(){return o.safeReference(e.values(this.X.actions))}}},7402:function(n,t,i){var e=i(9653);n.exports={initialize:function(){this.X={},this.on(e.REGISTER_ASYNC_DEFERRED,this.mn),this.on(e.RESOLVE_DEFERRED,this._n),this.on(e.REJECT_DEFERRED,this.wn)},getRequest:function(n){return this.X[n]},getPromise:function(n){var t=this.getRequest(n);if(t)return t.promise},mn:function(n){this.X[n.source]={promise:n.promise,resolver:n.resolver,rejecter:n.rejecter}},_n:function(n){var t=this.getRequest(n.source);if(!t)throw new Error("No request registered for source: "+n.source);t.resolver(n.resolveWith)},wn:function(n){var t=this.getRequest(n.source);if(!t)throw new Error("No request registered for source: "+n.source);if(!t.rejecter)throw new Error("No rejecter registered for source: "+n.source);t.rejecter(n.rejectWith)}}},1139:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739);function a(n,t){return t||(t={}),n?(e.each(n,(function(n){if(!e.isString(n)){if(e.isObject(n)){var i=n.type,r=n.name||"_";t[i]||(t[i]={}),t[i][r]=!0}e.isArray(n)&&a(n,t)}})),t):t}n.exports={initialize:function(){this.X={audiences:{},featuresNeeded:{}},this.on(r.DATA_LOADED,this.hn)},hn:function(n){e.isEmpty(n.data.audiences)||(e.each(n.data.audiences,e.bind((function(n){o.deepFreeze(n),e.merge(this.X.featuresNeeded,a(n.conditions)),this.X.audiences[n.id]=n}),this)),this.emitChange())},getAll:function(){return o.safeReference(e.values(this.X.audiences))},getFeaturesNeeded:function(n){return o.safeReference(this.X.featuresNeeded[n]||{})},getAudiencesMap:function(){return o.safeReference(this.X.audiences)},get:function(n){return o.safeReference(this.X.audiences[n])},getAudienceName:function(n){return e.find(e.values(this.X.audiences),{id:n}).name||"Aud "+n}}},4410:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739);n.exports={initialize:function(){this.X={},this.on(r.ADD_CHANGE,this.yn),this.on(r.DATA_LOADED,this.hn)},getChange:function(n){return this.X[n]},hn:function(n){e.isEmpty(n.data.changes)||e.each(n.data.changes,e.bind(this.yn,this))},yn:function(n){o.deepFreeze(n),this.X[n.id]=n,this.emitChange()}}},9247:function(n,t,i){var e=i(3232),r=i(9653),o=i(2425);n.exports={initialize:function(){this.X={},e.each(o.Lifecycle,e.bind((function(n){this.X[n]=[]}),this)),this.on(r.ADD_CLEANUP_FN,this.En),this.on(r.CLEAR_CLEANUP_FN,this.bn)},getCleanupFns:function(n){return e.cloneDeep(this.X[n])},En:function(n){this.X[n.lifecycle].push(n.cleanupFn),this.emitChange()},bn:function(n){var t=this.X[n.lifecycle];if(n.cleanupFn){var i=t.indexOf(n.cleanupFn);i>-1&&(t.splice(i,1),this.emitChange())}else this.X[n.lifecycle]=[],this.emitChange()}}},4599:function(n,t,i){var e=i(9653),r=i(8127);n.exports={initialize:function(){this.X={name:r.NAME,version:r.VERSION},this.on(e.SET_CLIENT_NAME,this.In),this.on(e.SET_CLIENT_VERSION,this.An)},getClientName:function(){return this.X.name},getClientVersion:function(){return this.X.version},In:function(n){n&&(this.X.name=n),this.emitChange()},An:function(n){n&&(this.X.version=n),this.emitChange()}}},7283:function(n,t,i){var e=i(9653);n.exports={initialize:function(){this.X={currentDomain:null,defaultAgeSeconds:15552e3,autoRefresh:true},this.on(e.SET_COOKIE_DOMAIN,this.Tn),this.on(e.SET_COOKIE_AGE,this.Sn),this.on(e.SET_COOKIE_AUTO_REFRESH,this.Rn)},getCurrentDomain:function(){return this.X.currentDomain},getDefaultAgeInSeconds:function(){return this.X.defaultAgeSeconds},getAutoRefresh:function(){return this.X.autoRefresh},Tn:function(n){this.X.currentDomain=n,this.emitChange()},Sn:function(n){this.X.defaultAgeSeconds=n,this.emitChange()},Rn:function(n){this.X.autoRefresh=n,this.emitChange()}}},5:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739);n.exports={initialize:function(){this.X={},this.on(r.DATA_LOADED,this.hn)},hn:function(n){e.isEmpty(n.data.dimensions)||(e.each(n.data.dimensions,e.bind((function(n){o.deepFreeze(n),this.X[n.id]=n}),this)),this.emitChange())},getAll:function(){return o.safeReference(e.values(this.X))},getById:function(n){return o.safeReference(this.X[n])},getByApiName:function(n){return o.safeReference(e.find(e.values(this.X),{apiName:n}))}}},4911:function(n,t,i){var e=i(3232),r=i(9653);n.exports={initialize:function(){this.X={disabled:!1,forceAudienceIds:[],forceVariationIds:[],alreadyInitialized:!1,mutationObserverAPISupported:!1,isEditor:!1,isPreview:!1,isLegacyPreview:!1,isSlave:!1,previewLayerIds:[],projectToken:null,shouldOptOut:!1,trackingDisabled:!1,isRunningInV2Editor:!1,isRunningInDesktopApp:!1,forceTracking:!1},this.on(r.LOAD_DIRECTIVE,this.kn)},getAll:function(){return e.cloneDeep(this.X)},conflictInObservingChanges:function(){return!this.X.mutationObserverAPISupported},isDisabled:function(){return this.X.disabled},isEditor:function(){return this.X.isEditor},clientHasAlreadyInitialized:function(){return this.X.alreadyInitialized},getForceAudienceIds:function(){return this.X.forceAudienceIds},getForceVariationIds:function(){return this.X.forceVariationIds},getPreviewLayerIds:function(){return this.X.previewLayerIds},getProjectToken:function(){return this.X.projectToken},getForceTracking:function(){return this.X.forceTracking},shouldActivate:function(){return!this.X.isEditor&&!this.isDisabled()},shouldBootstrapDataForPreview:function(){return this.X.isPreview},shouldBootstrapDataForEditor:function(){return this.X.isEditor},shouldInitialize:function(){return!(this.shouldLoadPreview()||this.isDisabled()||this.getProjectToken())},shouldLoadPreview:function(){return!(this.X.isPreview||this.X.isLegacyPreview||!this.getProjectToken()||this.X.isEditor)},shouldBailForDesktopApp:function(){return!this.X.isEditor&&this.X.isRunningInDesktopApp},shouldLoadInnie:function(){return!this.X.isSlave&&!this.X.isEditor&&this.X.isRunningInV2Editor},shouldObserveChangesIndefinitely:function(){return this.X.mutationObserverAPISupported},shouldObserveChangesUntilTimeout:function(){return!this.shouldObserveChangesIndefinitely()},shouldOptOut:function(){return this.X.shouldOptOut},shouldSendTrackingData:function(){return!this.X.trackingDisabled&&(!!this.X.forceTracking||!this.X.isPreview&&e.isEmpty(this.getForceVariationIds())&&e.isEmpty(this.getForceAudienceIds()))},isSlave:function(){return this.X.isSlave},isRunningInDesktopApp:function(){return this.X.isRunningInDesktopApp},isRunningInV2Editor:function(){return this.X.isRunningInV2Editor},kn:function(n){e.extend(this.X,n),this.emitChange()}}},6391:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739);n.exports={initialize:function(){this.X={},this.on(r.DATA_LOADED,this.hn)},getAll:function(){return o.safeReference(e.values(this.X))},getEventsMap:function(){return o.safeReference(this.X)},get:function(n){return o.safeReference(this.X[n])},getByApiName:function(n){return o.safeReference(e.find(e.values(this.X),{apiName:n}))},getByPageId:function(n){return o.safeReference(e.filter(this.X,{pageId:n}))},hn:function(n){e.isEmpty(n.data.events)||(e.each(n.data.events,e.bind((function(n){n.pageId||(n.pageId=n.viewId),o.deepFreeze(n),this.X[n.id]=n}),this)),this.emitChange())}}},4021:function(n,t,i){var e=i(3232),r=i(9653);function o(n){var t=[];return n&&e.isObject(n)?(n.type&&t.push(n.type),t.push("|"),n.type&&n.name&&t.push(n.name),t.join("")):"|"}n.exports={initialize:function(){this.X={handlers:{}},this.on(r.ADD_EMITTER_HANDLER,this.Nn),this.on(r.REMOVE_EMITTER_HANDLER,this.Dn)},getHandlers:function(n,t){var i=[null,{type:n.type},{type:n.type,name:n.name}],r=[];return e.each(i,e.bind((function(n){var t=o(n),i=this.X.handlers[t];i&&(r=r.concat(i))}),this)),t&&(r=e.filter(r,(function(n){return!n.publicOnly}))),r},Nn:function(n){var t=o(n.filter);this.X.handlers[t]||(this.X.handlers[t]=[]),this.X.handlers[t].push({handler:n.handler,token:n.token,publicOnly:!!n.publicOnly,emitErrors:!!n.emitErrors}),this.emitChange()},Dn:function(n){var t=!1,i=n.token;e.forOwn(this.X.handlers,e.bind((function(n,r){var o=e.filter(n,(function(n){return n.token!==i}));o.length!==n.length&&(t=!0,this.X.handlers[r]=o)}),this)),t&&this.emitChange()}}},6033:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739);n.exports={initialize:function(){this.X={holdback:0,isGlobalHoldback:null,listTargetingKeys:[],revision:null,projectId:null,accountId:null,namespace:null,activationId:null,activationTimestamp:null,dcpServiceId:null,dcpKeyfieldLocators:[],recommenderServices:[],anonymizeIP:null,projectJS:null,snippetId:null,plugins:[],domContentLoaded:!1,experimental:{}},this.on(r.DATA_LOADED,this.Cn),this.on(r.ACTIVATE,this.On),this.on(r.RECORD_GLOBAL_DECISION,this.xn),this.on(r.SET_DOMCONTENTLOADED,this.Pn)},getRevision:function(){return this.X.revision},getGlobalHoldbackThreshold:function(){return this.X.holdback},getProjectId:function(){return this.X.projectId},getSnippetId:function(){return this.X.snippetId},getAccountId:function(){return this.X.accountId},getNamespace:function(){return this.X.namespace},getActivationId:function(){return this.X.activationId},getActivationTimestamp:function(){return this.X.activationTimestamp},getAnonymizeIP:function(){return this.X.anonymizeIP},isGlobalHoldback:function(){return!!this.X.isGlobalHoldback},getListTargetingKeys:function(){return this.X.listTargetingKeys.slice()},getDCPServiceId:function(){return this.X.dcpServiceId},getDCPKeyfieldLocators:function(){return this.X.dcpKeyfieldLocators},getRecommenderServices:function(){return this.X.recommenderServices},getProjectJS:function(){return this.X.projectJS},getPlugins:function(){return this.X.plugins},getExperimental:function(){return o.safeReference(this.X.experimental)},domContentLoadedHasFired:function(){return this.X.domContentLoaded},On:function(n){this.X.activationId=n.activationId,this.X.activationTimestamp=n.activationTimestamp,this.X.isGlobalHoldback=null},xn:function(n){var t=n.isGlobalHoldback;if(null!==this.X.isGlobalHoldback&&this.X.isGlobalHoldback!==t)throw new Error("Attempted to change already set global holdback!");this.X.isGlobalHoldback=t,this.emitChange()},Cn:function(n){var t=e.pick(n.data,["holdback","accountId","projectId","snippetId","namespace","revision","listTargetingKeys","dcpServiceId","dcpKeyfieldLocators","recommenderServices","anonymizeIP","plugins","projectJS","experimental"]);if(0!==e.keys(t).length){e.extend(this.X,{listTargetingKeys:[],dcpServiceId:null,dcpKeyfieldLocators:[]},t),this.emitChange()}},Pn:function(){this.X.domContentLoaded=!0,this.emitChange()}}},1647:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739);n.exports={initialize:function(){this.X={},this.on(r.DATA_LOADED,this.hn)},hn:function(n){e.isEmpty(n.data.groups)||(e.each(n.data.groups,e.bind((function(n){o.deepFreeze(n),this.X[n.id]=n}),this)),this.emitChange())},getAll:function(){return o.safeReference(e.values(this.X))},getGroupsMap:function(){return o.safeReference(this.X)},get:function(n){return o.safeReference(this.X[n])}}},8858:function(n,t,i){var e=i(3232),r=i(9653),o=i(7082);n.exports={initialize:function(){this.X={originalPushState:null,originalReplaceState:null},this.on(r.ENSURE_ORIGINAL_PUSHSTATE,this.Mn),this.on(r.ENSURE_ORIGINAL_REPLACESTATE,this.Ln)},getOriginalPushState:function(){return this.X.originalPushState},getOriginalReplaceState:function(){return this.X.originalReplaceState},Mn:function(){this.X.originalPushState||(this.X.originalPushState=e.bind(o.getGlobal("history").pushState,o.getGlobal("history")))},Ln:function(){this.X.originalReplaceState||(this.X.originalReplaceState=e.bind(o.getGlobal("history").replaceState,o.getGlobal("history")))}}},9627:function(n,t,i){var e=i(3232),r=i(9653);n.exports={initialize:function(){this.X={},this.on(r.DATA_LOADED,this.hn),this.on(r.SET_INTEGRATION_SETTINGS,this.Vn)},hn:function(n){e.isEmpty(n.data.integrationSettings)||(e.each(n.data.integrationSettings,e.bind((function(n){this.X[n.id]=n}),this)),this.emitChange())},Vn:function(n){var t=this.X[n.id];t?e.extend(t,n):this.X[n.id]=n},getAll:function(){return e.cloneDeep(e.values(this.X))},get:function(n){return e.cloneDeep(this.X[n])},getReference:function(n){return this.X[n]}}},8347:function(n,t,i){var e=i(3232),r=i(9653),o=i(3308),a="*";n.exports={initialize:function(){this.X={},this.on(r.LOAD_PERSISTED_LAYER_STATES,this.Fn),this.on(r.RECORD_LAYER_DECISION,this.Un),this.on(r.RECORD_LAYER_DECISION_EVENT_ID,this.zn)},getLayerState:function(n,t){if(this.X[n]){var i=this.X[n];if(e.keys(i).length>1&&!t)throw new Error("View Id must be specified when more than one layerState for layer.");return t?e.cloneDeep(e.find(i,{pageId:t})):e.cloneDeep(i["*"])}},getLayerStates:function(n){var t=[];for(var i in this.X)e.forEach(this.X[i],(function(i){(e.isUndefined(n)||i.namespace===n)&&t.push(e.cloneDeep(i))}));return t},getLayerStatesForAnalytics:function(){var n=[];for(var t in this.X)e.forEach(this.X[t],(function(t){n.push(e.pick(t,["layerId","decision","decisionEventId"]))}));return n},Fn:function(n){n.merge||(this.X={}),e.each(n.layerStates,e.bind((function(n){var t=n.layerId;n.pageId||(n.pageId=n.viewId);var i=n.pageId||a,r=this.X[t];if(e.isUndefined(r))this.X[t]={},this.X[t][i]=n;else{var o=r[i];(!o||n.decisionTimestamp>(o.decisionTimestamp||0))&&(this.X[t][i]=n)}}),this)),this.emitChange()},Un:function(n){var t={layerId:n.layerId,revision:n.revision,namespace:n.namespace,pageId:n.pageId,decisionTicket:n.decisionTicket,decision:n.decision,decisionActivationId:n.activationId,decisionTimestamp:n.timestamp,decisionEventId:null},i=this.X[n.layerId]||{};n.pageId?(delete i["*"],i[n.pageId]=t):(i={})["*"]=t,this.X[n.layerId]=i,this.emitChange()},zn:function(n){var t=n.layerId,i=n.pageId||a;this.X[t]?this.X[t][i]?(this.X[t][i].decisionEventId=n.decisionId,this.emitChange()):o.warn("Not recording decision event: Layer state not found for view",i):o.warn("Not recording decision event: Campaign not registered",t)}}},3831:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739),a=i(5293);n.exports={initialize:function(){this.X={layers:{},experiments:{},variations:{}},this.on(r.DATA_LOADED,this.hn)},hn:function(n){if(!e.isEmpty(n.data.layers)){var t=this;e.each(n.data.layers,(function(n){e.each(n.experiments,(function(i){n.pageIds||(n.pageIds=n.viewIds),i.campaignName||a.isSingleExperimentPolicy(n.policy)?a.isSingleExperimentPolicy(n.policy)&&n.groupId&&(i.groupId=n.groupId):i.campaignName=n.name,e.each(i.variations,(function(n){e.each(n.actions,(function(n){n.pageId||(n.pageId=n.viewId)})),t.X.variations[n.id]=n})),t.X.experiments[i.id]=i})),o.deepFreeze(n),t.X.layers[n.id]=n})),this.emitChange()}},getAll:function(){return o.safeReference(e.values(this.X.layers))},getCampaignsMap:function(){return o.safeReference(this.X.layers)},getExperimentsMap:function(){return o.safeReference(this.X.experiments)},getVariationsMap:function(){return o.safeReference(this.X.variations)},getCount:function(){return e.keys(this.X.layers).length},getAllByPageIds:function(n){return o.safeReference(e.filter(this.X.layers,(function(t){return e.some(n,e.partial(e.includes,t.pageIds))})))},get:function(n){return o.safeReference(this.X.layers[n])},getLayerByExperimentId:function(n){var t=e.find(this.X.layers,(function(t){return e.find(t.experiments,{id:n})}));return o.safeReference(t)},getExperimentByVariationId:function(n){var t;return e.some(this.X.layers,(function(i){return e.some(i.experiments,(function(i){return e.find(i.variations,{id:n})&&(t=i),t})),t})),o.safeReference(t)}}},1066:function(n,t,i){var e=i(9653);n.exports={initialize:function(){this.X={logs:[]},this.on(e.LOG,this.Bn)},getLogs:function(){return this.X.logs},Bn:function(n){this.X.logs.push(n),this.emitChange()},Z:function(){return this.X.logs.slice()}}},8592:function(n,t,i){var e=i(9653),r=i(9739);n.exports={initialize:function(){this.X={data:null,hasTracked:null},this.on(e.LOAD_REDIRECT_DATA,this.Gn),this.on(e.REGISTER_TRACKED_REDIRECT_DATA,this.jn)},get:function(){return r.safeReference(this.X.data)},hasTracked:function(){return this.X.hasTracked},Gn:function(n){r.deepFreeze(n),this.X.data=n,this.X.hasTracked=!1,this.emitChange()},jn:function(){this.X.hasTracked=!0}}},2492:function(n,t,i){var e=i(3232),r=i(9653),o=i(6898);n.exports={initialize:function(){this.X={},this.on(r.SET_PENDING_EVENT,this.qn),this.on(r.REMOVE_PENDING_EVENT,this.Hn),this.on(r.LOAD_PENDING_EVENTS,this.Yn)},getEvents:function(){return this.X},getEventsString:function(){return o.stringify(this.X)},qn:function(n){e.keys(this.X).length>=1e3&&this.Kn();var t=n.id,i=n.retryCount;this.X[t]&&this.X[t].retryCount===i||(this.X[t]={id:t,timeStamp:n.timeStamp,data:n.data,retryCount:i},this.emitChange())},Hn:function(n){delete this.X[n.id],this.emitChange()},Yn:function(n){this.X=n.events,this.Kn(),this.emitChange()},Kn:function(){for(var n=e.sortBy(this.X,"timeStamp"),t=0;t<=n.length-1e3;t++)delete this.X[n[t].id];this.emitChange()}}},493:function(n,t,i){var e=i(3232),r=i(9653);n.exports={initialize:function(){this.X={layerId:null},this.on(r.ANNOUNCE_PENDING_REDIRECT,this.Gn)},isExpectingRedirect:function(){return e.isString(this.X.layerId)},getLayerId:function(){return this.X.layerId},Gn:function(n){this.isExpectingRedirect()||(this.X.layerId=n.layerId,this.emitChange())}}},703:function(n,t,i){var e=i(3232),r=i(9653),o=i(2425);n.exports={initialize:function(){this.X={},this.X[o.PerformanceData.performance_marks]={},this.on(r.SET_PERFORMANCE_MARKS_DATA,this.$n)},$n:function(n){e.isUndefined(this.X[o.PerformanceData.performance_marks][n.name])&&(this.X[o.PerformanceData.performance_marks][n.name]=[]),this.X[o.PerformanceData.performance_marks][n.name].push(n.data),this.emitChange()},getMarks:function(){return e.mapValues(this.X[o.PerformanceData.performance_marks],(function(n){return e.map(n,(function(n){return[n.startTime,n.duration]}))}))},getDurationsFor:function(n){return e.reduce(n,e.bind((function(n,t){var i=this.X[o.PerformanceData.performance_marks][t];return i&&(n[t]=Math.round(e.reduce(i,(function(n,t){return n+t.duration}),0))),n}),this),{})}}},1043:function(n,t,i){var e=i(3232),r=i(9653),o=i(2425),a=i(3308);n.exports={initialize:function(){this.X=e.mapValues(o.PluginTypes,(function(){return{}})),this.on(r.REGISTER_PLUGIN,this.Wn)},Wn:function(n){var t=n.type,i=n.name,e=n.plugin;if(!t||!i)throw new Error("Missing information needed to register plugins: "+t+":"+i);if(!this.X[t])throw new Error("Invalid plugin type specified: "+t);this.X[t][i]=e,a.debug("Plugin Store: Registering Plugin :",n)},getAllPlugins:function(n){if(!n)return this.X;if(this.X[n])return this.X[n];throw new Error("Invalid plugin type: "+n)},getPlugin:function(n,t){if(!t||!n)throw new Error("Missing plugin parameters");return this.getAllPlugins(n)[t]||null}}},6858:function(n,t,i){var e=i(3232),r=i(9653),o=i(5210);n.exports={initialize:function(){this.X={},this.on(r.SET_VISITOR_ATTRIBUTE_PENDING,this.Xn)},getPendingAttributeValue:function(n){return n=e.isArray(n)?n.concat("pending"):[n,"pending"],o.getFieldValue(this.X,n)},Xn:function(n){o.setFieldValue(this.X,n.key,{pending:n.pending}),this.emitChange()}}},2981:function(n,t,i){var e=i(3232),r=i(9653);n.exports={initialize:function(){this.X={inRumSample:!1,id:null,src:null,RumHost:null,data:{extras:{}},apis:{},DOMObservation:{},featuresNeeded:{}},this.on(r.SET_RUM_DATA,this.Jn),this.on(r.RECORD_API_USAGE,this.Qn),this.on(r.INITIALIZE_CHANGE_METRICS,this.Zn),this.on(r.RECORD_ACTIVATION_TYPE_USAGE,this.nt),this.on(r.RECORD_AUDIENCE_USAGE,this.tt),this.on(r.RECORD_CHANGE_MACROTASK_RATE,this.it),this.on(r.RECORD_CHANGE_OVERHEATED,this.et),this.on(r.RECORD_CHANGE_TYPE_USAGE,this.rt),this.on(r.RECORD_DOM_OBSERVATION_OCCURENCE,this.ot),this.on(r.RECORD_INTEGRATION_USAGE,this.ut),this.on(r.RECORD_LAYER_FEATURE_USAGE,this.st),this.on(r.RECORD_LAYER_POLICY_USAGE,this.ct),this.on(r.RECORD_VIEW_FEATURE_USAGE,this.ft),this.on(r.RECORD_VIEWS_INITIALLY_ACTIVATED_COUNT,this.dt),this.on(r.RECORD_VISITOR_ID_LOCATOR_USAGE,this.ht),this.on(r.RECORD_VISITOR_ID_ERROR,this.vt),this.on(r.RECORD_STICKY_BUCKETING_FEATURE,this._t)},Jn:function(n){e.merge(this.X,n),this.emitChange()},Qn:function(n){this.X.apis[n.methodName]||(this.X.apis[n.methodName]=0),this.X.apis[n.methodName]++,this.emitChange()},Zn:function(){e.isUndefined(this.X.data.extras.changeMacrotaskRate)&&(this.X.data.extras.changeMacrotaskRate=0),e.isUndefined(this.X.data.extras.numOverheatedChanges)&&(this.X.data.extras.numOverheatedChanges=0)},it:function(n){e.isUndefined(this.X.data.extras.changeMacrotaskRate)&&(this.X.data.extras.changeMacrotaskRate=0),n.changeMacrotaskRate>this.X.data.extras.changeMacrotaskRate&&(this.X.data.extras.changeMacrotaskRate=n.changeMacrotaskRate),this.emitChange()},et:function(){e.isUndefined(this.X.data.extras.numOverheatedChanges)&&(this.X.data.extras.numOverheatedChanges=0),this.X.data.extras.numOverheatedChanges++,this.emitChange()},ot:function(n){this.X.DOMObservation[n.counterName]||(this.X.DOMObservation[n.counterName]=0),this.X.DOMObservation[n.counterName]++,this.emitChange()},wt:function(n,t,i){e.isUndefined(this.X.featuresNeeded[n])&&(this.X.featuresNeeded[n]={});var r=this.X.featuresNeeded[n];e.each(t,(function(n){r[n]||(r[n]={}),r[n][i]||(r[n][i]=!0)}))},ut:function(n){this.wt("integrations",n.integrations,n.layerId)},rt:function(n){this.wt("changeTypes",n.changeTypes,n.layerId)},nt:function(n){this.wt("activationTypes",[n.activationType],n.entityId),this.emitChange()},ft:function(n){this.wt("viewFeatures",n.featuresUsed,n.entityId),this.emitChange()},st:function(n){this.wt("layerFeatures",[n.feature],n.entityId),this.emitChange()},ct:function(n){this.wt("policy",[n.policy],n.layerId),this.emitChange()},tt:function(n){this.wt("audiences",n.audienceTypes,n.layerId),this.emitChange()},dt:function(n){this.X.data.extras.viewsInitiallyActivatedCount=n.viewsInitiallyActivatedCount,this.emitChange()},ht:function(n){this.wt("visitorIdLocatorType",[n.visitorIdLocatorType],n.entityId),this.emitChange()},vt:function(n){this.X.data.extras.errorCustomVisitorId=n.isError,this.emitChange()},_t:function(n){this.wt("stickyBucketing",[n.feature],n.id)},getSampleRum:function(){return this.X.inRumSample},getRumId:function(){return this.X.id},getRumHost:function(){return this.X.RumHost},getApiData:function(){return this.X.apis},getDOMObservationData:function(){return this.X.DOMObservation},getRumData:function(){return e.cloneDeep(this.X.data)},getScriptSrc:function(){return this.X.src},getFeaturesNeededData:function(){var n=this.X.featuresNeeded,t={};return e.forOwn(n,(function(n,i){var r=e.keys(n);e.isEmpty(r)||(t[i]={}),e.forEach(r,(function(r){t[i][r]=e.keys(n[r]).length}))})),t}}},2709:function(n,t,i){var e=i(9653);n.exports={initialize:function(){this.X={initialized:!1,natives:{}},this.on(e.SANDBOXED_FUNCTIONS_ADDED,this.yt)},yt:function(n){if(!n.sandboxedFunctions)throw new Error("No sandboxedFunctions found in payload");this.X.natives=n.sandboxedFunctions,this.X.initialized=!0,this.emitChange()},getAll:function(){return this.X.natives},get:function(n){if(!n)throw new Error("Missing name parameter");return this.X.natives[n]||null},isInitialized:function(){return this.X.initialized}}},5053:function(n,t,i){var e=i(3232),r=i(9653),o=i(1217),a=i(5662);n.exports={initialize:function(){this.X={lastSessionTimestamp:0,sessionId:null},this.on(r.REFRESH_SESSION,this.Et),this.on(r.LOAD_SESSION_STATE,this.bt)},getState:function(){return e.cloneDeep(this.X)},getSessionId:function(){return this.X.sessionId},bt:function(n){this.X.sessionId=n.sessionId,this.X.lastSessionTimestamp=n.lastSessionTimestamp,this.emitChange()},Et:function(){var n=o.now(),t=this.X.lastSessionTimestamp;(!this.X.sessionId||n-t>18e5)&&(this.X.sessionId=a.generate()),this.X.lastSessionTimestamp=n,this.emitChange()}}},1755:function(n,t,i){var e=i(3232),r=i(9653);n.exports={initialize:function(){this.It(),this.on(r.FINALIZE_BATCH_SNAPSHOT,this.At),this.on(r.REGISTER_PREVIOUS_BATCH,this.Tt),this.on(r.REGISTER_TRACKER_VISITOR,this.St),this.on(r.REGISTER_TRACKER_EVENT,this.Rt),this.on(r.REGISTER_TRACKER_DECISION,this.kt),this.on(r.RESET_TRACKER_EVENTS,this.Nt),this.on(r.RESET_TRACKER_STORE,this.It),this.on(r.RESET_TRACKER_PREVIOUS_BATCHES,this.Dt),this.on(r.SET_TRACKER_POLLING,this.Ct),this.on(r.SET_TRACKER_BATCHING,this.Ot),this.on(r.SET_TRACKER_SEND_EVENTS,this.xt),this.on(r.SET_TRACKER_PERSISTABLE_STATE,this.Pt),this.on(r.SET_TRACKER_DIRTY,this.Mt),this.on(r.UPDATE_TRACKER_VISITOR_ATTRIBUTES,this.Lt)},getPersistableState:function(){return this.X.isDirty?this.hasEventsToSend()||this.hasPreviousBatchesToSend()?{data:this.X.data,decisions:this.X.decisions,decisionEvents:this.X.decisionEvents,previousBatches:this.X.previousBatches}:{}:null},Pt:function(n){e.isEmpty(this.X.data)||e.isEmpty(n.data)||(this.At(),this.X.previousBatches.push(this.getEventBatch())),this.X.data=n.data||{},this.X.decisions=n.decisions||[],this.X.decisionEvents=n.decisionEvents||[],e.isEmpty(this.X.previousBatches)||e.isEmpty(n.previousBatches)?this.X.previousBatches=n.previousBatches||[]:this.X.previousBatches=this.X.previousBatches.concat(n.previousBatches),this.emitChange()},Mt:function(n){this.X.isDirty=n,this.emitChange()},Rt:function(n){var t=this.Vt();(e.isEmpty(t.snapshots)||!e.isEmpty(this.X.decisionEvents))&&this.Ft(),this.Ut().events.push(n.event),this.X.decisions=n.decisions,this.Mt(!0)},kt:function(n){this.X.decisionEvents.push(n.decisionEvent),this.X.decisions=n.decisions,this.Mt(!0)},St:function(n){e.isEmpty(this.X.data)?this.X.data=n.data:this.At(),this.X.data.visitors.push(n.visitor),this.X.decisions=n.decisions,this.X.decisionEvents=[],this.Mt(!0)},Tt:function(n){this.X.previousBatches.push(n),this.Mt(!0)},It:function(){this.X={polling:!1,shouldBatch:!0,data:{},decisions:[],decisionEvents:[],canSend:!1,isDirty:!1,previousBatches:[]},this.emitChange()},Nt:function(){var n=this.Vt();this.X.data.visitors=[n],n.snapshots=[],this.Mt(!0)},Dt:function(){this.X.previousBatches=[],this.Mt(!0)},Ct:function(n){this.X.polling=n,this.emitChange()},Ot:function(n){this.X.shouldBatch=n,this.emitChange()},xt:function(n){this.X.canSend=n,this.emitChange()},getEventBatch:function(){return e.cloneDeep(this.X.data)},getPreviousBatches:function(){return e.cloneDeep(this.X.previousBatches)},zt:function(){return this.X.decisionEvents.slice()},Bt:function(){this.X.decisionEvents=[]},Gt:function(){return this.X.decisions.slice()},isPolling:function(){return this.X.polling},shouldBatch:function(){return this.X.shouldBatch},Ut:function(){return e.last(this.Vt().snapshots)},Vt:function(){return e.last(this.X.data.visitors)},Ft:function(){var n=this.zt();this.Vt().snapshots.push({decisions:this.Gt(),events:n}),this.Bt(),this.Mt(!0)},At:function(){this.X.decisionEvents.length>0&&this.Ft()},hasEventsToSend:function(){if(!e.isEmpty(this.X.decisionEvents))return!0;if(!e.isEmpty(this.X.data)&&e.some(this.X.data.visitors||[],(function(n){return n.snapshots.length>0})))return!0;return!1},hasPreviousBatchesToSend:function(){return!e.isEmpty(this.X.previousBatches)},canSend:function(){return this.X.canSend},Lt:function(n){var t=this.Vt();t&&(t.attributes=n.attributes)}}},557:function(n,t,i){var e=i(3232),r=i(9653);n.exports={initialize:function(){this.X={},this.on(r.SET_UA_DATA,this.hn)},hn:function(n){e.isEmpty(this.X)&&(this.X=n.data)},get:function(){return e.cloneDeep(this.X)}}},3523:function(n,t,i){var e=i(3232),r=i(9653),o=i(3308),a={globalTags:{},viewStates:{},shouldBatch:!1};n.exports={initialize:function(){this.X=e.cloneDeep(a),this.on(r.REGISTER_VIEWS,this.jt),this.on(r.SET_VIEW_ACTIVE_STATE,this.qt),this.on(r.UPDATE_PARSED_VIEW_METADATA,this.Ht),this.on(r.UPDATE_USER_SUPPLIED_METADATA,this.Yt),this.on(r.TRACK_VIEW_ACTIVATED_EVENT,this.Kt),this.on(r.SET_GLOBAL_TAGS,this.$t),this.on(r.RESET_VIEW_STATES,this.Wt),this.on(r.SET_VIEW_BATCHING,this.Ot)},getAll:function(){var n={};for(var t in this.X.viewStates)n[t]=this.getViewState(t);return n},shouldBatch:function(){return this.X.shouldBatch},getViewState:function(n){var t=e.cloneDeep(this.X.viewStates[n]),i=this.X.globalTags;return t.metadata=e.extend({},t.parsedMetadata,i,t.userSuppliedMetadata),t},getActiveViewTags:function(){var n=this.getActiveViewStates(),t=e.map(n,(function(n){return n.metadata})),i=[{}].concat(t);return e.extend.apply(e,i)},getActivationEventId:function(n){return this.X.viewStates[n]?this.X.viewStates[n].activationEventId:null},getActiveViewStates:function(){return e.reduce(this.X.viewStates,e.bind((function(n,t,i){return this.isViewActive(i)&&n.push(this.getViewState(i)),n}),this),[])},isViewActive:function(n){var t=this.X.viewStates[n];return t||o.warn("No Page registered with id",n),!!t.isActive},getGlobalTags:function(){return e.cloneDeep(this.X.globalTags)},Wt:function(){this.X.viewStates={},this.emitChange()},jt:function(n){e.each(n.views,e.bind((function(n){var t=n.id;this.X.viewStates[t]={id:t,isActive:e.isBoolean(n.isActive)?n.isActive:null,activatedTimestamp:null,activationEventId:null,parsedMetadata:{},userSuppliedMetadata:{}}}),this)),this.emitChange()},qt:function(n){var t=n.view.id;if(!this.X.viewStates[t])throw new Error("No view exists with id "+t);this.X.viewStates[t].isActive=n.isActive,n.isActive?this.X.viewStates[t].activatedTimestamp=n.timestamp:(this.X.viewStates[t].parsedMetadata={},this.X.viewStates[t].userSuppliedMetadata={}),this.emitChange()},Ht:function(n){var t=n.pageId;if(!this.X.viewStates[t])throw new Error("No view exists with id "+t);e.assign(this.X.viewStates[t].parsedMetadata,n.metadata),this.emitChange()},Yt:function(n){var t=n.pageId;if(!this.X.viewStates[t])throw new Error("No view exists with id "+t);e.assign(this.X.viewStates[t].userSuppliedMetadata,n.metadata),this.emitChange()},Kt:function(n){var t=n.pageId;this.X.viewStates[t]&&(this.X.viewStates[t].activationEventId=n.eventData.eventId,this.emitChange())},$t:function(n){e.extend(this.X.globalTags,n),this.emitChange()},Ot:function(n){this.X.shouldBatch=n,this.emitChange()}}},6107:function(n,t,i){var e=i(3232),r=i(9653),o=i(9739);n.exports={initialize:function(){this.X={views:{},apiNamesToViews:{}},this.on(r.DATA_LOADED,this.hn)},getAll:function(){return o.safeReference(e.values(this.X.views))},getPagesMap:function(){return o.safeReference(this.X.views)},get:function(n){return o.safeReference(this.X.views[n])},getByApiName:function(n){return o.safeReference(this.X.apiNamesToViews[n])},apiNameToId:function(n){var t=this.X.apiNamesToViews[n];if(t)return t.id},idToApiName:function(n){var t=this.X.views[n];if(t)return t.apiName},getNumberOfPages:function(){return e.keys(this.X.views).length},getAllViewsForActivationType:function(n){return e.filter(this.X.views,{activationType:n})},hn:function(n){e.isEmpty(n.data.views)||(e.each(n.data.views,e.bind((function(n){o.deepFreeze(n),this.X.views[n.id]=n,this.X.apiNamesToViews[n.apiName]=n}),this)),this.emitChange())}}},2975:function(n,t,i){var e=i(3232),r=i(9653),o=i(5210);n.exports={initialize:function(){this.X={profile:{},metadata:{},visitorId:null},this.on(r.SET_VISITOR_ID_VIA_API,this.Xt),this.on(r.SET_VISITOR_ATTRIBUTES,this.Jt),this.on(r.LOAD_EXISTING_VISITOR_PROFILE,this.Qt)},getVisitorProfile:function(){return this.X.profile},getVisitorProfileMetadata:function(){return this.X.metadata},getAttribute:function(n){var t=this.X.profile;return e.cloneDeep(o.getFieldValue(t,n))},getAttributeMetadata:function(n){return e.cloneDeep(this.X.metadata[n])},getVisitorIdFromAPI:function(){return this.X.visitorId},Qt:function(n){this.X.profile=n.profile,this.X.metadata=n.metadata,this.emitChange()},Jt:function(n){e.each(n.attributes,e.bind((function(n){var t=n.key;o.setFieldValue(this.X.profile,t,n.value),n.metadata&&e.forOwn(n.metadata,e.bind((function(n,i){o.setFieldValue(this.X.metadata,t.concat(i),n)}),this))}),this)),this.emitChange()},Xt:function(n){this.X.visitorId=n,this.emitChange()}}},7947:function(n,t,i){var e=i(3232),r=i(9653);n.exports={initialize:function(){this.X={},this.on(r.DATA_LOADED,this.Zt)},getCustomBehavioralAttributes:function(){return e.filter(this.X,(function(n){return!!n.rule_json}))},getVisitorAttribute:function(n){var t=e.values(this.X);if(n.datasourceId&&(t=e.filter(t,{dcp_datasource_id:String(n.datasourceId)})),n.attributeName&&n.attributeId)throw new Error("Must not specify both attribute name and attribute ID");if(n.attributeId){var i=this.X[n.attributeId];if(!i)throw new Error("Unrecognized attribute ID: "+n.attributeId);return i}if(n.attributeName){var r=e.filter(t,{name:n.attributeName});if(!r.length)throw new Error("Unrecognized attribute name: "+n.attributeName);if(r.length>1)throw new Error("Too many attributes with name: "+n.attributeName);return r[0]}throw new Error("Must specify attribute name or attribute ID")},Zt:function(n){e.isEmpty(n.data.visitorAttributes)||(e.each(n.data.visitorAttributes,e.bind((function(n){this.X[n.id]=n}),this)),this.emitChange())}}},6018:function(n,t,i){var e=i(3232),r=i(9653),o=i(6898);n.exports={initialize:function(){this.X={variationIdMap:{},preferredLayerMap:{}},this.on(r.UPDATE_VARIATION_ID_MAP,this.ni),this.on(r.MERGE_VARIATION_ID_MAP,this.ti),this.on(r.UPDATE_PREFERRED_LAYER_MAP,this.ii),this.on(r.MERGE_PREFERRED_LAYER_MAP,this.ei)},getVariationIdMap:function(){return e.cloneDeep(this.X.variationIdMap)},getVariationIdMapString:function(){return o.stringify(this.X.variationIdMap)},ni:function(n){var t=this.X.variationIdMap[n.layerId]||{};t[n.experimentId]!==n.variationId&&(t[n.experimentId]=n.variationId,this.X.variationIdMap[n.layerId]=t,this.emitChange())},ti:function(n){var t=this.getVariationIdMap(),i=n.variationIdMap;e.each(t||{},(function(n,t){i[t]?e.assign(i[t],n):i[t]=n})),this.X.variationIdMap=i,this.emitChange()},getPreferredLayerMap:function(){return e.cloneDeep(this.X.preferredLayerMap)},getPreferredLayerMapString:function(){return o.stringify(this.X.preferredLayerMap)},getPreferredLayerId:function(n){return this.X.preferredLayerMap[n]},ii:function(n){this.X.preferredLayerMap[n.groupId]!==n.layerId&&(this.X.preferredLayerMap[n.groupId]=n.layerId,this.emitChange())},ei:function(n){var t=this.getPreferredLayerMap(),i=n.preferredLayerMap;e.assign(i,t),this.X.preferredLayerMap=i,this.emitChange()}}},1325:function(n,t,i){i(3232);var e=i(9653);i(6200).j;n.exports={initialize:function(){this.X={events:[],foreignEvents:{},foreignEventQueues:{}},this.on(e.SET_VISITOR_EVENTS,this.hn),this.on(e.SET_FOREIGN_VISITOR_EVENTS,this.ri),this.on(e.SET_FOREIGN_VISITOR_EVENT_QUEUE,this.oi)},getEvents:function(){return this.X.events},getForeignEvents:function(){return this.X.foreignEvents},getForeignEventQueues:function(){return this.X.foreignEventQueues},hn:function(n){this.X.events=n,this.emitChange()},ri:function(n){this.X.foreignEvents[n.key]=n.value},oi:function(n){this.X.foreignEventQueues[n.key]=n.value}}},98:function(n,t,i){var e=i(9653);n.exports={initialize:function(){this.X={baseMap:{},eventQueue:[],lastEvent:null,initialized:!1,cleared:!1},this.on(e.UPDATE_BEHAVIOR_STORE,this.ai)},getBaseMap:function(){return this.X.baseMap},getEventQueue:function(){return this.X.eventQueue},getLastEvent:function(){return this.X.lastEvent},getCleared:function(){return this.X.cleared},getInitialized:function(){return this.X.initialized},ai:function(n){this.X[n.key]=n.value}}},6950:function(n,t,i){var e=i(3232),r=i(9653);n.exports={initialize:function(){this.X={randomId:null,visitorIdLocator:null},this.on(r.SET_VISITOR_ID,this.hn),this.on(r.DATA_LOADED,this.ui)},getBucketingId:function(){return this.getRandomId()},getRandomId:function(){return this.X.randomId},getVisitorIdLocator:function(){return this.X.visitorIdLocator},hn:function(n){e.extend(this.X,n),this.emitChange()},ui:function(n){e.isEmpty(n.data.visitorIdLocator)||(this.X.visitorIdLocator=n.data.visitorIdLocator,this.emitChange())}}},2775:function(n,t,i){var e=i(3232),r=i(3308),o=i(9653);n.exports={initialize:function(){this.X={frames:[],defaultFrame:null,messages:[],subscribers:[],canonicalOrigins:null,disabled:!1},this.on(o.XDOMAIN_SET_DEFAULT_FRAME,this.ci),this.on(o.XDOMAIN_ADD_FRAME,this.fi),this.on(o.XDOMAIN_SET_MESSAGE,this.li),this.on(o.XDOMAIN_ADD_SUBSCRIBER,this.di),this.on(o.XDOMAIN_SET_CANONICAL_ORIGINS,this.hi),this.on(o.XDOMAIN_SET_DISABLED,this.vi)},getMessages:function(){return e.cloneDeep(this.X.messages)},getOffset:function(){return 0===this.X.messages.length?0:this.X.messages[0].data.id},getNextMessageId:function(){return this.X.messages.length+this.getOffset()},getMessageById:function(n){return this.X.messages[n-this.getOffset()]},getSubscribers:function(){return this.X.subscribers},getFrames:function(){return this.X.frames},getNextFrameId:function(){return this.X.frames.length},getDefaultFrame:function(){return this.X.defaultFrame},getCanonicalOrigins:function(){return e.cloneDeep(this.X.canonicalOrigins)},isDisabled:function(){return this.X.disabled},ci:function(n){this.X.defaultFrame=n},fi:function(n){this.X.frames.push(n)},li:function(n){for(this.X.messages[n.messageId-this.getOffset()]=n.message;this.X.messages.length>1e3;){var t=this.X.messages.shift();r.debug("XDomainStorage: Cleared old message: "+t.data.id)}},di:function(n){this.X.subscribers.push(n.subscriber)},hi:function(n){this.X.canonicalOrigins=n.canonicalOrigins},vi:function(n){this.X.disabled=n.disabled}}},3900:function(n,t){t.locatorType={CSS_SELECTOR:"css_selector",JAVASCRIPT:"javascript",URL_REGEX:"url_regex"},t.valueType={STRING:"string",NUMBER:"number",CURRENCY:"currency"},t.nodeNames={INPUT:"INPUT",SELECT:"SELECT"}},2152:function(n,t,i){var e=i(8235).U;t.Error=e("TagError")},3468:function(n,t,i){var e=i(2425).PluginTypes,r=i(9350).get("stores/plugins");t.getTagValue=function(n){var i=r.getPlugin(e.viewTagLocators,n.locatorType);if(!i)throw new t.Error("No locator registered for tag locatorType: "+n.locatorType);return i(n)},t.enums=i(3900),t.Error=i(2152).Error},1115:function(n,t,i){var e=i(9653),r=i(9358),o=i(4702).Promise,a=i(9350).get("stores/async_request");t.makeAsyncRequest=function(n,t){var i,u,s=a.getPromise(n);if(s)return s;var c=new o((function(n,t){i=n,u=t}));return r.dispatch(e.REGISTER_ASYNC_DEFERRED,{source:n,promise:c,resolver:i,rejecter:u}),t&&t(),c},t.resolveRequest=function(n,t){r.dispatch(e.RESOLVE_DEFERRED,{source:n,resolveWith:t})},t.rejectRequest=function(n,t){r.dispatch(e.REJECT_DEFERRED,{source:n,rejectWith:t})}},2052:function(n,t,i){var e=i(3405),r=i(7082);t.getLanguage=function(){return r.getNavigatorLanguage()},t.getQueryParams=e.getQueryParams,t.getQueryParamValue=e.getQueryParamValue,t.getUrl=function(){return r.getHref()}},6491:function(n,t,i){var e=i(3232),r=i(8235).U,o=i(1217),a=i(1596),u=i(7082),s=i(9653),c=i(9350),f=i(9358),l=c.get("stores/cookie_options"),d=t.SetError=r("CookieSetError"),h=t.MismatchError=r("CookieMismatchError");t.getAll=function(n){var i,r,o,u,s;e.isUndefined(n)&&(n=!0),i=a.getCookieString().split(/\s*;\s*/);var c={};for(o=0;o<i.length;o++)if((u=(r=i[o]).indexOf("="))>0&&void 0===c[s=t.safeDecodeURIComponent(r.substring(0,u))]){var f=r.substring(u+1);n&&(f=t.safeDecodeURIComponent(f)),c[s]=f}return c},t.safeDecodeURIComponent=function(n){try{return decodeURIComponent(n)}catch(t){return n}},t.get=function(n,i){return t.getAll(i)[n]},t.set=function(n,i,r,c){r=e.extend({encodeValue:!0},r),!1!==c&&(c=!0);var g=[];if(e.isUndefined(r.domain)){var m=l.getCurrentDomain();m||(m=function(n,i){!1!==i&&(i=!0);for(var r,o,a=n.hostname.split("."),u=[],c=null,l=a.length-1;l>=0;l--)if(u.unshift(a[l]),r=u.join("."),!e.includes(v,r)){o={domain:i?"."+r:r};try{t.set(p,Math.random().toString(),o),t.remove(p,o),c=o.domain;break}catch(d){}}return f.dispatch(s.SET_COOKIE_DOMAIN,c),c}(u.getLocation(),!0)),r.domain=m}if(r.domain&&g.push("domain="+r.domain),e.isUndefined(r.path)&&(r.path="/"),r.path&&g.push("path="+r.path),e.isUndefined(r.expires)){var _=e.isUndefined(r.maxAge)?l.getDefaultAgeInSeconds():r.maxAge;r.expires=new Date(o.now()+1e3*_)}if(e.isUndefined(r.expires)||g.push("expires="+r.expires.toUTCString()),r.secure&&g.push("secure"),a.setCookie(n+"="+(r.encodeValue?encodeURIComponent(i):i)+";"+g.join(";")),c){var w=r.encodeValue,y=t.get(n,w);if(y!==i){if(!y)throw new d('Failed to set cookie "'+n+'"');throw new h('Expected "'+i+'" for "'+n+'", got "'+y+'"')}}},t.remove=function(n,i){for(var r=u.getLocation().hostname.split(".");r.length>0;)t.set(n,null,e.extend({},i,{domain:"."+r.join("."),expires:new Date(0)}),!1),r.shift()};var v=["optimizely.test"],p="optimizelyDomainTestCookie"},8235:function(n,t,i){var e=i(7871),r=e("InternalError");t.G=r,t.U=function(n){return e(n,r)}},3341:function(n,t,i){var e=i(3232),r=i(4702).Promise;n.exports=function(){var n,t,i=new r((function(i,e){n=i,t=e}));return i.resolve=function(){return n.apply(null,e.toArray(arguments)),i},i.reject=function(){return t.apply(null,e.toArray(arguments)),i},i}},9739:function(n,t,i){var e=i(3232);t.deepFreeze=function(n){},t.safeReference=function(n){return e.cloneDeep(n)}},5210:function(n,t,i){var e=i(3232);t.getFieldValue=function(n,t){e.isArray(t)||(t=[t]);for(var i=n,r=0;r<t.length;r++){var o=t[r];if(!e.isObject(i)||!i.hasOwnProperty(o))return;i=i[o]}return i},t.setFieldValue=function(n,t,i){if(!e.isArray(t)||e.isEmpty(t))throw new Error("Attempted to set an invalid key path: "+t);for(var r=n,o=0;o<t.length-1;o++){var a=t[o];e.isObject(r[a])||(r[a]={}),r=r[a]}r[t[t.length-1]]=i}},4662:function(n,t,i){var e=i(3232);t.create=function(n){if(e.isEmpty(n))return null;var t=document.createElement("a");return t.href=n,t}},3308:function(n,t,i){var e=i(3232),r=i(9653),o=i(1217),a=i(2425),u=i(9358),s=i(6898);function c(){this.logLevel=null,this.logMatch=null,this.logs=[],this.timebase=o.now()}c.prototype.pi=function(){return!e.isNull(this.logLevel)},c.prototype.setLogLevel=function(n){var t=this.gi(n);null===t?console.error("Unknown log level: "+n):this.logLevel!==t&&(this.log("Setting log level to "+t),this.logLevel=t,this.flush())},c.prototype.setLogMatcher=function(n){e.isString(n)?this.logMatcher=n:this.logMatcher="",this.logGroup=0},c.prototype.shouldLog=function(n){return this.pi()&&this.logLevel>=n},c.prototype.matchesLogMessage=function(n,t){var i=this.logMatcher;if(!this.logMatcher)return!0;if(this.logGroup)return"GROUPSTART"===n?this.logGroup++:"GROUPEND"===n&&this.logGroup--,!0;var r=e.some(t,(function(n){if(!e.isString(n))try{n=s.stringify(n)}catch(t){}return e.isString(n)&&e.includes(n,i)}));return r&&"GROUPSTART"===n&&this.logGroup++,r},c.prototype.storeLog=function(n,t){var i={logLevel:n,logMessage:t};u.dispatch(r.LOG,i)},c.prototype.flush=function(){var n=i(9350).get("stores/log");this.logGroup=0;var t=n.getLogs();e.each(t,e.bind((function(n){this.mi(n.logLevel,n.logMessage,!0)}),this))},c.prototype.mi=function(n,t,i){var r,o=n;if(console)switch(n){case"GROUPSTART":r=console.groupCollapsed,o=a.LogLevel.DEBUG;break;case"GROUPEND":r=console.groupEnd,o=a.LogLevel.DEBUG;break;case a.LogLevel.ERROR:r=console.error;break;case a.LogLevel.WARN:r=console.warn;break;case a.LogLevel.DEBUG:r=console.debug;break;default:r=console.log}try{i||this.pi()&&!this.shouldLog(o)||(e.isArray(t)&&e.isString(t[0])&&(t=this._i(t)),this.storeLog(n,t)),r&&this.shouldLog(o)&&this.matchesLogMessage(n,t)&&r.apply(console,t)}catch(u){console&&(console.error?console.error(u):console.log(u))}},c.prototype.debug=function(){this.mi(a.LogLevel.DEBUG,[].slice.call(arguments))},c.prototype.log=function(){this.mi(a.LogLevel.INFO,[].slice.call(arguments))},c.prototype.logAlways=function(){var n=this._i([].slice.call(arguments));console&&console.log&&console.log.apply&&console.log.apply(console,n),this.storeLog(a.LogLevel.INFO,n)},c.prototype.warn=function(){this.mi(a.LogLevel.WARN,[].slice.call(arguments))},c.prototype.error=function(n){var t=[].slice.call(arguments);1===t.length&&n.stack?(this.mi(a.LogLevel.ERROR,[this.wi(),n]),this.mi(a.LogLevel.INFO,[n.stack])):this.mi(a.LogLevel.ERROR,t)},c.prototype.groupCollapsed=function(){this.mi("GROUPSTART",[].slice.call(arguments))},c.prototype.groupEnd=function(){this.mi("GROUPEND",[].slice.call(arguments))},c.prototype._i=function(n){var t=this.wi().toString();return t.length<6&&(t=("     "+t).slice(-6)),[t+"| Optly / "+n[0]].concat(n.slice(1))},c.prototype.wi=function(){return this.timebase?o.now()-this.timebase:0},c.prototype.gi=function(n){return n&&("TRUE"===(n=n.toUpperCase())&&(n="INFO"),"FALSE"===n&&(n="OFF"),"ALL"===n&&(n="DEBUG"),!e.isUndefined(a.LogLevel[n]))?a.LogLevel[n]:null},n.exports=new c},8578:function(n,t,i){n.exports=i(4840)},5293:function(n,t){t.isSingleExperimentPolicy=function(n){return"single_experiment"===n||"multivariate"===n}},5969:function(n,t,i){var e=i(3232),r=i(4702).Promise,o=i(7082);t.pollFor=function(n,t,i){var a,u;return e.isFunction(i)?u=i:(a=i||100,u=function(){return--a<-1}),t=t||50,new r((function(i,e){!function r(){var a;if(!u()){try{var s=n();if(s)return i(s)}catch(c){a=c}return o.setTimeout(r,t)}e(a||new Error("Poll timed out"))}()}))}},2819:function(n,t,i){var e=i(3232),r=i(4702).Promise;t.firstToResolve=function(n){return new r((function(t){e.each(n,(function(n){r.resolve(n).then(t,(function(){}))}))}))}},3405:function(n,t,i){var e=i(3232),r=i(7082);t.getQueryParams=function(){var n=r.getLocationSearch()||"";if(0===n.indexOf("?")&&(n=n.substring(1)),0===n.length)return[];for(var t=n.split("&"),i=[],e=0;e<t.length;e++){var o="",a="",u=t[e].split("=");u.length>0&&(o=u[0]),u.length>1&&(a=u[1]),i.push([o,a])}return i},t.getQueryParamValue=function(n){for(var i=t.getQueryParams(),e=0;e<i.length;e++)if(i[e][0]===n)return i[e][1]},t.queryStringFromMap=function(n){return e.map(n,(function(n,t){return t+"="+n})).join("&")}},7338:function(n,t,i){var e=i(3232),r=i(3308),o=i(7082);function a(n){this.windowLength=n,this.count=0,this.listeners={},this.isIncrementingTick=!1}a.prototype.countCurrentTick=function(){this.isIncrementingTick||(this.isIncrementingTick=!0,this.increment(),o.setTimeout(e.bind((function(){this.isIncrementingTick=!1}),this),0))},a.prototype.increment=function(){this.count+=1,e.forEach(this.listeners[String(this.count)],(function(n){n()})),o.setTimeout(e.bind(this.decrement,this),this.windowLength)},a.prototype.decrement=function(){this.count-=1,this.count<0&&(r.warn("Decremented down to negative count: ",this.count),this.count=0)},a.prototype.addListener=function(n,t){this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push(t)},n.exports=a},6371:function(n,t,i){var e=i(3232),r=i(9350).get("stores/observed_redirect");t.getReferrer=function(){var n=r.get();return n?n.referrer:null},t.getExperimentAndVariation=function(){var n=r.get();return n&&e.isString(n.variationId)?e.pick(n,["experimentId","variationId"]):null}},1674:function(n,t,i){var e=i(3232),r=i(9653),o=i(1217),a=i(9350),u=i(1596),s=i(2425),c=i(9358),f=i(3308),l=a.get("stores/sandbox"),d=i(7082);t.shouldSandbox=function(){return!1},t.get=function(n){if(!n)throw new Error("Name is required");if(t.shouldSandbox()){l.isInitialized()||h();var i=l.get(n);if(i)return i}return d.getGlobal(n)};var h=function(){try{var n="optimizely_"+o.now(),t=u.createElement("iframe");t.name=n,t.style.display="none",u.appendToHead(t);var i=t.contentWindow,a=t.contentDocument;a.write("<script><\/script>"),a.close();var l=e.mapValues(s.SandboxedFunctions,(function(n){return i[n]}));c.dispatch(r.SANDBOXED_FUNCTIONS_ADDED,{sandboxedFunctions:l}),t.parentNode.removeChild(t)}catch(d){f.warn("Unable to create a sandbox: ",d)}}},4452:function(n,t,i){var e=i(1596),r=i(3308),o=i(4755);t.addScriptAsync=function(n,t){var i=e.querySelector("head"),o=e.createElement("script");o.type="text/javascript",o.async=!0,o.src=n,t&&(o.onload=t),i.insertBefore(o,i.firstChild),r.debug("Asynchronously requesting "+n)},t.addScriptSync=function(n,i){try{var a="optimizely_synchronous_script_"+Math.floor(1e5*Math.random());if(-1!==n.indexOf('"'))return void r.error("Blocked attempt to load unsafe script: "+n);e.write('<script id="'+a+'" src="'+n+'"><\/script>');var u=e.querySelector("#"+a);if(!u)throw new Error("DocumentEnv.write failed to append script");u.onload=i,u.onerror=function(e){r.warn("Failed to load script ("+n+") synchronously:",e),t.addScriptAsync(n,i)}}catch(s){r.debug("DocumentEnv.write failed for "+n+": "+s.message);return o.request({url:n,async:!1,contentType:"text/plain",success:function(n){new Function(n.responseText)(),i&&i()}})["catch"]((function(e){r.error("Failed to load "+n+" via synchronous XHR: "+e.message),t.addScriptAsync(n,i)}))}}},2798:function(n,t,i){var e=i(4702).Promise,r=i(7082);t.makeTimeoutPromise=function(n){return new e((function(t,i){r.setTimeout((function(){i(new Error("Timed out after "+n+" ms"))}),n)}))}},5412:function(n,t,i){var e=i(3232),r=i(260),o=i(7082),a=i(9653),u=i(9350),s=i(9358),c=u.get("stores/ua_data");t.get=function(){var n=c.get();return e.isEmpty(n)&&(n=r.parseUA(o.getUserAgent()),s.dispatch(a.SET_UA_DATA,{data:n})),n}},9455:function(n,t){t.guessDomain=function(n,t){if(!n)return"";try{return t?n.match(/:\/\/(.[^/]+)/)[1]:n.match(/:\/\/(?:www[0-9]?\.)?(.[^/:]+)/)[1]}catch(i){return""}}},5762:function(n,t,i){var e=i(3232),r=i(4702).Promise,o=i(9653),a=i(9350),u=i(9358),s=i(1826),c=i(8235).U,f=i(1217),l=i(1596),d=i(6898),h=i(5969),v=i(7324),p=i(7082),g=i(3308),m=a.get("stores/xdomain"),_=t.Error=c("XDomainStorageError");function w(n){var t;if(e.find(m.getFrames(),{origin:n.origin})){try{t=d.parse(n.data)}catch(a){return void g.debug("XDomain","Ignoring malformed message event:",n)}if("ERROR"===t.type)u.dispatch(o.XDOMAIN_SET_DISABLED,{disabled:!0}),s.emitInternalError(new _("Xdomain Error: "+t.response));else if("SYNC"===t.type)e.each(m.getSubscribers(),(function(n){n(t.response.key,t.response.value)}));else{var i=m.getMessageById(t.id);if(!i){if(g.warn("XDomain","No stored message found for ID",t.id),e.isNumber(t.id)){var r=m.getNextMessageId();t.id>=r?s.emitInternalError(new _("Message ID is greater than expected maximum ID ("+t.id+">"+r+")")):t.id<0?s.emitInternalError(new _("Message ID is < 0: "+t.id)):s.emitInternalError(new _("No stored message found for message ID: "+t.id))}else s.emitInternalError(new _("Message ID is not a number: "+t.id));return}if(!i.resolver)return void g.warn("XDomain","Message already resolved, ignoring:",t.id);i.resolver(t.response),u.dispatch(o.XDOMAIN_SET_MESSAGE,{messageId:t.id,message:{data:{id:t.id,type:i.data.type,key:i.data.key},startTime:i.startTime,endTime:f.now()}})}}else g.debug("XDomain","No frame found for origin: "+n.origin)}function y(n,t){return t||(t=m.getDefaultFrame()),new r((function(i){var r={data:e.extend({},n,{id:m.getNextMessageId()}),resolver:i};t?m.isDisabled()||E(r,t):u.dispatch(o.XDOMAIN_SET_MESSAGE,{messageId:r.data.id,message:r})}))}function E(n,t){var i=n.data;u.dispatch(o.XDOMAIN_SET_MESSAGE,{messageId:n.data.id,message:e.extend({},n,{startTime:f.now()})}),t.target.postMessage(d.stringify(i),t.origin)}t.setItem=function(n,t,i){return y({type:"PUT",key:n,value:t},i)},t.getItem=function(n,t){return y({type:"GET",key:n},t)},t.fetchAll=function(n){return y({type:"GETALL"},n)},t.deleteData=function(n,t){return y({type:"DELETE",visitorId:n},t)},t.subscribe=function(n){u.dispatch(o.XDOMAIN_ADD_SUBSCRIBER,{subscriber:n})},t.loadIframe=function(n,t){return new r((function(i){var e=l.createElement("iframe");e.src=n+t,e.hidden=!0,e.setAttribute("tabindex","-1"),e.setAttribute("title","Optimizely Internal Frame"),e.style.display="none",e.height=0,e.width=0,e.onload=function(){var r={id:m.getNextFrameId(),target:e.contentWindow,origin:n,path:t};u.dispatch(o.XDOMAIN_ADD_FRAME,r),i(r)},l.appendTo(l.querySelector("body"),e)}))},t.getXDomainUserId=function(n,t){var i,r={},o=e.keys(n);return e.each(t,(function(n){r[n]=[],e.each(o,(function(t){var o=v.getUserIdFromKey(t,n);!i&&o&&(i=o),o&&!e.includes(r[n],o)&&r[n].push(o)}))})),g.debug("XDomain: Found userIds:",r),i},t.load=function(n,i){p.addEventListener("message",w);return h.pollFor((function(){return!!l.querySelector("body")})).then((function(){return t.loadIframe(n,i)})).then((function(n){u.dispatch(o.XDOMAIN_SET_DEFAULT_FRAME,n),m.isDisabled()||e.each(m.getMessages(),(function(t){t.startTime||E(t,n)}))}))}},4755:function(n,t,i){var e=i(3232),r=i(9653),o=i(1217),a=i(9358),u=i(6898),s=i(3308),c=i(4702).Promise,f=i(1674);t.isCORSSupported=function(){return"withCredentials"in new(f.get("XMLHttpRequest"))},t.request=function(n){return n=e.extend({method:"GET",async:!0,contentType:"text/plain;charset=UTF-8"},n),new c((function(i,r){if(!t.isCORSSupported())return r("CORS is not supported");var o=new(f.get("XMLHttpRequest"));o.onload=function(){n.success&&n.success(o),i(o)},o.onerror=function(){n.error&&n.error(o),r(o)},e.isObject(n.data)&&(n.data=u.stringify(n.data)),o.open(n.method,n.url,n.async),n.withCredentials&&(o.withCredentials=n.withCredentials),o.setRequestHeader("Content-Type",n.contentType),e.isObject(n.headers)&&e.forEach(n.headers,(function(n,t){o.setRequestHeader(t,n)})),o.send(n.data)}))},t.retryableRequest=function(n,i,u,f){if(!i)return c.reject(new Error("No id specified for request."));if(!t.isCORSSupported())return c.reject(new Error("CORS is not supported."));e.isUndefined(f)&&(f=3),e.isUndefined(u)&&(u=0);var l={id:i,timeStamp:o.now(),data:n,retryCount:u};return a.dispatch(r.SET_PENDING_EVENT,l),s.debug("Sending event ",i),t.request(n).then((function(n){return a.dispatch(r.REMOVE_PENDING_EVENT,{id:i}),n}),(function(n){throw l.retryCount>=f?(a.dispatch(r.REMOVE_PENDING_EVENT,{id:i}),s.warn("Event ",l," could not be sent after ",f," attempts.")):(l.retryCount++,a.dispatch(r.SET_PENDING_EVENT,l),s.debug("Event ",l," failed to send, with error ",n," It will be retried ",f-u," times.")),n}))},t.sendBeacon=t.request},4247:function(n,t,i){var e=i(3232),r=i(9653),o=i(6274),a=i(2813),u=i(1217),s=i(9350),c=i(2425),f=i(1069),l=i(9358),d=i(3308),h=i(3468),v=s.get("stores/event_data"),p=s.get("stores/plugins"),g=s.get("stores/rum"),m=s.get("stores/view"),_=s.get("stores/view_data");function w(n,t){e.forEach(n,(function(n){if(n.eventType!==f.CUSTOM){var i=p.getPlugin(c.PluginTypes.eventImplementations,n.eventType);i?t?i.attach(n):i.detach(n):d.warn("No implementation found for event type:",n.eventType,"needed for event:",n)}}))}t.parseViewTags=function(n){var i=t.evaluateViewTags(n);t.setParsedViewTags(n.id,i)},t.updateAllViewTags=function(){var n=m.getActiveViewStates();e.each(n,(function(n){var i=_.get(n.id);t.parseViewTags(i)}))},t.evaluateViewTags=function(n){return n.tags?e.reduce(n.tags,(function(n,t){try{n[t.apiName]=h.getTagValue(t)}catch(r){i=r,(null!=(e=h.Error)&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?e[Symbol.hasInstance](i):i instanceof e)?d.warn("Page / Ignoring unparseable tag",t,r):d.error(r)}var i,e;return n}),{}):{}},t.createViewTicket=function(){var n={};return e.each(p.getAllPlugins(c.PluginTypes.viewProviders),(function(t){n[t.provides]=s.evaluate(t.getter)})),n},t.registerViews=function(n){l.dispatch(r.REGISTER_VIEWS,{views:n})},t.activateViaAPI=function(n,i){i&&t.setUserSuppliedViewTags(n.id,i),t.activateMultiple([n],i)},t.getViewsAndActivate=function(n){var i=_.getAllViewsForActivationType(n);t.activateMultiple(i)},t.activateMultiple=function(n,i){var a=[];return e.each(n,(function(n){var u=m.getViewState(n.id),s=t.createViewTicket();if(u.isActive)if(n.deactivationEnabled)try{t.hasValidStaticConditions(n,s)||t.deactivate(n)}catch(h){d.error("Page / Error evaluating whether to deactivate page ",t.description(n),h)}else d.log("Not activating Page, already active ",t.description(n));else{try{if(!t.hasValidStaticConditions(n,s))return e.isBoolean(u.isActive)||t.setViewActiveState(n,!1),void d.log("Page / Failed to match page conditions for "+t.description(n),n.staticConditions)}catch(h){return e.isBoolean(u.isActive)||t.setViewActiveState(n,!1),void d.error("Page / Error evaluating whether to activate page ",t.description(n),h)}if(a.push(n),t.setViewActiveState(n,!0),d.log("Activated Page",t.description(n)),o.emitViewActivated({view:n,metadata:i}),g.getSampleRum()){var f=n.activationType||c.ViewActivationTypes.immediate;l.dispatch(r.RECORD_ACTIVATION_TYPE_USAGE,{activationType:f,entityId:n.id})}w(v.getByPageId(n.id),!0)}})),e.isEmpty(a)||o.emitViewsActivated({views:a}),a},t.deactivate=function(n){m.getViewState(n.id).isActive?(t.setViewActiveState(n,!1),d.log("Deactivated Page",t.description(n)),o.emitPageDeactivated({page:n}),w(v.getByPageId(n.id),!1)):d.log("Not deactivating Page, already inactive ",t.description(n))},t.setViewActiveState=function(n,t){l.dispatch(r.SET_VIEW_ACTIVE_STATE,{view:n,timestamp:u.now(),isActive:t})},t.setGlobalTags=function(n){l.dispatch(r.SET_GLOBAL_TAGS,n)},t.setParsedViewTags=function(n,t){l.dispatch(r.UPDATE_PARSED_VIEW_METADATA,{pageId:n,metadata:t})},t.setUserSuppliedViewTags=function(n,t){l.dispatch(r.UPDATE_USER_SUPPLIED_METADATA,{pageId:n,metadata:t})},t.hasValidStaticConditions=function(n,t){var i={};if(e.isEmpty(n.staticConditions))return!0;var o=p.getAllPlugins(c.PluginTypes.viewMatchers);d.groupCollapsed("Page / Evaluating staticConditions:",n.staticConditions),d.debug("Matching to current value:",t);var u=a.evaluate(n.staticConditions,(function(n){var e=n.type,r=o[e];if(!r)throw new Error("Page / No matcher found for type="+e);return r&&(i[n.type]||(i[n.type]=!0)),r.match(t,n)}));return d.groupEnd(),g.getSampleRum()&&u&&l.dispatch(r.RECORD_VIEW_FEATURE_USAGE,{featuresUsed:e.keys(i),entityId:n.id}),u},t.description=function(n){return'"'+n.name+'" ('+n.id+")"},t.isActivationTypeImmediate=function(n){return n===c.ViewActivationTypes.immediate||!n},t.shouldTriggerImmediately=function(n){return n===c.ViewActivationTypes.DOMChanged||n===c.ViewActivationTypes.URLChanged||n===c.ViewActivationTypes.immediate||!n},t.create=function(n,t){return{id:n,apiName:t,category:"other"}},t.createState=function(n){return{id:n,isActive:!0,metadata:{},parsedMetadata:{},userSuppliedMetadata:{}}}},7324:function(n,t,i){var e,r=i(3232),o=i(9358),a=i(9653),u=i(7201),s=i(405),c=i(6491),f=i(1217),l=i(9350),d=i(2425),h=i(6898),v=i(5210),p=i(7075).mM,g=i(3308),m=i(4702).Promise,_=i(3405),w=i(2425).VisitorStorageKeys,y=i(7082);e=i(5762);var E=l.get("stores/cookie_options"),b=l.get("stores/global"),I=l.get("stores/layer"),A=l.get("stores/plugins"),T=l.get("stores/rum"),S=l.get("stores/session"),R=l.get("stores/visitor_id"),k=l.get("stores/visitor_bucketing"),N=l.get("stores/visitor"),D=l.get("stores/provider_status");function C(n,t){var i=function(n,i){var e;t.attributionType&&(e=f.now()),o.dispatch(a.SET_VISITOR_ATTRIBUTES,{attributes:[{key:n,value:i,metadata:{lastModified:e}}]})};if(t.getter){var e=t.provides;if(r.isArray(e)||(e=[e]),!(t.isSticky&&!r.isUndefined(v.getFieldValue(n,e)))){var u;try{var s=l.evaluate(t.getter);r.isFunction(s)&&(s=s((function(){return v.getFieldValue(n,e)}),(function(n){i(e,n)}))),r.isUndefined(s)||(t.isAsync?(u=s.then((function(n){i(e,n)}),(function(n){g.warn('Failed to evaluate provider for "'+t.provides+'"; error was:',n)})),o.dispatch(a.SET_VISITOR_ATTRIBUTE_PENDING,{key:e,pending:u})):i(e,s))}catch(c){g.warn('Failed to evaluate getter for provider for "'+t.provides+'"; error was: '+c.message)}return u}}}function O(n){var t=M(n),i=p.getItem(t);return r.isString(i)&&(i=F(i)),i}function x(n){return n.layerId?n:{layerId:n.i,pageId:n.p,decisionTimestamp:n.t,decisionTicket:{audienceIds:n.a||[]},decision:{layerId:n.i,experimentId:n.x||null,variationId:n.v||null,isLayerHoldback:n.h||!1}}}function P(n,t,i){try{var r=M(n);i||(t=h.stringify(t));try{p.setItem(r,t)}catch(o){throw g.warn("Visitor / Unable to set localStorage key, error was:",o),new Error("Unable to set localStorage")}e.setItem(r,t)}catch(o){g.warn("Unable to persist visitor data:",o.message)}}function M(n){var i=R.getBucketingId();if(!i)throw new Error("Visitor bucketingId not set");var e=t.getNamespace();if(!e)throw new Error("Namespace is not set");return[i,e,n].join("$$")}function L(n,i){if(!R.getBucketingId())throw new Error("Cannot update local store because bucketingId not set");if(V(n)){var e=t.getStorageKeyFromKey(n);if(r.includes(w,e)){var u=M(e);if(!(n.indexOf(u)<=0)&&(i=F(i)))if(e===w.EVENT_QUEUE)o.dispatch(a.SET_FOREIGN_VISITOR_EVENT_QUEUE,{key:n,value:s.deserialize(i)});else if(e===w.EVENTS)o.dispatch(a.SET_FOREIGN_VISITOR_EVENTS,{key:n,value:s.deserialize(i)});else if(e===w.LAYER_STATES)o.dispatch(a.LOAD_PERSISTED_LAYER_STATES,{layerStates:r.map(i,x),merge:!0});else if(e===w.VARIATION_MAP)o.dispatch(a.MERGE_VARIATION_ID_MAP,{variationIdMap:i});else if(e===w.VISITOR_PROFILE){var c=i;r.each(["custom"],(function(n){var t=A.getPlugin(d.PluginTypes.visitorProfileProviders,n);if(t){if(c.profile&&c.metadata){var i=function(n,t,i){var e=N.getAttribute(t),o=N.getAttributeMetadata(t),a=n.profile[t],u=n.metadata[t];if(r.isEmpty(e))return{data:a,metadata:u};var s={};return r.forOwn(a,(function(n,t){var e,a;o&&o[t]&&(e=o[t].lastModified),u&&u[t]&&(a=u[t].lastModified),(i===d.AttributionTypes.FIRST_TOUCH&&e>=a||i===d.AttributionTypes.LAST_TOUCH&&a>=e||r.isUndefined(e)&&a)&&(s.data=s.data||{},s.data[t]=n,a&&(s.metadata=s.metadata||{},s.metadata[t]=s.metadata[t]||{},s.metadata[t].lastModified=a))})),s}(c,n,t.attributionType);if(!r.isEmpty(i)){var e=[];r.forOwn(i.data,(function(t,r){var o=i.metadata[r],a={key:[n,r],value:t,metadata:o};e.push(a)})),o.dispatch(a.SET_VISITOR_ATTRIBUTES,{attributes:e})}}}else g.debug("Attribute type",n,"not used by any audiences")}))}}}}function V(n){return n.split("$$")[0].indexOf("://")>0}function F(n){try{return h.parse(n)}catch(t){return g.debug("Failed to parse: ",n,t),null}}t.getOrGenerateId=function(){return{randomId:t.getCurrentId()||"oeu"+f.now()+"r"+Math.random()}},t.getCurrentId=function(){var n=R.getVisitorIdLocator();return N.getVisitorIdFromAPI()||(n?function(n){var t,i=n.name;switch(n.type){case d.VisitorIdLocatorType.COOKIE:t=c.get(i);break;case d.VisitorIdLocatorType.JS_VARIABLE:t=y.getGlobalByPath(i);break;case d.VisitorIdLocatorType.LOCALSTORAGE:try{t=y.getGlobal("localStorage").getItem(i)}catch(u){throw new Error("Unable to read localStorage: "+u.toString())}break;case d.VisitorIdLocatorType.QUERY:t=_.getQueryParamValue(i)}try{if(!t)throw g.error("Visitor / Customer provided visitor id cannot be found. Type:",n.type," Name:",i),new Error("Failure to obtain visitor id from "+n.type);if(!r.isString(t)&&!r.isNumber(t))throw g.error("Visitor / Customer provided visitor id is not a string or number. Type:",n.type," Name:",i," Id Type:",(e=t)&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e),new Error("Customer provided visitor id is not a string or number")}catch(s){throw T.getSampleRum()&&o.dispatch(a.RECORD_VISITOR_ID_ERROR,{isError:!0}),s}var e;T.getSampleRum()&&(o.dispatch(a.RECORD_VISITOR_ID_ERROR,{isError:!1}),o.dispatch(a.RECORD_VISITOR_ID_LOCATOR_USAGE,{visitorIdLocatorType:n.type,entityId:t}));return String(t)}(n):c.get(d.COOKIES.VISITOR_ID))},t.hasSomeData=function(){return p.keys().length>0},t.setId=function(n){var i,s,f=R.getBucketingId();o.dispatch(a.SET_VISITOR_ID,n),R.getBucketingId()!==f&&(!function(){!function(n,t){0;u.initializeStore(n,t)}(O(w.EVENTS)||[],O(w.EVENT_QUEUE)||[]);var n=(i=w.LAYER_STATES,e=R.getBucketingId(),s=[],c=new RegExp(e+"\\$\\$([^$]+?)\\$\\$"+i),r.each(p.keys(),(function(n){var t=n.match(c);if(t){var i={namespace:t[1],userId:e,item:F(p.getItem(n))};s.push(i)}})),s);var i,e,s,c;r.forEach(n,(function(n){n.item=r.map(n.item,x)})),l=n,h=[],r.each(l,(function(n){r.each(n.item,(function(t){t.namespace=n.namespace,h.push(t)}))})),g=h,o.dispatch(a.LOAD_PERSISTED_LAYER_STATES,{layerStates:r.filter(g,(function(n){return!!n.decision}))}),v=O(w.SESSION_STATE)||{},v=r.extend({lastSessionTimestamp:0,sessionId:null},v),o.dispatch(a.LOAD_SESSION_STATE,v),function(n){var t,i,e=A.getAllPlugins(d.PluginTypes.visitorProfileProviders),u=r.filter(e,(function(n){return r.isFunction(n.restorer)}));n.profile&&n.metadata?(t=n.profile,i=n.metadata):(t=n,i={});t=r.reduce(t,(function(n,t,i){var e=t,o=r.find(u,{provides:i});return o&&(e=o.restorer(t)),n[i]=e,n}),{}),o.dispatch(a.LOAD_EXISTING_VISITOR_PROFILE,{profile:t,metadata:i})}(O(w.VISITOR_PROFILE)||{});var f=O(w.TRACKER_OPTIMIZELY);f&&(m=f,o.dispatch(a.SET_TRACKER_PERSISTABLE_STATE,m));var l,h;var v;var g;var m;t.loadForeignData(),t.removeLegacySessionStateCookies()}(),t.deleteOldLocalData(),e.deleteData(n));try{R.getVisitorIdLocator()||t.maybePersistVisitorId(n)}catch(l){if(g.error("Visitor / Unable to persist visitorId, disabling tracking"),o.dispatch(a.LOAD_DIRECTIVE,{trackingDisabled:!0}),i=l,null!=(s=c.MismatchError)&&"undefined"!=typeof Symbol&&s[Symbol.hasInstance]?s[Symbol.hasInstance](i):i instanceof s)throw g.error("Visitor / Cookie not set to correct value:",l),new Error("Cookie mismatch error while persisting visitorId");throw l}t.refreshSession()},t.getVariationIdMap=function(){return O(w.VARIATION_MAP)||{}},t.updateVariationIdMap=function(n,t,i){o.dispatch(a.UPDATE_VARIATION_ID_MAP,{layerId:n,experimentId:t,variationId:i})},t.persistVariationIdMap=function(){var n=k.getVariationIdMapString();P(w.VARIATION_MAP,n,!0)},t.getPreferredLayerMap=function(){return O(w.LAYER_MAP)||{}},t.updatePreferredLayerMap=function(n,t){o.dispatch(a.UPDATE_PREFERRED_LAYER_MAP,{groupId:n,layerId:t})},t.persistTrackerOptimizelyData=function(n){P(w.TRACKER_OPTIMIZELY,n)},t.refreshSession=function(){o.dispatch(a.REFRESH_SESSION)},t.populateEagerVisitorData=function(n,i){var e=r.filter(n,(function(n){return!n.isLazy}));return t.populateVisitorData(e,i)},t.populateLazyVisitorData=function(n,i){var e=r.filter(n,(function(n){return n.isLazy}));return t.populateVisitorData(e,i)},t.populateVisitorData=function(n,t){t=t||{};var i=r.partial(C,t),e=r(n).filter({isAsync:!0}).map(i).filter().value();return r.forEach(r.filter(n,(function(n){return!n.isAsync})),i),e.length>0?m.all(e):m.resolve()},t.persistBehaviorEvents=function(n){P(w.EVENTS,n)},t.persistBehaviorEventQueue=function(n){P(w.EVENT_QUEUE,n)},t.getPersistedBehaviorEventCount=function(){var n=O(w.EVENTS)||[],t=O(w.EVENT_QUEUE)||[];return s.deserialize(n).length+s.deserialize(t).length},t.persistLayerStates=function(){var n=I.getLayerStates(t.getNamespace());n=r.map(n,(function(n){return r.omit(n,"namespace")})),P(w.LAYER_STATES,n)},t.persistSessionState=function(){P(w.SESSION_STATE,S.getState())},t.persistVisitorProfile=function(){P(w.VISITOR_PROFILE,function(){var n=N.getVisitorProfile(),t=N.getVisitorProfileMetadata(),i=A.getAllPlugins(d.PluginTypes.visitorProfileProviders);if(i){var e=r.reduce(i,(function(n,t){return t.provides&&(n[t.provides]=t),n}),{});n=r.omitBy(n,(function(n,t){var i=e[t];return i&&i.isTransient}))}return{profile:n,metadata:t}}())},t.persistVisitorBucketingStore=function(){var n;t.persistVariationIdMap(),n=k.getPreferredLayerMapString(),P(w.LAYER_MAP,n,!0)},t.getUserIdFromKey=function(n,i){var e;return r.includes(n,i)&&r.includes(n,"_")&&r.includes(n,"$$")&&r.includes(n.slice(n.indexOf("$$")),t.getNamespace())&&(e=n.slice(n.indexOf("_")+1,n.indexOf("$$"))),e},t.maybePersistVisitorId=function(n){n.randomId&&(E.getAutoRefresh()||t.getCurrentId()!==n.randomId?(c.set(d.COOKIES.VISITOR_ID,n.randomId),g.log("Persisting visitorId:",n.randomId)):g.log("Not persisting visitorId: value is not changed and also auto-refresh is disabled"))},t.getAttribute=function(n){return N.getAttribute(n)},t.getPendingAttributeValue=function(n){return D.getPendingAttributeValue(n)},t.isForeignKey=V,t.checkKeyForVisitorId=function(n){var i=R.getBucketingId()||t.getCurrentId(),e=t.getIdFromKey(n);return!e||e===i},t.getIdFromKey=function(n){var i=n.split("$$")[0],e=t.getStorageKeyFromKey(n);if(r.includes(d.StorageKeys,e))return null;var o=i.indexOf("_");return-1===o?i:i.substring(o+1)},t.getStorageKeyFromKey=function(n){var t,i=n.split("$$").pop();if(i.indexOf("://")>-1){var e=i.indexOf("_");t=i.substring(e+1)}else t=i;return r.includes(r.values(d.AllStorageKeys),t)?t:null},t.deleteOldLocalData=function(){var n=p.keys();r.each(n,(function(n){t.isForeignKey(n)||t.checkKeyForVisitorId(n)||p.removeItem(n)}))},t.deleteOldForeignData=function(){var n=p.keys();r.each(n,(function(n){t.isForeignKey(n)&&p.removeItem(n)}))},t.loadForeignData=function(){r.each(p.keys(),(function(n){var t=p.getItem(n);t&&L(n,t)}))},t.getNamespace=function(){return b.getNamespace()},t.serializeFieldKey=function(n){return r.isArray(n)?n.join("$$"):n},t.removeLegacySessionStateCookies=function(){var n=c.getAll();r.forEach(r.keys(n),(function(n){0===n.indexOf(d.COOKIES.SESSION_STATE+"$$")&&c.remove(n)}))}},4773:function(n,t,i){var e=i(3232),r=i(2425);t.normalizeClientData=function(n){!n.listTargetingKeys&&n.listTargetingCookies&&(n.listTargetingKeys=e.map(n.listTargetingCookies,(function(n){return{type:r.ListTargetingKeyTypes.COOKIE,key:n}})),delete n.listTargetingCookies)}},9432:function(n,t,i){i(9350).register("env/jquery",i(6552))},6552:function(n,t,i){var e,r=i(7082);try{e=$}catch(a){}var o=r.getGlobal("$");n.exports=e&&e!==o?e:o},6236:function(n,t,i){function e(n,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](n):n instanceof t}var r=i(3232),o=i(8235).G,a=i(1217),u=i(9350),s=i(1596),c=i(3308),f=i(7082),l=i(4755),d=u.get("stores/client_metadata"),h=u.get("stores/global");function v(n){return n&&n.engine?n.engine:d.getClientName()}t.handleError=function(n,t){var i=function(){return l.request({url:"https://errors.client.optimizely.com/log",method:"POST",data:m,contentType:"application/json"}).then((function(n){c.log("Error Monitor / Logged error with response: ",n)}),(function(n){c.error("Failed to log error, response was: ",n)}))},u=n.name||"Error",p=n.message||"",g=n.stack||null;e(n,o)&&(e(p,Error)?(p=p.message,g=n.message.stack):g=null);var m={timestamp:a.now(),clientEngine:v(t),clientVersion:d.getClientVersion(),accountId:h.getAccountId(),projectId:h.getProjectId(),errorClass:u,message:p,stacktrace:g},_=r.map(h.getExperimental(),(function(n,t){return{key:"exp_"+t,value:String(n)}}));t&&r.forEach(t,(function(n,t){r.isObject(n)||_.push({key:t,value:String(n)})}),[]),r.isEmpty(_)||(m.metadata=_),c.error("Logging error",m),s.isLoaded()?i():f.addEventListener("load",i)}},4003:function(n,t,i){var e=i(3232),r=i(9653),o=i(1826),a=i(1729),u=i(8235).U,s=i(4944),c=i(3341),f=i(9350).get("stores/directive"),l=i(1596),d=i(5934),h=i(9358),v=i(3308),p=i(7338),g=i(6974),m=i(6365).create(),_=1e3,w=10,y=u("ChangeOverheatError");function E(n,t){if(this.change=n,this.identifier=t.identifier,this.startTime=t.startTime,f.shouldObserveChangesIndefinitely()){h.dispatch(r.INITIALIZE_CHANGE_METRICS),this.rateMeter=new p(_);var i=e.isNull(w)?Number.POSITIVE_INFINITY:w;this.rateMeter.addListener(i,e.bind((function(){v.warn("AppendChange",this,"has overheated and will no longer apply or reapply"),this.cancel(),h.dispatch(r.RECORD_CHANGE_OVERHEATED),o.emitError(new y("Change "+this.identifier+" has overheated"),{layerId:t.action&&t.action.layerId,experimentId:t.action&&t.action.experimentId,variationId:t.action&&t.action.variationId,changeId:n.id,changeType:n.type,movingWindowMilliseconds:_,maxMacroTasksInMovingWindow:i})}),this));for(var a=Math.min(i,50),u=0;u<=a;u++)this.rateMeter.addListener(u,e.partial((function(n){h.dispatch(r.RECORD_CHANGE_MACROTASK_RATE,{changeMacrotaskRate:n})}),u))}}E.prototype.numberOfRootNodes=function(n){var t=document.createElement("div");return t.innerHTML=n,t.childNodes.length},E.prototype.getSiblingElements=function(n,t,i){for(var e=n,r=[],o=0;o<t;o++)i?(r.push(e.nextSibling),e=e.nextSibling):(r.push(e.previousSibling),e=e.previousSibling);return r},E.prototype.apply=function(){this.applyDeferred=c();try{if(!this.numberOfRootNodes(this.change.value))throw new Error("No DOM elements to be created for this change: "+this.change.value);var n=e.partial(this.applyDeferred.reject,new Error("Unable to find selector.")),t={};f.shouldObserveChangesUntilTimeout()?t={timeout:e.partial(g.isTimedOut,this.startTime),onTimeout:n}:f.isEditor()&&m.waitUntil(e.partial(g.isTimedOut,this.startTime)).then(n,n),this.unobserveSelector=m.observeSelector(this.change.selector,e.bind(this.maybeApplyToElement,this),t);var i=l.querySelectorAll(this.change.selector);e.each(i,e.bind(this.maybeApplyToElement,this))}catch(r){this.applyDeferred.reject(r)}return this.applyDeferred},E.prototype.maybeApplyToElement=function(n){var t=a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id;if(n.hasAttribute(t))return v.debug("Not applying AppendChange to element",n,"because it was inserted by this change"),void this.applyDeferred.resolve();this.rateMeter&&this.rateMeter.countCurrentTick(),e.bind(this.applyOrReapplyToElement,this,n,t)(),this.applyDeferred.resolve()},E.prototype.applyOrReapplyToElement=function(n,t){var i;switch(this.change.operator){case d.DOMInsertionType.AFTER:i=d.insertAdjacentHTMLType.AFTER_END;break;case d.DOMInsertionType.APPEND:i=d.insertAdjacentHTMLType.BEFORE_END;break;case d.DOMInsertionType.BEFORE:i=d.insertAdjacentHTMLType.BEFORE_BEGIN;break;case d.DOMInsertionType.PREPEND:i=d.insertAdjacentHTMLType.AFTER_BEGIN;break;default:i=d.insertAdjacentHTMLType.BEFORE_END}n.insertAdjacentHTML(i,this.change.value),n.setAttribute(t,""),s.setData(n,this.change.id,this.identifier,[]);var r,o,a=this.numberOfRootNodes(this.change.value)-1;i===d.insertAdjacentHTMLType.BEFORE_END?(r=n.lastChild,o=this.getSiblingElements(r,a,!1)):i===d.insertAdjacentHTMLType.AFTER_BEGIN?(r=n.firstChild,o=this.getSiblingElements(r,a,!0)):i===d.insertAdjacentHTMLType.BEFORE_BEGIN?(r=n.previousSibling,o=this.getSiblingElements(r,a,!1)):i===d.insertAdjacentHTMLType.AFTER_END&&(r=n.nextSibling,o=this.getSiblingElements(r,a,!0)),o.unshift(r),e.each(o,e.bind((function(n){var i=n.nodeType===Node.ELEMENT_NODE?n:l.parentElement(n);i.setAttribute(t,"");var r=s.getData(i,this.change.id,this.identifier)||[];r.push(n),s.setData(i,this.change.id,this.identifier,r),e.each(l.childrenOf(i),(function(n){n.setAttribute(t,"")}))}),this))},E.prototype.cancel=function(){this.unobserveSelector&&this.unobserveSelector()},E.prototype.undo=function(){var n=a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id,t=document.querySelectorAll("["+n+"]");return e.each(t,e.bind((function(t){var i=s.getData(t,this.change.id,this.identifier)||[];e.each(i,(function(n){n.parentNode.removeChild(n)})),t.removeAttribute(n),s.removeData(t,this.change.id,this.identifier),e.each(l.childrenOf(t),(function(t){t.removeAttribute(n)}))}),this)),c().resolve(d.changeState.UNAPPLIED)},n.exports=function(n){n.registerChangeApplier(d.changeType.APPEND,E)}},2123:function(n,t,i){var e=i(3232),r=i(5934);t.transformVisibilityAttributesToCSS=function(n){if(!n.attributes)return n;if(n.attributes[r.selectorChangeType.HIDE]||n.attributes[r.selectorChangeType.REMOVE]){var t=e.extend({css:{}},e.cloneDeep(n));return n.attributes[r.selectorChangeType.HIDE]&&(t.css.visibility="hidden",delete t.attributes[r.selectorChangeType.HIDE]),n.attributes[r.selectorChangeType.REMOVE]&&(t.css.display="none",delete t.attributes[r.selectorChangeType.REMOVE]),t}return n},t.createStylesFromChange=function(n,t){if(e.isEmpty(t.css))return t.attributes.style;var i="",r=t.attributes.style||"";return e.each(t.css,(function(n,t){new RegExp(t+"\\s?:").test(r)||(i+=t+":"+n+";")})),e.isUndefined(t.attributes.style)?(n||"")+i:i+r}},3813:function(n,t,i){var e=i(3232),r=(i(4702).Promise,i(9653)),o=i(1826),a=i(1729),u=i(8235).U,s=i(4944),c=i(3341),f=i(9350).get("stores/directive"),l=i(1596),d=i(5934),h=i(9358),v=i(3308),p=i(1016),g=i(7338),m=i(6974),_=i(7082),w=i(2123),y=i(6365).create(),E={attributes:!0,childList:!0,subtree:!0,characterData:!0},b=1e3,I=10,A=u("ChangeOverheatError");function T(n,t){if(this.change=e.cloneDeep(n),this.change=w.transformVisibilityAttributesToCSS(this.change),this.identifier=t.identifier,this.startTime=t.startTime,this.disconnectObserverQueue=[],f.shouldObserveChangesIndefinitely()){h.dispatch(r.INITIALIZE_CHANGE_METRICS),this.rateMeter=new g(b);var i=e.isNull(I)?Number.POSITIVE_INFINITY:I;this.rateMeter.addListener(i,e.bind((function(){v.warn("AttributeChange",this,"has overheated and will no longer apply or reapply"),this.cancel(),h.dispatch(r.RECORD_CHANGE_OVERHEATED),o.emitError(new A("Change "+this.identifier+" has overheated"),{layerId:t.action&&t.action.layerId,experimentId:t.action&&t.action.experimentId,variationId:t.action&&t.action.variationId,changeId:n.id,changeType:n.type,movingWindowMilliseconds:b,maxMacroTasksInMovingWindow:i})}),this));for(var a=Math.min(i,50),u=0;u<=a;u++)this.rateMeter.addListener(u,e.partial((function(n){h.dispatch(r.RECORD_CHANGE_MACROTASK_RATE,{changeMacrotaskRate:n})}),u))}this.cancelled=!1}T.prototype.apply=function(){this.applyDeferred=c();try{if(e.isEmpty(this.change.attributes)&&e.isEmpty(this.change.css))return v.debug("Not applying empty AttributeChange"),this.applyDeferred.resolve(),this.applyDeferred;var n=e.partial(this.applyDeferred.reject,new Error("Unable to find selector.")),t={};f.shouldObserveChangesUntilTimeout()?t={timeout:e.partial(m.isTimedOut,this.startTime),onTimeout:n}:f.isEditor()&&y.waitUntil(e.partial(m.isTimedOut,this.startTime)).then(n,n),this.unobserveSelector=y.observeSelector(this.change.selector,e.bind(this.maybeApplyToElement,this),t);var i=l.querySelectorAll(this.change.selector);e.each(i,e.bind(this.maybeApplyToElement,this))}catch(r){this.applyDeferred.reject(r)}return this.applyDeferred},T.prototype.maybeApplyToElement=function(n){var t=a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id;if(n.hasAttribute(t))return v.debug("AttributeChange not being applied. Element already changed, or is a child of an element that was changed by this AttributeChange. "+n),void this.applyDeferred.resolve();this.rateMeter&&this.rateMeter.countCurrentTick();var i=e.bind(this.applyOrReapplyToElement,this,n,t);i();var r=e.bind((function(){var t=e.bind((function(){this.cancelled||p.observe(o,n,E)}),this);return _.setTimeout(t)}),this),o=p.create(e.bind((function(){this.rateMeter&&this.rateMeter.countCurrentTick(),o.disconnect(),i(),r()}),this));r(),this.disconnectObserverQueue.push(e.bind(o.disconnect,o)),this.applyDeferred.resolve()},T.prototype.applyOrReapplyToElement=function(n,t){var i={};e.forOwn(this.change.attributes,(function(r,o){switch(o){case d.selectorChangeType.CLASS:e.isUndefined(n.className)||(i[d.selectorChangeType.CLASS]=n.className,n.className=r);break;case d.selectorChangeType.HREF:e.isUndefined(n.href)||(i[d.selectorChangeType.HREF]=n.href,n.href=r);break;case d.selectorChangeType.HTML:e.isUndefined(n.innerHTML)||(i[d.selectorChangeType.HTML]=n.innerHTML,n.innerHTML=r,e.each(l.childrenOf(n),(function(n){n.setAttribute(t,"")})));break;case d.selectorChangeType.SRC:e.isUndefined(n.src)||(i[d.selectorChangeType.SRC]=n.src,n.src=r);break;case d.selectorChangeType.STYLE:break;case d.selectorChangeType.TEXT:e.isUndefined(n.textContent)||(i[d.selectorChangeType.TEXT]=n.textContent,n.textContent=r);break;default:throw new Error("Unrecognized attribute: "+o)}}));var r=w.createStylesFromChange(n.style.cssText,this.change);e.isString(r)&&(i[d.selectorChangeType.STYLE]=n.style.cssText,n.style.cssText=r),n.setAttribute(t,""),s.setData(n,this.change.id,this.identifier,i)},T.prototype.cancel=function(){this.cancelled=!0,this.unobserveSelector&&this.unobserveSelector(),e.each(this.disconnectObserverQueue,(function(n){try{n()}catch(t){}}))},T.prototype.undo=function(){var n=document.querySelectorAll("["+a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id+"]");return e.each(n,e.bind((function(n){var t=s.getData(n,this.change.id,this.identifier);t&&e.forOwn(t,(function(t,i){switch(i){case d.selectorChangeType.CLASS:n.className=t;break;case d.selectorChangeType.HREF:n.href=t;break;case d.selectorChangeType.HTML:n.innerHTML=t;break;case d.selectorChangeType.SRC:n.src=t;break;case d.selectorChangeType.STYLE:n.style.cssText=t;break;case d.selectorChangeType.TEXT:n.textContent=t;break;case d.selectorChangeType.HIDE:n.style.visibility=t;break;case d.selectorChangeType.REMOVE:n.style.display=t;break;default:throw new Error("Unrecognized attribute: "+i)}})),n.removeAttribute(a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id),s.removeData(n,this.change.id,this.identifier)}),this)),c().resolve(d.changeState.UNAPPLIED)},n.exports=function(n){n.registerChangeApplier(d.changeType.ATTRIBUTE,T)}},5166:function(n,t,i){var e=i(3232),r=i(3341),o=i(5934),a=i(3209);function u(n,t){if(!e.isFunction(n.value))throw new Error("Custom code must be a function");this.change=n}u.prototype.apply=function(){var n=r();try{a.apply(this.change.value),n.resolve()}catch(t){n.reject(t)}return n},u.prototype.undo=function(){return r().resolve(o.changeState.IGNORED)},n.exports=function(n){n.registerChangeApplier(o.changeType.CUSTOM_CODE,u)}},9566:function(n,t,i){var e=i(3232),r=i(4702).Promise,o=i(9653),a=i(2425),u=i(6491),s=i(1596),c=i(5934),f=i(9358),l=i(4662),d=i(3308),h=i(7082);function v(n,t){if(this.change=n,this.config=t,this.reasonShouldNotRedirect=this._checkForReasonNotToRedirect(),!this.reasonShouldNotRedirect){if(!e.isString(this.change.dest)&&!e.isFunction(this.change.dest))throw new Error("Redirect destination is not a string or function");if(e.isFunction(this.change.dest)&&(this.change.dest=this.change.dest(),!e.isString(this.change.dest)))throw new Error("Redirect destination function did not evaluate to a string");if(!this.config.action)throw new Error("Redirect changes require an action to be passed in the config.");f.dispatch(o.ANNOUNCE_PENDING_REDIRECT,{layerId:this.config.action.layerId})}}v.prototype.apply=function(){if(this.reasonShouldNotRedirect)return d.warn("Redirect change is not being applied because: "+this.reasonShouldNotRedirect),r.resolve(c.changeState.IGNORED);if(this.reasonInvalid)return d.error("Redirect change cannot be applied because:",this.reasonInvalid),r.reject(this.reasonInvalid);try{this.yi(this.Ei())}catch(n){return r.reject(n)}return r.resolve(c.changeState.APPLIED)},v.prototype.Ei=function(){var n=l.create(this.change.dest);if(this.change.preserveParameters){var t=h.getLocation().search;t&&(n.search?n.search+="&"+t.substr(1):n.search=t)}return n.toString()},v.prototype.bi=function(){var n=s.createElement("style");n.setAttribute("type","text/css"),n.innerHTML="body{display:none;visibility:hidden;}",s.appendToHead(n)},v.prototype.yi=function(n){(!this.change.hasOwnProperty("hidePage")||this.change.hidePage)&&this.bi(),h.setLocation(n)},v.prototype._checkForReasonNotToRedirect=function(){var n=u.get(a.COOKIES.REDIRECT);if(!this.change.allowAdditionalRedirect&&!e.isUndefined(n))return"Page was already redirected."},v.prototype.undo=function(){return r.resolve(c.changeState.IGNORED)},n.exports=function(n){n.registerChangeApplier(c.changeType.REDIRECT,v)}},795:function(n,t,i){Object.defineProperty(t,"Ii",{value:!0});var e=i(7929),r=i(3529).E,o={selectExperiment:function(n,t,i){if(n.experiments.length<1)throw new r("Unable to find experiment to bucket user into");var o=n.experiments[0];if(!e.isValidExperiment(t,o))throw new r('Audience conditions failed for experiment: "'+o.id+'".');return o}};n.exports=function(n){n.registerDecider("single_experiment",o),n.registerDecider("multivariate",o)}},7136:function(n,t,i){var e=function(n){return n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n},r=i(3232),o=i(1826),a=i(8235).U,u=i(1596),s=i(8578),c=t.Error=a("ClickDelegateError");function f(n){this.handler=n,this.events=[],this.unlistenFn=null,this.clickHandler=r.bind((function(n){r.forEach(this.events,r.bind((function(t){try{var i=t.config&&t.config.selector?t.config.selector:t.eventFilter.selector;(function(n,t,i){var a=n.target,u=0;for(;a;){var f;try{f=s(a,t)}catch(d){var l={typeofElementValue:void 0===a?"undefined":e(a),nodeName:r.result(a,["nodeName"],null),nodeType:r.result(a,["nodeType"],null),targetName:r.result(n,["target","nodeName"],null),targetType:r.result(n,["target","nodeType"],null),numParentsTraversed:u,selector:t,errorMessage:d.message,eventId:i.id};return o.emitError(new c("Unable to evaluate match for element"),l),!1}if(f)return!0;a=a.parentElement,u++}return!1})(n,i,t)&&this.handler(t)}catch(a){o.emitError(new c("Unable to handle click for selector"+i+":"+a.message))}}),this))}),this)}f.prototype.listen=function(){this.unlistenFn=u.addEventListener("click",this.clickHandler,!0)},f.prototype.unlisten=function(){this.unlistenFn&&(this.unlistenFn(),this.unlistenFn=null)},f.prototype.hasEvents=function(){return this.events.length>0},f.prototype.addEvent=function(n){this.events.push(n)},f.prototype.removeEvent=function(n){this.events=r.filter(this.events,(function(t){return t.apiName!==n.apiName}))},n.exports=f},8520:function(n,t,i){var e=i(8317),r=i(7136),o=i(3308),a=i(4247);function u(n){return"apiName: "+n.apiName+", selector: "+n.eventFilter.selector}n.exports=function(n){var t=new r((function(n){a.updateAllViewTags(),e.trackClickEvent(n)?o.log("Tracking click event:",n):o.log("Not tracking click event:",n)}));n.registerEventImplementation("click",{attach:function(n){t.hasEvents()||t.listen(),t.addEvent(n),o.debug("Started listening for click event ("+u(n)+"):",n)},detach:function(n){t.removeEvent(n),t.hasEvents()||t.unlisten(),o.debug("Stopped listening for click event ("+u(n)+"):",n)}})}},3844:function(n,t,i){var e=i(3232),r=i(8473),o=i(1007),a=i(9666);function u(n,t){var i=o.buildFromSpecV0_1(t);if(1!==i.length)throw new Error("Invalid query descriptor; verify that no aggregators are specified");return a.execute(i[0],n)}function s(n,t){return e.map(n,(function(n){return e.isFunction(n.toObject)?n.toObject(t):n}))}function c(n,t){if(!n)return["Descriptor not defined"];var i=[];return n.count&&i.push('Unexpected "count" clause specified'),n.pick&&n.pick.modifier&&-1===t.indexOf(n.pick.modifier)&&i.push('Invalid "pick" modifier "'+n.pick.modifier+'"'),e.each(n.filters,(function(n){e.isUndefined(n.modifier)||i.push('Unexpected "filter" modifier "'+n.modifier+'"')})),i.length>0?i:void 0}function f(n,t){var i={revenueAsTag:!1,timeAsTimestamp:!0};if(e.isUndefined(t))return s(r.getEvents(n),i);if(e.isNumber(t)){if(t<=0)throw new Error("Count must be a positive integer, got "+t);return s(r.getEvents(n).slice(-t),i)}var a=c(t,e.values(o.RECENCY_FILTERS));if(a)throw new Error(a.join("\n"));return s(u(r.getEvents(n),t),i)}function l(n,t){if(!(t=e.cloneDeep(t)||{}).pick)throw new Error('No "pick" clause provided in query descriptor');if(!t.pick.name)throw new Error('No field name provided in "pick" clause');t.pick.modifier=t.pick.modifier||o.FREQUENCY_FILTERS.MOST_FREQUENT;var i=c(t,e.values(o.FREQUENCY_FILTERS));if(i)throw new Error(i.join("\n"));return u(r.getEvents(n),t)}function d(n,t){var i=o.buildFromSpecV0_2(t),u=r.getEvents(n),c=s(a.execute(i,u),{revenueAsTag:!0,timeAsTimestamp:!1});return(t.pick||t.reduce&&"count"===t.reduce.aggregator)&&(c=e.flatten(c)),t.reduce&&(c=c[0]),c}n.exports=["stores/visitor_events",function(n){return{getEvents:e.partial(f,n),getByFrequency:e.partial(l,n),query:e.partial(d,n)}}]},371:function(n,t,i){n.exports=function(n){n.registerApiModule("behavior",i(3844))}},6746:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(1650)),n.registerAudienceMatcher("behavior",i(3695))}},3695:function(n,t,i){var e=i(3232),r=i(6898),o=i(1007),a=i(9666);n.exports={fieldsNeeded:["events"],match:function(n,t){var i,u=r.parse(t.value);return i=e.isUndefined(u.version)?[u]:o.buildFromSpecV0_1(u),e.every(i,(function(t){return a.isSatisfied(t,n.events)}))}}},1650:function(n,t,i){var e=i(8473);n.exports={provides:"events",isTransient:!0,getter:[function(){return e.getEvents()}]}},3395:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(7919))}},7919:function(n,t,i){var e=i(3232),r=i(1006),o=i(8473),a=i(6898),u=i(1007);n.exports={provides:"customBehavior",shouldTrack:!0,isLazy:!1,getter:["stores/global","stores/visitor_attribute_entity",function(n,t){var i=n.getProjectId(),s=e.filter(e.map(t.getCustomBehavioralAttributes(i),(function(n){try{return{id:n.id,granularity:r.GRANULARITY.ALL,rule:u.buildFromSpecV0_2(a.parse(n.rule_json))}}catch(t){return}}))),c=o.getEvents();return r.evaluate(s,c)}]}},1643:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(4072)),n.registerAudienceMatcher("first_session",i(504))}},504:function(n){n.exports={fieldsNeeded:["first_session"],match:function(n){return!!n.first_session}}},4072:function(n,t,i){var e=i(2460),r=i(8473),o=i(5210).getFieldValue,a=i(2611).CURRENT_SESSION_INDEX;n.exports={provides:"first_session",shouldTrack:!0,getter:[function(){var n=r.getEvents();if(n&&n.length>0){var t=n[0];return o(t,[e.FIELDS.SESSION_INDEX])===a}return!0}]}},1006:function(n,t,i){var e=i(3308),r={FIELDS:i(2460).FIELDS},o=i(1007),a=i(9666);t.GRANULARITY={ALL:"all",CURRENT_SESSION:"current_session",LAST_30_DAYS:"last_30_days",LAST_60_DAYS:"last_60_days"},t.evaluate=function(n,i){var u={};if(0===i.length){for(var s=0;s<n.length;s++)u[n[s].id]=n[s].defaultValue;return u}var c=function(n){if(0===n.length)return[];for(var t=n.length-1,i=r.FIELDS.SESSION_ID,e=n[t][i];t>0&&e===n[t-1][i];)t--;return n.slice(t)}(i),f=function(n,t){if(0===n.length||t<=0)return[];var i=+new Date-t*o.MILLIS_IN_A_DAY;i-=i%o.MILLIS_IN_A_DAY;for(var e=n.length;e>0&&i<=n[e-1][r.FIELDS.TIME];)e--;return n.slice(e)}(i,60);for(s=0;s<n.length;s++){var l=n[s],d=i;l.granularity===t.GRANULARITY.CURRENT_SESSION?d=c:l.granularity===t.GRANULARITY.LAST_60_DAYS&&(d=f);try{var h=d;l.rule&&(h=a.execute(l.rule,d)),u[l.id]=l.defaultValue,1===h.length?u[l.id]=h[0][0]||l.defaultValue:e.debug("Behavior / Rule for",l.id,"returned",h.length,"results, expected 1")}catch(v){e.error("Behavior / Rule for",l.id,"failed with",v.message||"")}}return u}},8473:function(n,t,i){var e=i(3232),r=i(405),o=i(9350).get("stores/visitor_events");t.getEvents=function(){var n=r.getEvents(),t=[].concat.apply([],e.values(o.getForeignEvents())),i=[].concat.apply([],e.values(o.getForeignEventQueues())),a=r.mergeAllEvents([n,t,i]);return a.slice(a.length-1e3)}},1007:function(n,t,i){var e=t,r=i(3232),o={FIELDS:i(2460).FIELDS,FIELDS_V0_2:i(2460).FIELDS_V0_2},a=i(6898),u=i(3308),s=i(9666);e.MILLIS_IN_A_DAY=864e5,e.aggregateField=function(n,t){return r.isString(t)&&(t=[t]),t=t||s.DEFAULT_FIELD,[s.generateAlias(n,t)]},e.groupField=function(n){return r.isString(n)&&(n=[n]),[(n=n||s.DEFAULT_FIELD).join(".")]};var c={"<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","==":"eq"};function f(n){return n=(n||"").toString().trim(),c[n]||n}function l(n,t,i){var a={where:t};if(n.count&&(a.limit=n.count),n.modifier===e.FREQUENCY_FILTERS.MOST_FREQUENT){var u=e.getFieldKeyPathForSource(n.name,i),s=e.aggregate("count"),c=e.aggregateField("count"),f=e.groupField(u);return r.extend(a,{select:[{field:f}],groupBy:e.groupBy([u]),aggregate:[s],orderBy:[{field:c,direction:"DESC"}]})}return r.extend(a,{orderBy:[{field:[o.FIELDS.TIME],direction:"DESC"}]})}e.fieldComparison=function(n,t,i){return n=f(n),r.isString(t)&&(t=[t]),"exists"===n?{op:n,args:[{field:t}]}:{op:n,args:[{field:t},{value:i}]}},e.relativeTimeComparison=function(n,t){return{op:f(n),args:[{op:"-",args:[{eval:"now"},{field:[o.FIELDS.TIME]}]},{value:t*e.MILLIS_IN_A_DAY}]}},e.rangeTimeComparison=function(n){return r.isArray(n)?{op:"between",args:[{field:[o.FIELDS.TIME]},{value:[n[0]||+new Date(0),n[1]||+new Date]}]}:(u.error("Rule builder","rangeTimeComparison passed invalid range",n),null)},e.groupBy=function(n){for(var t=[],i=0;i<n.length;i++)t[i]={field:n[i]};return t},e.aggregate=function(n,t){return r.isString(t)&&(t=[t]),{op:n,args:[{field:t=t||s.DEFAULT_FIELD}]}},e.SOURCE_TYPES={BEHAVIOR:"events",CUSTOM_BEHAVIOR:"custom_behavior",DCP:"dcp"},e.FREQUENCY_FILTERS={MOST_FREQUENT:"most_frequent",LEAST_FREQUENT:"least_frequent"},e.RECENCY_FILTERS={MOST_RECENT:"most_recent",LEAST_RECENT:"least_recent"},e.getFieldKeyPathForSource=function(n,t){t=t||e.SOURCE_TYPES.BEHAVIOR;var i=[];return r.isString(n)?(i=[n],t!==e.SOURCE_TYPES.BEHAVIOR||r.includes(r.values(o.FIELDS),n)||(i=[o.FIELDS.OPTIONS,n])):i=n,i},e.buildFromSpecV0_1=function(n){if(!(n.action||n.filters&&0!==n.filters.length))throw new Error('Audience spec must have an "action" field or at least one "filter" '+a.stringify(n));var t=e.fieldComparison("gt",o.FIELDS.TIME,0),i=[],s=[];if(n.action&&(s.push(e.fieldComparison("eq",o.FIELDS.NAME,n.action.value)),n.action.type&&s.push(e.fieldComparison("eq",o.FIELDS.TYPE,n.action.type))),n.time)if("last_days"===n.time.type)s.push(e.relativeTimeComparison("lte",n.time.days));else if("range"===n.time.type){var c=e.rangeTimeComparison([n.time.start,n.time.stop]);c&&s.push(c)}else u.error("Rule builder",'Audience spec has bad "time" type',n.time.type);if(t={op:"and",args:s},n.count&&i.push({where:e.fieldComparison(n.count.comparator,"0",n.count.value),from:{select:[{field:e.aggregateField("count")}],where:t,aggregate:[e.aggregate("count")]}}),n.filters&&r.each(n.filters,(function(r){var a,u,c=e.getFieldKeyPathForSource(r.name,n.source);if(r.modifier===e.FREQUENCY_FILTERS.MOST_FREQUENT?(a=e.aggregate("count"),u=e.aggregateField("count")):r.modifier===e.RECENCY_FILTERS.MOST_RECENT&&(a=e.aggregate("max",o.FIELDS.TIME),u=e.aggregateField("max",o.FIELDS.TIME)),a){var f=c,l=e.groupField(f);i.push({where:e.fieldComparison(r.comparator,"0",r.value),from:{select:[{field:l}],where:t,groupBy:e.groupBy([f]),aggregate:[a],orderBy:[{field:u,direction:"DESC"}],limit:1}})}else s.push(e.fieldComparison(r.comparator,c,r.value))})),n.pick){if(i.length>0)throw new Error('A "pick" clause must not be specified with "count" or "most_recent", "most_frequent" modifiers'+a.stringify(n));return[l(n.pick,t,n.source)]}return i.length>0?i:[{where:t}]},e.buildFromSpecV0_2=function(n){!function(n){var t=[];if(r.isUndefined(n))throw new Error("rule is undefined");if(!r.isObject(n))throw new Error("rule is not an Object");"0.2"!==n.version&&t.push('version: not "0.2"'),n.filter&&(r.isArray(n.filter)?r.each(n.filter,(function(n,i){var r=e.validateFieldKeyPathV0_2(n.field,e.FieldPurpose.FILTER);r&&t.push("filter["+i+"]: "+r);var o=e.validateComparatorAndValue(n.comparator,n.value);o&&t.push("filter["+i+"]: "+o)})):t.push("filter: not an array"));var i=[],o=[];n.sort&&(n.reduce&&n.reduce.aggregator&&"nth"!==n.reduce.aggregator&&t.push("sort: superfluous because we can apply aggregator "+a.stringify(n.reduce.aggregator)+" to unsorted items"),r.isArray(n.sort)?r.each(n.sort,(function(n,u){var s=e.validateFieldKeyPathV0_2(n.field,e.FieldPurpose.SORT);s&&t.push("sort["+u+"]: "+s),n.field&&"frequency"===n.field[0]?i.push(n):o.push(n);var c=function(n){var t="direction "+(a.stringify(n)||String(n));if(!r.includes(["ascending","descending"],n))return t+' is not "ascending" or "descending"'}(n.direction);c&&t.push("sort["+u+"]: "+c)})):t.push("sort: not an array"),i.length&&o.length&&t.push('sort: sorting by non-["frequency"] field is pointless because we are going to sort the picked values by ["frequency"]'),i.length&&!n.pick&&t.push('sort: sorting by ["frequency"] is impossible because no values have been picked'));if(n.pick){n.reduce&&"count"===n.reduce.aggregator&&t.push('pick: superfluous because we can apply aggregator "count" to raw events');var u=e.validateFieldKeyPathV0_2(n.pick.field);u&&t.push("pick: "+u)}if(n.reduce){var s=n.reduce.aggregator,c="aggregator "+(a.stringify(s)||String(s)),f=n.reduce.n,l="index "+(a.stringify(f)||String(f));r.includes(["sum","avg","max","min","count","nth"],s)||t.push("reduce: "+c+" is unknown"),r.includes(["sum","avg","max","min"],s)&&(n.pick||t.push("reduce: "+c+" is impossible to use because no values have been picked")),"nth"===s?((!r.isNumber(f)||isNaN(f)||parseInt(f,10)!==f||f<0)&&t.push("reduce: "+l+" is not a non-negative integer (mandated by "+c+")"),n.sort||t.push('reduce: aggregator "nth" is meaningless without a specific sort order')):r.isUndefined(f)||t.push("reduce: "+l+" is defined (not mandated by "+c+")")}if(t.length)throw new Error(t.join("\n"))}(n);var t={where:{op:"and",args:r.map(n.filter||[],(function(n){return"age"===n.field[0]?e.relativeTimeComparison(n.comparator||"eq",n.value/e.MILLIS_IN_A_DAY):e.fieldComparison(n.comparator||"eq",e.convertFieldKeyPathFromSpecV0_2(n.field),n.value)}))}};if(n.reduce&&"count"===n.reduce.aggregator)return r.extend(t,{aggregate:[{op:"count",args:[{field:["*"]}]}],select:[{field:["_count_*"]}]});var i=[],o=[];if(n.sort&&(r.each(n.sort,(function(n){r.includes(["ascending","descending"],n.direction)&&(r.includes(["time","age"],n.field[0])&&o.push(n),"frequency"===n.field[0]&&i.push(n))})),o.length&&!i.length&&(t.orderBy=r.filter(r.map(o,(function(n){return"time"===n.field[0]?{field:e.convertFieldKeyPathFromSpecV0_2(["time"]),direction:"ascending"===n.direction?"ASC":"DESC"}:"age"===n.field[0]?{field:e.convertFieldKeyPathFromSpecV0_2(["time"]),direction:"ascending"===n.direction?"DESC":"ASC"}:void 0}))))),n.pick&&n.pick.field){var u=e.convertFieldKeyPathFromSpecV0_2(n.pick.field);if(n.reduce&&r.includes(["avg","max","min","sum"],n.reduce.aggregator))return r.extend(t,{aggregate:[{op:n.reduce.aggregator,args:[{field:u}]}],select:[{field:[s.generateAlias(n.reduce.aggregator,u)]}]});t=i.length?r.extend(t,{groupBy:[{field:u}],aggregate:[{op:"count",args:[{field:["*"]}]}],orderBy:[{field:["_count_*"],direction:"ascending"===i[0].direction?"ASC":"DESC"}],select:[{field:[u.join(".")]}]}):r.extend(t,{select:[{field:u}]})}if(n.reduce&&"nth"===n.reduce.aggregator){var c=n.reduce.n;if(r.isNumber(c)&&c>=0&&Number(c)===Math.floor(Number(c)))return r.extend(t,{offset:c,limit:1})}return t},e.convertFieldKeyPathFromSpecV0_2=function(n){return"tags"===n[0]&&"revenue"===n[1]?["r"]:[o.FIELDS_V0_2[n[0]]].concat(n.slice(1))},e.FieldPurpose={FILTER:"filter",SORT:"sort",PICK:"pick"},e.validateFieldKeyPathV0_2=function(n,t){var i="field "+(a.stringify(n)||String(n));if(!r.isArray(n)||!r.every(n,r.isString))return i+" is not an array of strings";if("tags"===n[0]&&n.length>2||"tags"!==n[0]&&n.length>1)return i+" includes too many strings";if("tags"===n[0]&&n.length<2)return i+" does not specify an exact tag";if(n.length<1)return i+" does not specify a top-level field";var u=r.keys(o.FIELDS_V0_2),s=["age","frequency"];return t===e.FieldPurpose.FILTER&&(u.push("age"),s=["frequency"]),t===e.FieldPurpose.SORT&&(u=["time","age","frequency"],s=["name","type","category","tags"]),r.includes(s,n[0])?i+" is not supported here":r.includes(u,n[0])?void 0:i+" is unknown"},e.validateComparatorAndValue=function(n,t){var i="comparator "+(a.stringify(n)||String(n)),e="value "+(a.stringify(t)||String(t));if(!r.isString(n)&&!r.isUndefined(n))return i+" is not a string";switch(n){case void 0:case"eq":case"is":case"contains":break;case"lt":case"gt":case"lte":case"gte":if(!r.isNumber(t))return e+" is not a number (mandated by "+i+")";break;case"in":if(!r.isArray(t))return e+" is not an array (mandated by "+i+")";break;case"between":if(!(r.isArray(t)&&2===t.length&&r.isNumber(t[0])&&r.isNumber(t[1])&&t[0]<=t[1]))return e+" is not a pair of increasing numbers (mandated by "+i+")";break;case"regex":if(!(r.isString(t)||r.isArray(t)&&2===t.length&&r.isString(t[0])&&r.isString(t[1])))return e+" is not a pattern string or a [pattern string, flags string] array (mandated by "+i+")";break;case"exists":if(!r.isUndefined(t))return e+" is not undefined (mandated by "+i+")";break;default:return i+" is unknown"}}},9666:function(n,t,i){var e=i(3232),r=i(2425),o=i(3308),a=e.bind(o.log,o),u=i(1217),s=i(5210).getFieldValue,c=i(6898),f=function(n,t,i){if(n.getValueOrDefault)return n.getValueOrDefault(t,i);if(!e.isArray(t))return i;var r=s(n,t);return void 0===r&&(r=i),r},l=function(n){return"string"==typeof n?n.trim().toLowerCase():n};t.clause={WHERE:"where",GROUP_BY:"groupBy",AGGREGATE:"aggregate",HAVING:"having",ORDER_BY:"orderBy",SELECT:"select",OFFSET:"offset",LIMIT:"limit",FROM:"from"},t.DEFAULT_FIELD=["*"],t.booleanOperators={eq:function(n){var t=e.map(n,l);return t[0]==t[1]},is:function(n){return n[0]===n[1]},gt:function(n){return n[0]>n[1]},lt:function(n){return n[0]<n[1]},gte:function(n){return n[0]>=n[1]},lte:function(n){return n[0]<=n[1]},"in":function(n){var t=e.map(n[1]||[],l);return e.includes(t,l(n[0]))},between:function(n){return n[1][0]<=n[0]&&n[0]<=n[1][1]},contains:function(n){var t=e.map(n,(function(n){return"string"==typeof n?n.toLowerCase():n}));return-1!==(t[0]||"").indexOf(t[1])},regex:function(n){try{var t,i;return e.isString(n[1])?(t=n[1],i="i"):(t=n[1][0]||"",i=n[1][1]||""),new RegExp(t,i).test(n[0])}catch(r){return o.error("Rules",'In operator "regex", error: '+(r.message||"invalid RegExp /"+[t,i].join("/"))),!1}},exists:function(n){return void 0!==n[0]},and:function(n){return e.every(n,(function(n){return n}))},or:function(n){return e.some(n,(function(n){return n}))},not:function(n){return!n[0]}},t.arithmeticOperators={"+":function(n){return(n[0]||0)+(n[1]||0)},"-":function(n){return(n[0]||0)-(n[1]||0)},"/":function(n){return(n[0]||0)/(n[1]||1)},"%":function(n){return(n[0]||0)%(n[1]||1)}},t.aggregateOperators={sum:function(n,i){for(var e=n[0]||t.DEFAULT_FIELD,r=0,o=0;o<i.length;o++)r+=f(i[o],e,0);return r},avg:function(n,i){if(0===i.length)return 0;for(var e=n[0]||t.DEFAULT_FIELD,r=0,o=0;o<i.length;o++)r+=f(i[o],e,0);return r/i.length},max:function(n,i){for(var e=n[0]||t.DEFAULT_FIELD,r=Number.NEGATIVE_INFINITY,o=0;o<i.length;o++)r=Math.max(r,f(i[o],e,Number.NEGATIVE_INFINITY));return r},min:function(n,i){for(var e=n[0]||t.DEFAULT_FIELD,r=Number.POSITIVE_INFINITY,o=0;o<i.length;o++)r=Math.min(r,f(i[o],e,Number.POSITIVE_INFINITY));return r},count:function(n,t){return t.length}};var d={now:function(){return u.now()}},h=function(n,i){if(i.hasOwnProperty("value"))return i.value;if(i.hasOwnProperty("field"))return f(n,i.field);if(i.hasOwnProperty("eval"))return i.eval in d?d[i.eval]():void o.error("Rules","Unknown function: "+i.eval);if(i.op){var r,a=(r=i.op)in t.booleanOperators?t.booleanOperators[r]:r in t.arithmeticOperators?t.arithmeticOperators[r]:null;if(a){var u=e.partial(h,n),s=i.args||[];return a(e.map(s,(function(n){return u(n)})),n)}o.error("Rules","Unknown operator: "+i.op)}else o.error("Rules","No operator specified: "+c.stringify(i))};t.generateAlias=function(n,t){return"_"+n+"_"+t.join(".")};t.rewrite=function(n){var i=[],r={};function a(n,u){if(e.isArray(n)&&("and"!==n[0]&&"or"!==n[0]&&"not"!==n[0]&&o.error("Rules","Unexpected operation "+n[0]+". Continuing optimistically."),n={op:n[0],args:n.slice(1)}),n.hasOwnProperty("field")||n.hasOwnProperty("value")||n.hasOwnProperty("eval"))return n;if(u&&n.op in t.aggregateOperators){var s=(n.args&&n.args[0]||{}).field||t.DEFAULT_FIELD,c=t.generateAlias(n.op,s);return c in r||(i.push({op:n.op,args:n.args}),r[c]=!0),{field:[c]}}for(var f=[],l=n.args||[],d=0;d<l.length;d++)f[d]=a(l[d],u);return{op:n.op,args:f}}var u={};n.hasOwnProperty(t.clause.WHERE)&&(u[t.clause.WHERE]=a(n[t.clause.WHERE],!1)),n.hasOwnProperty(t.clause.HAVING)&&(u[t.clause.HAVING]=a(n[t.clause.HAVING],!0)),(n.hasOwnProperty(t.clause.AGGREGATE)||i.length>0)&&(u[t.clause.AGGREGATE]=(n[t.clause.AGGREGATE]||[]).concat(i));for(var s=[t.clause.GROUP_BY,t.clause.ORDER_BY,t.clause.SELECT,t.clause.OFFSET,t.clause.LIMIT],c=0;c<s.length;c++)n.hasOwnProperty(s[c])&&(u[s[c]]=n[s[c]]);return n.hasOwnProperty(t.clause.FROM)&&(u[t.clause.FROM]=t.rewrite(n[t.clause.FROM])),u};var v=function(n,i){i=i||0;var r=[];if(n.hasOwnProperty(t.clause.WHERE)?n[t.clause.WHERE].op?n[t.clause.WHERE].op in t.booleanOperators||r.push("Non-boolean WHERE clause operator"):r.push("Missing WHERE clause operator"):r.push("Missing WHERE clause"),!n.hasOwnProperty(t.clause.HAVING)||(n[t.clause.HAVING].op?n[t.clause.HAVING].op in t.booleanOperators||r.push("Non-boolean HAVING clause operator"):r.push("Missing HAVING clause operator")),n.hasOwnProperty(t.clause.GROUP_BY)&&!n.hasOwnProperty(t.clause.AGGREGATE)&&r.push("No AGGREGATE clause specified with GROUP_BY clause"),n.hasOwnProperty(t.clause.SELECT)){var o=n[t.clause.SELECT];if(e.isArray(o))for(var a=0;a<o.length;a++)o[a].op&&o[a].op in t.aggregateOperators&&r.push('In SELECT clause, aggregate operator "'+o[a].op+'" specified in selector at index '+a);else r.push("SELECT clause must be an array")}if(n.hasOwnProperty(t.clause.OFFSET)){var u=n[t.clause.OFFSET];(!e.isNumber(u)||Number(u)<0||Number(u)!==Math.floor(Number(u)))&&r.push("OFFSET must be a non-negative integer")}if(n.hasOwnProperty(t.clause.LIMIT)){var s=n[t.clause.LIMIT];(!e.isNumber(s)||Number(s)<0||Number(s)!==Math.floor(Number(s)))&&r.push("LIMIT must be a non-negative integer")}return i>0&&(r=e.map(r,(function(n){return"Sub-rule "+i+": "+n}))),n.hasOwnProperty(t.clause.FROM)&&(r=r.concat(v(n[t.clause.FROM],i+1))),r},p=function(n,i){var r,u,s,l=i;if(n.hasOwnProperty(t.clause.FROM)&&(o.debug("Evaluating FROM clause:",n[t.clause.FROM]),l=p(n[t.clause.FROM],l),o.debug("Results after FROM:",l)),o.debug("Evaluating WHERE clause:",n[t.clause.WHERE]),l=e.filter(l,(function(i){return h(i,n[t.clause.WHERE])})),o.debug("Results after WHERE:",l),n.hasOwnProperty(t.clause.AGGREGATE)){o.debug("Evaluating AGGREGATE clause:",n[t.clause.AGGREGATE]);var d=function(n,t){var i={};if(void 0===n||!e.isArray(n)||0===n.length)return i["*"]={fieldValues:{},events:t},i;for(var r=e.map(n,(function(n){return n.field})),o=0;o<t.length;o++){for(var a=t[o],u=[],s={},l=0;l<r.length;l++){var d=r[l],h=f(a,d),v=d.join(".");s[v]=h,u.push(encodeURIComponent(v)+"="+encodeURIComponent(c.stringify(h)))}var p=u.join("&");i.hasOwnProperty(p)||(i[p]={fieldValues:s,events:[]}),i[p].events.push(a)}return i}(n[t.clause.GROUP_BY],l);l=function(n,t){var i=[];return e.each(n,(function(n,r){var o=e.extend({},n.fieldValues),a=t[r]||{};e.extend(o,a),i.push(o)})),i}(d,(r=n[t.clause.AGGREGATE],u=d,s={},e.each(u,(function(n,i){s[i]={};for(var e=0;e<r.length;e++){var a=r[e],u=a.op;if(u in t.aggregateOperators){var c=(a.args&&a.args[0]||{}).field||t.DEFAULT_FIELD,f=t.generateAlias(u,c),l=t.aggregateOperators[u]([c],n.events);s[i][f]=l}else o.error("Rules","Unknown aggregate operator "+u)}})),s)),o.debug("Results after AGGREGATE:",l)}n.hasOwnProperty(t.clause.HAVING)&&(o.debug("Evaluating HAVING clause:",n[t.clause.HAVING]),l=e.filter(l,(function(i){return h(i,n[t.clause.HAVING])})),o.debug("Results after HAVING:",l)),n.hasOwnProperty(t.clause.ORDER_BY)&&(o.debug("Evaluating ORDER_BY clause:",n[t.clause.ORDER_BY]),l=function(n,t){return e.isArray(n)?0===n.length?t:t.sort((function(t,i){for(var e=0;e<n.length;e++){var r=n[e],o="ASC"===(r.direction||"ASC")?1:-1,a=r.field,u=f(t,a,0),s=f(i,a,0);if(u<s)return-o;if(u>s)return o}return 0})):(a("Rules","groupBy rule must be an array"),t)}(n[t.clause.ORDER_BY],l),o.debug("Results after ORDER_BY:",l));var v,g=0;return n.hasOwnProperty(t.clause.OFFSET)&&(o.debug("Evaluating OFFSET clause:",n[t.clause.OFFSET]),g=Number(n[t.clause.OFFSET])),n.hasOwnProperty(t.clause.LIMIT)&&(o.debug("Evaluating LIMIT clause:",n[t.clause.LIMIT]),v=g+Number(n[t.clause.LIMIT])),(g>0||!e.isUndefined(v))&&(l=l.slice(g,v),o.debug("Results after OFFSET/LIMIT:",l)),n.hasOwnProperty(t.clause.SELECT)&&(o.debug("Evaluating SELECT clause:",n[t.clause.SELECT]),l=function(n,t){return e.map(t,(function(t){return e.map(n,(function(n){return h(t,n)}))}))}(n[t.clause.SELECT],l),o.debug("Results after SELECT:",l)),l};t.execute=function(n,i){n=t.rewrite(n),o.shouldLog(r.LogLevel.DEBUG)&&o.groupCollapsed("Evaluating Behavioral Rule"),o.debug("Rule:",n,c.stringify(n)),o.debug("Events:",i);var e=v(n);if(e.length>0)throw new Error("Rule "+c.stringify(n)+" has violations: "+e.join("\n"));var a=p(n,i);return o.debug("Rule result:",a),o.shouldLog(r.LogLevel.DEBUG)&&o.groupEnd(),a},t.isSatisfied=function(n,i){try{return t.execute(n,i).length>0}catch(e){return o.error("Rules","Error "+e.toString()+" while evaluating rule "+c.stringify(n)),!1}}},6934:function(n,t,i){n.exports=function(n){n.registerDependency("sources/browser_id",i(8589)),n.registerVisitorProfileProvider(i(7425)),n.registerVisitorProfileProvider(i(2723)),n.registerAudienceMatcher("browser_version",i(7107))}},7107:function(n,t,i){var e=i(4855).y;n.exports={fieldsNeeded:["browserVersion","browserId"],match:function(n,t){var i=t.value,r=n.browserId,o=n.browserVersion;if(0===i.indexOf(r)){var a=i.substr(r.length);return 0===e(o,a)}return!1}}},7425:function(n){n.exports={provides:"browserId",shouldTrack:!0,isSticky:!0,getter:["sources/browser_id",function(n){return n.getId()}]}},2723:function(n){n.exports={provides:"browserVersion",getter:["sources/browser_id",function(n){return n.getVersion()}]}},8589:function(n,t,i){var e=i(5412);t.getId=function(){return e.get().browser.id},t.getVersion=function(){return e.get().browser.version}},302:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(4739)),n.registerAudienceMatcher("campaign",i(7875))}},7875:function(n,t,i){var e=i(894);n.exports={fieldsNeeded:["campaign"],match:function(n,t){return e.hasMatch(t.value,t.match,n.campaign)}}},4739:function(n,t,i){var e=i(2052);n.exports={provides:"campaign",shouldTrack:!0,isSticky:!0,getter:[function(){return e.getQueryParamValue("utm_campaign")}]}},1551:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(6877));var t=i(3426);n.registerAudienceMatcher("custom_attribute",t),n.registerAudienceMatcher("custom_dimension",t)}},3426:function(n,t,i){var e=i(3232),r=i(894);t.match=function(n,t){var i;return n.custom&&(i=n.custom[t.name]),e.isObject(i)&&(i=i.value),r.hasMatch(t.value,t.match,i)}},6877:function(n,t,i){var e=i(3232),r=i(2425),o=i(3308),a=i(9350).get("stores/dimension_data");n.exports={provides:"custom",attributionType:r.AttributionTypes.LAST_TOUCH,restorer:function(n){return e.reduce(n,(function(n,t,i){var r=i,u=a.getByApiName(i),s=a.getById(i);return e.isObject(t)?(!t.id&&u&&(s=u,r=u.id,e.extend(t,{id:s.segmentId||s.id})),!t.name&&s&&s.apiName&&(t.name=s.apiName),t.id||s||o.warn("Unable to determine ID for custom attribute:",i,"; segmentation is disabled."),n[r]=t,n):(o.error('Unable to restore custom attribute "'+i+'" because value is not an object'),n)}),{})},shouldTrack:!0}},3848:function(n,t,i){n.exports=function(n){n.registerDependency("sources/device",i(1884)),n.registerVisitorProfileProvider(i(1194)),n.registerAudienceMatcher("device",i(6484))}},6484:function(n){n.exports={fieldsNeeded:["device"],match:function(n,t){return n.device===t.value}}},1194:function(n){n.exports={provides:"device",shouldTrack:!0,isSticky:!0,getter:["sources/device",function(n){return n.getDevice()}]}},1884:function(n,t,i){var e=i(5412);t.getDevice=function(){var n=e.get().device;return"unknown"!==n.model?n.model:"tablet"===n.type?"tablet":n.isMobile?"mobile":"desktop"}},58:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(6738)),n.registerAudienceMatcher("device_type",i(4))}},4:function(n){n.exports={fieldsNeeded:["device_type"],match:function(n,t){return n.device_type===t.value}}},6738:function(n,t,i){var e=i(5412);n.exports={provides:"device_type",shouldTrack:!0,isSticky:!0,getter:[function(){var n=e.get().device;switch(n.type){case"mobile":return"phone";case"tablet":case"desktop_laptop":return n.type;default:return"other"}}]}},1105:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(3042)),n.registerAudienceMatcher("referrer",i(2915))}},2915:function(n,t,i){var e=i(2554);t.fieldsNeeded=["referrer"],t.match=function(n,t){return null!==n.referrer&&e(n.referrer,t)}},3042:function(n,t,i){var e=i(1596),r=i(6371);n.exports={provides:"referrer",shouldTrack:!0,isSticky:!0,getter:[function(){var n=r.getReferrer()||e.getReferrer();return""===n&&(n=null),n}]}},4355:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(3290)),n.registerAudienceMatcher("source_type",i(4595))}},4595:function(n,t,i){var e=i(894);t.fieldsNeeded=["source_type"],t.match=function(n,t){return e.hasMatch(t.value,t.match,n.source_type)}},3290:function(n,t,i){var e=i(2052),r=i(1596),o=i(6371),a=i(9455),u=["google\\.\\w{2,3}(\\.\\w{2,3})?/(search|url)","bing\\.\\w{2,3}(\\.\\w{2,3})?/(search|url)","yahoo\\.\\w{2,3}(\\.\\w{2,3})?/search","baidu\\.\\w{2,3}(\\.\\w{2,3})?/","https://(www)?\\.google\\..*?/?$","https://search\\.yahoo\\..*?/?$","https://(www)?\\.bing\\..*?/?$"];n.exports={provides:"source_type",shouldTrack:!0,isSticky:!1,getter:[function(){return function(n,t){var i,s=n(),c=function(){if(e.getQueryParamValue("utm_source")||e.getQueryParamValue("gclid")||e.getQueryParamValue("otm_source"))return"campaign";for(var n=o.getReferrer()||r.getReferrer(),t=0;t<u.length;t++){var i=u[t];if(n.match(i))return"search"}return n&&a.guessDomain(n)!==a.guessDomain(e.getUrl())?"referral":"direct"}();i=c,(!s||"direct"!==i)&&t(c)}}]}},3469:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(4710)),n.registerVisitorProfileProvider(i(1716)),n.registerAudienceMatcher("time_and_day",i(4201))}},4201:function(n,t,i){var e=i(3915);t.fieldsNeeded=["currentTimestamp"],t.match=function(n,t){return e.test(t.value,new Date(n.currentTimestamp))}},4710:function(n,t,i){var e=i(1217);n.exports={provides:"currentTimestamp",shouldTrack:!0,isLazy:!0,getter:[function(){return e.now()}]}},1716:function(n){n.exports={provides:"offset",shouldTrack:!0,isLazy:!0,getter:[function(){return(new Date).getTimezoneOffset()}]}},3915:function(n,t,i){var e=i(3232);function r(n){var t=n.split(":");if(2!==t.length)throw new Error("optly.timeAndDayInterval.timeStringToMinutes: Invalid time string "+n);return 60*parseInt(t[0],10)+parseInt(t[1],10)}t.test=function(n,t){var i=function(n){var t=n.split("_");if(3!==t.length)throw new Error("Invalid time and day string "+n);var i=t[2].split(",");return{start_time:t[0],end_time:t[1],days:i}}(n),o=r(i.start_time),a=r(i.end_time),u=60*t.getHours()+t.getMinutes(),s=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][t.getDay()];return u>=o&&u<=a&&e.includes(i.days,s)}},9285:function(n,t,i){n.exports=function(n){n.registerVisitorProfileProvider(i(977))}},977:function(n){n.exports={provides:"visitorId",getter:["stores/visitor_id",function(n){return n.getRandomId()}]}},1096:function(n,t,i){var e=i(3232),r=i(9350),o=i(5562),a=i(4630),u=i(3308),s=i(5969),c=i(7082),f=r.get("stores/layer_data"),l=i(6349),d="ClicktaleIntegrationExperienceHandler";function h(n,t){var i=f.get(t.data.decision.layerId),r=i.integrationSettings;if(r&&!e.isUndefined(r.clicktale)){var o=function(n,t){var i=e.find(t.experiments,{id:n.experimentId});if(!i)return;var r=e.find(i.variations,{id:n.variationId});if(!r)return;return l.generateAnalyticsString(t,i,r,n.isLayerHoldback,255,!0)}(t.data.decision,i);o&&(n.push(o),u.log("Pushing action.applied event to Clicktale queue. Data:",t))}}function v(n){c.getGlobal(d)(n,"Optimizely")}n.exports=function(){var n=[],t={queue:n,push:e.bind(n.push,n)};o.on({filter:{type:a.TYPES.ACTION,name:"appliedAllForDecision"},handler:e.partial(h,t)}),function(n){var t=50,i=200;s.pollFor((function(){return n=c.getGlobal(d),e.isFunction(n);var n}),i,t).then((function(){e.each(n.queue,v),n.push=v}))}(t)}},4949:function(n,t,i){var e=i(3232),r=i(1826),o=i(5662),a=i(9653),u=i(8235).U,s=i(6898),c=i(3308),f=i(6822),l=i(7324),d=i(7082),h=i(4755),v=i(9350),p=(i(1596),i(5562)),g=i(4630),m=i(9358),_=v.get("stores/global"),w=v.get("stores/tracker_optimizely"),y=t.Error=u("OptimizelyTrackerError"),E="client_activation",b="campaign_activated",I="view_activated",A={revenue:{validate:O,sanitize:Math.floor,excludeFeature:!0},quantity:{validate:O,sanitize:Math.floor,excludeFeature:!0},value:{validate:O,sanitize:e.identity}},T="AUTO",S=[function(){return function(n){P(function(n){return e.extend({entity_id:n.pageId,key:n.pageApiName,timestamp:n.timestamp,uuid:n.eventId,type:I},D(n.eventTags))}(n),n.userFeatures,K(n.layerStates))}}],R=[function(){return function(n){!function(n){var t=e.isNull(_.getAnonymizeIP())?void 0:_.getAnonymizeIP(),i={account_id:n.accountId,anonymize_ip:t,client_name:n.clientName,client_version:n.clientVersion,project_id:n.projectId,visitors:[]};i.revision=n.revision,i.enrich_decisions=!0;var r={session_id:L(n.sessionId),visitor_id:n.visitorId,attributes:[],snapshots:[]},o=K(n.layerStates);m.dispatch(a.REGISTER_TRACKER_VISITOR,{data:i,visitor:r,decisions:o}),Y()}(n),P(function(n){return{entity_id:null,type:E,uuid:n.eventId,timestamp:n.timestamp}}(n),n.userFeatures,K(n.layerStates))}}],k=[function(){return function(n){var t;P((t=n,e.extend({entity_id:t.eventEntityId,key:t.eventApiName,timestamp:t.timestamp,uuid:t.eventId,type:t.eventCategory},D(t.eventTags))),n.userFeatures,K(n.layerStates))}}],N=[function(){return function(n){var t;P((t=n,e.extend({entity_id:t.eventEntityId,key:t.eventApiName,timestamp:t.timestamp,uuid:t.eventId,type:t.eventCategory},D(t.eventTags))),n.userFeatures,K(n.layerStates))}}];function D(n){var t=function(n,t,i){try{C(t),n[i]=t}catch(e){r.emitError(new y("Bad value for eventTags["+i+"]: "+e.message))}return n},i=e.keys(A),o=e.omit(n,i),a=e.pick(n,i),u=e.reduce(o,t,{}),s=e.reduce(a,(function(n,i,e){var o=A[e];o.excludeFeature||t(u,i,e);try{o.validate(i),n[e]=o.sanitize(i),u[e]=n[e]}catch(a){r.emitError(new y("Bad value for eventMetrics["+e+"]: "+a.message))}return n}),{});return s.tags=u,s}function C(n){if(null==n)throw new Error("Feature value is null");if("object"==typeof n){var t;try{t=s.stringify(n)}catch(i){}throw new Error('Feature value is complex: "'+t)}}function O(n){if(null==n)throw new Error("Metric value is null");if(!e.isNumber(n))throw new Error("Metric value is not numeric")}function x(n){return e.reduce(n,(function(n,t){try{C(t.value),n.push({entity_id:t.id||null,key:t.name,type:t.type,value:t.value})}catch(i){c.warn("Error evaluating user feature",t,i)}return n}),[])}function P(n,t,i){m.dispatch(a.REGISTER_TRACKER_EVENT,{event:n,decisions:i}),M(t),Y()}function M(n){var t=x(n);m.dispatch(a.UPDATE_TRACKER_VISITOR_ATTRIBUTES,{attributes:t})}function L(n){return T}function V(){if(w.canSend()){var n=w.hasEventsToSend(),t=w.hasPreviousBatchesToSend();n||t?(t&&(e.each(w.getPreviousBatches(),F),m.dispatch(a.RESET_TRACKER_PREVIOUS_BATCHES)),n&&(m.dispatch(a.FINALIZE_BATCH_SNAPSHOT),F(w.getEventBatch()),m.dispatch(a.RESET_TRACKER_EVENTS))):c.debug("Not sending events because there are no events to send")}else c.debug("Not sending events (holding)")}function F(n){c.debug("Sending ticket:",n);var t=o.generate();h.retryableRequest({url:"https://logx.optimizely.com/v1/events",method:"POST",data:U(n)},t)}function U(n){return e.extend({},e.pick(n,["account_id","anonymize_ip","client_name","client_version","enrich_decisions","project_id","revision"]),{visitors:e.map(n.visitors,z)})}function z(n){return{visitor_id:n.visitor_id,session_id:T,attributes:e.map(n.attributes,B),snapshots:e.map(n.snapshots,G)}}function B(n){return H(n,{entity_id:"e",key:"k",type:"t",value:"v"})}function G(n){var t=n.events;return t=function(n){var t=e.reduce(n,(function(n,t){var i;if(n[i=t.type===I&&e.isEmpty(t.tags)&&e.isEmpty(e.pick(t,e.keys(A)))?t.type:t.uuid]){var r=n[i].timestamp;t.timestamp>r&&(r=t.timestamp),n[i]=e.extend({},n[i],{key:n[i].key+"-"+(t.key||""),entity_id:n[i].entity_id+"-"+t.entity_id,timestamp:r})}else n[i]=t;return n}),{});return e.values(t)}(t),{activationTimestamp:_.getActivationTimestamp(),decisions:e.map(n.decisions,j),events:e.map(t,q)}}function j(n){return H(n,{campaign_id:"c",experiment_id:"x",is_campaign_holdback:"h",variation_id:"v"})}function q(n){return n.key===b&&(n.type=b,delete n.key),H(n,{entity_id:"e",key:"k",quantity:"q",revenue:"$",tags:"a",timestamp:"t",uuid:"u",value:"v",type:"y"})}function H(n,t){return e.reduce(n,(function(n,i,e){return e in t&&(n[t[e]||e]=i),n}),{})}function Y(){if(w.shouldBatch()){if(!w.isPolling()){d.setTimeout((function n(){V(),w.isPolling()&&d.setTimeout(n,1e3)}),1e3),m.dispatch(a.SET_TRACKER_POLLING,!0),d.setTimeout((function(){m.dispatch(a.SET_TRACKER_BATCHING,!1),m.dispatch(a.SET_TRACKER_POLLING,!1)}),1e4)}}else V()}function K(n){return e.map(n,(function(n){return{campaign_id:n.layerId,experiment_id:n.decision.experimentId,variation_id:n.decision.variationId,is_campaign_holdback:n.decision.isLayerHoldback}}))}function $(){var n=w.getPersistableState();if(n)try{c.debug("Persisting pending batch:",n),l.persistTrackerOptimizelyData(n),m.dispatch(a.SET_TRACKER_DIRTY,!1)}catch(t){c.debug("Failed to persist pending batch:",t)}}var W={trackLayerDecision:function(n){n.timing===f.TrackLayerDecisionTimingFlags.postRedirectPolicy?function(n){var t=x(n.userFeatures),i={account_id:n.accountId,anonymize_ip:n.anonymizeIP,client_name:n.clientName,client_version:n.clientVersion,project_id:n.projectId,visitors:[{session_id:L(n.sessionId),visitor_id:n.visitorId,attributes:t,snapshots:[{decisions:[{campaign_id:n.layerId,experiment_id:n.experimentId,variation_id:n.variationId,is_campaign_holdback:n.isLayerHoldback}],events:[{uuid:n.decisionId,entity_id:n.layerId,timestamp:n.timestamp,type:b}]}]}]};m.dispatch(a.REGISTER_PREVIOUS_BATCH,i),Y()}(n):function(n){var t={entity_id:n.layerId,type:b,uuid:n.decisionId,timestamp:n.timestamp};m.dispatch(a.REGISTER_TRACKER_DECISION,{decisionEvent:t,decisions:K(n.layerStates)}),M(n.userFeatures),Y()}(n)},postRedirectPolicy:f.PostRedirectPolicies.TRACK_AFTER_SYNC,nonRedirectPolicy:f.NonRedirectPolicies.TRACK_IMMEDIATELY,onPageActivated:S,onClientActivation:R,onClickEvent:N,onCustomEvent:k};n.exports=function(n){n.registerAnalyticsTracker("optimizely",W),p.on({filter:{type:g.TYPES.ANALYTICS,name:"sendEvents"},handler:function(){m.dispatch(a.SET_TRACKER_SEND_EVENTS,!0),w.isPolling()||V()}}),p.on({filter:{type:g.TYPES.ANALYTICS,name:"holdEvents"},handler:function(){m.dispatch(a.SET_TRACKER_SEND_EVENTS,!1)}}),m.dispatch(a.SET_TRACKER_SEND_EVENTS,!0);var t=p.on({filter:{type:"lifecycle",name:"activated"},handler:function(){w.observe($),p.off(t)}})}},6742:function(n,t,i){var e=i(3209),r={match:function(n,t){return e.apply(t.value)}};n.exports=function(n){n.registerViewMatcher("custom_code",r)}},4905:function(n){var t={match:function(n,t){return!!document.querySelector(t.value)}};n.exports=function(n){n.registerViewMatcher("element_present",t)}},9262:function(n,t,i){n.exports=function(n){n.registerViewProvider(i(6599)),n.registerViewMatcher("url",i(9451))}},9451:function(n,t,i){var e=i(2554);n.exports={fieldsNeeded:["url"],match:function(n,t){return e(n.url,t)}}},6599:function(n,t,i){var e=i(2052);n.exports={provides:"url",getter:[function(){return e.getUrl()}]}},8026:function(n,t,i){var e=i(1596),r=i(2425),o=i(5562),a=i(8818),u=i(4247),s={token:void 0,setUpObserver:function(){a.createDOMChangedObserver(),this.token=o.on({filter:{type:"viewTrigger",name:"DOMChanged"},handler:function(){u.getViewsAndActivate(r.ViewActivationTypes.DOMChanged)}})},turnOffObserver:function(){o.off(this.token)}};n.exports=function(n){e.isReady()?s.setUpObserver():e.addReadyHandler(s.setUpObserver),n.registerViewTrigger("DOMChanged",s)}},127:function(n,t,i){var e=i(3232),r=i(9350),o=i(5562),a=i(4630),u=i(7082),s=r.get("stores/directive"),c="optimizelyPreview",f=function(n){u.getGlobal(c).push(n)};t.initialize=function(n){s.isSlave()&&function(n){var t=!1;if(e.isArray(window.optimizely)&&e.each(window.optimizely,(function(i){e.isArray(i)&&"verifyPreviewProject"===i[0]&&String(i[1])===n&&(t=!0)})),!t)throw new Error("Preview projectId: "+n+" does not match expected")}(n),o.on({filter:{type:a.TYPES.ANALYTICS,name:"trackEvent"},handler:f}),o.on({filter:{type:a.TYPES.LIFECYCLE,name:"viewActivated"},handler:f}),o.on({filter:{type:a.TYPES.LIFECYCLE,name:"layerDecided"},handler:f}),o.on({filter:{type:"error"},publicOnly:!0,handler:f})},t.setupPreviewGlobal=function(){u.getGlobal(c)||u.setGlobal(c,[])},t.pushToPreviewGlobal=function(n){f(n)}},5715:function(n,t,i){var e=i(3232),r=i(5662),o=i(1115),a=i(7201),u=i(1217),s=i(1596),c=i(9358),f=i(7075).mM,l=i(3308),d=i(4593),h=i(4702).Promise,v=i(7324),p=i(7082),g=i(4755),m=i(9653),_=i(2425),w=i(9350),y=w.get("stores/async_request"),E=w.get("stores/client_metadata"),b=w.get("stores/global"),I=w.get("stores/rum"),A=w.get("stores/performance"),T=w.get("stores/xdomain"),S=w.get("stores/view_data"),R=i(9414),k="https://rum.optimizely.com/rum",N="1.0";function D(n){return e.isEmpty(n)?h.resolve():(t=function(){return g.request({url:k,method:"POST",data:n,withCredentials:!0}).then((function(n){return o.resolveRequest("RUM_FIRST_BEACON",n),n}))["catch"]((function(n){throw l.error("POST to client-rum failed:",n),o.rejectRequest("RUM_FIRST_BEACON",n),n}))},(i=y.getPromise("RUM_FIRST_BEACON"))?i.then(t):o.makeAsyncRequest("RUM_FIRST_BEACON",t));var t,i}function C(){try{return!s.querySelector("body")}catch(n){return null}}function O(){var n=p.getGlobal("performance"),t=n?n.timing:{},i=A.getMarks()||{},r=I.getApiData(),o=I.getDOMObservationData(),a=R.get("state").getActiveExperimentIds(),u=I.getFeaturesNeededData(),c=s.parseUri(I.getScriptSrc()),l=I.getRumData()||{},h=l.extras||{};e.assign(h,{apiCalls:r,DOMObservationData:o,paintTimings:P(),activeExperimentIds:a,numPages:S.getNumberOfPages(),snippet:{scheme:c.protocol.slice(0,-1),host:c.host,path:c.pathname},networkInfo:x(),experimental:b.getExperimental(),featuresNeeded:u,beacon:{cjsOnload:!0}});var g=p.getGlobal("Prototype");g&&!e.isUndefined(g.Version)&&(h.prototypeJS=g.Version);var m=!1;m=!0;var _=T.getFrames();_.length&&(h.xdFramesLoaded=_.length);var w={id:I.getRumId(),v:N,project:b.getSnippetId()||b.getProjectId(),navigationTimings:t,userTimings:i,xd:m,apis:e.keys(r),extras:h,sampleRate:l.sampleRate};(function(){var n=f.keys(),t=e.filter(e.map(n,(function(n){var t=v.getStorageKeyFromKey(n);return t?{key:n,isForeign:v.isForeignKey(n),category:t,size:n.length+f.getItem(n).length}:null}))),i=e.reduce(t,(function(n,t){var i=t.key,e=v.getIdFromKey(i);return e?((t.isForeign?n.foreign:n.local)[e]=!0,n):n}),{local:{},foreign:{}}),r=e.chain(t).filter({isForeign:!0}).reduce((function(n,t){return n[t.key.split("_")[0]]=!0,n}),{}).value(),o={local:0,foreign:0},a={local:{},foreign:{}};e.forEach(t,(function(n){var t=n.isForeign?"foreign":"local";o[t]+=n.size,a[t][n.category]||(a[t][n.category]=0),a[t][n.category]+=n.size}));var u={numKeys:f.allKeys().length,sizeKeys:f.allKeys().toString().length,sizeValues:f.allValues().toString().length,idCounts:{local:e.keys(i.local).length,foreign:e.keys(i.foreign).length},foreignOriginCount:e.keys(r).length,byteTotals:o,byteTotalsByCategory:a};return d.estimateStorage().then((function(n){return e.assign(u,{storageEstimate:n})}))})().then((function(n){D(e.assign(w,{lsMetrics:n}))}))}function x(){var n=p.getGlobal("navigator");if(n&&n.connection)return e.pick(n.connection,["downlink","rtt","effectiveType"])}function P(){var n=p.getGlobal("performance");if(n)try{var t=n.getEntriesByType("paint");if(e.isEmpty(t))return;return e.reduce(t,(function(n,t){return n[t.name]=Math.round(t.startTime),n}),{})}catch(i){return}}t.initialize=function(){var n,t=r.generate().replace(/-/g,"");n=Math.random()<.01;var i=function(){var n=s.getCurrentScript();if(n)return n.src}();c.dispatch(m.SET_RUM_DATA,{id:t,RumHost:k,inRumSample:n,src:i,data:{id:t,sync:C(),timebase:u.now(),sampleRate:.01,url:i,extras:{initialDOMState:s.getReadyState()}}})},t.queueBeacons=function(){return I.getSampleRum()?(function(){try{p.getGlobal("requestAnimationFrame")((function(){var n=I.getRumData().timebase;c.dispatch(m.SET_RUM_DATA,{data:{render:u.now()-(n||0)}})}))}catch(n){return}}(),s.isLoaded()?p.setTimeout(O,3e3):p.addEventListener("load",O),new h((function(n,t){p.setTimeout((function(){(function(){!function(){var n={id:I.getRumId(),v:N,account:b.getAccountId(),project:b.getSnippetId()||b.getProjectId(),snippet:b.getSnippetId(),revision:b.getRevision(),clientVersion:E.getClientVersion(),hasSlave:!1,wxhr:!0,extras:{}},t=v.getPersistedBehaviorEventCount(),i=a.getEventCount();n.numBehaviorEvents=i;var r=i-t;e.extend(n.extras,{behaviorEventCountDiff:r,behaviorEventCountDecreased:r<0}),e.assign(n,function(){var n=p.getGlobal("performance");if(!n)return;var t,i=I.getScriptSrc();try{if(i){l.debug("Using derived script src: ",i);var r=n.getEntriesByName(i);r.length>0&&(t=r[0])}if(!t){var o=/\/\/[^.]+\.optimizely\.(com|test)\/(js|api\/client)\/[\d]+\.js/gi;l.debug("Scanning resource timing entries with regex");var a=n.getEntriesByType("resource");t=e.find(a,(function(n){return o.test(n.name)}))}if(t)return e.mapValues(_.ResourceTimingAttributes,(function(n,i){var e=t[i];return"number"==typeof e?Math.round(1e3*(e||0))/1e3:"serverTiming"===i?e||[]:void 0}))}catch(u){return}}(),A.getDurationsFor(e.values(_.RUMPerformanceTimingAttributes))),c.dispatch(m.SET_RUM_DATA,{data:n})}();var n=I.getRumData(),t=A.getMarks()||{};return n.extras=n.extras||{},n.extras.beacon={cjsTimeout:!0},n.userTimings=t,D(n=e.pickBy(n,(function(n){return!e.isUndefined(n)})))})().then(n,t)}),3e3)}))["catch"]((function(n){l.warn("RUM / Error sending data:",n)}))):h.resolve()}},8206:function(){}},__webpack_module_cache__={};function __webpack_require__(n){var t=__webpack_module_cache__[n];if(t!==undefined)return t.exports;var i=__webpack_module_cache__[n]={id:n,loaded:!1,exports:{}};return __webpack_modules__[n].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),__webpack_require__.nmd=function(n){return n.paths=[],n.children||(n.children=[]),n};var __webpack_exports__={};!function(){try{!function(){var n=function(n){var t=[__webpack_require__(9285)];t.push(__webpack_require__(6746)),t.push(__webpack_require__(3395)),t.push(__webpack_require__(1643)),t.push(__webpack_require__(371)),t.push(__webpack_require__(6934)),t.push(__webpack_require__(302)),t.push(__webpack_require__(1551)),t.push(__webpack_require__(3848)),t.push(__webpack_require__(58)),t.push(__webpack_require__(1105)),t.push(__webpack_require__(4355)),t.push(__webpack_require__(3469)),t.push(__webpack_require__(1096)),t.push(__webpack_require__(4949)),t.push(__webpack_require__(9262)),t.push(__webpack_require__(6742)),t.push(__webpack_require__(4905)),t.push(__webpack_require__(8026)),t.push(__webpack_require__(8520)),t.push(__webpack_require__(4003)),t.push(__webpack_require__(3813)),t.push(__webpack_require__(5166)),t.push(__webpack_require__(9566)),t.push(__webpack_require__(795)),f.initializePlugins(t)};window.performance&&window.performance.mark&&window.performance.mark("optimizely:blockBegin"),__webpack_require__(5715).initialize();var t=__webpack_require__(5519),i=__webpack_require__(3308),e=__webpack_require__(9350);__webpack_require__(9432);var r=e.get("stores/directive");if(!__webpack_require__(4755).isCORSSupported())throw new Error("CORS is not supported on this browser, aborting.");var o,a=__webpack_require__(644),u=__webpack_require__(474),s=__webpack_require__(4452),c={"layers": [{"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["19255812295"], "experiments": [{"weightDistributions": null, "audienceName": "Everyone else", "name": "Onehelp expert - Routing", "bucketingStrategy": null, "variations": [{"id": "19166194647", "actions": [{"viewId": "19255812295", "changes": [{"dependencies": [], "type": "custom_code", "id": "9AE28867-5A6C-4314-8EB0-C93CF0225E70", "value": function($){/**
 * Experiment.
 * Name: 383: Provisioning Landing Page Tile (Expert)
 */

 var experimentId_383 = '21489150558';
 var pageName_383 = '8156242263_url_targeting_for_383_provisioning_landing_page_tile';
 var original_383 = '21470241059';
 var variation1_383 = '21477390822';
 
 var traffic_383 = [
  {
   expertOptiBucket: 2,
   variation: original_383
     
   },
   {
    expertOptiBucket: 1,
    variation: variation1_383
      
    },
    {
   expertOptiBucket: 0,
   variation: original_383
     
   },
   {
    expertOptiBucket: 3,
    variation: variation1_383
      
    },
    {
   expertOptiBucket: 6,
   variation: variation1_383
     
   },
   {
    expertOptiBucket: 7,
    variation: variation1_383
      
    },
    {
   expertOptiBucket: 4,
   variation: original_383
     
   },
   {
    expertOptiBucket: 5,
    variation: variation1_383
      
    },
    {
   expertOptiBucket: 8,
   variation: original_383
     
   },
    {
   expertOptiBucket: 9,
   variation: original_383
     
   },

 ];

var utils = window.optimizely.get('utils');
utils.observeSelector('[data-tracking-pod="nav_button"]:last-of-type', function (lastB) {
 window.__opty_Onehelp_expert.activate(pageName_383, experimentId_383, traffic_383);
});
 

/**
 * Experiment.
 * Name: 388: Expert - Home move third party article to flow
 */
 var experimentId_388 = '21524730019';
 var pageName_388 = '8156242263_url_targeting_for_388_expert__home_move_third_party_a';
 var original_388 = '21538560024';
 var variation1_388 = '21535840010';
 
 var traffic_388 = [
  {
   expertOptiBucket: 2,
   variation: original_388
     
   },
   {
    expertOptiBucket: 1,
    variation: variation1_388
      
    },
    {
   expertOptiBucket: 0,
   variation: original_388
     
   },
   {
    expertOptiBucket: 3,
    variation: variation1_388
      
    },
    {
   expertOptiBucket: 6,
   variation: variation1_388
     
   },
   {
    expertOptiBucket: 7,
    variation: variation1_388
      
    },
    {
   expertOptiBucket: 4,
   variation: original_388
     
   },
   {
    expertOptiBucket: 5,
    variation: variation1_388
      
    },
    {
   expertOptiBucket: 8,
   variation: original_388
     
   },
    {
   expertOptiBucket: 9,
   variation: original_388
     
   },

 ];
 

 window.__opty_Onehelp_expert.activate(pageName_388, experimentId_388, traffic_388);

/**
 * Experiment.
 * Name: 400: Expert - BB&T Cancellation Guidance
 */
 var experimentId_400 = '21660020062';
 var pageName_400 = '8156242263_url_targeting_for_bbt_cancellation_guidance';
 var original_400 = '21646060071';
 var variation1_400 = '21665660051';
 
 var traffic_400 = [
  {
   expertOptiBucket: 2,
   variation: original_400
     
   },
   {
    expertOptiBucket: 1,
    variation: variation1_400
      
    },
    {
   expertOptiBucket: 0,
   variation: original_400
     
   },
   {
    expertOptiBucket: 3,
    variation: variation1_400
      
    },
    {
   expertOptiBucket: 6,
   variation: variation1_400
     
   },
   {
    expertOptiBucket: 7,
    variation: variation1_400
      
    },
    {
   expertOptiBucket: 4,
   variation: original_400
     
   },
   {
    expertOptiBucket: 5,
    variation: variation1_400
      
    },
    {
   expertOptiBucket: 8,
   variation: original_400
     
   },
    {
   expertOptiBucket: 9,
   variation: original_400
     
   },

 ];
 

 window.__opty_Onehelp_expert.activate(pageName_400, experimentId_400, traffic_400);


/**
 * Experiment.
 * Name: 461: AC - Mobile Swap/Upgrade help - expert
 */
 var experimentId_461 = '22026720774';
 var pageName_461 = '8156242263_url_targeting_for_copy_of_ac__mobile_swapupgrade_help';
 var original_461 = '22030691285';
 var variation1_461 = '22048210472';
 
 var traffic_461 = [
  {
   expertOptiBucket: 2,
   variation: original_461
     
   },
   {
    expertOptiBucket: 1,
    variation: variation1_461
      
    },
    {
   expertOptiBucket: 0,
   variation: original_461
     
   },
   {
    expertOptiBucket: 3,
    variation: variation1_461
      
    },
    {
   expertOptiBucket: 6,
   variation: variation1_461
     
   },
   {
    expertOptiBucket: 7,
    variation: variation1_461
      
    },
    {
   expertOptiBucket: 4,
   variation: original_461
     
   },
   {
    expertOptiBucket: 5,
    variation: variation1_461
      
    },
    {
   expertOptiBucket: 8,
   variation: original_461
     
   },
    {
   expertOptiBucket: 9,
   variation: original_461
     
   },

 ];
 

 window.__opty_Onehelp_expert.activate(pageName_461, experimentId_461, traffic_461);
}}]}], "name": "Original"}], "audienceIds": null, "changes": null, "id": "19266561397", "integrationSettings": null}], "id": "19210034990", "weightDistributions": null, "name": "Onehelp expert - Routing", "groupId": null, "commitId": "22042800067", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"dependencies": [], "type": "custom_code", "id": "EC76CA07-F6E4-45C9-AFB6-514908721F32", "value": function($){window.__opty_Onehelp_expert = (function(){

var expertID = document.querySelector('#onehelp-expert-id').innerText;
var expertOptiBucket = document.querySelector('#onehelp-expert-opti-bucket').innerText;

  
function getVariationID(traffic){

  var variationId = null;
 for(var i=0; i< traffic.length; i++){
 var option = traffic[i];
 if(option.expertOptiBucket == expertOptiBucket){
   variationId = option.variation;
   break;
   }
 
 } 


  return variationId;
}
  
function activate(pageName, experimentId, traffic){
window['optimizely'] = window['optimizely'] || [];

var variationId = getVariationID(traffic);

  
window["optimizely"].push({
  "type": "bucketVisitor",
  "experimentId": experimentId,
  "variationId": variationId
});
  
window['optimizely'].push({
  type: "page",
  pageName: pageName
});
}

   function getCookie(cname){
        
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) { 
            return c.substring(name.length, c.length);
        }
    }
    return "";
    
  }
  
return {
  
  activate:activate,
  getCookie: getCookie

};


})();
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["20132636282", "20180056507", "20181838066"], "experiments": [{"weightDistributions": [{"entityId": "20189761572", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "Messaging - LC AB test", "bucketingStrategy": null, "variations": [{"id": "20157417470", "actions": [{"viewId": "20132636282", "changes": [{"selector": ".c-height-small", "dependencies": [], "attributes": {}, "type": "attribute", "id": "371445BC-4738-432E-9F48-0EABA507A1A4", "css": {}}]}], "name": "Original"}, {"id": "20189761572", "actions": [{"viewId": "20132636282", "changes": [{"dependencies": [], "type": "custom_code", "id": "3E91FACC-DC61-4128-B7E9-E6AF51061EAD", "value": function($){var utils = window.optimizely.get('utils');
var getCookie = window.__opty_message_Lc.getCookie;
var manageCss = window.__opty_message_Lc.manageCss;
var checkSupported = window.__opty_message_Lc.checkSupported;
var renderOptions = window.__opty_message_Lc.configRenderOptions('https://m.me/102994661806971', '07786207303');

var checkTime = window.__opty_message_Lc.checkTime;

if(!checkTime()){
manageCss('timeoff');    
} else {

function apiCall(){
var query = "query ContactEligibilty { me { profileID contactOptions { otherAccessibleOptions { availableToCustomer } } } }"; 
var url  = "https://skyport.sky.com";
  window.fetch(url, {
    method: 'POST',
    body: JSON.stringify({ query: query }),
    headers: {
      'content-type': 'application/json',
      'x-api-token': '218bd9b0-51ab-0139-b483-4e7dfe16cc61',
      'Authorization': 'Bearer: ' + getCookie('skyCEsidsso01')
    }
  })
  	.then(function (result) { return result.json(); })
  	.then(function (data) {
  if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
   }    
if(data.data && data.data.me && data.data.me.profileID){
  manageCss('yesSupportedIn');  
} else {
  manageCss('yesSupportedOut'); 
}
  }).catch(function(e){

     console.log('Error', e);
  });
}







//main
manageCss('intialStyle');

setTimeout(function(){

  
if(checkSupported()){
if(!getCookie('skyCEsidsso01')){
 if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
}   
 manageCss('yesSupportedOut'); 
} else {  
apiCall();
}  

  utils.observeSelector('#opty_item_message button', function(btn) {
if( window.livepersonDtmApi &&
  window.livepersonDtmApi.openLivePersonChat){
var launchMessenger = window.__opty_message_Lc.configMessenger('Bot_Sales_Winback_Web');  
 btn.removeEventListener('click', launchMessenger, false); 
btn.addEventListener('click', launchMessenger, false);                                                                      
} else {
btn.removeEventListener('click', renderOptions, false); 
btn.addEventListener('click', renderOptions, false);    
}
                    
});
  
} else {
//not supported
 
if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
}  
manageCss('notSupported');  
  
utils.observeSelector('#opty_item_message button', function(btn) {
btn.removeEventListener('click', renderOptions, false); 
btn.addEventListener('click', renderOptions, false);                      
});

}
}, 9000);



}
}}, {"selector": ".c-live-chat__item-left", "dependencies": [], "attributes": {"html": "<div id=\"opty_item_message\"><h2 class=\"c-live-chat__header c-text-body u-margin-bottom-small opty-elem\">Message online with a Sky Advisor now</h2><div class=\"live-chat opty-elem\"><h3 class=\"c-heading-delta u-margin-bottom-small opty-elem\" data-test-id=\"livechat-header\"></h3><div><div><div><button class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn\" data-tracking-label=\"Message us\">Message us</button>\n  <button class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn is-disabled\" disabled>Busy, please wait...</button>\n    <button id=\"opty-btn-timeoff\" class=\"c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn is-disabled\" disabled>Message us</button>  \n  <a href=\"https://skyid.sky.com/signin?successUrl=https%3A%2F%2Fwww.sky.com%2Flive-chat%2Fcomeback&cancelUrl=https%3A%2F%2Fwww.sky.com%2Flive-chat%2Fcomeback\" class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn\" data-tracking-label=\"Sign in\">Sign in</a></div><p class=\" opty-elem c-text-smallprint text-smallprint--light\">Message online and on the go with one of our experts. We\u2019ll help you come back to us .\nOur replies might not be immediate. Opening hours: Mon-Sun <strong>09:00-19:30</strong>. If you get in touch outside of these times, expect a response the following day.<br>Need help with your account or bills? Go to: <a ref=\"https://www.sky.com/help/home/your-account\" data-tracking-label=\"Link to /help/home/your-account\">https://www.sky.com/help/home/your-account</a></p></div></div></div>"}, "type": "attribute", "id": "0D315269-B4B5-4AFF-9B22-7EEDDB646DB8", "css": {}}, {"selector": "a.c-height-small.live-chat__btn.c-btn.c-btn--primary.opty-elem.u-margin-bottom-small", "dependencies": [], "attributes": {}, "type": "attribute", "id": "A1975F20-7825-4543-B7B2-8599A33EC60B", "css": {}}]}, {"viewId": "20180056507", "changes": [{"dependencies": [], "type": "custom_code", "id": "1C4427D1-B0F7-4782-AB10-CC062735EAE9", "value": function($){var utils = window.optimizely.get('utils');

var getCookie = window.__opty_message_Lc.getCookie;
var manageCss = window.__opty_message_Lc.manageCss;
var checkSupported = window.__opty_message_Lc.checkSupported;
var renderOptions = window.__opty_message_Lc.configRenderOptions('https://m.me/101450531963340', '07537404357');

var checkTime = window.__opty_message_Lc.checkTime;

if(!checkTime()){
manageCss('timeoff');    
} else {

function apiCall(){
var query = "query ContactEligibilty { me { profileID contactOptions { otherAccessibleOptions { availableToCustomer } } } }"; 
var url  = "https://skyport.sky.com";
  window.fetch(url, {
    method: 'POST',
    body: JSON.stringify({ query: query }),
    headers: {
      'content-type': 'application/json',
      'x-api-token': '218bd9b0-51ab-0139-b483-4e7dfe16cc61',
      'Authorization': 'Bearer: ' + getCookie('skyCEsidsso01')
    }
  })
  	.then(function (result) { return result.json(); })
  	.then(function (data) {
  if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
   }    
if(data.data && data.data.me && data.data.me.profileID){
  manageCss('yesSupportedIn');  
} else {
  manageCss('yesSupportedOut'); 
}
  }).catch(function(e){

     console.log('Error', e);
  });
}







//main
manageCss('intialStyle');

setTimeout(function(){

  
if(checkSupported()){
if(!getCookie('skyCEsidsso01')){
 if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
}   
 manageCss('yesSupportedOut'); 
} else {  
apiCall();
}  

  utils.observeSelector('#opty_item_message button', function(btn) {
if( window.livepersonDtmApi &&
  window.livepersonDtmApi.openLivePersonChat){
  var launchMessenger = window.__opty_message_Lc.configMessenger('Bot_Sales_Active_Blocked_Web');
 btn.removeEventListener('click', launchMessenger, false); 
btn.addEventListener('click', launchMessenger, false);                                                                      
} else {
btn.removeEventListener('click', renderOptions, false); 
btn.addEventListener('click', renderOptions, false);    
}
                    
});
  
} else {
//not supported
 
if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
}  
manageCss('notSupported');  
  
utils.observeSelector('#opty_item_message button', function(btn) {
btn.removeEventListener('click', renderOptions, false); 
btn.addEventListener('click', renderOptions, false);                      
});

}
}, 9000);


}
}}, {"selector": ".c-live-chat__item-left", "dependencies": [], "attributes": {"html": "<div id=\"opty_item_message\"><h2 class=\"c-live-chat__header c-text-body u-margin-bottom-small opty-elem\">Message online with a Sky Advisor now</h2><div class=\"live-chat opty-elem\"><h3 class=\"c-heading-delta u-margin-bottom-small opty-elem\" data-test-id=\"livechat-header\"></h3><div><div><div><button class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn\" data-tracking-label=\"Message us\">Message us</button>\n   <button class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn is-disabled\" disabled>Busy, please wait...</button>\n    <button id=\"opty-btn-timeoff\" class=\"c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn is-disabled\" disabled>Message us</button>    \n   <a href=\"https://skyid.sky.com/signin?successUrl=https%3A%2F%2Fwww.sky.com%2Flive-chat%2Fmissed-payment&cancelUrl=https%3A%2F%2Fwww.sky.com%2Flive-chat%2Fmissed-payment\" class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn\" data-tracking-label=\"Sign in\">Sign in</a></div><p class=\" opty-elem c-text-smallprint text-smallprint--light\">Message online and on the go with one of our experts. We\u2019ll help you come back to us .\nOur replies might not be immediate. Opening hours: Mon-Sun <strong>09:00-19:30</strong>. If you get in touch outside of these times, expect a response the following day.<br>Need help with your account or bills? Go to: <a ref=\"https://www.sky.com/help/home/your-account\" data-tracking-label=\"Link to /help/home/your-account\">https://www.sky.com/help/home/your-account</a></p></div></div></div>\n\n"}, "type": "attribute", "id": "5D8FBF0C-A92B-4571-9D60-F5DC29F849D5", "css": {}}]}, {"viewId": "20181838066", "changes": [{"dependencies": [], "type": "custom_code", "id": "26C93951-5D5F-4A94-BB15-12F04F61B8C9", "value": function($){var utils = window.optimizely.get('utils');

var getCookie = window.__opty_message_Lc.getCookie;
var manageCss = window.__opty_message_Lc.manageCss;
var checkSupported = window.__opty_message_Lc.checkSupported;
var renderOptions = window.__opty_message_Lc.configRenderOptions('https://m.me/103537785084496', '07786200542');

var checkTime = window.__opty_message_Lc.checkTime;

if(!checkTime()){
manageCss('timeoff');    
} else {

function apiCall(){
var query = "query ContactEligibilty { me { profileID contactOptions { otherAccessibleOptions { availableToCustomer } } } }"; 
var url  = "https://skyport.sky.com";
  window.fetch(url, {
    method: 'POST',
    body: JSON.stringify({ query: query }),
    headers: {
      'content-type': 'application/json',
      'x-api-token': '218bd9b0-51ab-0139-b483-4e7dfe16cc61',
      'Authorization': 'Bearer: ' + getCookie('skyCEsidsso01')
    }
  })
  	.then(function (result) { return result.json(); })
  	.then(function (data) {
  if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
   }    
if(data.data && data.data.me && data.data.me.profileID){
  manageCss('yesSupportedIn');  
} else {
  manageCss('yesSupportedOut'); 
}
  }).catch(function(e){

     console.log('Error', e);
  });
}







//main
manageCss('intialStyle');

setTimeout(function(){

  
if(checkSupported()){
if(!getCookie('skyCEsidsso01')){
 if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
}   
 manageCss('yesSupportedOut'); 
} else {  
apiCall();
}  

  utils.observeSelector('#opty_item_message button', function(btn) {
if( window.livepersonDtmApi &&
  window.livepersonDtmApi.openLivePersonChat){
  var launchMessenger = window.__opty_message_Lc.configMessenger('Bot_Sales_Pending_Cancel_Web');
 btn.removeEventListener('click', launchMessenger, false); 
btn.addEventListener('click', launchMessenger, false);                                                                      
} else {
btn.removeEventListener('click', renderOptions, false); 
btn.addEventListener('click', renderOptions, false);    
}
                    
});
  
} else {
//not supported
 
if(document.querySelector('#opty-intialStyle')){
   document.querySelector('#opty-intialStyle').remove();
}  
manageCss('notSupported');  
  
utils.observeSelector('#opty_item_message button', function(btn) {
btn.removeEventListener('click', renderOptions, false); 
btn.addEventListener('click', renderOptions, false);                      
});

}
}, 9000);

}
}}, {"selector": ".c-live-chat__item-left", "dependencies": [], "attributes": {"html": "<div id=\"opty_item_message\"><h2 class=\"c-live-chat__header c-text-body u-margin-bottom-small opty-elem\">Message online with a Sky Advisor now</h2><div class=\"live-chat opty-elem\"><h3 class=\"c-heading-delta u-margin-bottom-small opty-elem\" data-test-id=\"livechat-header\"></h3><div><div><div><button class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn\" data-tracking-label=\"Message us\">Message us</button>\n   <button class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn is-disabled\" disabled>Busy, please wait...</button>\n    <button id=\"opty-btn-timeoff\" class=\"c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn is-disabled\" disabled>Message us</button>    \n   <a href=\"https://skyid.sky.com/signin?successUrl=https%3A%2F%2Fwww.sky.com%2Flive-chat%2Fpending-cancel-tv&cancelUrl=https%3A%2F%2Fwww.sky.com%2Flive-chat%2Fpending-cancel-tv\" class=\"opty-elem c-btn c-btn--primary u-margin-bottom-small c-height-small live-chat__btn\" data-tracking-label=\"Sign in\">Sign in</a></div><p class=\" opty-elem c-text-smallprint text-smallprint--light\">Message online and on the go with one of our experts. We\u2019ll help you come back to us .\nOur replies might not be immediate. Opening hours: Mon-Sun <strong>09:00-19:30</strong>. If you get in touch outside of these times, expect a response the following day.<br>Need help with your account or bills? Go to: <a ref=\"https://www.sky.com/help/home/your-account\" data-tracking-label=\"Link to /help/home/your-account\">https://www.sky.com/help/home/your-account</a></p></div></div></div>\n\n"}, "type": "attribute", "id": "A4361374-D057-4A92-AB81-A6E8729F9836", "css": {}}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "20142646572", "integrationSettings": null}], "id": "20138487201", "weightDistributions": null, "name": "Messaging - LC AB test", "groupId": null, "commitId": "22187490469", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"value": "<style>.opty-sms {\nfont-weight:bold;\n}\n.opty-contact-option-body{\ntext-align: left\n}\n\n#opty-new-gate-keeper .NumberPoolingNumber, #opty-loading-span{\nfont-weight: bold;\ncolor: rgb(0, 115, 197);  \n}\n\n#opty-new-gate-keeper .opty-card{\n    border-radius: 4px;\n    box-shadow: rgb(0 0 0 / 15%) 0px 6px 15px 0px;\n    overflow: hidden;\n    position: relative;\n    margin-bottom: 20px;\n    background-color: rgb(255, 255, 255);\n}\n\n\n#opty-new-gate-keeper .opty-node-tree:after {\n    content: \"\";\n    position: absolute;\n    bottom: 0px;\n    left: 0px;\n    right: 0px;\n    height: 4px;\n    background-image: linear-gradient(to left, rgb(134, 45, 129) 0%, rgb(6, 68, 161) 100%);\n}\n\n\n.opty-header-div {\n    display: flex;\n    -webkit-box-align: center;\n    align-items: center;\n  margin-bottom: 0;\n}\nh2.opty-header{\ncolor: inherit;\nfont-weight: bold;\n  margin-bottom: 0;\n}\n\n.opty-p-container strong{\nfont-weight: bold;\n}\n\n.opty-p-container p{\nfont-size: 16px;\n line-height: 24px;\nmargin-bottom: 12px;\n}\n\n.opty-buttons-wrapper{\ndisplay: flex;\nmin-width: 100%;\nmargin: 0 0 0 -6px;\n}\n\n#opty-step-signed-in-step .opty-buttons-wrapper, \n#opty-step-2-out .opty-buttons-wrapper{\n\tmargin: 0;\n}\n\n\n.opty-buttons-wrapper button, #opty-step-thanks a{\nmargin: calc(6px);\ndisplay: flex;\n-webkit-box-pack: center;\njustify-content: center;\n -webkit-box-align: center;\nalign-items: center;\npadding: 8px 24px;\ncursor: pointer;  \n\n}\n.opty-buttons-wrapper button:not(.c-link), #opty-step-thanks a{\nbackground-color: rgb(255, 255, 255);\nborder: 1px solid rgb(192, 192, 192);\nborder-radius: 22px;\ntransition: background-color 0.3s ease 0s, border-color 0.3s ease 0s;\nfont: inherit; \ncolor: #fff;  \n}\n\n.opty-buttons-wrapper button:not(.c-link):hover, #opty-step-thanks a:hover, .opty-buttons-wrapper button:not(.c-link):active, #opty-step-thanks a:active{\n    text-decoration: none;\n    background-color: rgb(0, 115, 197);\n    border-color: rgb(0, 115, 197);\n  color: #fff;\n}\n\n.opty-buttons-wrapper button:not(.c-link):hover span, #opty-step-thanks a:hover span{\n  color: #fff;\n}\n\n.opty-buttons-wrapper button:not(.c-link):focus, #opty-step-thanks a:focus{\nbox-shadow: rgb(0 115 197 / 20%) 0px 0px 0px 7px;\noutline: none;\ncolor: #fff;\n}\n.opty-buttons-wrapper button:not(.c-link):focus span, #opty-step-thanks a:focus span{\ncolor: #fff;\n}\n\n.opty-buttons-wrapper span{\n    white-space: nowrap;\n    transition: color 0.3s ease 0s;\n  font-weight: bold;\n    color: rgb(0, 115, 197);\n}\n\n.opty-buttons-wrapper span:hover{\ntext-decoration: none;\n  color: #fff;  \n}\n\n.opty-buttons-wrapper .c-link {\npadding-top: 0;\n}\n\n\n.opty-breadcrumbs-new {\ndisplay: flex;\n}\n\n.opty-ontact-option-head svg {\n    fill: currentcolor;\n    flex: 0 0 auto;\n    height: 24px;\n    width: 24px;\n    margin-right: 12px;\n   margin-bottom: 12px;\n}\n\n.opty-ontact-option-head svg path{\n    fill: rgb(0, 115, 197) !important;\n}\n\n\n\n.opty-one-option{\n    display: flex;\n    border-radius: 4px;\n    border: 1px solid rgb(192, 192, 192);\n  margin-bottom: 20px;\n\n}\n\n.opty-ontact-option-head{\ndisplay: flex;\nflex-flow: row wrap;\n position: relative;\n}\n.opty-ontact-option-head:after{\n    content: \"\";\n    background-color: rgb(192, 192, 192);\n}\n.opty-title-and-availability {\n    display: flex;\n    flex-direction: column;\n\n}\n\n.opty-title-and-availability span{\n    max-width: 100%;\n}\n\n.opty-contact-option-body > p {\n    color: inherit;\n    font-size: 20px;\n    line-height: 24px;\n    margin-bottom: 8px;\n}\n\n.opty-contact-option-body-p {\nfont-size: 14px;\nline-height: 18px;\nmargin-bottom: 0px;    \n}\n\n.opty-contact-option-body-p p {\n    margin-bottom: 12px;\n      font-size: 14px;\n    line-height: 18px;\n}\n\n.opty-contact-option-cta {\n    flex-flow: row nowrap;\n}\n\n.opty-contact-option-cta button, .opty-contact-option-cta a:not(.opty-sms) {\n-webkit-box-align: center;\n    align-items: center;\n    border-radius: 4px;\n    border: 1px solid transparent;\n    cursor: pointer;\n    display: inline-flex;\n    flex-shrink: 0;\n    font-weight: bold;\n    -webkit-box-pack: center;\n    justify-content: center;\n    line-height: 24px;\n    position: relative;\n    text-align: center;\n    transition-duration: 300ms;\n    transition-property: background, color, box-shadow;\n    transition-timing-function: ease;\n    background-color: rgb(0, 115, 197);\n    color: rgb(255, 255, 255);\n    font-size: 20px;\n  min-height: 40px;\n}\n\n\n@media (min-width: 640px){\n.opty-contact-option-cta button, .opty-contact-option-cta a{\nmin-width: 180px;\n  \n}\n  \n.opty-ontact-option-head:after{\n    position: absolute;\n    right: 0px;\n    top: 0px;\n    height: calc(100% + 8px);\n    margin-top: -4px;\n    width: 1px;\n}\n}\n\n@media (max-width: 959px){\n  \n.opty-ontact-option-head:after{\n      width: calc(100% + 8px);\n    flex: 0 0 calc(100% + 8px);\n    margin: 12px auto auto -4px;\n    height: 1px;\n  }\n}\n\n@media (min-width: 959px){\n.opty-right-side-container{\n    align-items: flex-start;\n      flex-flow: column;\n}\n  \n.opty-contact-option-cta {\n    flex-direction: column;\n    -webkit-box-pack: center;\n    justify-content: center;\n} \n  \n  .opty-contact-option-cta button, .opty-contact-option-cta a{\n    width: 100%;\n}\n}\n\n\n@media (min-width: 960px){\n.opty-one-option{\nflex-flow: row nowrap;\npadding: 24px;\n}\n.opty-ontact-option-head{\nflex-flow: row nowrap;\n    flex: 0 0 200px;\n    padding-right: 16px;\n}\n  \n.opty-ontact-option-head svg{\n    flex: 0 0 32px;\n    margin-right: 12px;\n}\n  \n  .opty-title-and-availability span{\n   margin-top: 2px;\n}\n  .opty-right-side-container{\n    flex-flow: row nowrap;\n    display: flex;\n    flex: 1 1 100%;\n}\n  \n.opty-contact-option-cta {\n    display: flex;\n    -webkit-box-pack: start;\n    justify-content: flex-start;\n    flex: 0 0 234px;\n    align-items: flex-start;\n}\n  \n}\n\n\n\n@media (min-width: 1120px){\n.opty-contact-option-body{\n    margin-right: 72px;\n}\n}\n\n@media (min-width: 640px) and (max-width: 959px){\n\n.opty-one-option{\n    flex-flow: row nowrap;\n    padding: 24px 24px 32px;  \n}\n  \n.opty-ontact-option-head{\n    flex-flow: column;\n    -webkit-box-align: center;\n    align-items: center;\n    flex: 0 0 140px;\n    padding-right: 16px;  \n}\n\n  \n.opty-ontact-option-head svg{\n  \n    flex: 0 0 32px;\n    margin-bottom: 8px;\n  }\n\n.opty-title-and-availability {\n    -webkit-box-align: center;\n    align-items: center;\n    text-align: center;\n    width: 100%;\n}\n  \n  .opty-contact-option-body{\n    margin-bottom: 24px;\n}\n \n  .opty-contact-option-cta {\n    display: inline-flex;\n} \n  \n  \n}\n\n\n\n\n\n\n@media (min-width: 640px){\n#opty-new-gate-keeper .opty-card{\n  padding: 32px;\n  }\n.opty-header-div {\n    margin-bottom: 12px;\n}\n  \n h2.opty-header{\n  margin-bottom: 12px;\n  font-size: 28px;\n  line-height: 32px;\n   margin-bottom: 0;\n  }\n   .opty-p-container{\n  margin-bottom: 24px;\n  }\n  \n .opty-buttons-wrapper{\n  flex-flow: row wrap;\n  align-items: flex-start;\n  }\n  \n.opty-buttons-wrapper span{\n  font-size: 20px;\n    line-height: 24px;\n  }\n  \n.opty-breadcrumbs-new {\nmargin-bottom: 24px;\n}\n.opty-previous-mobile{\ndisplay: none;  \n}\n  \n  .opty-ontact-option-head svg{\n    height: 32px;\n    width: 32px;\n}\n  .opty-title-and-availability {\n    flex: 1 1 100%;\n\n}\n    .opty-title-and-availability span{\n    font-size: 24px;\n    line-height: 28px;\n}\n  .opty-right-side-container{\n    margin-left: 24px;\n}\n  \n.opty-contact-option-body{\n    flex: 1 1 100%;\n}\n  \n.opty-ontact-option-head:after{\n    position: absolute;\n    right: 0px;\n    top: 0px;\n    height: calc(100% + 8px);\n    margin-top: -4px;\n    width: 1px;  \n}\n}\n\n\n@media (max-width: 639px){\n#opty-new-gate-keeper .opty-card{\npadding: 24px 16px 32px;\n  }\n  \n.opty-header-div {\n  margin-bottom: 8px;\n  }\n  \nh2.opty-header{\n    margin-bottom: 8px;\n    font-size: 24px;\n    line-height: 28px;  \n} \n  \n     .opty-p-container{\n      margin-bottom: 16px;\n  }\n .opty-buttons-wrapper{\nflex-flow: column;\n    -webkit-box-align: stretch;\n    align-items: stretch;\n  }\n  \n.opty-breadcrumbs-new{\n    margin: -8px 0px 16px;  \n}\n  \n.opty-previous-mobile{\ndisplay: flex;\n    -webkit-box-align: center;\n    align-items: center;  \n}\n.opty-previous-mobile button{\n-webkit-box-align: center;\n    align-items: center;\n    background-color: transparent;\n    border: 1px solid transparent;\n    cursor: pointer;\n    display: inline-flex;\n    flex-shrink: 0;\n    font-weight: bold;\n    -webkit-box-pack: center;\n    justify-content: center;\n    line-height: 24px;\n    position: relative;\n    text-align: center;\n    transition-duration: 300ms;\n    transition-property: background, color, box-shadow;\n    transition-timing-function: ease;\n    border-radius: 8px;\n    color: rgb(0, 115, 197);\n    font-size: 16px;\n    padding: 0px;\n}\n.opty-previous-mobile svg{\nfill: rgb(0, 115, 197);\nmargin-left: -8px; \n    flex: 0 0 auto;\n    height: 24px;\n    width: 24px;  \n}\n  .opty-node-tree .opty-desktop {\n    display: none;\n  }\n  \n  \n.opty-one-option{\nflex-flow: column;\n    padding: 16px 16px 24px;  \n  }\n  \n.opty-ontact-option-head{\n    flex-flow: row wrap;  \n}\n  \n.opty-title-and-availability span{\n    font-size: 20px;\n    line-height: 24px;\n}\n  \n  .opty-right-side-container{\n    -webkit-box-align: center;\n    align-items: center;\n    margin-top: 12px;\n}\n    .opty-contact-option-body{\n    margin-bottom: 16px;\n}\n.opty-contact-option-cta {\n    display: flex;\n    text-align: center;\n}\n  .opty-previous-mobile button {\nwidth: 100%;  \n}\n  \n.opty-contact-option-cta button, .opty-contact-option-cta a   {\n  width: 100%;  \n  }\n  \n  #opty-step-signed-in-step .opty-buttons-wrapper a {\nmargin-bottom: 12px;  \n}\n}\n\n#opty-step-thanks svg {\n    fill: currentcolor;\n    flex: 0 0 auto;\n    height: 24px;\n    width: 24px;\n    margin-right: 12px;\n}\n\n#opty-step-thanks svg path{\nfill: rgb(22, 172, 46);\n}\n\n\n.opty-desktop .c-breadcrumbs {\n\tline-height: 1;\n}\n\n@media (max-width: 959px){\n  .opty-contact-option-cta{\n  width: 100%;\n  }\n\n  .opty-contact-option-cta a, .opty-contact-option-cta button{\n  max-width:180px;\n  }\n}\n@media (max-width: 629px){\n  .opty-contact-option-cta a, .opty-contact-option-cta button{\nmax-width: unset;\n  }\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "AC0BF2C0-B672-470E-B614-D9239DC78832"}, {"dependencies": [], "type": "custom_code", "id": "59DE2384-90F4-4E99-BAB8-B06B065E79D9", "value": function($){window.__opty_message_Lc = {

getCookie: function(cname){
        
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for(var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') {
                c = c.substring(1);
            }
            if (c.indexOf(name) == 0) { 
                return c.substring(name.length, c.length);
            }
        }
        return "";
        
    },
  
   manageCss: function(state){
  var css = '';
    if(state == "intialStyle"){
  css = '#opty_item_message a.opty-elem, #opty_item_message button.c-btn:not(.is-disabled), #opty-btn-timeoff  { display: none !important; }';
  }
    if(state == "notSupported"){
  css = '#opty_item_message a.opty-elem, #opty_item_message button.c-btn.is-disabled  { display: none !important; }';
  }
  
    if(state == "yesSupportedIn"){
  css = '#opty_item_message a.opty-elem, #opty_item_message button.c-btn.is-disabled  { display: none !important; }';
  }
      if(state == "yesSupportedOut"){
  css = ' #opty_item_message button.c-btn:not(.is-disabled), #opty_item_message button.c-btn.is-disabled  { display: none !important; } #opty_item_message a.opty-elem {display: inline-block !important;}';
  }
  
          if(state == "timeoff"){
  css = '#opty_item_message a, #opty_item_message button:not(#opty-btn-timeoff)  { display: none !important; }';
  }
     
var head = document.head || document.getElementsByTagName('head')[0],
    style = document.createElement('style');

head.appendChild(style);

style.type = 'text/css';
style.id="opty-"+state;  
if (style.styleSheet){
  // This is required for IE8 and below.
  style.styleSheet.cssText = css;
} else {
  style.appendChild(document.createTextNode(css));
}
},
  
checkSupported: function(){
if (window.livepersonDtmApi && window.livepersonDtmApi.browser) {
    return window.livepersonDtmApi.browser.supported;
  }
  return undefined;
},
  
 configRenderOptions: function(fb, sms){
   
   return function(){
var contactPod= '<div id="opty-new-gate-keeper"><div class="opty-card"><div class="opty-node-tree"><div class="opty-container"><div data-test-id="contact-option-sms" class="opty-one-option"><div class="opty-ontact-option-head"> <svg viewBox="0 0 32 32" class="icon__Svg-sc-6w188g-0 GKJxI coh-icon" role="presentation" aria-hidden="true" data-test-id="contact-option-icon"> <g id="linear-smartphone"> <path d="M11.5 4h10a1.5 1.5 0 0 1 1.493 1.356L23 5.5v22a1.5 1.5 0 0 1-1.355 1.493L21.5 29h-10a1.5 1.5 0 0 1-1.493-1.356L10 27.5v-22a1.5 1.5 0 0 1 1.355-1.493L11.5 4h10zm5.014 22.25a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5zM21 6h-9v19h9V6z" id="Icon"></path> </g> </svg><div class="opty-title-and-availability"> <span class="text__Text-sc-1u9gciq-0 dqoqrD coh-title">SMS text message</span><div class="sc-fzozJi jbSEI"><span data-test-id="availability" class="text__Text-sc-1u9gciq-0 fewzGA">Open</span></div></div></div><div class="opty-right-side-container"><div class="opty-contact-option-body"><p class="text__Text-sc-1u9gciq-0 jNcdKv">Send us a text</p><div class="opty-contact-option-body-p"><p>Our phone lines can get busy. Using our messaging service means you’re not waiting on the phone for an expert. Our replies won’t be immediate, but you’re free to go about your day while we work on your query in the background.</p></div><div class="opty-contact-option-body-p"><p>This number is for SMS text messages only and can’t accept calls.</p><p><strong>Just so you know:</strong> SMS/Mobile Data is charged at your mobile provider’s standard rates.</p><p class="text__Text-sc-1u9gciq-0 hSIKKp">Opening hours: Mon-Sun <strong>09:00-19:30 </strong></p></div></div><div class="opty-contact-option-cta"><button id="opty-text-us" aria-label="Text us" data-tracking-option="revealer" class="button__Button-t5gfjf-0 dTlfPI">Text us</button><a style="display:none;" class="opty-sms" href="sms:'+sms+'" class="" tab-index="-1">'+sms+'</a></div></div></div><div data-test-id="contact-option-facebook" class="opty-one-option"><div class="opty-ontact-option-head"> <svg viewBox="0 0 32 32" role="presentation" aria-hidden="true" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" version="1.1" class="sc-AxheI eXzlnr coh-icon"> <g id="linearFacebook"> <path d="M29.003 1H2.995A1.996 1.996 0 0 0 1 2.995v26.009C1 30.106 1.894 31 2.995 31h14.029V19.404h-3.911v-4.527h3.911v-3.339c0-3.875 2.366-5.985 5.823-5.985 1.655 0 3.078.124 3.493.178v4.05l-2.398.001c-1.879 0-2.244.894-2.244 2.204v2.891h4.484l-.583 4.527h-3.901V31h7.305a1.996 1.996 0 0 0 1.996-1.996V2.995A1.996 1.996 0 0 0 29.003 1"></path> </g> </svg><div class="opty-title-and-availability"> <span class="text__Text-sc-1u9gciq-0 dqoqrD coh-title">Facebook Messenger</span><div class="sc-fzozJi jbSEI"><span data-test-id="availability" class="text__Text-sc-1u9gciq-0 fewzGA">Open</span></div></div></div><div class="opty-right-side-container"><div class="opty-contact-option-body"><p class="text__Text-sc-1u9gciq-0 jNcdKv">Message us on Facebook</p><div class="opty-contact-option-body-p"><p>Our phone lines can get busy. Using our messaging service means you’re not waiting on the phone for an expert. Our replies won’t be immediate, but you’re free to go about your day as we work on your query in the background.</p></div><div class="opty-contact-option-body-p"><p>You’ll need an active Facebook account to use this option.</p><p><strong>Just so you know:</strong> Mobile Data is charged at your mobile provider’s standard rates.</p><p class="text__Text-sc-1u9gciq-0 hSIKKp">Opening hours: Mon-Sun <strong>09:00-19:30 </strong></p></div></div><div class="opty-contact-option-cta"> <a target="_blank" href="'+fb+'" aria-label="Message us" data-test-id="link-button" class="button__Button-t5gfjf-0 dTlfPI">Message us</a></div></div></div></div></div></div></div>';

if(!document.querySelector('#opty-new-gate-keeper')){
document.querySelector('.c-live-chat').insertAdjacentHTML('afterend', contactPod);
  
document.querySelector('#opty-text-us').addEventListener('click', function(){
this.style.display='none';
document.querySelector('.opty-sms').removeAttribute('style');
 
  
});
  window.scrollBy(0, 450);
} 
   };

},
  
   configMessenger: function(topic){
 
 
  window.livepersonDtmApi.onPageChanged(undefined, {
    section: 'section:contact-us',
    tagletSection: 'contact-us',
    topic: topic //Bot_Sales_Winback
  });
    
    return function(){
 setTimeout(function(){
  window.livepersonDtmApi.openLivePersonChat({}); 
  }, 1100);
 
     };

},
  
  
checkTime: function(){

var now = new Date();
var utc = new Date(now.getTime() + now.getTimezoneOffset() * 60000);
//utc +1
utc.setHours(utc.getHours() + 1);

var utcPlusHour =  utc.getHours();

if(utcPlusHour >= 9 && utcPlusHour < 20){
  
//  return true;
if(utcPlusHour < 19 || utc.getMinutes() < 30){
  return true;
} 
}

}  
  
  
  

};
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["21024280531"], "experiments": [{"weightDistributions": [{"entityId": "20998600460", "endOfRange": 5000}, {"entityId": "20996173552", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "325: Glass - Add Tooltip to Activate Page", "bucketingStrategy": null, "variations": [{"id": "20998600460", "actions": [], "name": "Original"}, {"id": "21021791803", "actions": [{"viewId": "21024280531", "changes": [{"dependencies": [], "type": "custom_code", "id": "BA651CB8-D9F3-4638-AF2E-D2B46869B51E", "value": function($){let utils = window["optimizely"].get("utils");
utils.observeSelector(".opty-popover", function() {
  
  document.querySelector(".opty-popover").addEventListener('click',function() {
    if (document.querySelector(".opty-tooltip-hidden")) {
            console.log("___IF RUNNING AKA this should have SHOWN the tooltip");
      document.querySelector(".opty-tooltip-hidden").classList.add("opty-tooltip-shown");
    	document.querySelector(".opty-tooltip-hidden").classList.remove("opty-tooltip-hidden");
    }
    
    else {
      console.log("___ELSE RUNNING AKA this should have hidden the tooltip");
      document.querySelector(".opty-tooltip-shown").classList.add("opty-tooltip-hidden");
    	document.querySelector(".opty-tooltip-shown").classList.remove("opty-tooltip-shown");
    }
  });
});
}}, {"value": "<style>[class*=\"text__Text\"] {\ndisplay:inline-flex; \n}\n\n.opty-svg {\n    vertical-align: middle;\n}\n\n.opty-svg:hover {\n  cursor:pointer;\n}\n\n.opty-tooltip-hidden {\n display:none; \n}\n\n.opty-tooltip-shown {\n display:block; \n}\n\n.preview__LivePreviewContainer-sc-11yuwww-1.QLFDZ {\n  -webkit-font-smoothing: antialiased;\n  text-size-adjust: 100%;\n  color: rgb(77, 77, 77);\n  font-family: \"Sky Text\", sans-serif;\n  font-size: 18px;\n  line-height: 1.5;\n  list-style: none;\n  box-sizing: border-box;\n  -webkit-box-align: center;\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 auto;\n  -webkit-box-pack: center;\n  justify-content: center;\n  \n  position: relative;\n}\n\n.popover__Wrapper-sc-1w5xlen-0.bSuoRt {\n  -webkit-font-smoothing: antialiased;\n  text-size-adjust: 100%;\n  color: rgb(77, 77, 77);\n  font-family: \"Sky Text\", sans-serif;\n  font-size: 18px;\n  line-height: 1.5;\n  list-style: none;\n  box-sizing: border-box;\n  position: relative;\n}\n\n.button__Button-sc-t5gfjf-0.fAeVZo {\n-webkit-font-smoothing: antialiased;\ntext-size-adjust: 100%;\nlist-style: none;\nbox-sizing: border-box;\nfont: inherit;\n-webkit-box-align: center;\nalign-items: center;\nbackground-color: transparent;\nborder-radius: 4px;\nborder: 1px solid transparent;\ncursor: pointer;\ndisplay: inline-flex;\nflex-shrink: 0;\nfont-weight: bold;\n-webkit-box-pack: center;\njustify-content: center;\nline-height: 24px;\noutline: none;\nposition: relative;\ntext-align: center;\ntransition-duration: 300ms;\ntransition-property: background, color, box-shadow;\ntransition-timing-function: ease;\ncolor: rgb(0, 15, 245);\nfont-size: 18px;\npadding: 8px 16px;\n}\n\n.fAeVZo::after {\n    content: \"\";\n    border: 2px solid rgb(0, 160, 255);\n    border-radius: 8px;\n    inset: -5px;\n    opacity: 0;\n    pointer-events: none;\n    position: absolute;\n    transition: opacity 150ms linear 0s;\n}\n\n.content__Element-sc-f4e6l7-0.fNcWJv {\n-webkit-font-smoothing: antialiased;\ntext-size-adjust: 100%;\ncolor: rgb(77, 77, 77);\nfont-family: \"Sky Text\", sans-serif;\nfont-size: 18px;\nline-height: 1.5;\nlist-style: none;\nbox-sizing: border-box;\nposition: absolute;\ntop: 130%;\nz-index: 1;\nright:-5px;\nmargin: 0px auto;\nmax-width: 30ch;\n}\n\n.fNcWJv::before, .fNcWJv::after {\n    left: 74%;\n}\n\n.fNcWJv::before, .fNcWJv::after {\n    content: \"\";\n    height: 16px;\n    position: absolute;\n    top: -8px;\n    transform: rotate(\n45deg);\n    width: 16px;\n}\n\n.fNcWJv::before {\n    box-shadow: rgb(0 0 0 / 20%) 0px 6px 20px 0px;\n    z-index: -1;\n}\n\n.content__Inner-sc-f4e6l7-1.gyZAs {\n-webkit-font-smoothing: antialiased;\ntext-size-adjust: 100%;\ncolor: rgb(77, 77, 77);\nfont-family: \"Sky Text\", sans-serif;\nlist-style: none;\nbox-sizing: border-box;\nbackground-color: rgb(255, 255, 255);\nborder-radius: 4px;\nbox-shadow: rgba(0, 0, 0, 0.2) 0px 6px 20px 0px;\npadding: 12px 16px;\nz-index: 1;\nfont-size: 16px;\nline-height: 20px;\n  min-width:fit-content;\n}\n\n.text__Text-sc-1u9gciq-0.fKjIJr {\n-webkit-font-smoothing: antialiased;\ntext-size-adjust: 100%;\nfont-family: \"Sky Text\", sans-serif;\nlist-style: none;\nfont-size: 16px;\nline-height: 20px;\nbox-sizing: border-box;\nfont-weight: normal;\nmargin: 0px;\ncolor: inherit;\n}\n\n.fNcWJv::after {\n    left: 74%;\n}\n\n.fNcWJv::before, .fNcWJv::after {\n    content: \"\";\n    height: 16px;\n    position: absolute;\n    top: -8px;\n    transform: rotate(\n45deg);\n    width: 16px;\n}\n\n.fNcWJv::after {\n    background-color: rgb(255, 255, 255);\n    z-index: 1;\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "DC02A411-4DAC-4EB0-B403-BE4A0B851C2D"}, {"value": "<div class=\"preview__LivePreviewContainer-sc-11yuwww-1 QLFDZ\">\n   <div class=\"opty-popover popover__Wrapper-sc-1w5xlen-0 bSuoRt\">\n       <svg class=\"opty-svg\" width=\"20px\" height=\"20px\" viewBox=\"0 0 30 40\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                     <title>linear-info</title>\n                     <desc>Created with Sketch.</desc>\n                     <g id=\"linear-info\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n                        <path d=\"M16,0 C24.836,0 32,7.164 32,16 C32,24.836 24.836,32 16,32 C7.164,32 0,24.836 0,16 C0,7.164 7.164,0 16,0 Z M16,2 C8.28,2 2,8.28 2,16 C2,23.72 8.28,30 16,30 C23.72,30 30,23.72 30,16 C30,8.28 23.72,2 16,2 Z M15.9975,12.3672 C16.2548333,12.3672 16.5126111,12.3774222 16.7693519,12.4008296 L17.1535,12.4462 L17.1535,24.6672 C17.1535,25.8287385 15.7315325,25.6496704 14.9082864,25.5319431 L14.8125,25.5182 L14.8125,13.2972 C14.8125,12.5602 15.3555,12.3672 15.9975,12.3672 Z M16.0112,6.1567 C16.9782,6.1567 17.7612,6.9397 17.7612,7.9067 C17.7612,8.8727 16.9782,9.6567 16.0112,9.6567 C15.0452,9.6567 14.2612,8.8727 14.2612,7.9067 C14.2612,6.9397 15.0452,6.1567 16.0112,6.1567 Z\" id=\"Icon\" fill=\"#000000\"></path>\n                     </g>\n                  </svg>\n      <div role=\"status\">\n         <div class=\"opty-tooltip-hidden content__Element-sc-f4e6l7-0 fNcWJv\">\n            <div class=\"content__Inner-sc-f4e6l7-1 gyZAs\">\n               <p class=\"text__Text-sc-1u9gciq-0 fKjIJr\">This is where the activation copy is going to go...<!--?xml version=\"1.0\" encoding=\"UTF-8\"?-->\n               </p>\n            </div>\n         </div>\n      </div>\n   </div>\n</div>", "selector": "[class*=\"text__Text\"]", "dependencies": [], "operator": "append", "type": "append", "id": "F0307B16-1C34-4E9C-B7A1-2F01D2C5CFC7"}]}], "name": "Variation #1 - IGNORE"}, {"id": "20996173552", "actions": [{"viewId": "21024280531", "changes": [{"dependencies": [], "type": "custom_code", "id": "5A31D67F-EBC8-4DAF-8C5F-38F23E4AF781", "value": function($){let utils = window["optimizely"].get("utils");

var tooltipHtml = '<span id="opty-new-tooltip" class="preview__LivePreviewContainer-sc-11yuwww-1 QLFDZ"> <span class="opty-popover popover__Wrapper-sc-1w5xlen-0 bSuoRt"> <svg class="opty-svg" width="20px" height="20px" viewBox="0 0 30 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>linear-info</title> <desc>Created with Sketch.</desc> <g id="linear-info" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M16,0 C24.836,0 32,7.164 32,16 C32,24.836 24.836,32 16,32 C7.164,32 0,24.836 0,16 C0,7.164 7.164,0 16,0 Z M16,2 C8.28,2 2,8.28 2,16 C2,23.72 8.28,30 16,30 C23.72,30 30,23.72 30,16 C30,8.28 23.72,2 16,2 Z M15.9975,12.3672 C16.2548333,12.3672 16.5126111,12.3774222 16.7693519,12.4008296 L17.1535,12.4462 L17.1535,24.6672 C17.1535,25.8287385 15.7315325,25.6496704 14.9082864,25.5319431 L14.8125,25.5182 L14.8125,13.2972 C14.8125,12.5602 15.3555,12.3672 15.9975,12.3672 Z M16.0112,6.1567 C16.9782,6.1567 17.7612,6.9397 17.7612,7.9067 C17.7612,8.8727 16.9782,9.6567 16.0112,9.6567 C15.0452,9.6567 14.2612,8.8727 14.2612,7.9067 C14.2612,6.9397 15.0452,6.1567 16.0112,6.1567 Z" id="Icon" fill="#000000"></path> </g> </svg> <div role="status"> <div class="opty-tooltip-hidden content__Element-sc-f4e6l7-0 fNcWJv"> <div class="content__Inner-sc-f4e6l7-1 gyZAs"> <p class="text__Text-sc-1u9gciq-0 fKjIJr">Enter the 6-digit code that’s showing on your TV screen.</p></div></div></div></span></span>';

function showHide(){
    if (document.querySelector("span .opty-tooltip-hidden")) {
      document.querySelector(".opty-tooltip-hidden").classList.add("opty-tooltip-shown");
    	document.querySelector(".opty-tooltip-hidden").classList.remove("opty-tooltip-hidden");
    }
    
    else {
      document.querySelector(".opty-tooltip-shown").classList.add("opty-tooltip-hidden");
    	document.querySelector(".opty-tooltip-shown").classList.remove("opty-tooltip-shown");
    }
}
utils.observeSelector('#app >   [class^="box__Box"]  >  [class^="box__Box"]   >  [class^="box__Box"] > p ', function(p) {
if(document.querySelector('#opty-new-tooltip')){ 
  document.querySelector('#opty-new-tooltip').remove();  
}
p.innerHTML =  p.innerHTML + tooltipHtml;
var optySpan = document.querySelector('#opty-new-tooltip');  
  if(optySpan){
  document.querySelector(".opty-popover").removeEventListener('click',showHide);
  document.querySelector(".opty-popover").addEventListener('click',showHide);
  }
  
});
}}, {"value": "<style>.opty-svg {\n    vertical-align: middle;\n}\n\n.opty-svg:hover {\n  cursor:pointer;\n}\n\n.opty-tooltip-hidden {\n display:none; \n}\n\n.opty-tooltip-shown {\n display:block; \n}\n\n.preview__LivePreviewContainer-sc-11yuwww-1.QLFDZ {\n  -webkit-font-smoothing: antialiased;\n  text-size-adjust: 100%;\n  color: rgb(77, 77, 77);\n  font-family: \"Sky Text\", sans-serif;\n  font-size: 18px;\n  line-height: 1.5;\n  list-style: none;\n  box-sizing: border-box;\n  -webkit-box-align: center;\n  align-items: center;\n  \n  flex-direction: column;\n  flex: 1 1 auto;\n  -webkit-box-pack: center;\n  justify-content: center;\n  \n  position: relative;\n}\n\n.popover__Wrapper-sc-1w5xlen-0.bSuoRt {\n  -webkit-font-smoothing: antialiased;\n  text-size-adjust: 100%;\n  color: rgb(77, 77, 77);\n  font-family: \"Sky Text\", sans-serif;\n  font-size: 18px;\n  line-height: 1.5;\n  list-style: none;\n  box-sizing: border-box;\n  position: relative;\n}\n\n.button__Button-sc-t5gfjf-0.fAeVZo {\n-webkit-font-smoothing: antialiased;\ntext-size-adjust: 100%;\nlist-style: none;\nbox-sizing: border-box;\nfont: inherit;\n-webkit-box-align: center;\nalign-items: center;\nbackground-color: transparent;\nborder-radius: 4px;\nborder: 1px solid transparent;\ncursor: pointer;\ndisplay: inline-flex;\nflex-shrink: 0;\nfont-weight: bold;\n-webkit-box-pack: center;\njustify-content: center;\nline-height: 24px;\noutline: none;\nposition: relative;\ntext-align: center;\ntransition-duration: 300ms;\ntransition-property: background, color, box-shadow;\ntransition-timing-function: ease;\ncolor: rgb(0, 15, 245);\nfont-size: 18px;\npadding: 8px 16px;\n}\n\n.fAeVZo::after {\n    content: \"\";\n    border: 2px solid rgb(0, 160, 255);\n    border-radius: 8px;\n    inset: -5px;\n    opacity: 0;\n    pointer-events: none;\n    position: absolute;\n    transition: opacity 150ms linear 0s;\n}\n\n.content__Element-sc-f4e6l7-0.fNcWJv {\n-webkit-font-smoothing: antialiased;\ntext-size-adjust: 100%;\ncolor: rgb(77, 77, 77);\nfont-family: \"Sky Text\", sans-serif;\nfont-size: 18px;\nline-height: 1.5;\nlist-style: none;\nbox-sizing: border-box;\nposition: absolute;\ntop: 130%;\nz-index: 10;\nright:-5px;\nmargin: 0px auto;\nmax-width: 30ch;\n}\n\n.fNcWJv::before, .fNcWJv::after {\n    left: 74%;\n}\n\n.fNcWJv::before, .fNcWJv::after {\n    content: \"\";\n    height: 16px;\n    position: absolute;\n    top: -8px;\n    transform: rotate(\n45deg);\n    width: 16px;\n}\n\n.fNcWJv::before {\n    box-shadow: rgb(0 0 0 / 20%) 0px 6px 20px 0px;\n    z-index: -1;\n}\n\n.content__Inner-sc-f4e6l7-1.gyZAs {\n-webkit-font-smoothing: antialiased;\ntext-size-adjust: 100%;\ncolor: rgb(77, 77, 77);\nfont-family: \"Sky Text\", sans-serif;\nlist-style: none;\nbox-sizing: border-box;\nbackground-color: rgb(255, 255, 255);\nborder-radius: 4px;\nbox-shadow: rgba(0, 0, 0, 0.2) 0px 6px 20px 0px;\npadding: 12px 16px;\nz-index: 10;\nfont-size: 16px;\nline-height: 20px;\n  min-width:fit-content;\n}\n\n.text__Text-sc-1u9gciq-0.fKjIJr {\n-webkit-font-smoothing: antialiased;\ntext-size-adjust: 100%;\nfont-family: \"Sky Text\", sans-serif;\nlist-style: none;\nfont-size: 16px;\nline-height: 20px;\nbox-sizing: border-box;\nfont-weight: normal;\nmargin: 0px;\ncolor: inherit;\n}\n\n.fNcWJv::after {\n    left: 74%;\n}\n\n.fNcWJv::before, .fNcWJv::after {\n    content: \"\";\n    height: 16px;\n    position: absolute;\n    top: -8px;\n    transform: rotate(\n45deg);\n    width: 16px;\n}\n\n.fNcWJv::after {\n    background-color: rgb(255, 255, 255);\n    z-index: 1;\n}\n\n\n.opty-tooltip-shown{\n\n  right: -42px !important;\n  top: 150% !important;\n}\n\n.opty-tooltip-shown [class^=\"content__Inner\"]{\n\n  min-width: 230px ;\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "263E82D1-7FA5-47FC-B086-D34FFA38C475"}]}], "name": "Variation #1 (1)"}], "audienceIds": null, "changes": null, "id": "21033500911", "integrationSettings": null}], "id": "21027860311", "weightDistributions": null, "name": "325: Glass - Add Tooltip to Activate Page", "groupId": null, "commitId": "22176350859", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["21569670495"], "experiments": [{"weightDistributions": [{"entityId": "21551801102", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "Contextual CTA Broadband Test", "bucketingStrategy": null, "variations": [{"id": "21548640782", "actions": [], "name": "Original"}, {"id": "21551801102", "actions": [{"viewId": "21569670495", "changes": [{"dependencies": [], "type": "custom_code", "id": "3756F432-C555-439E-B39C-C9DA8DD855EA", "value": function($){console.log('Broadband_CTA');

var utils = window["optimizely"].get('utils');

setTimeout(function () {
  
  utils.observeSelector('.hUden', function(footerElement) {
  document.querySelectorAll('[data-tracking-label="broadband-continue-without-broadband"]')[0].innerText = "No, I'm happy with my current broadband"; });
  
  utils.observeSelector('.jMTVFb', function(footerElement) {
     document.getElementsByClassName('jMTVFb')[0].innerText = 'Enter your postcode';
     });

}, 1000);
}}, {"value": "<style>.hUden[data-test-id=\"broadband-next-action-button\"] {\n    background-color: rgb(255, 255, 255)!important;\n  \tborder: 1px solid rgb(0, 15, 245)!important;\n}\n\n.hUden[data-test-id=\"broadband-next-action-button\"]:not(:disabled):hover{\n    background-color: rgb(240, 241, 255)!important;\n}\n\n.cvAzRV {\n\t\ttext-align: center!important;\n}\n\n@media (min-width: 800px) {\n  .dkVbeH {\n      font-size: 70px!important;\n      line-height: 80px!important;\n  }\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "97C98B1D-0B70-46BD-9D98-6607B2FB167D"}, {"selector": ".gijwMh", "dependencies": [], "attributes": {"html": "Find my address"}, "type": "attribute", "id": "58BDADB3-4B4D-420E-8A55-1E8A064ECB12", "css": {}}, {"selector": ".euuMcv", "dependencies": [], "attributes": {"remove": true}, "type": "attribute", "id": "8A841D77-7679-4E84-BC00-56C587CA3103", "css": {}}, {"selector": ".dkVbeH", "dependencies": [], "attributes": {"html": "Want to see your Sky Broadband deals?"}, "type": "attribute", "id": "8BB0EDC2-075D-418C-93EE-F11123DD3CC3", "css": {}}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "21552140746", "integrationSettings": null}], "id": "21528361682", "weightDistributions": null, "name": "Contextual CTA Broadband Test", "groupId": null, "commitId": "21766020664", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["21610410599", "22045007557"], "experiments": [{"weightDistributions": [{"entityId": "21656080033", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "398: Glass - Future Bill List Add Key Actions", "bucketingStrategy": null, "variations": [{"id": "21581711043", "actions": [{"viewId": "21610410599", "changes": [{"dependencies": [], "type": "custom_code", "id": "9229893E-DCC0-410B-8678-AE7BD79A1964", "value": function($){var utils = window.optimizely.get('utils');

utils.observeSelector('[class^="FutureBills__FutureBillsWrapper"]', function() {
   targetEvar({
dataLayer:s_c_il,
val:'398: Glass - Future Bill List Add Key Actions (REAL)>Original'
   });  
});
}}]}], "name": "Original"}, {"id": "21597230747", "actions": [{"viewId": "21610410599", "changes": [{"dependencies": [], "type": "custom_code", "id": "8A40E2F9-1B1E-44FB-ABF8-0D3E9CEFFC5E", "value": function($){var utils = window.optimizely.get('utils');



var html = '<ul class="opty-itTwkV u-hidden-print" id="opty-new-ui"> <li class="opty-jLxbGt"> <a id="opty-make-p-link" href="/bill/glass/make-payment" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Make a payment </span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li><li class="opty-jLxbGt"> <a href="/bill/glass/change-payment-due-date" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Change payment date</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li><li class="opty-jLxbGt"> <a href="/bill/glass/change-payment-method" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Change payment method</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li></ul>';
/*
<li class="opty-jLxbGt"> <a class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv"><span class="PDFLink__PDFLinkText-sc-123rr4z-0 fxjNY">Download bill PDF</span></span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li><li class="opty-jLxbGt"> <a href="/bill/glass/credit-agreements" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">View your CCA agreements</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li>
*/
utils.observeSelector('[class^="FutureBills__FutureBillsWrapper"]', function(futureC) {
if(!document.querySelector('#opty-new-ui')){
futureC.insertAdjacentHTML('afterend',html);  
}
   targetEvar({
dataLayer:s_c_il,
val:'398: Glass - Future Bill List Add Key Actions (REAL)>Variation #1'
   });  
});
utils.observeSelector('[class^="PreviousBills__PreviousBillsWrapper-"] ', function() {
if(document.querySelector('#opty-new-ui')){
document.querySelector('#opty-new-ui').remove();
}
});
utils.observeSelector('[data-test-id="payment-summary-table"] ', function() {
if(document.querySelector('#opty-new-ui')){
document.querySelector('#opty-new-ui').remove();
}
});
}}, {"value": "<style>.opty-itTwkV{\n    -webkit-columns: 1;\n    columns: 1;\n    list-style: none !important;\n    margin-left: 0;\n    padding: 16px;\n    font-size: 20px;\n    line-height: 24px;\n}\n\n.opty-itTwkV *{\nfont-size: 20px;\nline-height: 24px;\n}\n\n.opty-jLxbGt{\nmargin: 0 auto 4px;\n    padding: 0px 12px;\n    margin-bottom: 8px;\n}\n\n.opty-gPxSsN{\ncolor: #000FF5;\n}\n\n.opty-kgONWJ{\ndisplay: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-align-items: center;\n    -webkit-box-align: center;\n    -ms-flex-align: center;\n    align-items: center;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n    -ms-flex-pack: justify;\n    justify-content: space-between;\n    width: 100%;\n}\n\n.opty-fXPYjv{\n    -webkit-flex-shrink: 1;\n    -ms-flex-negative: 1;\n    flex-shrink: 1;\n    -webkit-flex-basis: auto;\n    -ms-flex-preferred-size: auto;\n    flex-basis: auto;\n}\n\n.opty-evQkBI{\nfill: currentColor;\n    -webkit-flex: none;\n    -ms-flex: none;\n    flex: none;\n    height: 32px;\n    width: 32px;\n}\n#opty-new-note{\nmargin-top: 10px;\n}\n@media (min-width: 640px){\n.opty-itTwkV{\n-webkit-columns: 2;\ncolumns: 2;\n}\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "88F88F2C-048D-4C06-B6B8-65AF76C74ED6"}]}], "name": "Variation #1"}, {"id": "21656080033", "actions": [{"viewId": "21610410599", "changes": [{"dependencies": [], "type": "custom_code", "id": "4B3171E2-85CF-4B9E-8C28-BD0702298368", "value": function($){var utils = window.optimizely.get('utils');

var html = '<ul class="opty-itTwkV u-hidden-print" id="opty-new-ui"> <li class="opty-jLxbGt"> <a id="opty-make-p-link" href="/bill/glass/make-payment" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Make a payment </span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li><li class="opty-jLxbGt"> <a href="/bill/glass/change-payment-due-date" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Change payment date</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li><li class="opty-jLxbGt"> <a href="/bill/glass/change-payment-method" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Change payment method</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li></ul>';

utils.observeSelector('#opty-listadd-wrapper', function(futureC) {
if(!document.querySelector('#opty-new-ui')){
futureC.insertAdjacentHTML('afterbegin',html);
}
     targetEvar({
dataLayer:s_c_il,
val:'398: Glass - Future Bill List Add Key Actions (REAL)>Variation #2'
   });  
});



utils.observeSelector('[class ^="BillLinks__List-"] [href ="/bill/glass/make-payment"]', function(linkCtr) {
linkCtr.addEventListener('click',function(){
document.cookie = "opty-new-journey= ; expires = Thu, 01 Jan 1970 00:00:00 GMT;path=/";
});
});

utils.observeSelector('#opty-make-p-link', function(link) {
link.addEventListener('click',function(){
document.cookie = "opty-new-journey=make-Payment;path=/;";
});
});
}}, {"value": "<style>.opty-itTwkV{\n    -webkit-columns: 1;\n    columns: 1;\n    list-style: none !important;\n    margin-left: 0;\n    padding: 16px;\n    font-size: 20px;\n    line-height: 24px;\n}\n\n.opty-itTwkV *{\nfont-size: 20px;\nline-height: 24px;\n}\n\n.opty-jLxbGt{\nmargin: 0 auto 4px;\n    padding: 0px 12px;\n    margin-bottom: 8px;\n}\n\n.opty-gPxSsN{\ncolor: #000FF5;\n}\n\n.opty-kgONWJ{\ndisplay: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-align-items: center;\n    -webkit-box-align: center;\n    -ms-flex-align: center;\n    align-items: center;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n    -ms-flex-pack: justify;\n    justify-content: space-between;\n    width: 100%;\n}\n\n.opty-fXPYjv{\n    -webkit-flex-shrink: 1;\n    -ms-flex-negative: 1;\n    flex-shrink: 1;\n    -webkit-flex-basis: auto;\n    -ms-flex-preferred-size: auto;\n    flex-basis: auto;\n}\n\n.opty-evQkBI{\nfill: currentColor;\n    -webkit-flex: none;\n    -ms-flex: none;\n    flex: none;\n    height: 32px;\n    width: 32px;\n}\n#opty-new-note{\nmargin-top: 10px;\n}\n@media (min-width: 640px){\n.opty-itTwkV{\n-webkit-columns: 2;\ncolumns: 2;\n}\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "8CC14844-D5A3-488F-B91A-C36F99D651F5"}, {"value": "<div id=\"opty-listadd-wrapper\"></div>", "selector": "[class^=\"FutureBills__FutureBillsWrapper\"]", "dependencies": [], "operator": "after", "type": "append", "id": "0B110137-407B-4E07-94CA-EC4AE4BEA4AF"}]}, {"viewId": "22045007557", "changes": [{"dependencies": [], "type": "custom_code", "id": "F2D73823-0B5C-4673-90AC-FC981A389730", "value": function($){var utils = window.optimizely.get('utils');

 var _getCookie = function(name) {
   var match = document.cookie.match(name+'=([^;]*)');
   return match ? match[1] : undefined;
 };

utils.observeSelector('[class^="ManagePayments__ManagePaymentsContentWrapper"] [class *= "InlineNotification__InlineNotificationWrapper"] [class ^="text__Text-sc"]', function(txt) {
if(document.location.pathname.indexOf('/streaming-tv/make-payment') > -1 && _getCookie('opty-new-journey')){
  if(!document.querySelector('#opty-new-note')){
txt.innerHTML = txt.innerHTML + '<p id="opty-new-note"><strong>Please note:</strong> Any payments you make today will apply to your latest bill only.</p>';
}
  
}  

});
}}]}], "name": "Variation #2"}], "audienceIds": null, "changes": null, "id": "21607080929", "integrationSettings": null}], "id": "21564790640", "weightDistributions": null, "name": "398: Glass - Future Bill List Add Key Actions", "groupId": null, "commitId": "22191241620", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"dependencies": [], "type": "custom_code", "id": "09D80D0F-8484-4D2A-AC2F-EC2063E34751", "value": function($){window.targetEvar = function(options) {  
            options.dataLayer.map(function(s) {  
                if (typeof s.tl !== 'undefined') { 
                    s.linkTrackVars = 'eVar18'; 
                    s.linkTrackEvents = ''; 
                    s.eVar18 = options.val;  
                    s.tl(true, 'o', 'page load');  
                } 
            }); 
          };
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["21783361616", "21792710185"], "experiments": [{"weightDistributions": [{"entityId": "21774301230", "endOfRange": 9500}, {"entityId": "21777751923", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "408-adding-dropdown-to-help", "bucketingStrategy": null, "variations": [{"id": "21774301230", "actions": [{"viewId": "21792710185", "changes": [{"dependencies": [], "type": "custom_code", "id": "D3DA30DB-A5A8-4F8D-B445-1904EDC1BEDC", "value": function($){document.cookie="opty-masthead-408-variation=original;path=/;";

window['optimizely'] = window['optimizely'] || [];
window['optimizely'].push({
  type: "page",
  pageName: "8156242263_url_targeting_for_408addingdropdowntohelp"
});
}}]}], "name": "Original"}, {"id": "21777751923", "actions": [{"viewId": "21783361616", "changes": [{"dependencies": [], "type": "custom_code", "id": "D27A10BC-F0CF-4B90-8B90-2472EC0EE62A", "value": function($){var utils = window.optimizely.get('utils');
function updateClosedMenu(){ 
  if(document.querySelector('.footer-wrapper .help-nav-wrapper .nav-item-group.active button.tab-focus')){ 
  document.querySelector('.footer-wrapper .help-nav-wrapper .nav-item-group').classList.remove('active');
document.querySelector('.footer-wrapper .help-nav-wrapper .nav-item-group button.tab-focus').setAttribute('aria-label','Open Help menu');
 document.querySelector('.footer-wrapper .help-nav-wrapper .nav-item-group button.tab-focus').setAttribute('data-tracking-label','masthead_open_help_menu');     
     }
}

function updateOpenedMenu(){

  //close others
     if(document.querySelector('.scrollable-wrapper  .nav-wrapper .primary-nav-list li.nav-item > div.active button.tab-focus')){
  document.querySelector('.scrollable-wrapper  .nav-wrapper .primary-nav-list li.nav-item > div.active button.tab-focus').click();
  }
 if(document.querySelector('.search-wrapper #masthead-search-toggle[aria-label="Close Search"]')){
 document.querySelector('.search-wrapper #masthead-search-toggle[aria-label="Close Search"]').click();
 }
   if(document.querySelector('#masthead-alerts-toggle[aria-label="Close alerts"]')){
 document.querySelector('#masthead-alerts-toggle[aria-label="Close alerts"]').click();
 }

  
  
  if(document.querySelector('.footer-wrapper .help-nav-wrapper .nav-item-group:not(.active) button.tab-focus')){
  document.querySelector('.footer-wrapper .help-nav-wrapper .nav-item-group').classList.add('active');
document.querySelector('.footer-wrapper .help-nav-wrapper .nav-item-group button.tab-focus').setAttribute('aria-label','Close Help menu');
 document.querySelector('.footer-wrapper .help-nav-wrapper .nav-item-group button.tab-focus').setAttribute('data-tracking-label','masthead_close_help_menu');     
     }

}
function init(){
!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?n(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.CcxUtils=function(){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.name=e}return n=t,(i=[{key:"domReady",value:function(e){"loading"!==document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",(function(){"loading"!==document.readyState&&e()}))}},{key:"cleanUp",value:function(){window.ccx[this.name]&&((window.ccx[this.name].observers||[]).forEach((function(e){return e()})),(window.ccx[this.name].mutationObservers||[]).forEach((function(e){return e.disconnect()})))}},{key:"runScript",value:function(e){window.ccx=window.ccx||{},this.cleanUp(),window.ccx[this.name]=e,window.ccx[this.name]()}},{key:"createElementFromHTML",value:function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}},{key:"observeSelector",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"optimizely";if("optimizely"===i)window.ccx[this.name]=r(r({},window.ccx[this.name]),{},{observers:[].concat(o(window.ccx[this.name].observers||[]),[optimizely.get("utils").observeSelector(e,t,n)])});else{var c=new MutationObserver(t);c.observe(document.querySelector(e),n),window.ccx[this.name]=r(r({},window.ccx[this.name]),{},{mutationObservers:[].concat(o(window.ccx[this.name].mutationObservers||[]),[c])})}}},{key:"setCookie",value:function(e,t,n){var r="";if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),r="; expires=".concat(o.toUTCString())}document.cookie="".concat(e,"=").concat(t||"").concat(r,"; path=/")}},{key:"getCookie",value:function(e){var t=document.cookie.split(";").map((function(e){return e.split("=")})).find((function(t){return t[0]===e}));return void 0!==t?t[1]:null}},{key:"waitForElement",value:function(e){return function(){return window.optimizely.get("utils").waitForElement(e)}}},{key:"reactSelector",value:function(e){var t=document.querySelector(e);if(!t)return null;var n,r,o=Object.keys(t).find((function(e){return-1!==e.indexOf("Instance")}));return o?{instance:(n="string"==typeof t[o].elementType?(r=t[o].memoizedProps.children)._owner||r[0]._owner:t[o]).stateNode,Component:n.elementType,domElement:t,children:r}:null}},{key:"insertAfter",value:function(e,t){t.parentNode.insertBefore(e,t.nextSibling)}},{key:"insertBefore",value:function(e,t){t.parentNode.insertBefore(e,t)}},{key:"waitFor",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){document.querySelectorAll(e).length<e.length?setTimeout(waitFor.bind(null,e,t),200):t()}))}])&&e(n.prototype,i),t;var n,i}()}();
!function(){"use strict";!function(a,e){void 0===e&&(e={});var t=e.insertAt;if("undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css","top"===t&&n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l),l.styleSheet?l.styleSheet.cssText=a:l.appendChild(document.createTextNode(a))}}("@media (min-width:75em){.footer-wrapper .extra-link-wrapper:last-child .nav-item.svelte-1fn4u5b:first-child{margin-left:0}}.footer-wrapper .help-nav-wrapper .secondary-nav-list{justify-content:flex-end}.footer-wrapper .help-nav-wrapper .secondary-nav-list .secondary-nav-item:last-child a{padding-right:0}.extra-link-wrapper:last-child .extra-nav-link{display:none}");var a=new window.CcxUtils("sky-408");a.runScript((function(){!function(){var e=document.querySelector(".footer-wrapper .extra-link-wrapper:last-child");if(!document.querySelector(".help-nav-wrapper")){var t=a.createElementFromHTML('\n   <div class="nav-wrapper help-nav-wrapper svelte-9oi38x">\n    <nav aria-label="primary" data-test-id="nav">\n      <ul class="primary-nav-list svelte-it2p1o" data-test-id="primary-nav-list">\n        <li class="nav-item primary-nav-item svelte-1fn4u5b" data-test-id="nav-item">\n          <div class="nav-item-group svelte-1t1ezmk" data-test-id="nav-item-group">\n            <div class="nav-item-group-ctas svelte-1t1ezmk">\n                <a href="https://www.sky.com/help/home" class="nav-item-link nav-link tab-focus primary-nav-link svelte-snrkiz" aria-label="" data-test-id="nav-item-link" data-tracking-label="masthead_visit_primary_help_link">\n                  Help\n                </a> \n                <button class="button tab-focus nav-toggle svelte-1t1ezmk" aria-label="Open Help menu" id="primary-help" aria-expanded="false" data-tracking-label="masthead_open_help_menu">\n                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" class="arrow" data-test-id="up-down-arrow" aria-hidden="true"><g class="linear-arrow-up"><path d="M15.513 10.274L5.249 20.54c-.162.165-.241.332-.249.53 0 .453.785 1.058 1.033 1.262l.137.112 10.003-10.003 10.003 10.003.137-.112c.248-.204 1.033-.809 1.033-1.262-.008-.198-.087-.365-.248-.53L16.834 10.274a.931.931 0 00-1.321 0z"></path></g><g class="linear-arrow-down"><path d="M16.174 20.002L6.171 10a6.52 6.52 0 00-.138.11C5.786 10.316 5 10.92 5 11.372a.777.777 0 00.249.53L15.513 22.17a.934.934 0 001.321 0l10.264-10.268a.763.763 0 00.248-.53c0-.452-.784-1.056-1.033-1.262a4.806 4.806 0 00-.136-.11L16.174 20.002z"></path></g></svg>\n                </button>\n               </div>\n              <div class="secondary-nav-wrapper svelte-1t1ezmk">\n                <ul class="secondary-nav-list svelte-1t1ezmk" data-test-id="secondary-nav-list">\n                  <li class="secondary-nav-item svelte-1t1ezmk">\n                    <a href="https://www.sky.com/help/home" class="nav-item-link nav-link tab-focus secondary-nav-link svelte-snrkiz" aria-label="" data-test-id="nav-item-link" data-tracking-label="masthead_visit_secondary_other_link">\n                    Other</a>\n                  </li>\n                  <li class="secondary-nav-item svelte-1t1ezmk">\n                    <a href="https://www.sky.com/help/home/sky-vip" class="nav-item-link nav-link tab-focus secondary-nav-link svelte-snrkiz" aria-label="" data-test-id="nav-item-link" data-tracking-label="masthead_visit_secondary_vip_link">\n                    VIP</a>\n                  </li>\n                  <li class="secondary-nav-item svelte-1t1ezmk">\n                    <a href="https://www.sky.com/help/home/sky-talk" class="nav-item-link nav-link tab-focus secondary-nav-link svelte-snrkiz" aria-label="" data-test-id="nav-item-link" data-tracking-label="masthead_visit_secondary_talk_link">\n                    Talk</a>\n                  </li>\n                  <li class="secondary-nav-item svelte-1t1ezmk">\n                    <a href="https://www.sky.com/help/home/sky-mobile" class="nav-item-link nav-link tab-focus secondary-nav-link svelte-snrkiz" aria-label="" data-test-id="nav-item-link" data-tracking-label="masthead_visit_secondary_mobile_link">\n                    Mobile</a>\n                  </li>\n                  <li class="secondary-nav-item svelte-1t1ezmk">\n                    <a href="https://www.sky.com/help/home/sky-tv" class="nav-item-link nav-link tab-focus secondary-nav-link svelte-snrkiz" aria-label="" data-test-id="nav-item-link" data-tracking-label="masthead_visit_secondary_tv_link">\n                    TV</a>\n                  </li>\n                  <li class="secondary-nav-item svelte-1t1ezmk">\n                    <a href="https://www.sky.com/help/home/broadband" class="nav-item-link nav-link tab-focus secondary-nav-link svelte-snrkiz" aria-label="" data-test-id="nav-item-link" data-tracking-label="masthead_visit_secondary_broadband_link">\n                    Broadband</a>\n                  </li>\n                  <li class="secondary-nav-item svelte-1t1ezmk">\n                    <a href="https://www.sky.com/help/home/your-account" class="nav-item-link nav-link tab-focus secondary-nav-link svelte-snrkiz" aria-label="" data-test-id="nav-item-link" data-tracking-label="masthead_visit_secondary_myaccount_link">\n                    My Account</a>\n                  </li>\n                </ul> <button class="visually-hidden" data-tracking-label="masthead_close_watch_menu">Close Watch menu</button>\n            </div>\n          </div>\n        </li>\n      </ul>\n    </nav>\n    </div>\n  ');e.appendChild(t)}var n=document.querySelector(".help-nav-wrapper").cloneNode(!0);document.querySelector(".scrollable-wrapper .extra-link-wrapper:last-child").appendChild(n),document.querySelector(".footer-wrapper .help-nav-wrapper .nav-item-group .nav-toggle").addEventListener("click",(function(){if(!this.parentElement.parentElement.classList.contains('active')){
this.setAttribute('aria-label','Close Help menu');
this.setAttribute('data-tracking-label','masthead_close_help_menu');
} document.querySelector(".footer-wrapper .help-nav-wrapper .nav-item-group").classList.toggle("active");
if(this.parentElement.parentElement.classList.contains('active')){
  //activate
  //activate
updateOpenedMenu();
//close others

  //add events

} else {
this.setAttribute('aria-label','Open Help menu');
this.setAttribute('data-tracking-label','masthead_open_help_menu');
}

//document.querySelectorAll('.scrollable-wrapper  .nav-wrapper .primary-nav-list li.nav-item > div').forEach(function(l){
//  l.classList.remove('active');
//  });
  
  })),document.querySelector(".scrollable-wrapper .help-nav-wrapper .nav-item-group .nav-toggle").addEventListener("click",(function(){if(!this.parentElement.parentElement.classList.contains('active')){
this.setAttribute('aria-label','Close Help menu');
this.setAttribute('data-tracking-label','masthead_close_help_menu');
} document.querySelector(".scrollable-wrapper .help-nav-wrapper .nav-item-group").classList.toggle("active");
if(this.parentElement.parentElement.classList.contains('active')){
this.setAttribute('aria-label','Close Help menu');
this.setAttribute('data-tracking-label','masthead_close_help_menu');   
} else {
this.setAttribute('aria-label','Open Help menu');
this.setAttribute('data-tracking-label','masthead_open_help_menu');
}
 }))}()}))}();
}





function addEventsToLeft(){
   if(document.querySelector('[aria-label="Open TV menu"]')){ 
document.querySelector('[aria-label="Open TV menu"]').addEventListener("click",updateClosedMenu);
  }
     if(document.querySelector('[aria-label="Open Broadband menu"]')){
document.querySelector('[aria-label="Open Broadband menu"]').addEventListener("click",updateClosedMenu);
  }
  
       if(document.querySelector('[aria-label="Open Mobile menu"]')){
document.querySelector('[aria-label="Open Mobile menu"]').addEventListener("click",updateClosedMenu);
  }
         if(document.querySelector('[aria-label="Open navigation menu"]')){
document.querySelector('[aria-label="Open navigation menu"]').addEventListener("click",updateClosedMenu);
  }
           if(document.querySelector('[aria-label="Open Watch menu"]')){
document.querySelector('[aria-label="Open Watch menu"]').addEventListener("click",updateClosedMenu);
  }
             if(document.querySelector('[aria-label="Open Glass menu"]')){
document.querySelector('[aria-label="Open Glass menu"]').addEventListener("click",updateClosedMenu);
  }
               if(document.querySelector('[aria-label="Open Sky Q menu"]')){
document.querySelector('[aria-label="Open Sky Q menu"]').addEventListener("click",updateClosedMenu);
  }
                 if(document.querySelector('[aria-label="Open Search"]')){
document.querySelector('[aria-label="Open Search"]').addEventListener("click",updateClosedMenu);
  }
                   if(document.querySelector('[aria-label="Open alerts, you have no alerts"]')){
document.querySelector('[aria-label="Open alerts, you have no alerts"]').addEventListener("click",updateClosedMenu);
  }
  


}
var interval = setInterval(function() {
    if(document.readyState === 'complete') {
        clearInterval(interval);
        init();
addEventsToLeft();
  utils.observeSelector('[aria-label="Open TV menu"]',function () {
addEventsToLeft();
   });   
    }    
}, 200);
setTimeout(function(){
 clearInterval(interval);
},
          10000);
}}]}, {"viewId": "21792710185", "changes": [{"dependencies": [], "type": "custom_code", "id": "9A9D3232-A1F4-4244-8290-DAD9D7A9AB6C", "value": function($){document.cookie="opty-masthead-408-variation=variation1;path=/;";

window['optimizely'] = window['optimizely'] || [];
window['optimizely'].push({
  type: "page",
  pageName: "8156242263_url_targeting_for_408addingdropdowntohelp"
});
}}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "21774231202", "integrationSettings": null}], "id": "21764011316", "weightDistributions": null, "name": "408-adding-dropdown-to-help", "groupId": null, "commitId": "22159811745", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["21863612954"], "experiments": [{"weightDistributions": [{"entityId": "21899120826", "endOfRange": 5000}, {"entityId": "21875911965", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "433: Tripleplay - Future Bill Add Key Actions", "bucketingStrategy": null, "variations": [{"id": "21899120826", "actions": [{"viewId": "21863612954", "changes": [{"dependencies": [], "type": "custom_code", "id": "B04ECD99-F390-4D20-AF34-DB5882D4B618", "value": function($){var utils = window.optimizely.get('utils');

var isFutureUrl = function(){
return document.location.pathname.replace(/\/$/, "") === '/myaccount/bill/future';
}


utils.observeSelector('.c-tabs__content', function(ctnt) {
if(isFutureUrl()){
   targetEvar({
dataLayer:s_c_il,
val:'433: Tripleplay - Future Bill Add Key Actions (REAL)>Original'
   });  
}

    
});
}}]}], "name": "Original"}, {"id": "21875911965", "actions": [{"viewId": "21863612954", "changes": [{"dependencies": [], "type": "custom_code", "id": "E35A6F97-CAE8-4E24-8733-44484C1FF4F1", "value": function($){var utils = window.optimizely.get('utils');

 var _getCookie = function(name) {
   var match = document.cookie.match(name+'=([^;]*)');
   return match ? match[1] : undefined;
 };

var isFutureUrl = function(){
return document.location.pathname.replace(/\/$/, "") === '/myaccount/bill/future';
}

function addUI(html){
  if(!document.querySelector('#opty-new-ui')){
document.querySelector('.c-tabs__content').insertAdjacentHTML('beforeend',html);
}
}
function removeUI(){
if(document.querySelector('#opty-new-ui')){
document.querySelector('#opty-new-ui').remove();
}
}

var html = '<div id="opty-new-ui"><hr class="c-divider" style="margin-top:20px;" /><ul role="presentation" style="margin-top:30px;" class="opty-new-links o-list-bare u-hidden-print tripleplay-bill-link-block u-padding-left u-padding-right"><li><a id="opty-make-p-link" class="c-link-external t-tripleplay-bill-payment-link" href="/myaccount/bill/pay">Make a payment</a></li><li><a class="c-link-external  t-tripleplay-bill-paymentdue-link" href="/myaccount/bill/change-payment-date">Change payment date</a></li><li><a class="c-link-external  t-tripleplay-bill-paymentmethod-link" href="/myaccount/bill/change-payment-method">Change payment method</a></li></ul></div>';

var utils = window.optimizely.get('utils');
utils.observeSelector('[data-test-id="previous-tab-button"]', function(pastB) {
  pastB.addEventListener('click', function(){
  removeUI();
  });
  });

utils.observeSelector('[data-test-id="latest-tab-button"]', function(currentB) {
  currentB.addEventListener('click', function(){
  removeUI();
  });
});
/*
//.t-bill-range
utils.observeSelector('p.u-margin-bottom-none.u-text-bold.u-text-center', function(tRange) { console.log('___________________ trange');
if(document.location.pathname.indexOf('/future/2022-') > -1){
  if(document.querySelector('p.u-margin-bottom-none.u-text-bold.u-text-center') && document.querySelector('p.u-margin-bottom-none.u-text-bold.u-text-center').innerText == 'Future bill estimate')
  console.log('___________________ if');
utils.observeSelector('[data-test-id="future-tab-button"]', function(futureB) { console.log('___________________ obs range');
    futureB.addEventListener('click', function(){ console.log('___________________ click range');
addUI(html);
  });

});
}
});
*/

utils.observeSelector('[data-test-id="future-tab-button"]', function(futureB) {
    futureB.addEventListener('click', function(){
addUI(html);
  });

});







utils.observeSelector('.c-tabs__content', function(ctnt) {
if(isFutureUrl() && !document.querySelector('#opty-new-ui')){
  ctnt.insertAdjacentHTML('beforeend',html);
   targetEvar({
dataLayer:s_c_il,
val:'433: Tripleplay - Future Bill Add Key Actions (REAL)>Variation #1'
   });  
}

    
});


utils.observeSelector('[href ="/myaccount/bill/pay"]:not(#opty-make-p-link)', function(linkCtr) {
linkCtr.addEventListener('click',function(){
document.cookie = "opty-new-journey=make-payment ; expires = Thu, 01 Jan 1970 00:00:00 GMT;path=/";
});
});



utils.observeSelector('#opty-make-p-link', function(link) {
link.addEventListener('click',function(){
document.cookie = "opty-new-journey=make-payment;path=/;";
});
});


utils.observeSelector('h2.c-heading-charlie[aria-label="Make a payment"]', function(txt) {
if(document.location.pathname.indexOf('/myaccount/bill/pay') > -1 && _getCookie('opty-new-journey')){
  if(!document.querySelector('#opty-new-note')){
    txt.insertAdjacentHTML('afterend','<p id="opty-new-note" class="u-padding-left u-padding-right"><strong>Please note:</strong> Any payments you make today will apply to your latest bill only.</p>');
}
  
}  

});
}}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "21882460266", "integrationSettings": null}], "id": "21869572866", "weightDistributions": null, "name": "433: Tripleplay - Future Bill Add Key Actions", "groupId": null, "commitId": "21946650360", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"dependencies": [], "type": "custom_code", "id": "2AB85F95-9AA7-4277-A442-9B17CD30061F", "value": function($){window.targetEvar = function(options) {  
            options.dataLayer.map(function(s) {  
                if (typeof s.tl !== 'undefined') { 
                    s.linkTrackVars = 'eVar18'; 
                    s.linkTrackEvents = ''; 
                    s.eVar18 = options.val;  
                    s.tl(true, 'o', 'page load');  
                } 
            }); 
          };
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["21851217303"], "experiments": [{"weightDistributions": [{"entityId": "21818855420", "endOfRange": 5000}, {"entityId": "21834716978", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "AC - Change link on 'Create Sky Id' button", "bucketingStrategy": null, "variations": [{"id": "21818855420", "actions": [], "name": "Original"}, {"id": "21834716978", "actions": [{"viewId": "21851217303", "changes": [{"selector": ".c-btn.c-btn--secondary[aria-label=\"Create a Sky iD\"]", "dependencies": [], "attributes": {"href": "https://skyid.sky.com/signup/skycomlinked"}, "type": "attribute", "id": "11171AA8-6F13-43EA-BDE7-16F00642D82C", "css": {}}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "21837477026", "integrationSettings": null}], "id": "21874492014", "weightDistributions": null, "name": "AC - Change link on 'Create Sky Id' button", "groupId": null, "commitId": "22083211861", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["21902410416"], "experiments": [{"weightDistributions": [{"entityId": "21931110464", "endOfRange": 5000}, {"entityId": "21902280790", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "434: Mobile Bill - Future Bill Add Key Actions", "bucketingStrategy": null, "variations": [{"id": "21931110464", "actions": [{"viewId": "21902410416", "changes": [{"dependencies": [], "type": "custom_code", "id": "bcd227e8e67e42bc873f98c37af090f5", "value": function($){var utils = window.optimizely.get('utils');

var isFutureUrl = function(){
return document.location.pathname.replace(/\/$/, "") === '/mobile-bill/future';
}


utils.observeSelector('.c-tabs__content', function(ctnt) {
if(isFutureUrl()){
   targetEvar({
dataLayer:s_c_il,
val:'434: Mobile Bill - Future Bill Add Key Actions (REAL)>Original'
   });  
}

    
});
}}]}], "name": "Original"}, {"id": "21902280790", "actions": [{"viewId": "21902410416", "changes": [{"dependencies": [], "type": "custom_code", "id": "63f6783f0d784444ad5b6b578b21b9b7", "value": function($){var utils = window.optimizely.get('utils');

 var _getCookie = function(name) {
   var match = document.cookie.match(name+'=([^;]*)');
   return match ? match[1] : undefined;
 };

var isFutureUrl = function(){
return document.location.pathname.replace(/\/$/, "") === '/mobile-bill/future';
};

function addUI(html){
  if(!document.querySelector('#opty-new-ui')){
document.querySelector('.c-tabs__content').insertAdjacentHTML('beforeend',html);
}
}
function removeUI(){
if(document.querySelector('#opty-new-ui')){
document.querySelector('#opty-new-ui').remove();
}
}

var html = '<div id="opty-new-ui"><hr class="c-divider" style="margin-top:20px;" /><ul role="presentation" style="margin-top:30px;" class="opty-new-links o-list-bare u-hidden-print tripleplay-bill-link-block u-padding-left u-padding-right"><li><a id="opty-make-p-link" class="c-link-external t-tripleplay-bill-payment-link" href="/mobile-bill/pay">Make a payment</a></li><li><a class="c-link-external  t-tripleplay-bill-paymentdue-link" href="/mobile-bill/change-payment-date">Change payment date</a></li><li><a class="c-link-external  t-tripleplay-bill-paymentmethod-link" href="/mobile-bill/change-payment-method">Change payment method</a></li></ul></div>';

var utils = window.optimizely.get('utils');
utils.observeSelector('[data-test-id="previous-tab-button"]', function(pastB) {
  pastB.addEventListener('click', function(){
  removeUI();
  });
  });

utils.observeSelector('[data-test-id="next-bill-tab-button"]', function(currentB) {
  currentB.addEventListener('click', function(){
  removeUI();
  });
});

utils.observeSelector('[data-test-id="future-tab-button"]', function(futureB) {
    futureB.addEventListener('click', function(){
addUI(html);
  });

});







utils.observeSelector('.c-tabs__content', function(ctnt) {
if(isFutureUrl() && !document.querySelector('#opty-new-ui')){
  ctnt.insertAdjacentHTML('beforeend',html);
   targetEvar({
dataLayer:s_c_il,
val:'434: Mobile Bill - Future Bill Add Key Actions (REAL)>Variation #1'
   });  
}

    
});


utils.observeSelector('[href ="/mobile-bill/pay"]:not(#opty-make-p-link)', function(linkCtr) {
linkCtr.addEventListener('click',function(){
document.cookie = "opty-new-journey=make-payment ; expires = Thu, 01 Jan 1970 00:00:00 GMT;path=/";
});
});



utils.observeSelector('#opty-make-p-link', function(link) {
link.addEventListener('click',function(){
document.cookie = "opty-new-journey=make-payment;path=/;";
});
});


utils.observeSelector('h1.c-heading-charlie', function(txt) {
if(document.location.pathname.indexOf('/mobile-bill/pay') > -1 && _getCookie('opty-new-journey')){
  if(!document.querySelector('#opty-new-note')){
    txt.nextSibling.firstChild.insertAdjacentHTML('beforeend','<p id="opty-new-note" class="u-padding-right"><strong>Please note:</strong> Any payments you make today will apply to your latest bill only.</p>');
}
}  
});
}}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "21916280562", "integrationSettings": null}], "id": "21900840758", "weightDistributions": null, "name": "434: Mobile Bill - Future Bill Add Key Actions", "groupId": null, "commitId": "22170780470", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"dependencies": [], "type": "custom_code", "id": "B76C24F4-B826-486F-B2A0-3B4101125D50", "value": function($){window.targetEvar = function(options) {  
            options.dataLayer.map(function(s) {  
                if (typeof s.tl !== 'undefined') { 
                    s.linkTrackVars = 'eVar18'; 
                    s.linkTrackEvents = ''; 
                    s.eVar18 = options.val;  
                    s.tl(true, 'o', 'page load');  
                } 
            }); 
          };
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["21987690607"], "experiments": [{"weightDistributions": [{"entityId": "21977411270", "endOfRange": 3330}, {"entityId": "21968010980", "endOfRange": 6660}, {"entityId": "22057940995", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "445: Glass bill - future bill CTA on change payment date success", "bucketingStrategy": null, "variations": [{"id": "21977411270", "actions": [], "name": "Original"}, {"id": "21968010980", "actions": [{"viewId": "21987690607", "changes": [{"dependencies": [], "type": "custom_code", "id": "A118BB45-B9E5-4BF3-B329-72C66E3D940C", "value": function($){var utils = window.optimizely.get('utils');
utils.observeSelector('.new-cta-opty-btn', function(btn) {
  btn.addEventListener('click', function(){
location.href="/bill/streaming-tv/future";
  });
});
}}, {"value": "<style>button.new-cta-opty-btn{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0;}\nbutton.new-cta-opty-btn{overflow:visible;}\nbutton.new-cta-opty-btn{text-transform:none;}\nbutton.new-cta-opty-btn{-webkit-appearance:button;}\nbutton.new-cta-opty-btn::-moz-focus-inner{border-style:none;padding:0;}\nbutton.new-cta-opty-btn:-moz-focusring{outline:1px dotted ButtonText;}\nbutton.new-cta-opty-btn{font:inherit;}\n\nbutton.new-cta-opty-btn{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:transparent;border-radius:4px;border:2px solid transparent;cursor:pointer;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-weight:bold;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;line-height:24px;outline:none;position:relative;text-align:center;-webkit-transition-duration:300ms;transition-duration:300ms;-webkit-transition-property:background,color,box-shadow;transition-property:background,color,box-shadow;-webkit-transition-timing-function:ease;transition-timing-function:ease;background-color:#000FF5;background-image:linear-gradient( -1deg,transparent 49%,rgba(255,255,255,0.15) 50%,rgba(225,225,225,0) );color:#FFFFFF;font-size:18px;padding:8px 16px;}\nbutton.new-cta-opty-btn:hover{-webkit-text-decoration:none;text-decoration:none;}\nbutton.new-cta-opty-btn:disabled{background-color:#CCCCCC;background-image:none;border-color:transparent;color:#FFFFFF;cursor:not-allowed;}\nbutton.new-cta-opty-btn::after{border-radius:6px;border:1px solid #0097F5;bottom:-5px;content:'';left:-5px;opacity:0;pointer-events:none;position:absolute;right:-5px;top:-5px;-webkit-transition:opacity 150ms linear;transition:opacity 150ms linear;}\nbutton.new-cta-opty-btn:focus::after{opacity:1;}\nbutton.new-cta-opty-btn{width:152px;}\n\n@media only screen and (min-width: 640px)  {\nbutton.new-cta-opty-btn{  \nmargin-left: 20px;\n}\n}\n\n@media only screen and (max-width: 639px)  {\nbutton.new-cta-opty-btn{  \ndisplay: block;\nmargin-left: auto;\nmargin-right: auto;   \n}\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "93D9DEFB-A4D6-41A8-83DA-75CCC946B1C3"}, {"value": "<button class=\"new-cta-opty-btn\" aria-label=\"View future bill\" data-tracking-label=\"View future bill\">View future bill</button>", "selector": "[data-test-id=\"button-back\" ]", "dependencies": [], "operator": "after", "type": "append", "id": "A0B4F0DC-6F8F-4FA9-AAD7-D5218B1634AE"}, {"selector": "[data-test-id=\"button-back\" ]", "dependencies": [], "attributes": {"style": "width:152px;\ncolor:#fff;\nmargin-left:auto;\nmargin-right:auto;\nmargin-bottom:10px"}, "type": "attribute", "id": "F83BAC3F-9BDB-41B6-87D8-7B24383C9DF3", "css": {}}]}], "name": "Variation #1"}, {"id": "22057940995", "actions": [{"viewId": "21987690607", "changes": [{"value": "<style>/*\n\nbutton.new-cta-opty-btn{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0;}\nbutton.new-cta-opty-btn{overflow:visible;}\nbutton.new-cta-opty-btn{text-transform:none;}\nbutton.new-cta-opty-btn{-webkit-appearance:button;}\nbutton.new-cta-opty-btn::-moz-focus-inner{border-style:none;padding:0;}\nbutton.new-cta-opty-btn:-moz-focusring{outline:1px dotted ButtonText;}\nbutton.new-cta-opty-btn{font:inherit;}\n\nbutton.new-cta-opty-btn{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:transparent;border-radius:4px;border:2px solid transparent;cursor:pointer;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-weight:bold;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;line-height:24px;outline:none;position:relative;text-align:center;-webkit-transition-duration:300ms;transition-duration:300ms;-webkit-transition-property:background,color,box-shadow;transition-property:background,color,box-shadow;-webkit-transition-timing-function:ease;transition-timing-function:ease;background-color:#000FF5;background-image:linear-gradient( -1deg,transparent 49%,rgba(255,255,255,0.15) 50%,rgba(225,225,225,0) );color:#FFFFFF;font-size:18px;padding:8px 16px;}\nbutton.new-cta-opty-btn:hover{-webkit-text-decoration:none;text-decoration:none;}\nbutton.new-cta-opty-btn:disabled{background-color:#CCCCCC;background-image:none;border-color:transparent;color:#FFFFFF;cursor:not-allowed;}\nbutton.new-cta-opty-btn::after{border-radius:6px;border:1px solid #0097F5;bottom:-5px;content:'';left:-5px;opacity:0;pointer-events:none;position:absolute;right:-5px;top:-5px;-webkit-transition:opacity 150ms linear;transition:opacity 150ms linear;}\nbutton.new-cta-opty-btn:focus::after{opacity:1;}\n*/\na.new-cta-opty-btn{width:152px;}\n\n@media only screen and (min-width: 640px)  {\na.new-cta-opty-btn{  \nmargin-left: 20px;\n}\n}\n\n@media only screen and (max-width: 639px)  {\na.new-cta-opty-btn{  \ndisplay: block;\nmargin-left: auto;\nmargin-right: auto;   \n}\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "FC5592DE-23F0-4090-9C61-7CC5E5631FF9"}, {"value": "<a class=\"new-cta-opty-btn\" aria-label=\"View future bill\" data-tracking-label=\"View future bill\" href=\"/bill/streaming-tv/future\">View future bill</a>", "selector": "[data-test-id=\"button-back\" ]", "dependencies": [], "operator": "after", "type": "append", "id": "470340CF-81CD-4656-AEB9-31F6773DBE71"}, {"selector": "[data-test-id=\"button-back\" ]", "dependencies": [], "attributes": {"style": "width:152px;\ncolor:#fff;\nmargin-left:auto;\nmargin-right:auto;\nmargin-bottom:10px"}, "type": "attribute", "id": "EAC554D0-DF9E-494D-A70B-25181DEA630C", "css": {}}]}], "name": "Variation #2"}], "audienceIds": null, "changes": null, "id": "21962211386", "integrationSettings": null}], "id": "22003030683", "weightDistributions": null, "name": "445: Glass bill - future bill CTA on change payment date success", "groupId": null, "commitId": "22193221690", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22024160802", "22030900606", "22063030086"], "experiments": [{"weightDistributions": [{"entityId": "22027252558", "endOfRange": 5000}, {"entityId": "22030351414", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "449: Triple play bill - show next best actions across manage payment journeys", "bucketingStrategy": null, "variations": [{"id": "22027252558", "actions": [{"viewId": "22024160802", "changes": [{"dependencies": [], "type": "custom_code", "id": "334D3661-E4F8-4808-8828-423C97961128", "value": function($){var utils = window.optimizely.get('utils');

utils.observeSelector('.tripleplay-bill-container', function() {
   targetEvar({
dataLayer:s_c_il,
val:'449:Triple play bill - show next best actions across manage payment journeys (REAL)>Original'
   });  
});
}}]}, {"viewId": "22063030086", "changes": [{"dependencies": [], "type": "custom_code", "id": "9C2E267B-8ADD-4D14-9A80-56239985B8F1", "value": function($){var utils = window.optimizely.get('utils');

utils.observeSelector('.tripleplay-bill-container', function() {
   targetEvar({
dataLayer:s_c_il,
val:'449:Triple play bill - show next best actions across manage payment journeys (REAL)>Original'
   });  
});
}}]}, {"viewId": "22030900606", "changes": [{"dependencies": [], "type": "custom_code", "id": "E32CFDE4-9019-45B1-BF36-ABF632DF0B8D", "value": function($){var utils = window.optimizely.get('utils');

utils.observeSelector('.tripleplay-bill-container', function() {
   targetEvar({
dataLayer:s_c_il,
val:'449:Triple play bill - show next best actions across manage payment journeys (REAL)>Original'
   });  
});
}}]}], "name": "Original"}, {"id": "22030351414", "actions": [{"viewId": "22024160802", "changes": [{"dependencies": [], "type": "custom_code", "id": "736580F4-75F6-4A31-BEF0-E1AEA471BEC2", "value": function($){var utils = window.optimizely.get('utils');

var apiCall = window.__449_triple_play_bill_next_best_action.apiCall;
var getHtml = window.__449_triple_play_bill_next_best_action.getHtml;
apiCall();
utils.observeSelector('#opty-container-list', function(optyContainer) {
if(document.querySelector('#opty-new-ui-nextAction')){
document.querySelector('#opty-new-ui-nextAction').remove();
}
 var html =getHtml('makeP');
optyContainer.insertAdjacentHTML('afterbegin',html);  
   targetEvar({
dataLayer:s_c_il,
val:'449:Triple play bill - show next best actions across manage payment journeys (REAL)>Variation #1'
   });  
});
}}, {"value": "<div id=\"opty-container-list\"></div>", "selector": ".tripleplay-bill-container", "dependencies": [], "operator": "after", "type": "append", "id": "176F175E-FE59-45B3-8E42-8478CED5E8CF"}]}, {"viewId": "22063030086", "changes": [{"dependencies": [], "type": "custom_code", "id": "565D5B1F-BBB4-4922-AB07-36EC5CDE3006", "value": function($){var utils = window.optimizely.get('utils');

var apiCall = window.__449_triple_play_bill_next_best_action.apiCall;
var getHtml = window.__449_triple_play_bill_next_best_action.getHtml;
apiCall();

utils.observeSelector('#opty-container-list', function(optyContainer) {
if(document.querySelector('#opty-new-ui-nextAction')){
document.querySelector('#opty-new-ui-nextAction').remove();
}
 var html =getHtml('changePMethod');
optyContainer.insertAdjacentHTML('afterbegin',html);  
   targetEvar({
dataLayer:s_c_il,
val:'449:Triple play bill - show next best actions across manage payment journeys (REAL)>Variation #1'
   });  
});
}}, {"value": "<div id=\"opty-container-list\"></div>", "selector": ".tripleplay-bill-container", "dependencies": [], "operator": "after", "type": "append", "id": "B129A519-860D-42CA-9B5C-4837AC520447"}]}, {"viewId": "22030900606", "changes": [{"dependencies": [], "type": "custom_code", "id": "890247F2-049D-4456-A283-CCCE55B21C3C", "value": function($){var utils = window.optimizely.get('utils');

var getHtml = window.__449_triple_play_bill_next_best_action.getHtml;

utils.observeSelector('#opty-container-list', function(optyContainer) {
if(document.querySelector('#opty-new-ui-nextAction')){
document.querySelector('#opty-new-ui-nextAction').remove();
}
 var html =getHtml('changePDate');
optyContainer.insertAdjacentHTML('afterbegin',html);  
   targetEvar({
dataLayer:s_c_il,
val:'449:Triple play bill - show next best actions across manage payment journeys (REAL)>Variation #1'
   });  
});
}}, {"value": "<div id=\"opty-container-list\"></div>", "selector": ".tripleplay-bill-container", "dependencies": [], "operator": "after", "type": "append", "id": "EB9E45F1-419A-41DD-AFC3-094116F8B9D6"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22019191732", "integrationSettings": null}], "id": "22015022261", "weightDistributions": null, "name": "449: Triple play bill - show next best actions across manage payment journeys", "groupId": null, "commitId": "22182620302", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"value": "<style>#opty-container-list .opty-itTwkV{\n    -webkit-columns: 1;\n    columns: 1;\n    list-style: none !important;\n    margin-left: 0;\n    padding: 16px;\n    font-size: 20px;\n    line-height: 24px;\n      margin-top:24px;\n}\n\n#opty-container-list .opty-itTwkV *{\nfont-size: 20px;\nline-height: 24px;\n}\n\n#opty-container-list .opty-jLxbGt{\nmargin: 0 auto 4px;\n    padding: 0px 12px;\n    margin-bottom: 8px;\n}\n\n#opty-container-list .opty-gPxSsN{\ncolor: #000FF5;\n}\n\n#opty-container-list .opty-kgONWJ{\ndisplay: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-align-items: center;\n    -webkit-box-align: center;\n    -ms-flex-align: center;\n    align-items: center;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n    -ms-flex-pack: justify;\n    justify-content: space-between;\n    width: 100%;\n}\n\n#opty-container-list .opty-fXPYjv{\n    -webkit-flex-shrink: 1;\n    -ms-flex-negative: 1;\n    flex-shrink: 1;\n    -webkit-flex-basis: auto;\n    -ms-flex-preferred-size: auto;\n    flex-basis: auto;\n}\n\n#opty-container-list .opty-evQkBI{\nfill: currentColor;\n    -webkit-flex: none;\n    -ms-flex: none;\n    flex: none;\n    height: 32px;\n    width: 32px;\n}\n\n@media (min-width: 640px){\n#opty-container-list .opty-itTwkV{\n-webkit-columns: 2;\ncolumns: 2;\nwidth: 66.666666667% !important;  \nmargin-left: auto;\nmargin-right: auto;  \n}\n}\n\n.opty-test-class #opty-change-date-link {\ndisplay: none !important;\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "8001e5efe94d4be59f4cf5d5d18a8817"}, {"dependencies": [], "type": "custom_code", "id": "987b7696dece495ca3c6ad68f5cd1cf5", "value": function($){window.__449_triple_play_bill_next_best_action = {

getHtml: function(pageName){
var makeP = ' <li class="opty-jLxbGt"> <a id="opty-make-p-link" href="/myaccount/bill/pay" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Make a payment </span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li>'; 
  
var changePDate = '<li class="opty-jLxbGt" id="opty-change-date-link"> <a href="/myaccount/bill/change-payment-date" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Change payment date</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li>';
  
var changePMethod = '<li class="opty-jLxbGt"> <a href="/myaccount/bill/change-payment-method" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Change payment method</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li>';
var listOption='';  
  
if(pageName == 'makeP'){
listOption = changePDate + changePMethod;
} else if(pageName == 'changePDate'){
listOption = makeP + changePMethod;
} else if(pageName == 'changePMethod'){
 listOption = makeP + changePDate;         
}  
  
var html = '<ul class="opty-itTwkV u-hidden-print" id="opty-new-ui-nextAction">'+listOption+'</ul>';
  
  return html;
},
  
apiCall: function(){

function validateAudience(data){
  if(data.me && data.me.parties && data.me.parties.length > 0 && data.me.parties[0].billingAccount && data.me.parties[0].billingAccount.length > 0 && data.me.parties[0].billingAccount[0].preferences && data.me.parties[0].billingAccount[0].preferences.paymentDueDay){
return data.me.parties[0].billingAccount[0].preferences.paymentDueDay.canUpdate;
}
}

var query = "{me{parties{billingAccount{accountNumber preferences{etag paymentDueDay{currentDay canUpdate}}}}}}";
 
//var url  = "https://skyport.sky.com";
var url ="https://skyport-graphql-e05.cf.stage-paas.bskyb.com/graphiql"; 
  window.fetch(url, {
    method: 'POST',
    body: JSON.stringify({ query: query }),
    headers: {
      'content-type': 'application/json',
      'x-api-token': '218bd9b0-51ab-0139-b483-4e7dfe16cc61',
      'Authorization': 'Bearer: ' + getCookie('skyCEsidsso01')
    }
  })
  	.then(function (result) { 
    if(result.status == 401){
    return { optySignedout: true};
    } else{
    return result.json();
    } 
    })
  	.then(function (data) {                     
    if(data.optySignedout){
  return;
    } else {  
    var canUpdate = validateAudience(data.data);
      if(canUpdate === false){
       var utils = window.optimizely.get('utils');                       
     utils.observeSelector('body', function(body) {
body.classList.add('opty-test-class');
});
      }
    }        
  })
  .catch(function(err){
console.log(err);
    return;
  });
}

  

};
 window.targetEvar = function(options) {  
            options.dataLayer.map(function(s) {  
                if (typeof s.tl !== 'undefined') { 
                    s.linkTrackVars = 'eVar18'; 
                    s.linkTrackEvents = ''; 
                    s.eVar18 = options.val;  
                    s.tl(true, 'o', 'page load');  
                } 
            }); 
          };
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22032340099", "22035230274", "22043201512"], "experiments": [{"weightDistributions": [{"entityId": "22033480266", "endOfRange": 5000}, {"entityId": "22031360209", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "446:Glass bill - show next best actions across manage payment journeys", "bucketingStrategy": null, "variations": [{"id": "22033480266", "actions": [{"viewId": "22035230274", "changes": [{"dependencies": [], "type": "custom_code", "id": "2B025BEE-6BC3-4ED2-AB8C-F78DE874C14B", "value": function($){var utils = window.optimizely.get('utils');

utils.observeSelector('[class^="ManagePayments__ManagePaymentsContentWrapper"]', function() {
   targetEvar({
dataLayer:s_c_il,
val:'446:Glass bill - show next best actions across manage payment journeys (REAL)>Original'
   });  
});
}}]}, {"viewId": "22043201512", "changes": [{"dependencies": [], "type": "custom_code", "id": "7A52778F-2F5C-4A5B-BAA0-CFA8171B2DD6", "value": function($){var utils = window.optimizely.get('utils');

utils.observeSelector('[class^="ManagePayments__ManagePaymentsContentWrapper"]', function() {
   targetEvar({
dataLayer:s_c_il,
val:'446:Glass bill - show next best actions across manage payment journeys (REAL)>Original'
   });  
});
}}]}, {"viewId": "22032340099", "changes": [{"dependencies": [], "type": "custom_code", "id": "83375393-8387-4D4C-873D-703FE4FAB08A", "value": function($){var utils = window.optimizely.get('utils');

utils.observeSelector('[class^="ManagePayments__ManagePaymentsContentWrapper"]', function() {
   targetEvar({
dataLayer:s_c_il,
val:'446:Glass bill - show next best actions across manage payment journeys (REAL)>Original'
   });  
});
}}]}], "name": "Original"}, {"id": "22031360209", "actions": [{"viewId": "22035230274", "changes": [{"dependencies": [], "type": "custom_code", "id": "9DE8F804-536C-4AA2-A4AC-CE3FD4DA070C", "value": function($){var utils = window.optimizely.get('utils');

var getHtml = window.__446_glass_bill_next_best_action.getHtml;


utils.observeSelector('#opty-container-list', function(optyContainer) {
if(!document.querySelector('#opty-new-ui-nextAction')){
  var html =getHtml('changePDate');
optyContainer.insertAdjacentHTML('afterbegin',html);  
}
   targetEvar({
dataLayer:s_c_il,
val:'446:Glass bill - show next best actions across manage payment journeys (REAL)>Variation #1'
   });  
});
}}, {"value": "<div id=\"opty-container-list\"></div>", "selector": "[class^=\"ManagePayments__ManagePaymentsContentWrapper\"]", "dependencies": [], "operator": "after", "type": "append", "id": "330EB10A-DA62-4332-B7D9-5CF3CAE3B651"}]}, {"viewId": "22043201512", "changes": [{"dependencies": [], "type": "custom_code", "id": "479F4AB2-0AE4-400F-8D95-00F4298D5FA8", "value": function($){var utils = window.optimizely.get('utils');

var getHtml = window.__446_glass_bill_next_best_action.getHtml;
var apiCall = window.__446_glass_bill_next_best_action.apiCall;
apiCall();

utils.observeSelector('#opty-container-list', function(optyContainer) {
if(!document.querySelector('#opty-new-ui-nextAction')){
  var html =getHtml('makeP');
optyContainer.insertAdjacentHTML('afterbegin',html);  
}
   targetEvar({
dataLayer:s_c_il,
val:'446:Glass bill - show next best actions across manage payment journeys (REAL)>Variation #1'
   });  
});
}}, {"value": "<div id=\"opty-container-list\"></div>", "selector": "[class^=\"ManagePayments__ManagePaymentsContentWrapper\"]", "dependencies": [], "operator": "after", "type": "append", "id": "97EEC119-0D62-46E8-9433-0C315143D92E"}]}, {"viewId": "22032340099", "changes": [{"dependencies": [], "type": "custom_code", "id": "8F84936C-F2F2-4E18-A426-3DCA15C99962", "value": function($){var utils = window.optimizely.get('utils');

var getHtml = window.__446_glass_bill_next_best_action.getHtml;
var apiCall = window.__446_glass_bill_next_best_action.apiCall;
apiCall();

utils.observeSelector('#opty-container-list', function(optyContainer) {
if(!document.querySelector('#opty-new-ui-nextAction')){
  var html =getHtml('changePMethod');
optyContainer.insertAdjacentHTML('afterbegin',html);  
}
   targetEvar({
dataLayer:s_c_il,
val:'446:Glass bill - show next best actions across manage payment journeys (REAL)>Variation #1'
   });  
});
}}, {"value": "<div id=\"opty-container-list\"></div>", "selector": "[class^=\"ManagePayments__ManagePaymentsContentWrapper\"]", "dependencies": [], "operator": "after", "type": "append", "id": "131C4225-F917-4118-AAB0-4F3D2E362047"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22027170301", "integrationSettings": null}], "id": "22016970301", "weightDistributions": null, "name": "446:Glass bill - show next best actions across manage payment journeys", "groupId": null, "commitId": "22172812042", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"value": "<style>#opty-container-list .opty-itTwkV{\n    -webkit-columns: 1;\n    columns: 1;\n    list-style: none !important;\n    margin-left: 0;\n    padding: 16px;\n    font-size: 20px;\n    line-height: 24px;\n\n}\n\n#opty-container-list .opty-itTwkV *{\nfont-size: 20px;\nline-height: 24px;\n}\n\n#opty-container-list .opty-jLxbGt{\nmargin: 0 auto 4px;\n    padding: 0px 12px;\n    margin-bottom: 8px;\n}\n\n#opty-container-list .opty-gPxSsN{\ncolor: #000FF5;\n}\n\n#opty-container-list .opty-kgONWJ{\ndisplay: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-align-items: center;\n    -webkit-box-align: center;\n    -ms-flex-align: center;\n    align-items: center;\n    -webkit-box-pack: justify;\n    -webkit-justify-content: space-between;\n    -ms-flex-pack: justify;\n    justify-content: space-between;\n    width: 100%;\n}\n\n#opty-container-list .opty-fXPYjv{\n    -webkit-flex-shrink: 1;\n    -ms-flex-negative: 1;\n    flex-shrink: 1;\n    -webkit-flex-basis: auto;\n    -ms-flex-preferred-size: auto;\n    flex-basis: auto;\n}\n\n#opty-container-list .opty-evQkBI{\nfill: currentColor;\n    -webkit-flex: none;\n    -ms-flex: none;\n    flex: none;\n    height: 32px;\n    width: 32px;\n}\n\n@media (min-width: 640px){\n#opty-container-list .opty-itTwkV{\n-webkit-columns: 2;\ncolumns: 2;\npadding-top: 36px !important;\n}\n}\n\n.opty-test-class #opty-change-date-link-glass {\ndisplay: none !important;\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "200B3422-BE57-4253-8B9E-8F2207C00DA1"}, {"dependencies": [], "type": "custom_code", "id": "F75FB9AE-B4A5-494E-8002-532BD22E2961", "value": function($){window.__446_glass_bill_next_best_action = {

getHtml: function(pageName){
var makeP = ' <li class="opty-jLxbGt"> <a id="opty-make-p-link" href="/bill/streaming-tv/make-payment" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Make a payment </span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li>'; 
  
var changePDate = '<li class="opty-jLxbGt" id="opty-change-date-link-glass"> <a href="/bill/streaming-tv/change-payment-due-date" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Change payment date</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li>';
  
var changePMethod = '<li class="opty-jLxbGt"> <a href="/bill/streaming-tv/change-payment-method" class="opty-gPxSsN"> <div class="opty-kgONWJ"> <span data-test-id="bill-link-text" class="opty-fXPYjv">Change payment method</span> <svg viewBox="0 0 32 32" aria-hidden="true" class="opty-evQkBI"> <g id="linear-arrow-right"> <path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path> </g> </svg> </div></a> </li>';
var listOption='';  
  
if(pageName == 'makeP'){
listOption = changePDate + changePMethod;
} else if(pageName == 'changePDate'){
listOption = makeP + changePMethod;
} else if(pageName == 'changePMethod'){
 listOption = makeP + changePDate;         
}  
  
var html = '<ul class="opty-itTwkV u-hidden-print" id="opty-new-ui-nextAction">'+listOption+'</ul>';
  
  return html;
},
  
 
apiCall: function(){

function validateAudience(data){
  if(data.me && data.me.parties && data.me.parties.length > 0 && data.me.parties[0].billingAccount && data.me.parties[0].billingAccount.length > 0 && data.me.parties[0].billingAccount[0].preferences && data.me.parties[0].billingAccount[0].preferences.paymentDueDay){
return data.me.parties[0].billingAccount[0].preferences.paymentDueDay.canUpdate;
}
}

var query = "{me{parties{billingAccount{accountNumber preferences{etag paymentDueDay{currentDay canUpdate}}}}}}";
 
//var url  = "https://skyport.sky.com";
var url ="https://skyport-graphql-e05.cf.stage-paas.bskyb.com/graphiql"; 
  window.fetch(url, {
    method: 'POST',
    body: JSON.stringify({ query: query }),
    headers: {
      'content-type': 'application/json',
      'x-api-token': '218bd9b0-51ab-0139-b483-4e7dfe16cc61',
      'Authorization': 'Bearer: ' + getCookie('skyCEsidsso01')
    }
  })
  	.then(function (result) { 
    if(result.status == 401){
    return { optySignedout: true};
    } else{
    return result.json();
    } 
    })
  	.then(function (data) {                     
    if(data.optySignedout){
  return;
    } else {  
    var canUpdate = validateAudience(data.data);
      if(canUpdate === false){
       var utils = window.optimizely.get('utils');                       
     utils.observeSelector('body', function(body) {
body.classList.add('opty-test-class');
});
      }
    }        
  })
  .catch(function(err){
console.log(err);
    return;
  });
}

};
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22028680634"], "experiments": [{"weightDistributions": [{"entityId": "22008390827", "endOfRange": 6000}, {"entityId": "22010510237", "endOfRange": 8000}, {"entityId": "22012941561", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "NS - New HM test", "bucketingStrategy": null, "variations": [{"id": "22008390827", "actions": [], "name": "Original"}, {"id": "22010510237", "actions": [{"viewId": "22028680634", "changes": [{"dest": "https://www.sky.com/help/articles/home-move-start-av2", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "8D3711CD-DEAD-4C77-82C4-9FFA65D05C67"}]}], "name": "Variation #1"}, {"id": "22012941561", "actions": [{"viewId": "22028680634", "changes": [{"dest": "https://www.sky.com/help/articles/home-move-start-av3", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "F486409D-57CF-4F57-9A3D-4844A06CFAE6"}]}], "name": "Variation #2"}], "audienceIds": null, "changes": null, "id": "22027431478", "integrationSettings": null}], "id": "22047640311", "weightDistributions": null, "name": "NS - New HM test", "groupId": null, "commitId": "22242600149", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22027598186"], "experiments": [{"weightDistributions": [{"entityId": "22060140088", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "AC - On screen error message ", "bucketingStrategy": null, "variations": [{"id": "22079410087", "actions": [], "name": "Original"}, {"id": "22060140088", "actions": [{"viewId": "22027598186", "changes": [{"dest": "https://www.sky.com/help/articles/on-screen-message-v2", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "0E79AE21-4EDC-47B4-9EB3-0B9F6401F910"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22079630992", "integrationSettings": null}], "id": "22056420090", "weightDistributions": null, "name": "AC - On screen error message ", "groupId": null, "commitId": "22272120273", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22012122935", "22022392699"], "experiments": [{"weightDistributions": [{"entityId": "22022902186", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "450: Triple play bill - future bill (individual) show next best actions", "bucketingStrategy": null, "variations": [{"id": "22046992850", "actions": [{"viewId": "22022392699", "changes": [{"dependencies": [], "type": "custom_code", "id": "AAEB47B2-B814-468C-9180-BE90E21B64B8", "value": function($){var utils = window.optimizely.get('utils');

utils.observeSelector('.tripleplay-bill-container', function() {
   targetEvar({
dataLayer:s_c_il,
val:'450: Triple play bill - future bill (individual) show next best actions (REAL)>Original'
   }); 
});
}}]}], "name": "Original"}, {"id": "22022902186", "actions": [{"viewId": "22022392699", "changes": [{"dependencies": [], "type": "custom_code", "id": "020B7662-6055-4E40-9BCC-5E58B3B74AB4", "value": function($){var utils = window.optimizely.get('utils');

 var _getCookie = function(name) {
   var match = document.cookie.match(name+'=([^;]*)');
   return match ? match[1] : undefined;
 };


var html = '<div id="opty-individual-new-ui"><hr class="c-divider" style="margin-top:20px;" /><ul role="presentation" style="margin-top:30px;" class="opty-new-links o-list-bare u-hidden-print tripleplay-bill-link-block u-padding-left u-padding-right"><li><a id="opty-make-individual-p-link" class="c-link-external t-tripleplay-bill-payment-link" href="/myaccount/bill/pay">Make a payment</a></li><li><a class="c-link-external  t-tripleplay-bill-paymentdue-link" href="/myaccount/bill/change-payment-date">Change payment date</a></li><li><a class="c-link-external  t-tripleplay-bill-paymentmethod-link" href="/myaccount/bill/change-payment-method">Change payment method</a></li></ul></div>';

utils.observeSelector('#opty-individual-container', function(optyContainer) {
  
if(document.querySelector('#opty-individual-new-ui')){
document.querySelector('#opty-individual-new-ui').remove();
}
  optyContainer.insertAdjacentHTML('beforeend',html);
   targetEvar({
dataLayer:s_c_il,
val:'450: Triple play bill - future bill (individual) show next best actions (REAL)>Variation #1'
   }); 
});

utils.observeSelector('#opty-make-individual-p-link', function(link) {
link.addEventListener('click',function(){
document.cookie = "opty-new-individual-journey=make-payment;path=/;";
});
});

utils.observeSelector('.t-tripleplay-bill-payment-link:not(#opty-make-individual-p-link)', function(link) {
link.addEventListener('click',function(){
document.cookie = "opty-new-individual-journey=make-payment ; expires = Thu, 01 Jan 1970 00:00:00 GMT;path=/";
});
});
}}, {"value": "<style>#opty-individual-new-ui ul{\nfont-size: 20px;\n }\n#opty-individual-new-ui ul li{\ntext-align: left !important;\n }\n\n\n@media (max-width: 46.24em){\n  #opty-individual-new-ui{\n  width:100%;\n    text-align: center;\n  }\n  \n  #opty-individual-new-ui ul{\n  font-size: 18px;\n  }\n}\n\n@media (min-width: 46.25em){\n#opty-individual-new-ui {\n    width: 66.666666667% !important;\n      margin-left: auto;\n    margin-right: auto;\n\n}\n  #opty-individual-new-ui ul{\n    text-align: left;\n    padding-left: 0 !important;\n    padding-right: 0 !important;\n  }\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "34EFF2B0-1A13-43D7-B5D8-F9B8D4910872"}, {"value": "<div id=\"opty-individual-container\"></div>", "selector": ".tripleplay-bill-container", "dependencies": [], "operator": "after", "type": "append", "id": "C102AAFE-3121-4746-B110-B328A9B7E3B2"}]}, {"viewId": "22012122935", "changes": [{"value": "<p id=\"opty-individual-new-note\" class=\"u-padding-left u-padding-right\"><strong>Please note:</strong> Any payments you make today will apply to your latest bill only.</p>", "selector": "h2.c-heading-charlie[aria-label=\"Make a payment\"]", "dependencies": [], "operator": "after", "type": "append", "id": "FF4C1779-F8F3-4BB1-8A5E-C2817C4F0B0B"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22017622750", "integrationSettings": null}], "id": "22059410945", "weightDistributions": null, "name": "450: Triple play bill - future bill (individual) show next best actions", "groupId": null, "commitId": "22254670377", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"dependencies": [], "type": "custom_code", "id": "388F94F6-4702-4BDE-9BB1-8C69457C4F4F", "value": function($){window.targetEvar = function(options) {  
            options.dataLayer.map(function(s) {  
                if (typeof s.tl !== 'undefined') { 
                    s.linkTrackVars = 'eVar18'; 
                    s.linkTrackEvents = ''; 
                    s.eVar18 = options.val;  
                    s.tl(true, 'o', 'page load');  
                } 
            }); 
          };
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22026747698"], "experiments": [{"weightDistributions": [{"entityId": "22112221197", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "454: Re-design of contact us page", "bucketingStrategy": null, "variations": [{"id": "22011055727", "actions": [], "name": "Original"}, {"id": "22112221197", "actions": [{"viewId": "22026747698", "changes": [{"dependencies": [], "type": "custom_code", "id": "2107CD14-336A-443F-AF36-B9DD8A214CDF", "value": function($){var utils = window.optimizely.get('utils');

function initiateLoading(){
document.querySelector('#article > .c-article__container').classList.add('opty-height');
document.querySelector('#article .o-container.c-article__body').classList.add('ccx-hidden');
  var spinner = '<div role="progressbar" class="loading-spinner__SpinnerWrapper-sc-y0knjc-0 dActUj-opty"><span class="loading-spinner__Spinner-sc-y0knjc-1 hnHvyx-opty"></span></div>';
  if(!document.querySelector('.dActUj-opty')){
  document.querySelector('#article > .c-article__container').insertAdjacentHTML('afterbegin',svg);
  }
}

function removeLoading(){
    if(document.querySelector('.dActUj-opty')){
 document.querySelector('.dActUj-opty').remove();
  }
document.querySelector('#article > .c-article__container').classList.remove('opty-height');
document.querySelector('#article .o-container.c-article__body').classList.aremovedd('ccx-hidden');
}

function moveNewContainer(refLink){
  if(document.querySelector('div.c-card.c-card-cta.c-card--static.ccx-card > .ccx-dropdown-selection.o-container')){
  refLink.after(document.querySelector('div.c-card.c-card-cta.c-card--static.ccx-card > .ccx-dropdown-selection.o-container'));
  }
}

function getvgs(cardName){

  var getHelp = '<svg class="opty-new-svg" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.98901 13H13V15H4V23H13V29.0098H5.81508C5.58008 29.0098 5.38508 29.0908 5.23408 29.2518C4.91508 29.5948 4.96208 30.5768 5.13808 31.0098H26.8591C27.0351 30.5768 27.0831 29.5948 26.7631 29.2518C26.6121 29.0908 26.4191 29.0098 26.1831 29.0098H19V23H28L30.989 19.1035L28 15H19V13H27.989V5H19V2C19 1.44772 18.5523 1 18 1H14C13.4477 1 13 1.44772 13 2V5H3.98901L1 9.10352L3.98901 13ZM18.0002 11H14.0002H4.97565L3.49707 9.07252L5.0067 7H14.0002H18.0002H25.9892V11H18.0002ZM17 13H15V15H17V13ZM17 3V5H15V3H17ZM18 21H27.0135L28.4921 19.0725L26.9825 17H18H14H6V21H14H18ZM15 29V23H17V29H15Z" fill="#4A4A4A"/></svg>';
  
  var community = '<svg class="opty-new-svg" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M29 13.42H23.125V8C23.125 6.343 21.782 5 20.125 5H5C3.343 5 2 6.343 2 8V15.074C2 16.731 3.343 18.074 5 18.074H5.708V22.639C5.708 23.242 6.202 23.641 6.716 23.641C6.961 23.641 7.212 23.55 7.416 23.346L10.875 19.886V23.433C10.875 25.09 12.218 26.433 13.875 26.433H21.312L26.584 31.705C26.788 31.91 27.039 32 27.285 32C27.798 32 28.292 31.601 28.292 30.998V26.433H29C30.657 26.433 32 25.09 32 23.433V16.42C32 14.764 30.657 13.42 29 13.42ZM10.875 17.058V16.42C10.875 14.764 12.218 13.42 13.875 13.42H21.125V8C21.125 7.449 20.677 7 20.125 7H5C4.449 7 4 7.449 4 8V15.074C4 15.625 4.449 16.074 5 16.074H7.708V20.225L10.875 17.058ZM29 24.433C29.551 24.433 30 23.985 30 23.433V16.42C30 15.87 29.551 15.42 29 15.42H13.875C13.324 15.42 12.875 15.87 12.875 16.42V23.433C12.875 23.985 13.324 24.433 13.875 24.433H22.141L26.292 28.584V24.433H29ZM15.9756 19.9003C15.9756 19.2413 16.5096 18.7063 17.1696 18.7063C17.8296 18.7063 18.3646 19.2413 18.3646 19.9003C18.3646 20.5603 17.8296 21.0953 17.1696 21.0953C16.5096 21.0953 15.9756 20.5603 15.9756 19.9003ZM21.4372 18.7063C20.7772 18.7063 20.2432 19.2413 20.2432 19.9003C20.2432 20.5603 20.7772 21.0953 21.4372 21.0953C22.0972 21.0953 22.6312 20.5603 22.6312 19.9003C22.6312 19.2413 22.0972 18.7063 21.4372 18.7063ZM24.5117 19.9003C24.5117 19.2413 25.0457 18.7063 25.7057 18.7063C26.3657 18.7063 26.8997 19.2413 26.8997 19.9003C26.8997 20.5603 26.3657 21.0953 25.7057 21.0953C25.0457 21.0953 24.5117 20.5603 24.5117 19.9003Z" fill="#4A4A4A"/></svg>';
  
  var getInTouch = '<svg class="opty-new-svg" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_1605_37517)"><path fill-rule="evenodd" clip-rule="evenodd" d="M29.978 12.646H29.501C27.997 5.422 23.45 0 15.766 0C8.082 0 3.376 5.42 1.987 12.646H1.529C0.686 12.646 0 13.331 0 14.173V20.378C0 21.221 0.686 21.908 1.529 21.908H2.186C4.335 27.795 8.978 32 15.596 32C15.826 31.415 15.85 30.725 15.372 30.247C15.0992 30.0005 14.9078 29.9824 14.5163 29.9453L14.44 29.938C9.375 29.446 6.214 26.292 4.316 21.908H4.33C5.172 21.908 5.858 21.221 5.858 20.378V14.173C5.858 13.331 5.172 12.646 4.33 12.646H4.036C5.379 6.543 9.205 2 15.766 2C22.329 2 26.021 6.541 27.46 12.646H27.176C26.333 12.646 25.647 13.331 25.647 14.173V20.378C25.647 21.221 26.333 21.908 27.176 21.908H29.978C30.82 21.908 31.505 21.221 31.505 20.378V14.173C31.505 13.331 30.82 12.646 29.978 12.646ZM27.647 19.908H29.505V14.646H27.647V19.908ZM3.858 19.908H2V14.646H3.858V19.908Z" fill="#4A4A4A"/></g><defs><clipPath id="clip0_1605_37517"><rect width="32" height="32" fill="white"/></clipPath></defs></svg>';
 
  if(cardName == 'getHelp'){
  return getHelp;
  } else if(cardName =='community'){
   return community;         
 } else if(cardName == 'getInTouch'){
  return getInTouch;
  } 
}
function createNewContainers(){
    document.querySelectorAll('.c-card.c-card-cta.c-card--static > .o-container:not(.ccx-dropdown-selection)').forEach(function(innerCard){
        var title = innerCard.querySelector('h2');
        var newDiv = document.createElement("div");
        newDiv.classList.add('opty-new-right-container');
        if(!innerCard.querySelector('.opty-new-right-container')){
            title.after(newDiv);
        }
        var toMoveElemArr = [];
        innerCard.children.forEach(function(child){
        if(child.tagName !== "H2" && !child.classList.contains('opty-new-right-container')){
            toMoveElemArr.push(child);
        }
        });
    
        toMoveElemArr.forEach(elem => newDiv.append(elem));

        var newDivLeft = document.createElement("div");
        newDivLeft.classList.add('opty-new-left-container');
        if(!innerCard.querySelector('.opty-new-left-container')){
            innerCard.querySelector('.opty-new-right-container').before(newDivLeft);
        }
        newDivLeft.append(title);
      var svg = '';
      if(title.innerText.indexOf('help') > -1){
      svg = getvgs('getHelp');
      } else  if(title.innerText.indexOf('Community') > -1){
       svg = getvgs('community');
      } else  if(title.innerText.indexOf('touch') > -1){
       svg = getvgs('getInTouch');
      }
              if(!innerCard.querySelector('.opty-new-svg')){
                    title.insertAdjacentHTML('beforebegin',svg);
              }

      
        });

}




function getVisitOnlineHtml(){

    return `<div class="ccx-visit-online">
    <p class="text__Text-sc-1u9gciq-0">
       <strong>Over 90% of our customers</strong> quickly resolve their query without having
       to call with our range of guides on Sky Help.
    </p>
    <a href="https://sky.com/help/home" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Visit our online help" aria-label="Visit our online help">
    Visit our online help
    </a>
 </div>`;

}

function sendEvar(name, val){
 window.targetEvar = function(options) {  
            options.dataLayer.map(function(s) {  
                if (typeof s.tl !== 'undefined') { 
                    s.linkTrackVars = 'eVar7'; 
                    s.linkTrackEvents = ''; 
                    s.eVar7 = options.val;  
                    s.tl(true, 'o', 'page load');  
                } 
            }); 
          };
  
  targetEvar({
dataLayer:s_c_il,
val:'select dropdown '+name+' = '+val
   }); 
  
  
}
function numberChangeTest(){
  
   var numberPoolingClass = '.NumberPoolingNumber';
       // Check if configuration has already been set.
       var isConfigSet = function() {
        if (typeof window.SKYContact !== 'undefined') {
            if (window.SKYContact.config.endpoint && window.SKYContact.config.classIdentifier){
                return true;
            }
            return false;
        }
        return false;
    };
    
        
        // If configuration has not been set, then set it
        if (typeof window.SKYContact !== 'undefined' && !isConfigSet()) {
            // STAGING URL - replace with PROD url in production:  https://service-ranch-pools-a.cf.dev-paas.bskyb.com/number-pooling/number 
            window.SKYContact.config.endpoint = 'https://secure.sky.com/service-ranch/number-pooling/number'; 
            window.SKYContact.config.classIdentifier = numberPoolingClass;
        }
        if (isConfigSet()) {
                window.SKYContact.getNumberAndReplace()
                             .then(function(n){
  document.querySelector('.ccx-number-btn').classList.add('ccx-hidden');
                  document.querySelectorAll('.NumberPoolingNumber').forEach(function(a){
                    a.classList.remove('ccx-hidden');
  a.href =  'tel:' + n;
                     a.innerHTML = n+'<span>*</span>';
  });
      //  console.log('______ n', n);
      if (document.querySelector(".ccx-show-number .ccx-hidden.text-content")) {
      document
        .querySelector(".ccx-show-number .ccx-hidden.text-content")
        .classList.remove("ccx-hidden");
    }
      
                });
            }
  }

function mainUI(optyContainer){

const addedCard = document.createElement("div");
const cardHtml = `<div class="c-card c-card-cta c-card--static ccx-card" data-test-id="toolkit-card">
    <div class="o-container u-padding-large">
       <h2 class="text__Text-sc-1u9gciq-0 eGXblW">Get in touch</h2>
       <p class="text__Text-sc-1u9gciq-0 erhHuK">
          If you still need help and can't find what you’re looking for online,
          please get in touch with us below.
       </p>
       <p class="text__Text-sc-1u9gciq-0 erhHuK">
          <strong>
          Let us know what you need to contact us about and we’ll get you to the
          right team.
          </strong>
       </p>
       <a class="c-btn c-btn--full@small c-btn--stackable c-btn--primary ccx-get-touch" data-test-id="base-link" data-tracking-label="Get in touch" aria-label="Get in touch">
       Get in touch
       </a>
    </div>
    <div class="ccx-dropdown-selection o-container ccx-hidden">
       <div class="ccx-first-section">
          <p class="text__Text-sc-1u9gciq-0 ccx-first-headline">
             What would you like to contact us about?
          </p>
    <div class="ccx-select-wrapper">
          <select id="u46_input target" class="u46_input" aria-label="All products" name="All products">
             <option class="u46_input_option" selected="" value="Please choose">
                Please choose
             </option>
             <option class="u46_input_option" value="Sky TV">Sky TV</option>
             <!-- <option class="u46_input_option" value="My account">My account</option> -->
             <option class="u46_input_option" value="Billing and payments">Billing and payments</option>
             <option class="u46_input_option" value="Account and subscription">Account and subscription</option>
             <option class="u46_input_option" value="Sky Broadband">
                Sky Broadband
             </option>
             <option class="u46_input_option" value="Sky Mobile">Sky Mobile</option>
     <option class="u46_input_option" value="Sky Go">
             Sky Go
          </option>
          <option class="u46_input_option" value="Sky Talk">
          Sky Talk
       </option>
       <option class="u46_input_option" value="Sky Yahoo Mail">
       Sky Yahoo Mail
    </option>
             <option class="u46_input_option" value="Check for outages in your area">
                Check for outages in your area
             </option>
            
          </select>
    <div class="select__IconWrapper-sc-10ssrke-2 jsXipz"><svg viewBox="0 0 32 32" aria-hidden="true" class="icon__Svg-sc-1h46i2c-0 gTvruJ"><g id="linear-arrow-down"><path d="M16.174 20.002L6.171 10a6.52 6.52 0 0 0-.138.11C5.786 10.316 5 10.92 5 11.372a.777.777 0 0 0 .249.53L15.513 22.17a.934.934 0 0 0 1.321 0l10.264-10.268a.763.763 0 0 0 .248-.53c0-.452-.784-1.056-1.033-1.262a4.806 4.806 0 0 0-.136-.11L16.174 20.002z" id="Icon"></path></g></svg></div>
    
    </div>
       </div>
       <div class="ccx-second-section">
          <div id="Please choose" class="ccx-visible please-choose">
             <span class="ccx-border"></span>
            ${getVisitOnlineHtml()}
          </div>
          <div id="Sky TV" class="ccx-hidden">
             <a href="https://www.sky.com/help/home/sky-tv" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky TV" aria-label="Get help with Sky TV">
             Get help with Sky TV
             </a>
             <p class="text__Text-sc-1u9gciq-0 ccx-pt">
                Which Sky TV product do you want to talk about?
             </p>
    <div class="ccx-select-wrapper">
             <select id="u194_input" class="u194_input" aria-label="Sky TV products" name="Sky TV products">
                <option class="u194_input_option" selected="" value="Please choose 2">
                   Please choose
                </option>
                <option class="u194_input_option" value="Sky +">Sky +</option>
                <option class="u194_input_option" value="Sky Q">Sky Q</option>
                <option class="u194_input_option" value="Sky Glass">Sky Glass</option>
             </select>
    <div class="select__IconWrapper-sc-10ssrke-2 jsXipz"><svg viewBox="0 0 32 32" aria-hidden="true" class="icon__Svg-sc-1h46i2c-0 gTvruJ"><g id="linear-arrow-down"><path d="M16.174 20.002L6.171 10a6.52 6.52 0 0 0-.138.11C5.786 10.316 5 10.92 5 11.372a.777.777 0 0 0 .249.53L15.513 22.17a.934.934 0 0 0 1.321 0l10.264-10.268a.763.763 0 0 0 .248-.53c0-.452-.784-1.056-1.033-1.262a4.806 4.806 0 0 0-.136-.11L16.174 20.002z" id="Icon"></path></g></svg></div>
    </div>
    
    
             <div id="Please choose 2" class="ccx-sub ccx-visible">
                <span class="ccx-border"></span>
                <div class="ccx-list-links">
                   <p class="text__Text-sc-1u9gciq-0">
                      Other popular online help for Sky TV
                   </p>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus/sky-plus-watching-sky-tv" class="c-link" data-tracking-label="Watching Sky TV" aria-label="Watching Sky TV">
                   Watching Sky TV
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus/sky-plus-equipment" class="c-link" data-tracking-label="Sky + equipment" aria-label="Sky + equipment">
                   Sky + equipment
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-q/using-sky-q" class="c-link" data-tracking-label="Using Sky Q" aria-label="Using Sky Q">
                   Using Sky Q
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-q/fixing-sky-q" class="c-link" data-tracking-label="Sky Q - fixing a problem" aria-label="Sky Q - fixing a problem">
                   Sky Q - fixing a problem
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/buying-sky-glass" class="c-link" data-tracking-label="Buying Sky Glass" aria-label="Buying Sky Glass">
                   Buying Sky Glass
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/fixing-a-problem-sky-glass" class="c-link" data-tracking-label="Sky Glass - fixing a problem" aria-label="Sky Glass - fixing a problem">
                   Sky Glass - fixing a problem
                   </a>
                </div>
                ${getVisitOnlineHtml()}
                <span class="ccx-border opty-extra-border ccx-hidden-important"></span>
             </div>
             <div id="Sky +" class="ccx-sub ccx-hidden">
                <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky +" aria-label="Get help with Sky +">
                Get help with Sky +
                </a>
                <span class="ccx-border"></span>
                <div class="ccx-list-links">
                   <p class="text__Text-sc-1u9gciq-0">
                      Other popular online help for Sky +
                   </p>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus/sky-plus-watching-sky-tv" class="c-link" data-tracking-label="Watching SkyTV" aria-label="Watching SkyTV">
                   Watching SkyTV
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus/sky-plus-equipment" class="c-link" data-tracking-label="Sky + equipment" aria-label="Sky + equipment">
                   Sky + equipment
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus/viewing-card" class="c-link" data-tracking-label="Sky viewing card" aria-label="Sky viewing card">
                   Sky viewing card
                   </a>
                   <a href="https://www.sky.com/help/diagnostics-redirect/start_page/blt7c281e645443b607" class="c-link" data-tracking-label="Sky TV PIN" aria-label="Sky TV PIN">
                   Sky TV PIN
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus/settings-and-preferences" class="c-link" data-tracking-label="Settings and preferences" aria-label="Settings and preferences">
                   Settings and preferences
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus/sky-plus-sky-account" class="c-link" data-tracking-label="Account and billing" aria-label="Account and billing">
                   Account and billing
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-plus/sky-tv-error-messages" class="c-link" data-tracking-label="On screen error messages" aria-label="On screen error messages">
                   On screen error messages
                   </a>
                </div>
                ${getVisitOnlineHtml()}
                <span class="ccx-border"></span>
             </div>
             <div id="Sky Q" class="ccx-sub ccx-hidden">
                <a href="https://www.sky.com/help/home/sky-tv/sky-tv-q" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky Q" aria-label="Get help with Sky Q">
                Get help with Sky Q
                </a>
                <span class="ccx-border"></span>
                <div class="ccx-list-links">
                   <p class="text__Text-sc-1u9gciq-0">
                      Other popular online help for Sky Q
                   </p>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-q/setting-up-sky-q" class="c-link" data-tracking-label="Setting up Sky Q" aria-label="Setting up Sky Q">
                   Setting up Sky Q
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-q/using-sky-q" class="c-link" data-tracking-label="Using Sky Q" aria-label="Using Sky Q">
                   Using Sky Q
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-q/fixing-sky-q" class="c-link" data-tracking-label="Fixing a problem" aria-label="Fixing a problem">
                   Fixing a problem
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-q/q-my-account" class="c-link" data-tracking-label="My account" aria-label="My account">
                   My account
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-q/q-policies-info" class="c-link" data-tracking-label="Policies and information" aria-label="Policies and information">
                   Policies and information
                   </a>
                </div>
                ${getVisitOnlineHtml()}
                <span class="ccx-border"></span>
             </div>
             <div id="Sky Glass" class="ccx-sub ccx-hidden">
                <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky Glass" aria-label="Get help with Sky Glass">
                Get help with Sky Glass
                </a>
                <span class="ccx-border"></span>
                <div class="ccx-list-links">
                   <p class="text__Text-sc-1u9gciq-0">
                      Other popular online help for Sky Glass
                   </p>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/setting-up-sky-glass" class="c-link" data-tracking-label="Setting up" aria-label="Setting up">
                   Setting up
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/using-sky-glass" class="c-link" data-tracking-label="Using Sky Glass" aria-label="Using Sky Glass">
                   Using Sky Glass
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/fixing-a-problem-sky-glass" class="c-link" data-tracking-label="Fixing a problem" aria-label="Fixing a problem">
                   Fixing a problem
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/account-and-billing-sky-glass" class="c-link" data-tracking-label="Account and billing" aria-label="Account and billing">
                   Account and billing
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/buying-sky-glass" class="c-link" data-tracking-label="Buying Sky Glass" aria-label="Buying Sky Glass">
                   Buying Sky Glass
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/delivery-and-returns-sky-glass" class="c-link" data-tracking-label="Delivery and returns" aria-label="Delivery and returns">
                   Delivery and returns
                   </a>
                   <a href="https://www.sky.com/help/home/sky-tv/sky-tv-glass/sky-glass-faqs" class="c-link" data-tracking-label="Sky Glass FAQs" aria-label="Sky Glass FAQs">
                   Sky Glass FAQs
                   </a>
                </div>
                ${getVisitOnlineHtml()}
                <span class="ccx-border"></span>
             </div>
          </div>

          <!-- <div id="My account" class="ccx-sub ccx-hidden">
             <a href="https://sky.com/help/home/your-account" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with My account" aria-label="Get help with My account">
             Get help with My account
             </a>
             <span class="ccx-border"></span>
             <div class="ccx-list-links">
                <p class="text__Text-sc-1u9gciq-0">
                   Other popular online help for My account
                </p>
                <a href="https://www.sky.com/help/home/your-account/my-account-and-subscription" class="c-link" data-tracking-label="Account and subscription" aria-label="Account and subscription">
                Account and subscription
                </a>
                <a href="https://www.sky.com/help/home/your-account/account-my-bills-and-payments" class="c-link" data-tracking-label="Bills and payments" aria-label="Bills and payments">
                Bills and payments
                </a>
                <a href="https://www.sky.com/help/home/your-account/my-sky-id" class="c-link" data-tracking-label="Sky iD" aria-label="Sky iD">
                Sky iD
                </a>
                <a href="https://www.sky.com/help/home/your-account/moving-home" class="c-link" data-tracking-label="Moving home" aria-label="Moving home">
                Moving home
                </a>
                <a href="https://www.sky.com/help/home/your-account/orders-and-appointments" class="c-link" data-tracking-label="Orders and appointments" aria-label="Orders and appointments">
                Orders and appointments
                </a>
                <a href="https://www.sky.com/help/home/your-account/making-a-complaint" class="c-link" data-tracking-label="Making a complaint" aria-label="Making a complaint">
                Making a complaint
                </a>
                <a href="https://www.sky.com/help/home/your-account/information-and-policies" class="c-link" data-tracking-label="Information and policies" aria-label="Information and policies">
                Information and policies
                </a>
             </div>
             ${getVisitOnlineHtml()}
             <span class="ccx-border"></span>
          </div> -->

          <div id="Billing and payments" class="ccx-sub ccx-hidden">
            <a href="https://www.sky.com/help/home/your-account/account-my-bills-and-payments" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Billing and payments" aria-label="Get help with Billing and payments">
            Get help with Billing and payments
            </a>
            <span class="ccx-border"></span>
            <div class="ccx-list-links">
               <p class="text__Text-sc-1u9gciq-0">
                  Other popular online help for Billing and payments
               </p>
               <a href="https://www.sky.com/help/home/your-account/account-my-bills-and-payments/my-payments" class="c-link" data-tracking-label="My payments" aria-label="My payments">
               My payments
               </a>
               <a href="https://www.sky.com/help/home/your-account/account-my-bills-and-payments/difficulty-paying" class="c-link" data-tracking-label="Difficulty paying" aria-label="Difficulty paying">
               Difficulty paying
               </a>
               <a href="https://www.sky.com/help/home/your-account/account-my-bills-and-payments/understanding-my-bills/articles/sky-bills-and-payments" class="c-link" data-tracking-label="My bills" aria-label="My bills">
               My bills
               </a>
            </div>
            ${getVisitOnlineHtml()}
            <span class="ccx-border"></span>
         </div>

         <div id="Account and subscription" class="ccx-sub ccx-hidden">
            <a href="https://www.sky.com/help/home/your-account/my-account-and-subscription" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Account and subscription" aria-label="Get help with Account and subscription">
            Get help with Account and subscription
            </a>
            <span class="ccx-border"></span>
            <div class="ccx-list-links">
               <p class="text__Text-sc-1u9gciq-0">
                  Other popular online help for Account and subscription
               </p>
               <a href="https://www.sky.com/help/home/your-account/my-account-and-subscription/account-details" class="c-link" data-tracking-label="Change account details" aria-label="Change account details">
               Change account details
               </a>
               <a href="https://www.sky.com/help/home/your-account/my-account-and-subscription/change-subscription" class="c-link" data-tracking-label="Changing my subscription" aria-label="Changing my subscription">
               Changing my subscription
               </a>
               <a href="https://www.sky.com/help/home/your-account/my-account-and-subscription/cancelling" class="c-link" data-tracking-label="Cancelling" aria-label="Cancelling">
               Cancelling
               </a>
               <a href="https://www.sky.com/help/home/your-account/my-account-and-subscription/sky-mobile-account" class="c-link" data-tracking-label="Sky Mobile account" aria-label="Sky Mobile account">
               Sky Mobile account
               </a>
               <a href="https://www.sky.com/help/home/your-account/my-account-and-subscription/my-contract/articles/your-sky-contract-start" class="c-link" data-tracking-label="My contract" aria-label="My contract">
               My contract
               </a>
            </div>
            ${getVisitOnlineHtml()}
            <span class="ccx-border"></span>
         </div>

          <div id="Sky Broadband" class="ccx-sub ccx-hidden">
             <a href="https://sky.com/help/home/broadband" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky Broadband" aria-label="Get help with Sky Broadband">
             Get help with Sky Broadband
             </a>
             <span class="ccx-border"></span>
             <div class="ccx-list-links">
                <p class="text__Text-sc-1u9gciq-0">
                   Other popular online help for Sky Broadband
                </p>
                <a href="https://www.sky.com/help/home/broadband/connecting-to-my-broadband" class="c-link" data-tracking-label="Connecting to my Broadband" aria-label="Connecting to my Broadband">
                Connecting to my Broadband
                </a>
                <a href="https://www.sky.com/help/home/broadband/my-broadband-speed" class="c-link" data-tracking-label="My broadband speed" aria-label="My broadband speed">
                My broadband speed
                </a>
                <a href="https://www.sky.com/help/home/broadband/sky-broadband-equipment" class="c-link" data-tracking-label="Sky Broadband equipment" aria-label="Sky Broadband equipment">
                Sky Broadband equipment
                </a>
                <a href="https://www.sky.c   om/help/home/broadband/security-and-protection" class="c-link" data-tracking-label="Staying safe online" aria-label="Staying safe online">
                Staying safe online
                </a>
                <a href="https://www.sky.com/help/home/broadband/join-sky-broadband" class="c-link" data-tracking-label="Joining Sky Broadband" aria-label="Joining Sky Broadband">
                Joining Sky Broadband
                </a>
                <a href="https://www.sky.com/help/home/broadband/broadband-your-account" class="c-link" data-tracking-label="My account" aria-label="My account">
                My account
                </a>
                <a href="https://www.sky.com/help/home/broadband/policies-and-info" class="c-link" data-tracking-label="Policies and info" aria-label="Policies and info">
                Policies and info
                </a>
             </div>
             ${getVisitOnlineHtml()}
             <span class="ccx-border"></span>
          </div>
          <div id="Sky Mobile" class="ccx-sub ccx-hidden">
             <a href="https://sky.com/help/home/sky-mobile" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky Mobile" aria-label="Get help with Sky Mobile">
             Get help with Sky Mobile
             </a>
             <span class="ccx-border"></span>
             <div class="ccx-list-links">
                <p class="text__Text-sc-1u9gciq-0">
                   Other popular online help for Sky Mobile
                </p>
                <a href="https://www.sky.com/help/home/sky-mobile/setting-up-sky-mobile" class="c-link" data-tracking-label="Sky Mobile" aria-label="Sky Mobile">
                Sky Mobile
                </a>
                <a href="https://www.sky.com/help/home/sky-mobile/mobile-account-and-billing" class="c-link" data-tracking-label="Account and billing" aria-label="Account and billing">
                Account and billing
                </a>
                <a href="https://www.sky.com/help/home/sky-mobile/device-help" class="c-link" data-tracking-label="Device help" aria-label="Device help">
                Device help
                </a>
                <a href="https://www.sky.com/help/home/sky-mobile/data-calls-and-texts-mobile" class="c-link" data-tracking-label="Data, calls and texts" aria-label="Data, calls and texts">
                Data, calls and texts
                </a>
                <a href="https://www.sky.com/help/home/sky-mobile/mobile-upgrades" class="c-link" data-tracking-label="Upgrades" aria-label="Upgrades">
                Upgrades
                </a>
                <a href="https://www.sky.com/help/home/sky-mobile/going-or-calling-abroad" class="c-link" data-tracking-label="Going or calling abroad" aria-label="Going or calling abroad">
                Going or calling abroad
                </a>
                <a href="https://www.sky.com/help/home/sky-mobile/delivery-returns-and-repairs" class="c-link" data-tracking-label="Delivery, returns and repairs" aria-label="Delivery, returns and repairs">
                Delivery, returns and repairs
                </a>
                <a href="https://www.sky.com/help/home/sky-mobile/buying-sky-mobile" class="c-link" data-tracking-label="Buying Sky Mobile" aria-label="Buying Sky Mobile">
                Buying Sky Mobile
                </a>
             </div>
             ${getVisitOnlineHtml()}
             <span class="ccx-border"></span>
          </div>
    
          <div id="Check for outages in your area" class="ccx-sub ccx-hidden">
             <a href="https://www.sky.com/help/servicestatus#/uk/issues" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Check current Service Status" aria-label="Check current Service Status">
             Check current Service Status
             </a>
             <span class="ccx-border"></span>
             <div class="ccx-list-links">
                <p class="text__Text-sc-1u9gciq-0">
                   Other popular online help for service outages
                </p>
                <a href="" class="c-link" data-tracking-label="Sky Mobile - poor or no service" aria-label="Sky Mobile - poor or no service"> Sky Mobile - poor or no service </a>
                <a href="" class="c-link" data-tracking-label="Sky Q - fix connection problems" aria-label="Sky Q - fix connection problems"> Sky Q - fix connection problems </a>
                <a href="" class="c-link" data-tracking-label="Sky Mobile - poor or no service" aria-label="Sky Mobile - poor or no service"> Sky Mobile - poor or no service </a>
             </div>
             ${getVisitOnlineHtml()}
             <span class="ccx-border"></span>
          </div>
    
          <div id="Sky Go" class="ccx-sub ccx-hidden">
          <a href="https://www.sky.com/help/home/sky-apps" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky Go" aria-label="Get help with Sky Go">
          Get help with Sky Go
          </a>
          <span class="ccx-border"></span>
          <div class="ccx-list-links">
             <p class="text__Text-sc-1u9gciq-0">
                Other popular online help for Sky Go
             </p>
             <a href="https://www.sky.com/help/home/sky-apps/tv-apps-on-my-sky-q-box/articles/apps-on-sky-q-and-glass" class="c-link" data-tracking-label="TV apps on Sky" aria-label="TV apps on Sky">
                TV apps on Sky
             </a>
             <a href="https://www.sky.com/help/home/sky-apps/sky-go-what-do-you-need-help-with/articles/sky-go-what-do-you-need-help-with" class="c-link" data-tracking-label="Sky Go" aria-label="Sky Go">
                Sky Go
             </a>
             <a href="https://www.sky.com/help/home/sky-apps/tv-from-sky-what-do-you-need-help-with/articles/tv-from-sky-what-do-you-need-help-with" class="c-link" data-tracking-label="TV from Sky (games consoles)" aria-label="TV from Sky (games consoles)">
                TV from Sky (games consoles)
             </a>
             <a href="https://www.sky.com/help/home/sky-apps/sky-plus-app" class="c-link" data-tracking-label="Sky+" aria-label="Sky+">
                Sky+
             </a>
             <a href="https://www.sky.com/help/home/sky-apps/sky-app" class="c-link" data-tracking-label="My Sky" aria-label="My Sky">
                My Sky
             </a>
             <a href="https://www.sky.com/help/home/sky-apps/sky-kids-app/articles/sky-kids-what-would-you-like-help-with" class="c-link" data-tracking-label="Sky Kids" aria-label="Sky Kids">
                Sky Kids 
             </a>
             <a href="https://www.sky.com/help/home/sky-apps/sky-store-app/articles/sky-store" class="c-link" data-tracking-label="Sky Store" aria-label="Sky Store">
                Sky Store
             </a>
             <a href="https://www.sky.com/help/home/sky-apps/sky-news-app/articles/sky-news-app-what-do-you-need-help-with" class="c-link" data-tracking-label="Sky News" aria-label="Sky News">
                Sky News
             </a>
             <a href="https://www.sky.com/help/home/sky-apps/other-apps" class="c-link" data-tracking-label="Something else" aria-label="Something else">
             Something else
          </a>
          </div>
          ${getVisitOnlineHtml()}
          <span class="ccx-border"></span>
       </div>
    
       <div id="Sky Talk" class="ccx-sub ccx-hidden">
       <a href="https://www.sky.com/help/home/sky-talk" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky Talk" aria-label="Get help with Sky Talk">
       Get help with Sky Talk
       </a>
       <span class="ccx-border"></span>
       <div class="ccx-list-links">
          <p class="text__Text-sc-1u9gciq-0">
             Other popular online help for Sky Talk
          </p>
          <a href="https://www.sky.com/help/home/sky-talk/joining-sky-talk" class="c-link" data-tracking-label="Joining Sky Talk" aria-label="Joining Sky Talk">
             Joining Sky Talk
          </a>
          <a href="https://www.sky.com/help/home/sky-talk/fix-problems-with-my-phone/articles/fix-phone-problems-start" class="c-link" data-tracking-label="Fix problems with my phone" aria-label="Fix problems with my phone">
             Fix problems with my phone
          </a>
          <a href="https://www.sky.com/help/home/sky-talk/sky-talk-features" class="c-link" data-tracking-label="Sky Talk features" aria-label="Sky Talk features">
             Sky Talk features
          </a>
          <a href="https://www.sky.com/help/home/sky-talk/nuisance-calls/articles/dealing-with-nuisance-phone-calls-and-texts" class="c-link" data-tracking-label="Nuisance calls" aria-label="Nuisance calls">
             Nuisance calls
          </a>
          <a href="https://www.sky.com/help/home/sky-talk/talk-your-account" class="c-link" data-tracking-label="My account" aria-label="My account">
             My account
          </a>
          <a href="https://www.sky.com/help/home/sky-talk/talk-policies-and-info" class="c-link" data-tracking-label="Policies and info" aria-label="Policies and info">
             Policies and info
          </a>
       </div>
       ${getVisitOnlineHtml()}
       <span class="ccx-border"></span>
    </div>
    
    <div id="Sky Yahoo Mail" class="ccx-sub ccx-hidden">
    <a href="https://www.sky.com/help/home/sky-yahoo-mail" class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary" data-test-id="base-link" data-tracking-label="Get help with Sky Yahoo Mail" aria-label="Get help with Sky Yahoo Mail">
    Get help with Sky Yahoo Mail
    </a>
    <span class="ccx-border"></span>
    <div class="ccx-list-links">
       <p class="text__Text-sc-1u9gciq-0">
          Other popular online help for Sky Yahoo Mail
       </p>
       <a href="https://www.sky.com/help/home/sky-yahoo-mail/setting-up-yahoo-mail/articles/getting-started-with-sky-yahoo-mail" class="c-link" data-tracking-label="Accessing Yahoo Mail" aria-label="Accessing Yahoo Mail">
          Accessing Yahoo Mail
       </a>
       <a href="https://www.sky.com/help/home/sky-yahoo-mail/using-yahoo-mail" class="c-link" data-tracking-label="Using Yahoo Mail" aria-label="Using Yahoo Mail">
          Using Yahoo Mail
       </a>
       <a href="https://www.sky.com/help/home/sky-yahoo-mail/yahoo-mail-fix" class="c-link" data-tracking-label="Fixing issues with Yahoo Mail" aria-label="Fixing issues with Yahoo Mail">
          Fixing issues with Yahoo Mail
       </a>
       <a href="https://www.sky.com/help/home/sky-yahoo-mail/privacy-and-security" class="c-link" data-tracking-label="Privacy and security" aria-label="Privacy and security">
          Privacy and security
       </a>
       <a href="https://www.sky.com/help/home/sky-yahoo-mail/email-apps/articles/problems-accessing-sky-mail-from-your-email-app" class="c-link" data-tracking-label="Updating my email app" aria-label="Updating my email app">
          Updating my email app
       </a>
    </div>
    ${getVisitOnlineHtml()}
    <span class="ccx-border"></span>
    </div>
    
       </div>
    </div>
    </div>
`;
const container = optyContainer;
const numberGeneratorHtml = `
  <div class="ccx-show-number o-container ccx-hidden">
    <p class="text__Text-sc-1u9gciq-0">
      If you’re still unable to resolve your query using the options above, you
      can get a number below to give us a call.
    </p>
    <button class="c-btn c-btn--full@small c-btn--site-nav c-btn--secondary ccx-number-btn" data-tracking-label="Show contact number" aria-label="Show contact number">
      <span id="ccx-num-intro">Show contact number</span>
     <span id="ccx-num-spinner" class="ccx-hidden"></span>
    </button>
<a href="#" class="ccx-hidden c-btn c-btn--full@small c-btn--site-nav c-btn--secondary NumberPoolingNumber" data-tracking-label="Tel number" aria-label="Tel number">03 432 098765</a>
    <div class="ccx-hidden text-content">
      <p class="text__Text-sc-1u9gciq-0 ccx-pt">
        This number is available for you to call an expert
        <strong>within the next hour.</strong>
        </p>
      <p class="text__Text-sc-1u9gciq-0 ehtDrR-small">
        *Calls to Sky contact centres are inclusive for Sky Mobile and Sky Talk
        customers.
        </p>
      <p class="text__Text-sc-1u9gciq-0 ehtDrR-small">
        If you're not a Sky Mobile or Sky Talk customer, calls to 01 numbers
        cost the same as calls to 02 and 03. If you don't have a calls package,
        charges apply so check your provider's tariff guide.
      </p>
    </div>
  </div>
`;

container.append(addedCard);
addedCard.outerHTML = cardHtml;
const numberGenerator = document.createElement("div");
document
  .querySelector(".ccx-card .ccx-dropdown-selection")
  .append(numberGenerator);
numberGenerator.outerHTML = numberGeneratorHtml;

document
  .querySelector(".ccx-get-touch")
  .addEventListener("click", function (e) {
    e.preventDefault();
    document.querySelector(".ccx-get-touch").classList.add("ccx-hidden");
    if (document.querySelector(".ccx-dropdown-selection.ccx-hidden")) {
      document
        .querySelector(".ccx-dropdown-selection")
        .classList.remove("ccx-hidden");
    }
  });
document
  .getElementById("u46_input target")
  .addEventListener("change", function () {
    "use strict";
    let vis = document.querySelector(".ccx-visible:not(.ccx-sub)"),
      target = document.getElementById(this.value);
   // console.log(this.value);
  sendEvar(this.name,this.value);
    if (this.value !== "Please choose" && this.value !== "Sky TV") {
      if (document.querySelector(".ccx-show-number.ccx-hidden")) {
       // console.log(document.querySelector(".ccx-show-number.ccx-hidden"));
        document
          .querySelector(".ccx-show-number.ccx-hidden")
          .classList.remove("ccx-hidden");
      }
     // document.getElementById("u194_input").selectedIndex=0;
    } else if(this.value == "Sky TV" &&  document.getElementById("u194_input").selectedIndex > 0){
       if (document.querySelector(".ccx-show-number.ccx-hidden")) {
       // console.log(document.querySelector(".ccx-show-number.ccx-hidden"));
        document
          .querySelector(".ccx-show-number.ccx-hidden")
          .classList.remove("ccx-hidden");
      }
    }else {
      document.querySelector(".ccx-show-number").classList.add("ccx-hidden");
        document.querySelector('#ccx-num-intro').classList.remove('ccx-hidden');
  document.querySelector('#ccx-num-spinner').classList.add('ccx-hidden');
    document.querySelector('#ccx-num-spinner').classList.remove('ccx-inline-block');
      document.querySelector('.NumberPoolingNumber').classList.add('ccx-hidden');
       document.querySelector('.ccx-number-btn').classList.remove('ccx-hidden');
       if (document.querySelector(".ccx-show-number .text-content")) {
      document
        .querySelector(".ccx-show-number .text-content")
        .classList.add("ccx-hidden");
    }
      if(document.querySelector('.opty-extra-border')){
     // document.querySelector('.opty-extra-border').classList.add("ccx-hidden-important");
      }
      
    }
    if (vis !== null) {
      vis.className = "ccx-hidden";
    }
    if (target !== null) {
      target.className = "ccx-visible";
    }
  });
document.getElementById("u194_input").addEventListener("change", function () {
  "use strict";
  let vis = document.querySelector(".ccx-sub.ccx-visible"),
    target = document.getElementById(this.value);
 // console.log('______',this.value);
   sendEvar(this.name,this.value);
  if (vis !== null) {
    vis.className = "ccx-hidden";
  }
  if (target !== null) {
    target.className = "ccx-sub ccx-visible";
          if (document.querySelector(".ccx-show-number.ccx-hidden")) {
       // console.log(document.querySelector(".ccx-show-number.ccx-hidden"));
        document
          .querySelector(".ccx-show-number.ccx-hidden")
          .classList.remove("ccx-hidden");
      }
     if(document.querySelector('.opty-extra-border')){
     // document.querySelector('.opty-extra-border').classList.remove("ccx-hidden-important");
      }
  } else {
  document
          .querySelector(".ccx-show-number")
          .classList.add("ccx-hidden");
     if(document.querySelector('.opty-extra-border')){
   //   document.querySelector('.opty-extra-border').classList.add("ccx-hidden-important");
      }
  }
  if( this.value == 'Please choose 2') {
    document
          .querySelector(".ccx-show-number")
          .classList.add("ccx-hidden");
  }
});
document
  .querySelector(".ccx-number-btn")
  .addEventListener("click", function () {
  document.querySelector('#ccx-num-intro').classList.add('ccx-hidden');
  document.querySelector('#ccx-num-spinner').classList.remove('ccx-hidden');
    document.querySelector('#ccx-num-spinner').classList.add('ccx-inline-block');
  numberChangeTest();
   // document.querySelector(".ccx-number-btn").textContent = "03 432 098765";
   /* if (document.querySelector(".ccx-show-number .ccx-hidden.text-content")) {
      document
        .querySelector(".ccx-show-number .ccx-hidden.text-content")
        .classList.remove("ccx-hidden");
    } */
  });

}

utils.observeSelector('.o-container.c-article__body div', function(optyContainer) {
if(!document.querySelector('.ccx-card')){
mainUI(optyContainer);
 createNewContainers(); 
} 
});

utils.observeSelector('div.c-card.c-card-cta.c-card--static.ccx-card .opty-new-right-container > a', function(refLink) {
if(!document.querySelector('div.c-card.c-card-cta.c-card--static.ccx-card .opty-new-right-container > .ccx-dropdown-selection.o-container ')){
moveNewContainer(refLink);
} 
});

/*
utils.observeSelector('#article .o-container.c-article__body', function(body) {
if(document.location.pathname == '/help/articles/contact-us-t1'){
if(!document.querySelector('.opty-overlay')){
initiateLoading();
}
}
});

utils.observeSelector('div.c-card.c-card-cta.c-card--static.ccx-card .opty-new-right-container > .ccx-dropdown-selection.o-container', function() {
removeLoading();
});

*/
}}, {"value": "<style>.ccx-hidden {\n  display: none;\n}\n.opty-height{\nheight: 50vh;\n}\n\n.dActUj-opty{line-height:0;text-align: center;margin-top: 20px;}\n.hnHvyx-opty{animation:1s linear 0s infinite normal none running GLFYz;border-color:currentcolor currentcolor currentcolor transparent;border-radius:50%;border-style:solid;border-width:1px;display:inline-block;position:relative;height:40px;width:40px;}\n\n.ccx-hidden-important {\n  display: none !important;\n}\n.ccx-inline-block{\n display: inline-block;\n}\n.ccx-card .o-container.u-padding-large {\n  padding-bottom: 20px !important;\n}\n.ccx-card select {\n  height: 40px;\n}\n.ccx-card select#u46_input\\ target {\n  /*width: 50%;*/\n  width: 300px;\n  /*! CSS Used from: Embedded */\n}\n.ccx-card select#u194_input {\n  /*width: 30%;*/\n  width: 185px;\n}\n\n.ccx-card select#u46_input\\ target, .ccx-card select#u194_input {padding-left: 16px;background:none;border: 1px solid rgb(77, 77, 77);border-radius: 4px;cursor:pointer;font:inherit;height:54px;   -webkit-appearance: none;\n  -moz-appearance: none;}\n\n.ccx-select-wrapper{\n    position: relative;\n    width: fit-content;\n}\n\n.ccx-select-wrapper .jsXipz {\n-webkit-box-align: center;\n    align-items: center;\n    display: flex;\n    height: 100%;\n    pointer-events: none;\n    position: absolute;\n    right: 12px;\n    top: 0px;\n}\n.ccx-select-wrapper .gTvruJ {\n    fill: currentcolor;\n    flex: 0 0 auto;\n    height: 24px;\n    width: 24px;\n}\n/*\n#ccx_img_u194_div, #ccx_img_u46_div{\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    height: 22px;\n    margin: auto 0;\n}\n\n*/\n\n\n\n\n\n.ccx-card .c-btn--secondary {\n  margin-top: 20px;\n}\n.ccx-pt {\n  margin-top: 20px;\n  margin-bottom: 15px;\n}\n.ccx-card .c-link {\n  display: block;\n}\n.ccx-visit-online {\n  background-color: #fafafa;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  padding: 20px;\n}\n.ccx-list-links {\n  background-color: #fafafa;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  border-bottom: none;\n  padding: 20px;\n}\n.ccx-list-links p {\n  margin-bottom: 15px;\n}\n.ccx-show-number {\n  padding: 0;\n}\n.ccx-border {\n  display: inline-block;\n  margin: 20px 0;\n  width: 100%;\n  height: 1px;\n  background-color: rgba(0, 0, 0, 0.1);\n}\n.please-choose .ccx-visit-online {\n  padding: 20px;\n}\n.ehtDrR-small {\n  font-size: 14px;\n  line-height: 16px;\n  padding: 10px 0;\n}\n.c-btn--secondary.ccx-number-btn:focus {\n  box-shadow: none;\n}\n.ccx-number-btn, .NumberPoolingNumber{\n    width: 270px;\n}\n\n#ccx-num-spinner {\nanimation: 1s linear 0s infinite normal none running GLFYz;\n    border-color: currentcolor currentcolor currentcolor transparent;\n    border-radius: 50%;\n    border-style: solid;\n    border-width: 1px;\n    position: relative;\n    height: 24px;\n    width: 24px;\ncolor: #000FF5;\nmargin-top: 7px;\n}\n@keyframes GLFYz{\n100% {\n    transform: rotate(360deg);\n}\n}\n\n.NumberPoolingNumber{\nheight: 39.96px;\nline-height: 39.96px;\nfont-weight: 700;\nfont-style: normal;\nfont-size: 24px;\ncolor: #000FF5;   \n}\n\n.NumberPoolingNumber span{\nfont-weight: 400;\nfont-style: normal;\nfont-size: 16px;\nletter-spacing: normal;\ncolor: #333333;\n position: absolute;\n align-self: flex-start;\npadding: 0px 0px 0px 0px;\n box-sizing: border-box;\n}\n\n.ccx-dropdown-selection {\n  padding: 0 40px 20px 40px;\n}\n.ccx-first-headline {\n  border-top: 1px solid rgba(0, 0, 0, 0.1);\n  padding-top: 20px;\n  padding-bottom: 15px;\n}\n\n\n\n\n\n\n\n\n/***/\n\n.c-card.c-card-cta.c-card--static{\ndisplay: flex;\nflex-flow: column wrap;\nborder-radius: 4px;\nborder: 1px solid #CCCCCC;\nbox-shadow: none;\nmax-width: 736px;\nmargin-left: auto !important;  \nmargin-right:   auto !important;  \n}\n\n.c-card.c-card-cta.c-card--static.ccx-card {\nmargin-top: 20px;\n}\n\n.c-card.c-card-cta.c-card--static > .o-container {\ndisplay: flex;\nflex-flow: row nowrap;\nflex-direction: row;\npadding: 24px 24px 32px !important;  \nmargin: 0 !important;  \n}\n\n.c-card.c-card-cta.c-card--static > .o-container > h2{\n  display: block;\n    flex: 0 0 140px;\n    align-items: center;\n    flex-flow: column;\n      padding-right: 16px;\n      position: relative;\n}\n\n\n\n@media only screen and (min-width: 640px) {\n.o-container.c-article__body {\nmargin: 0 32px !important;\n}\n  .c-card.c-card-cta.c-card--static{\nmargin-bottom: 12px !important;\n}\n  .c-card.c-card-cta.c-card--static > .o-container > p{\n    margin-left: 24px;\n}\n}\n\n\n@media only screen and (max-width: 639px) {\n.o-container.c-article__body {\nmargin: 24px 16px 32px !important;\n}\n  \n    .c-card.c-card-cta.c-card--static{\nmargin-bottom: 4px !important;\n}\n   .ccx-card .c-btn.c-btn--secondary {\n    height: auto !important;\n    padding-bottom: 8px !important;\n    padding-top: 8px !important;\n    line-height: 1.5em !important;\n  }\n  \n  .ccx-list-links .c-link {\npadding-bottom: 12px;\n}\n  \n  .ccx-card > .o-container {\n  padding-left: 20px !important;\n   padding-right: 20px !important;  \n  }\n\n}\n\n\n/*\n@media only screen and (max-width: 739px) {\n  \n  .c-card.c-card-cta.c-card--static{\nmargin-bottom: 4px !important;\n}\n   .ccx-card .c-btn.c-btn--secondary {\n    height: auto !important;\n    padding-bottom: 4px !important;\n    padding-top: 4px !important;\n    line-height: 1.5em !important;\n  }\n  \n  .ccx-list-links .c-link {\npadding-bottom: 12px;\n}\n  \n  .ccx-card > .o-container {\n  padding-left: 20px !important;\n   padding-right: 20px !important;  \n  }\n\n} \n\n*/\n\n\n\n.opty-new-left-container{\n    padding-right: 16px;\n    position: relative;\n    display: flex;\n   align-items: center;\n}\n\n.opty-new-left-container::after{\n    content: '';\n    background-color: #CCCCCC;\n}\n\n@media only screen and (max-width: 959px) {\n    .opty-new-left-container::after{\n     width: calc(100% + 8px);\n    flex: 0 0 calc(100% + 8px);\n    margin: 12px auto auto -4px;\n    height: 1px; \n  }\n}\n@media only screen and (min-width: 640px) {\n  .opty-new-left-container{\n    flex-flow: column;\n    flex: 0 0 140px;\n    align-items: center;\n  }\n  .opty-new-left-container::after{\n    position: absolute;\n    right: 0;\n    top: 0;\n    height: calc(100% + 8px);\n    margin-top: -4px;\n    width: 1px;\n  }\n  \n  .opty-new-left-container .opty-new-svg {\n  height: 32px;\n  width: 32px;\n   flex: 0 0 32px;\n    margin-bottom: 8px;\n  }\n  \n    .opty-new-left-container [class ^=\"text__Text\"] {\n    align-items: center;\n    text-align: center;\n    width: 100%;\n     flex: 1 1 100%;\n     display: flex;\n    flex-direction: column;\n     font-size: 24px;\n    line-height: 28px;\n  }\n  \n  .opty-new-right-container{\n  margin-left: 24px;\n  }\n}\n/******/\n\n\n/*******/\n@media only screen and (max-width: 639px) {\n  \n  .c-card.c-card-cta.c-card--static > .o-container {\ndisplay: flex;\nflex-flow: column;\n padding: 16px 16px 24px;\npadding: 24px 24px 32px !important;  \nmargin: 0 !important;  \n}\n  \n  .opty-new-left-container{\n    flex-flow: row wrap;\n  }\n     .opty-new-left-container .opty-new-svg {\n    height: 24px;\n    width: 24px;\n    flex: 0 0 24px;\n    margin-right: 12px;\n  }\n  \n      .opty-new-left-container [class ^=\"text__Text\"] {\n     display: flex;\n    flex-direction: column;\n    font-size: 20px;\n    line-height: 24px;\n    margin-bottom: 0px;\n  }\n    .opty-new-right-container{\n    align-items: center;\n    margin-top: 12px;\n  }\n  \n  \n  /***new content**/\n  .ccx-select-wrapper {\nwidth: auto;  \n}\n}\n\n\n\n/*\n26-09\n*/\n.opty-new-right-container > a.ccx-get-touch.ccx-hidden{\ndisplay: none !important;\n}\n\n@media only screen and (max-width: 739px) {\n.ccx-get-touch{\ndisplay: inline-block !important;  \nwidth: auto !important;  \n}\n}\n\n@media only screen and (max-width: 639px) {\n.ccx-get-touch, .opty-new-right-container > a{\ndisplay: block !important;  \nwidth: 100% !important;  \n}\n  \n.ccx-dropdown-selection.o-container{\n  padding: 0 !important;\n}\n    .ccx-card select#u46_input\\ target, .ccx-card select#u194_input {\n    width: 100%;\n  }\n}\n\n@media only screen and (max-width: 444px) {\n .u46_input, .u194_input {\n  white-space:pre-wrap;\n   font-size: 16px !important;\n  }\n}\n@media only screen and (max-width: 400px) {\n  .NumberPoolingNumber.c-btn--secondary, .c-btn--secondary.ccx-number-btn{\n      width: 100% !important;;\n  }\n}\n@media only screen and (max-width: 355px) and (min-width: 300px)  {\n  .u46_input {\n  padding-left: 2px;\n  }\n  .ccx-select-wrapper .jsXipz {\n    right: 4px;\n}\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "F8861410-ACF2-494D-A60A-3C09C9D4DC34"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22103460202", "integrationSettings": null}], "id": "22091500235", "weightDistributions": null, "name": "454: Re-design of contact us page", "groupId": null, "commitId": "22198951661", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22009305579", "22094200480", "22105650832", "22266250491", "22298890066"], "experiments": [{"weightDistributions": [{"entityId": "22107531194", "endOfRange": 1000}, {"entityId": "22104200469", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "AC - messaging in billing", "bucketingStrategy": null, "variations": [{"id": "22107531194", "actions": [], "name": "Original"}, {"id": "22104200469", "actions": [{"viewId": "22105650832", "changes": [{"dest": "https://www.sky.com/help/articles/been-overcharged-bwm-t1", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "28C0CD13-BF0F-470D-A2B5-17A37BA7EA6F"}]}, {"viewId": "22094200480", "changes": [{"dest": "https://www.sky.com/help/articles/bill-not-as-expected-not-sure-bwm-t1", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "7B96C9E5-430A-4E04-8922-0ED9FBF0CC28"}]}, {"viewId": "22009305579", "changes": [{"dest": "https://www.sky.com/help/articles/understanding-my-bills-bwm-t1", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "3256CE13-E70D-4B2A-847D-52C79103F61C"}]}, {"viewId": "22298890066", "changes": [{"dest": "https://www.sky.com/help/articles/billing-and-debt-management-bwm-t1", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "F78C7690-8D8C-4307-B7C6-DF4CDCF95527"}]}, {"viewId": "22266250491", "changes": [{"dest": "https://www.sky.com/help/articles/bills-and-payments-management-bwm-t1", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "C71F041B-8EEA-43F5-A14F-00D43DF9C341"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22033037310", "integrationSettings": null}], "id": "22096190472", "weightDistributions": null, "name": "AC - messaging in billing", "groupId": null, "commitId": "22323080057", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22142190200"], "experiments": [{"weightDistributions": [{"entityId": "22141570501", "endOfRange": 2000}, {"entityId": "22110140426", "endOfRange": 4000}, {"entityId": "22149760300", "endOfRange": 6000}, {"entityId": "22117930962", "endOfRange": 8000}, {"entityId": "22167010264", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "462: Community x Gatekeeper API round 2", "bucketingStrategy": null, "variations": [{"id": "22141570501", "actions": [{"viewId": "22142190200", "changes": [{"dependencies": [], "type": "custom_code", "id": "A686A73B-3921-42D9-9CC6-08728B2DC1B3", "value": function($){var utils = window.optimizely.get('utils');


var resultItems = false;
var contactUsCopy = false;
var queryBuilder = window.__opty_gatekeeper_community__roundTwo.queryBuilder;
var fetchApi = window.__opty_gatekeeper_community__roundTwo.fetchApi;
var getMetaData = window.__opty_gatekeeper_community__roundTwo.getMetaData;
var pushGenEvar7 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar7;
var pushGenEvar18 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar18;

////////////////////////


var buildUI = function(items){
  pushGenEvar18('462: Community x Gatekeeper API round2: Original');
};

//////////////////////////

 if(resultItems !== false){
  buildUI(resultItems);
 } else {

var columns_list_arr = ['board.id', 'board.view_href', 'post_time_friendly', 'view_href', 'subject', 'search_snippet', 'conversation.solved'];
var subject_matches_arrThree = getMetaData(3);
var body_matches_arrThree =getMetaData(3);
var isSolved = true;
var limit = 3;

var urlQueryThree =  queryBuilder(columns_list_arr, subject_matches_arrThree, body_matches_arrThree, isSolved, limit);

var fetchThree = fetchApi(urlQueryThree);

fetchThree.then(function(itemsThree){
  if(Array.isArray(itemsThree)){
  if(itemsThree.length == 0){

var subject_matches_arrTitle = getMetaData(0,true);
var body_matches_arrTitle =getMetaData(0,true);  
var urlQueryTitle =  queryBuilder(columns_list_arr, subject_matches_arrTitle, body_matches_arrTitle, isSolved, limit);
var fetchTitle = fetchApi(urlQueryTitle);
fetchTitle.then(function(itemsTitle){
    if(Array.isArray(itemsTitle)){
  if(itemsTitle.length == 0){

var subject_matches_arrTwo = getMetaData(2);
var body_matches_arrTwo =getMetaData(2);  
var urlQueryTwo =  queryBuilder(columns_list_arr, subject_matches_arrTwo, body_matches_arrTwo, isSolved, limit);   
var fetchTwo = fetchApi(urlQueryTwo);
     fetchTwo.then(function(itemsTwo){
    if(Array.isArray(itemsTwo)){
  if(itemsTwo.length == 0){   

var subject_matches_arrOne = getMetaData(1);
var body_matches_arrOne =getMetaData(1);  
var urlQueryOne =  queryBuilder(columns_list_arr, subject_matches_arrOne, body_matches_arrOne, isSolved, limit);   
var fetchOne = fetchApi(urlQueryOne);   
     fetchOne.then(function(itemsOne){
           if(Array.isArray(itemsOne)){
  if(itemsOne.length > 0){


  resultItems = itemsOne;
   
   buildUI(itemsOne);
  } 
             
  }         
       
       
       
     });
    
    
    
  } else {
    resultItems = itemsTwo;
     buildUI(itemsTwo);
  }
    }
       
     });
    
  } else {
  resultItems = itemsTitle;
   buildUI(itemsTitle);
  }
    }
   
   
   
   
 
 }).catch(function(e){
console.log('error', e);
});   
    
    
    
    
  } else {
  resultItems = itemsThree;
  buildUI(itemsThree);
  }
  }

}).catch(function(e){
//removetempStyle();
console.log('error', e);
}); 
 }
}}]}], "name": "Original"}, {"id": "22110140426", "actions": [{"viewId": "22142190200", "changes": [{"dependencies": [], "type": "custom_code", "id": "9C006B39-51B9-4B1C-8C7F-D3CEB8F50B74", "value": function($){var utils = window.optimizely.get('utils');

function initialLoading(){
 hideControlPods();
var spinner = '<div style="width: 30px;margin: auto;" id="ccx-num-spinner-container"> <span id="ccx-num-spinner"></span></div>';
document.querySelector(' [class^="contact-option__CardContainer-gatekeeper-lib"]').insertAdjacentHTML('beforebegin', spinner);

}

function removeLoader(){
  if(document.querySelector('#ccx-num-spinner-container')){
    document.querySelector('#ccx-num-spinner-container').remove();
  }
}

function showControlPods(){
    document.querySelectorAll('.hidden-opty-control').forEach(controlPod => 
        controlPod.classList.remove('hidden-opty-control')); 
    }


function hideControlPods(){

    document.querySelector('[class^="ContactTreeHeader__Wrapper-gatekeeper-lib"]').classList.add('hidden-opty-control');
    document.querySelectorAll('[class^="contact-option__CardContainer-gatekeeper-lib"]').forEach(controlPod => 
        controlPod.classList.add('hidden-opty-control')); 
}

var resultItems = false;
var contactUsCopy = false;
var queryBuilder = window.__opty_gatekeeper_community__roundTwo.queryBuilder;
var fetchApi = window.__opty_gatekeeper_community__roundTwo.fetchApi;
var getMetaData = window.__opty_gatekeeper_community__roundTwo.getMetaData;
var pushGenEvar7 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar7;
var pushGenEvar18 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar18;

////////////////////////

function clearAll(){
  /*
document.querySelectorAll('[class*="opty-"]').forEach(function(elem){
elem.classList.remove('opty-show-on');
elem.classList.remove('opty-parent-title');
elem.classList.remove('opty-parent-option');  
});
*/  
  if(document.querySelector('#opty-community-api')){
  document.querySelector('#opty-community-api').remove();
  }
 
      // for var3 & 4
//   if(document.querySelector('#opty-community-api-extra')){
//     document.querySelector('#opty-community-api-extra').remove();
// } 
  
showControlPods();
}
/////////////////////////////

function updateBreadCrumbs(showContact){
  if(document.querySelector('.c-breadcrumbs-no-background')){
  if(!showContact){
  if(document.querySelector('.c-breadcrumbs-no-link')){
if(contactUsCopy === false){
   contactUsCopy =  document.querySelector('.c-breadcrumbs-no-link').innerText;
}

     document.querySelector('.c-breadcrumbs-no-link').innerText = 'Sky Community Help';
    if(document.querySelector('#opty-breadcrumb-community')){
    document.querySelector('#opty-breadcrumb-community').remove();
    }

  }
  
  } else {
  //contact
      var newB = '<div id="opty-breadcrumb-community" class="c-breadcrumbs__crumb c-breadcrumbs__crumb--no-margin" data-test-id="breadcrumbs-breadcrumb-onclick"><button type="button" aria-label="Return to Sky Community Help" class="c-link" data-test-id="toolkit-link"><span data-test-id="toolkit-clickable-text" class="" aria-hidden="true">Sky Community Help</span></button><svg viewBox="0 0 32 32" class="icon__Svg-sc-6w188g-0 egIReE c-icon" aria-hidden="true"><g id="linear-arrow-right"><path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path></g></svg></div>';
     if(document.querySelector('.c-breadcrumbs-no-link')){
  document.querySelector('.c-breadcrumbs-no-link').innerText = contactUsCopy;
       if(!document.querySelector('#opty-breadcrumb-community')){
         document.querySelector('.c-breadcrumbs-no-link').insertAdjacentHTML('beforebegin', newB);
         document.querySelector('#opty-breadcrumb-community button').addEventListener('click', function(){
             updateBreadCrumbs();  
           hideControlPods(); 
           buildUI(resultItems);
           
         });
       }
  }
  }

  

}

}


var buildUI = function(items){
var svgBubble = '<svg viewBox="0 0 32 32" class="opty-svg-bubble" role="presentation" aria-hidden="true" data-test-id="contact-option-icon"><g id="linear-chat2"><path d="M19.125 3a3 3 0 0 1 3 3v5.42H28a3 3 0 0 1 3 3v7.013a3 3 0 0 1-3 3h-.708v4.565a1 1 0 0 1-1.708.707l-5.272-5.272h-7.437a3 3 0 0 1-3-3v-3.547l-3.459 3.46a1 1 0 0 1-1.708-.707v-4.565H4a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3zM28 13.42H12.875c-.551 0-1 .449-1 1v7.013c0 .551.449 1 1 1h8.266l4.151 4.151v-4.151H28c.551 0 1-.449 1-1V14.42c0-.551-.449-1-1-1zM19.125 5H4c-.551 0-1 .449-1 1v7.074c0 .551.449 1 1 1h2.708v4.151l3.167-3.167v-.638a3 3 0 0 1 3-3h7.25V6c0-.551-.449-1-1-1z" id="Icon"></path></g></svg>';

var solvedBubble = '<div class="opty-solved-bubble">Solved</div>';

var getInTouch = '<div class="opty-prefer-contact"><h3>Not quite what you’re looking for?</h3><button id="opty-prefer-contact" aria-label="I’d prefer to get in touch ☎️">I’d prefer to get in touch ☎️</button></div>';
var html = '<div id="opty-community-api">';
html+='<h2 class="opty-header">Sky Community - What other people are asking</h2>';
html+= '<div class="opty-intro"><p>Interact with a community of customers sharing experiences and helping each other with advice.</p></div>';
for(var i=0;i<items.length;i++){
var theAnswer =   items[i];

html+= '<div class="opty-single-answer">';

html+=  '<div class="opty-single-header">';
html+=  '<div class="opty-single-header-left">';  
html+= svgBubble;
html+= '<a class="title-link" href="'+theAnswer.view_href+'" target="_blank">'+theAnswer.subject+'</a>';
html+= '</div>'; //end header-left
html+=  '<div class="opty-single-header-right">';    
html+= '<span class="span-local-date">'+theAnswer.post_time_friendly+'</span>';
html+= solvedBubble;
html+= '</div>'; //end header-right  
html+= '</div>'; //end header 

html+=  '<div class="opty-single-body">'; 
html+= '<p>'+theAnswer.search_snippet+'</p>';   
html+= '</div>'; //end body  
html+= '</div>'; //end single
}
html+= getInTouch;
html+= '</div>';

utils.observeSelector('[data-test-id="tree-node"] [data-test-id="node-heading"]',function (title) {
   if(document.querySelector('[data-test-id="tree-node"]  .c-breadcrumbs-no-background')){
      var parentTitle = title.parentElement;
if(!document.querySelector('#opty-community-api')){
parentTitle.insertAdjacentHTML('afterend', html);  
// addCommunityCss(parentTitle); 
removeLoader();
updateBreadCrumbs();  
} 
   
   }

});
  pushGenEvar18('462: Community x Gatekeeper API round2: Variation#1');
};

//////////////////////////

 if(resultItems !== false){
  buildUI(resultItems);
 } else {
  initialLoading();
var columns_list_arr = ['board.id', 'board.view_href', 'post_time_friendly', 'view_href', 'subject', 'search_snippet', 'conversation.solved'];
var subject_matches_arrThree = getMetaData(3);
var body_matches_arrThree =getMetaData(3);
var isSolved = true;
var limit = 3;

var urlQueryThree =  queryBuilder(columns_list_arr, subject_matches_arrThree, body_matches_arrThree, isSolved, limit);

var fetchThree = fetchApi(urlQueryThree);

fetchThree.then(function(itemsThree){
  if(Array.isArray(itemsThree)){
  if(itemsThree.length == 0){

var subject_matches_arrTitle = getMetaData(0,true);
var body_matches_arrTitle =getMetaData(0,true);  
var urlQueryTitle =  queryBuilder(columns_list_arr, subject_matches_arrTitle, body_matches_arrTitle, isSolved, limit);
var fetchTitle = fetchApi(urlQueryTitle);
fetchTitle.then(function(itemsTitle){
    if(Array.isArray(itemsTitle)){
  if(itemsTitle.length == 0){

var subject_matches_arrTwo = getMetaData(2);
var body_matches_arrTwo =getMetaData(2);  
var urlQueryTwo =  queryBuilder(columns_list_arr, subject_matches_arrTwo, body_matches_arrTwo, isSolved, limit);   
var fetchTwo = fetchApi(urlQueryTwo);
     fetchTwo.then(function(itemsTwo){
    if(Array.isArray(itemsTwo)){
  if(itemsTwo.length == 0){   

var subject_matches_arrOne = getMetaData(1);
var body_matches_arrOne =getMetaData(1);  
var urlQueryOne =  queryBuilder(columns_list_arr, subject_matches_arrOne, body_matches_arrOne, isSolved, limit);   
var fetchOne = fetchApi(urlQueryOne);   
     fetchOne.then(function(itemsOne){
           if(Array.isArray(itemsOne)){
  if(itemsOne.length > 0){


  resultItems = itemsOne;
   
   buildUI(itemsOne);
  }  else {
    /*08-2022*/
  // removetempStyle();
   clearAll(); 
  }
             
  }         
       
       
       
     });
    
    
    
  } else {
    resultItems = itemsTwo;
     buildUI(itemsTwo);
  }
    }
       
     });
    
  } else {
  resultItems = itemsTitle;
   buildUI(itemsTitle);
  }
    }
   
   
   
   
 
 }).catch(function(e){
 //removetempStyle();
 clearAll(); 
console.log('error', e);
});   
    
    
    
    
  } else {
  resultItems = itemsThree;
  buildUI(itemsThree);
  }
  }

}).catch(function(e){
//removetempStyle();
clearAll(); 
console.log('error', e);
}); 
 }  



  utils.observeSelector('[data-test-id^="contact-option-"]',function () {
   // addCommunityCss(); 
   // ??????? hideControlPods();
  });

  utils.observeSelector('[data-test-id^="node-button"]',function () {
   clearAll(); 
  });

  utils.observeSelector('#opty-prefer-contact',function (btn) {
    btn.addEventListener('click', function(){
        clearAll(); 
        updateBreadCrumbs(true); 

    });
  });

 utils.observeSelector('.opty-single-answer .title-link',function () {
   document.querySelectorAll('.opty-single-answer .title-link').forEach(function(l){
   l.addEventListener('click', function(){
           pushGenEvar7();
         });
   });
  });

//Add previous
 utils.observeSelector('.ctn-previous',function (prev) {
  var parentPrev = prev.parentElement;
     parentPrev.style.display = 'none'; 
   if(!document.querySelector('#opty-previous-container')){
      parentPrev.insertAdjacentHTML('afterend', '<div id="opty-previous-container"> <svg viewBox="0 0 32 32" aria-hidden="true"> <g id="linear-arrow-left"> <path d="M22.333 6.032C22.128 5.785 21.523 5 21.07 5c-.198.008-.366.087-.53.248L10.274 15.512a.934.934 0 0 0 0 1.32L20.54 27.098c.164.162.332.24.53.248.452 0 1.057-.784 1.262-1.032l.11-.137-10.002-10.003L22.444 6.17l-.111-.138" id="Icon"></path> </g> </svg> <button data-test-id="back-contact-tree-link">Previous step</button> </div>');
     //.c-breadcrumbs-no-background button
     if(document.querySelector('#opty-previous-container button')){
     document.querySelector('#opty-previous-container button').addEventListener('click', function(){
     document.querySelectorAll('.c-breadcrumbs-no-background button')[document.querySelectorAll('.c-breadcrumbs-no-background button').length -1 ].click();
     });
     }
   }

  });
//    }
}}, {"value": "<style>#ccx-num-spinner {\nanimation: 1s linear 0s infinite normal none running GLFYz;\n    border-color: currentcolor currentcolor currentcolor transparent;\n    border-radius: 50%;\n    border-style: solid;\n    border-width: 1px;\n    position: relative;\n  display:inline-block;\n    height: 24px;\n    width: 24px;\ncolor: rgb(77, 77, 77);\nmargin-top: 7px;\n}\n@keyframes GLFYz{\n100% {\n    transform: rotate(360deg);\n}\n}\n\n.hidden-opty-control{\ndisplay: none !important;\n}\n#opty-community-api .opty-intro {\nmargin-bottom: 13px;\n}\n\n\n\n#opty-community-api .opty-header{\ncolor: inherit;\nfont-weight: bold;\n margin-bottom: 20px;\n}\n\n#opty-community-api .opty-single-answer{\n    border-radius: 4px;\n    border: 1px solid #CCCCCC;\n  margin-bottom: 13px;\n  padding-top: 12px;\n  padding-left:25px;\n  padding-right: 16px;\n  padding-bottom: 20px;\n}\n\n#opty-community-api .opty-single-header{\n  display: flex;\n}\n#opty-community-api .opty-single-header-left{\n    display: flex;\n  mmax-width:400px;\n}\n#opty-community-api .opty-single-header-right{\n display: flex;\n    min-width: 130px;\n  justify-content: space-between;\n   flex-grow: 100;\n}\n\n#opty-community-api .opty-solved-bubble{\n width: 60px;\nheight: 19px;\nfont-size: 14px;\nbackground: #046714;\nborder-radius: 40px;\ndisplay: flex;\ncolor: #ffffff;\njustify-content: center;\nfont-weight: bold;  \nmargin-top: 2px;  \n}\n\n#opty-community-api .title-link{\nfont-weight: bold;\nfont-size: 20px;\nwwhite-space: nowrap;  \n}\n\n#opty-community-api .span-local-date{\nfont-size: 13px;\nline-height: 15px;\n  color: #4D4D4D;\n  word-break: break-word;\n    word-wrap: break-word;\n  margin-left: 14px;\n  margin-top: 6px;\n}\n\n\n#opty-community-api .opty-single-body p{\npadding-left: 45px;\nmax-width: 692px;\nwhite-space: nowrap;\noverflow: hidden;\ntext-overflow: ellipsis;  \n  \n}\n\n#opty-community-api .opty-single-body p, #opty-community-api .opty-intro p{\nfont-size: 16px;\n}\n\n.opty-prefer-contact h3 {\nfont-size: 28px;\n}\n\n@media (min-width: 640px){\n#opty-community-api .opty-header {\n    font-size: 28px;\n    line-height: 32px;\n}\n  #opty-community-api .opty-svg-bubble{\n  flex: 0 0 32px;\n    margin-bottom: 8px;\n    height: 32px;\n    width: 32px;\n    fill: #000FBE;\n    margin-right: 13px;\n  }\n  #opty-community-api .opty-single-header{\n  width: 100%;\n  }\n}\n\n@media (min-width: 0px) and (max-width: 639px){\n#opty-community-api .opty-single-answer{\n  padding-left:15px;\n  padding-right:15px;\n    padding-bottom: 18px;\n}\n  \n#opty-community-api .opty-single-header {\n    flex-direction: column;\n}\n  \n#opty-community-api .opty-header {\n    font-size: 24px;\n    line-height: 28px;\n}\n  \n    #opty-community-api .opty-svg-bubble{\n    flex: 0 0 24px;\n    margin-right: 12px;\n      height: 24px;\n    width: 24px;\n    fill: #000FBE;\n    margin-right: 11px;  \n  }\n  #opty-community-api .title-link{\n\nfont-size: 16px;  \n}\n  #opty-community-api .opty-single-body p {\n     padding-left: 0;\n}\n  #opty-community-api .opty-single-header-right {\n    justify-content: left;\n    flex-direction: row-reverse;\n    padding-left: 35px;\n}\n  .opty-prefer-contact h3 {\nfont-size: 24px;\n}\n\n}\n\n\n\n\n#opty-prefer-contact{-webkit-box-align:center;align-items:center;border:2px solid rgb(0, 15, 245);border-radius:4px;cursor:pointer;display:inline-flex;flex-shrink:0;font-size:18px;font-weight:bold;-webkit-box-pack:center;justify-content:center;line-height:24px;outline:none;padding:8px 16px;position:relative;text-align:center;transition-duration:300ms;transition-property:background, color, box-shadow;transition-timing-function:ease;background-color:rgb(255, 255, 255);color:rgb(0, 15, 245);}\n#opty-prefer-contact:hover{text-decoration:none; background-color: rgb(242, 243, 255);}\n#opty-prefer-contact:disabled{background-color:rgb(204, 204, 204);background-image:none;border-color:transparent;color:rgb(255, 255, 255);cursor:not-allowed;}\n#opty-prefer-contact::after{border:1px solid rgb(0, 151, 245);border-radius:6px;inset:-5px;content:\"\";opacity:0;pointer-events:none;position:absolute;transition:opacity 150ms linear 0s;}\n#opty-prefer-contact:focus::after{opacity:1;}\n@media (min-width:0px) and (max-width:639px){\n#opty-prefer-contact{font-size:18px;line-height:22px;}\n}\n@media (min-width:640px){\n#opty-prefer-contact{font-size:20px;line-height:24px;}\n}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n\n/*\n#opty-prefer-contact{color:inherit;font-weight:bold;color:#000FF5;}\n#opty-prefer-contact:hover{-webkit-text-decoration:none;text-decoration:none;}\n@media (min-width:0px) and (max-width:639px){\n#opty-prefer-contact{font-size:18px;line-height:22px;}\n}\n@media (min-width:640px){\n#opty-prefer-contact{font-size:20px;line-height:24px;}\n}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n\n\n#opty-prefer-contact{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row no-wrap;-ms-flex-flow:row no-wrap;flex-flow:row no-wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#FFFFFF;border:1px solid #CCCCCC;padding:8px 24px;border-bottom:2px solid #000FF5#00D2FF;border-radius:22px;cursor:pointer;-webkit-transition:background-color 0.3s ease,border-color 0.3s ease;transition:background-color 0.3s ease,border-color 0.3s ease;}\n#opty-prefer-contact:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#000FF5;border-color:#000FF5;}\n#opty-prefer-contact:hover span{color:#FFFFFF;}\n#opty-prefer-contact:focus{box-shadow:0 0 0 7px rgba(0,115,197,0.2);outline:none;}\n#opty-prefer-contact span{white-space:nowrap;-webkit-transition:color 0.3s ease;transition:color 0.3s ease;}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n*/\n\n/*****/\n\n/*\n.opty-show-on [data-test-id=\"node-heading\"], .opty-show-on div[data-test-id^=\"contact-option-\"], .opty-show-on .opty-parent-title{\ndisplay: none;\n}\n.opty-show-on .opty-parent-option{\nborder: 0;\n}\n*/</style>", "selector": "head", "dependencies": [], "type": "append", "id": "EDD4892F-242B-48E9-9E33-283B093EE4D7"}]}], "name": "Variation #1"}, {"id": "22149760300", "actions": [{"viewId": "22142190200", "changes": [{"dependencies": [], "type": "custom_code", "id": "8D18038E-9AFA-4C00-AFDC-D23DD891DD62", "value": function($){var utils = window.optimizely.get('utils');

function initialLoading(){
 hideControlPods();
var spinner = '<div style="width: 30px;margin: auto;" id="ccx-num-spinner-container"> <span id="ccx-num-spinner"></span></div>';
document.querySelector(' [class^="contact-option__CardContainer-gatekeeper-lib"]').insertAdjacentHTML('beforebegin', spinner);

}

function removeLoader(){
  if(document.querySelector('#ccx-num-spinner-container')){
    document.querySelector('#ccx-num-spinner-container').remove();
  }
}

function showControlPods(){
    document.querySelectorAll('.hidden-opty-control').forEach(controlPod => 
        controlPod.classList.remove('hidden-opty-control')); 
    }


function hideControlPods(){

    document.querySelector('[class^="ContactTreeHeader__Wrapper-gatekeeper-lib"]').classList.add('hidden-opty-control');
    document.querySelectorAll('[class^="contact-option__CardContainer-gatekeeper-lib"]').forEach(controlPod => 
        controlPod.classList.add('hidden-opty-control')); 
}

var resultItems = false;
var contactUsCopy = false;
var queryBuilder = window.__opty_gatekeeper_community__roundTwo.queryBuilder;
var fetchApi = window.__opty_gatekeeper_community__roundTwo.fetchApi;
var getMetaData = window.__opty_gatekeeper_community__roundTwo.getMetaData;
var pushGenEvar7 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar7;
var pushGenEvar18 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar18;

////////////////////////

function clearAll(){
  /*
document.querySelectorAll('[class*="opty-"]').forEach(function(elem){
elem.classList.remove('opty-show-on');
elem.classList.remove('opty-parent-title');
elem.classList.remove('opty-parent-option');  
});
*/  
  if(document.querySelector('#opty-community-api')){
  document.querySelector('#opty-community-api').remove();
  }
 
      // for var3 & 4
//   if(document.querySelector('#opty-community-api-extra')){
//     document.querySelector('#opty-community-api-extra').remove();
// } 
  
showControlPods();
}
/////////////////////////////

function updateBreadCrumbs(showContact){
  if(document.querySelector('.c-breadcrumbs-no-background')){
  if(!showContact){
  if(document.querySelector('.c-breadcrumbs-no-link')){
if(contactUsCopy === false){
   contactUsCopy =  document.querySelector('.c-breadcrumbs-no-link').innerText;
}

     document.querySelector('.c-breadcrumbs-no-link').innerText = 'Sky Community Help';
    if(document.querySelector('#opty-breadcrumb-community')){
    document.querySelector('#opty-breadcrumb-community').remove();
    }

  }
  
  } else {
  //contact
      var newB = '<div id="opty-breadcrumb-community" class="c-breadcrumbs__crumb c-breadcrumbs__crumb--no-margin" data-test-id="breadcrumbs-breadcrumb-onclick"><button type="button" aria-label="Return to Sky Community Help" class="c-link" data-test-id="toolkit-link"><span data-test-id="toolkit-clickable-text" class="" aria-hidden="true">Sky Community Help</span></button><svg viewBox="0 0 32 32" class="icon__Svg-sc-6w188g-0 egIReE c-icon" aria-hidden="true"><g id="linear-arrow-right"><path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path></g></svg></div>';
     if(document.querySelector('.c-breadcrumbs-no-link')){
  document.querySelector('.c-breadcrumbs-no-link').innerText = contactUsCopy;
       if(!document.querySelector('#opty-breadcrumb-community')){
         document.querySelector('.c-breadcrumbs-no-link').insertAdjacentHTML('beforebegin', newB);
         document.querySelector('#opty-breadcrumb-community button').addEventListener('click', function(){
             updateBreadCrumbs();  
           hideControlPods(); 
           buildUI(resultItems);
           
         });
       }
  }
  }

  

}

}


var buildUI = function(items){
var svgBubble = '<svg viewBox="0 0 32 32" class="opty-svg-bubble" role="presentation" aria-hidden="true" data-test-id="contact-option-icon"><g id="linear-chat2"><path d="M19.125 3a3 3 0 0 1 3 3v5.42H28a3 3 0 0 1 3 3v7.013a3 3 0 0 1-3 3h-.708v4.565a1 1 0 0 1-1.708.707l-5.272-5.272h-7.437a3 3 0 0 1-3-3v-3.547l-3.459 3.46a1 1 0 0 1-1.708-.707v-4.565H4a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3zM28 13.42H12.875c-.551 0-1 .449-1 1v7.013c0 .551.449 1 1 1h8.266l4.151 4.151v-4.151H28c.551 0 1-.449 1-1V14.42c0-.551-.449-1-1-1zM19.125 5H4c-.551 0-1 .449-1 1v7.074c0 .551.449 1 1 1h2.708v4.151l3.167-3.167v-.638a3 3 0 0 1 3-3h7.25V6c0-.551-.449-1-1-1z" id="Icon"></path></g></svg>';

var solvedBubble = '<div class="opty-solved-bubble">Solved</div>';

var getInTouch = '<div class="opty-prefer-contact"><h3>Not quite what you’re looking for?</h3><button id="opty-prefer-contact" aria-label="I’d prefer to get in touch ☎️">I’d prefer to get in touch ☎️</button></div>';
var html = '<div id="opty-community-api">';
html+='<h2 class="opty-header">Find your answer on Sky Community</h2>';
html+= '<div class="opty-intro"><p>Here are some discussions by other customers related to this issue, which have been answered and you may find useful:</p></div>';
for(var i=0;i<items.length;i++){
var theAnswer =   items[i];

html+= '<div class="opty-single-answer">';

html+=  '<div class="opty-single-header">';
html+=  '<div class="opty-single-header-left">';  
html+= svgBubble;
html+= '<a class="title-link" href="'+theAnswer.view_href+'" target="_blank">'+theAnswer.subject+'</a>';
html+= '</div>'; //end header-left
html+=  '<div class="opty-single-header-right">';    
html+= '<span class="span-local-date">'+theAnswer.post_time_friendly+'</span>';
html+= solvedBubble;
html+= '</div>'; //end header-right  
html+= '</div>'; //end header 

html+=  '<div class="opty-single-body">'; 
html+= '<p>'+theAnswer.search_snippet+'</p>';   
html+= '</div>'; //end body  
html+= '</div>'; //end single
}
html+= getInTouch;
html+= '</div>';

utils.observeSelector('[data-test-id="tree-node"] [data-test-id="node-heading"]',function (title) {
   if(document.querySelector('[data-test-id="tree-node"]  .c-breadcrumbs-no-background')){
      var parentTitle = title.parentElement;
if(!document.querySelector('#opty-community-api')){
parentTitle.insertAdjacentHTML('afterend', html);  
// addCommunityCss(parentTitle); 
removeLoader();
updateBreadCrumbs();  
} 
   
   }

});
    pushGenEvar18('462: Community x Gatekeeper API round2: Variation#2');
};

//////////////////////////

 if(resultItems !== false){
  buildUI(resultItems);
 } else {
  initialLoading();
var columns_list_arr = ['board.id', 'board.view_href', 'post_time_friendly', 'view_href', 'subject', 'search_snippet', 'conversation.solved'];
var subject_matches_arrThree = getMetaData(3);
var body_matches_arrThree =getMetaData(3);
var isSolved = true;
var limit = 3;

var urlQueryThree =  queryBuilder(columns_list_arr, subject_matches_arrThree, body_matches_arrThree, isSolved, limit);

var fetchThree = fetchApi(urlQueryThree);

fetchThree.then(function(itemsThree){
  if(Array.isArray(itemsThree)){
  if(itemsThree.length == 0){

var subject_matches_arrTitle = getMetaData(0,true);
var body_matches_arrTitle =getMetaData(0,true);  
var urlQueryTitle =  queryBuilder(columns_list_arr, subject_matches_arrTitle, body_matches_arrTitle, isSolved, limit);
var fetchTitle = fetchApi(urlQueryTitle);
fetchTitle.then(function(itemsTitle){
    if(Array.isArray(itemsTitle)){
  if(itemsTitle.length == 0){

var subject_matches_arrTwo = getMetaData(2);
var body_matches_arrTwo =getMetaData(2);  
var urlQueryTwo =  queryBuilder(columns_list_arr, subject_matches_arrTwo, body_matches_arrTwo, isSolved, limit);   
var fetchTwo = fetchApi(urlQueryTwo);
     fetchTwo.then(function(itemsTwo){
    if(Array.isArray(itemsTwo)){
  if(itemsTwo.length == 0){   

var subject_matches_arrOne = getMetaData(1);
var body_matches_arrOne =getMetaData(1);  
var urlQueryOne =  queryBuilder(columns_list_arr, subject_matches_arrOne, body_matches_arrOne, isSolved, limit);   
var fetchOne = fetchApi(urlQueryOne);   
     fetchOne.then(function(itemsOne){
           if(Array.isArray(itemsOne)){
  if(itemsOne.length > 0){


  resultItems = itemsOne;
   
   buildUI(itemsOne);
  }  else {
    /*08-2022*/
  // removetempStyle();
   clearAll(); 
  }
             
  }         
       
       
       
     });
    
    
    
  } else {
    resultItems = itemsTwo;
     buildUI(itemsTwo);
  }
    }
       
     });
    
  } else {
  resultItems = itemsTitle;
   buildUI(itemsTitle);
  }
    }
   
   
   
   
 
 }).catch(function(e){
 //removetempStyle();
 clearAll(); 
console.log('error', e);
});   
    
    
    
    
  } else {
  resultItems = itemsThree;
  buildUI(itemsThree);
  }
  }

}).catch(function(e){
//removetempStyle();
clearAll(); 
console.log('error', e);
}); 
 }  



  utils.observeSelector('[data-test-id^="contact-option-"]',function () {
   // addCommunityCss(); 
   // ??????? hideControlPods();
  });

  utils.observeSelector('[data-test-id^="node-button"]',function () {
   clearAll(); 
  });

  utils.observeSelector('#opty-prefer-contact',function (btn) {
    btn.addEventListener('click', function(){
        clearAll(); 
        updateBreadCrumbs(true); 

    });
  });

 utils.observeSelector('.opty-single-answer .title-link',function () {
   document.querySelectorAll('.opty-single-answer .title-link').forEach(function(l){
   l.addEventListener('click', function(){
           pushGenEvar7();
         });
   });
  });

//Add previous
 utils.observeSelector('.ctn-previous',function (prev) {
  var parentPrev = prev.parentElement;
     parentPrev.style.display = 'none'; 
   if(!document.querySelector('#opty-previous-container')){
      parentPrev.insertAdjacentHTML('afterend', '<div id="opty-previous-container"> <svg viewBox="0 0 32 32" aria-hidden="true"> <g id="linear-arrow-left"> <path d="M22.333 6.032C22.128 5.785 21.523 5 21.07 5c-.198.008-.366.087-.53.248L10.274 15.512a.934.934 0 0 0 0 1.32L20.54 27.098c.164.162.332.24.53.248.452 0 1.057-.784 1.262-1.032l.11-.137-10.002-10.003L22.444 6.17l-.111-.138" id="Icon"></path> </g> </svg> <button data-test-id="back-contact-tree-link">Previous step</button> </div>');
     //.c-breadcrumbs-no-background button
     if(document.querySelector('#opty-previous-container button')){
     document.querySelector('#opty-previous-container button').addEventListener('click', function(){
     document.querySelectorAll('.c-breadcrumbs-no-background button')[document.querySelectorAll('.c-breadcrumbs-no-background button').length -1 ].click();
     });
     }
   }

  });
//    }
}}, {"value": "<style>#ccx-num-spinner {\nanimation: 1s linear 0s infinite normal none running GLFYz;\n    border-color: currentcolor currentcolor currentcolor transparent;\n    border-radius: 50%;\n    border-style: solid;\n    border-width: 1px;\n    position: relative;\n  display:inline-block;\n    height: 24px;\n    width: 24px;\ncolor: rgb(77, 77, 77);\nmargin-top: 7px;\n}\n@keyframes GLFYz{\n100% {\n    transform: rotate(360deg);\n}\n}\n\n.hidden-opty-control{\ndisplay: none !important;\n}\n#opty-community-api .opty-intro {\nmargin-bottom: 13px;\n}\n\n\n\n#opty-community-api .opty-header{\ncolor: inherit;\nfont-weight: bold;\n margin-bottom: 20px;\n}\n\n#opty-community-api .opty-single-answer{\n    border-radius: 4px;\n    border: 1px solid #CCCCCC;\n  margin-bottom: 13px;\n  padding-top: 12px;\n  padding-left:25px;\n  padding-right: 16px;\n  padding-bottom: 20px;\n}\n\n#opty-community-api .opty-single-header{\n  display: flex;\n}\n#opty-community-api .opty-single-header-left{\n    display: flex;\n  mmax-width:400px;\n}\n#opty-community-api .opty-single-header-right{\n display: flex;\n    min-width: 130px;\n  justify-content: space-between;\n   flex-grow: 100;\n}\n\n#opty-community-api .opty-solved-bubble{\n width: 60px;\nheight: 19px;\nfont-size: 14px;\nbackground: #046714;\nborder-radius: 40px;\ndisplay: flex;\ncolor: #ffffff;\njustify-content: center;\nfont-weight: bold;  \nmargin-top: 2px;  \n}\n\n#opty-community-api .title-link{\nfont-weight: bold;\nfont-size: 20px;\nwwhite-space: nowrap;  \n}\n\n#opty-community-api .span-local-date{\nfont-size: 13px;\nline-height: 15px;\n  color: #4D4D4D;\n  word-break: break-word;\n    word-wrap: break-word;\n  margin-left: 14px;\n  margin-top: 6px;\n}\n\n\n#opty-community-api .opty-single-body p{\npadding-left: 45px;\nmax-width: 692px;\nwhite-space: nowrap;\noverflow: hidden;\ntext-overflow: ellipsis;  \n  \n}\n\n#opty-community-api .opty-single-body p, #opty-community-api .opty-intro p{\nfont-size: 16px;\n}\n\n.opty-prefer-contact h3 {\nfont-size: 28px;\n}\n\n@media (min-width: 640px){\n#opty-community-api .opty-header {\n    font-size: 28px;\n    line-height: 32px;\n}\n  #opty-community-api .opty-svg-bubble{\n  flex: 0 0 32px;\n    margin-bottom: 8px;\n    height: 32px;\n    width: 32px;\n    fill: #000FBE;\n    margin-right: 13px;\n  }\n  #opty-community-api .opty-single-header{\n  width: 100%;\n  }\n}\n\n@media (min-width: 0px) and (max-width: 639px){\n#opty-community-api .opty-single-answer{\n  padding-left:15px;\n  padding-right:15px;\n    padding-bottom: 18px;\n}\n  \n#opty-community-api .opty-single-header {\n    flex-direction: column;\n}\n  \n#opty-community-api .opty-header {\n    font-size: 24px;\n    line-height: 28px;\n}\n  \n    #opty-community-api .opty-svg-bubble{\n    flex: 0 0 24px;\n    margin-right: 12px;\n      height: 24px;\n    width: 24px;\n    fill: #000FBE;\n    margin-right: 11px;  \n  }\n  #opty-community-api .title-link{\n\nfont-size: 16px;  \n}\n  #opty-community-api .opty-single-body p {\n     padding-left: 0;\n}\n  #opty-community-api .opty-single-header-right {\n    justify-content: left;\n    flex-direction: row-reverse;\n    padding-left: 35px;\n}\n  .opty-prefer-contact h3 {\nfont-size: 24px;\n}\n\n}\n\n\n\n/*\n#opty-prefer-contact{-webkit-box-align:center;align-items:center;border:2px solid rgb(0, 15, 245);border-radius:4px;cursor:pointer;display:inline-flex;flex-shrink:0;font-size:18px;font-weight:bold;-webkit-box-pack:center;justify-content:center;line-height:24px;outline:none;padding:8px 16px;position:relative;text-align:center;transition-duration:300ms;transition-property:background, color, box-shadow;transition-timing-function:ease;background-color:rgb(255, 255, 255);color:rgb(0, 15, 245);}\n#opty-prefer-contact:hover{text-decoration:none; background-color: rgb(242, 243, 255);}\n#opty-prefer-contact:disabled{background-color:rgb(204, 204, 204);background-image:none;border-color:transparent;color:rgb(255, 255, 255);cursor:not-allowed;}\n#opty-prefer-contact::after{border:1px solid rgb(0, 151, 245);border-radius:6px;inset:-5px;content:\"\";opacity:0;pointer-events:none;position:absolute;transition:opacity 150ms linear 0s;}\n#opty-prefer-contact:focus::after{opacity:1;}\n@media (min-width:0px) and (max-width:639px){\n#opty-prefer-contact{font-size:18px;line-height:22px;}\n}\n@media (min-width:640px){\n#opty-prefer-contact{font-size:20px;line-height:24px;}\n}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n*/\n/*\n#opty-prefer-contact{color:inherit;font-weight:bold;color:#000FF5;}\n#opty-prefer-contact:hover{-webkit-text-decoration:none;text-decoration:none;}\n@media (min-width:0px) and (max-width:639px){\n#opty-prefer-contact{font-size:18px;line-height:22px;}\n}\n@media (min-width:640px){\n#opty-prefer-contact{font-size:20px;line-height:24px;}\n}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n\n\n#opty-prefer-contact{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row no-wrap;-ms-flex-flow:row no-wrap;flex-flow:row no-wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#FFFFFF;border:1px solid #CCCCCC;padding:8px 24px;border-bottom:2px solid #000FF5#00D2FF;border-radius:22px;cursor:pointer;-webkit-transition:background-color 0.3s ease,border-color 0.3s ease;transition:background-color 0.3s ease,border-color 0.3s ease;}\n#opty-prefer-contact:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#000FF5;border-color:#000FF5;}\n#opty-prefer-contact:hover span{color:#FFFFFF;}\n#opty-prefer-contact:focus{box-shadow:0 0 0 7px rgba(0,115,197,0.2);outline:none;}\n#opty-prefer-contact span{white-space:nowrap;-webkit-transition:color 0.3s ease;transition:color 0.3s ease;}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n*/\n\n/*****/\n\n\n#opty-prefer-contact{color:inherit;font-weight:bold;color:#000FF5;}\n#opty-prefer-contact:hover{-webkit-text-decoration:none;text-decoration:none;}\n@media (min-width:0px) and (max-width:639px){\n#opty-prefer-contact{font-size:18px;line-height:22px;}\n}\n@media (min-width:640px){\n#opty-prefer-contact{font-size:20px;line-height:24px;}\n}\n#opty-prefer-contact{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row no-wrap;-ms-flex-flow:row no-wrap;flex-flow:row no-wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#FFFFFF;border:1px solid #CCCCCC;padding:8px 24px;border-bottom:2px solid #000FF5#00D2FF;border-radius:22px;cursor:pointer;-webkit-transition:background-color 0.3s ease,border-color 0.3s ease;transition:background-color 0.3s ease,border-color 0.3s ease;}\n#opty-prefer-contact:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#000FF5;border-color:#000FF5;color: white;}\n#opty-prefer-contact:hover span{color:#FFFFFF !important;} \n#opty-prefer-contact:focus{box-shadow:0 0 0 7px rgba(0,115,197,0.2);outline:none;}\n#opty-prefer-contact span{white-space:nowrap;-webkit-transition:color 0.3s ease;transition:color 0.3s ease;}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n\n/*\n.opty-show-on [data-test-id=\"node-heading\"], .opty-show-on div[data-test-id^=\"contact-option-\"], .opty-show-on .opty-parent-title{\ndisplay: none;\n}\n.opty-show-on .opty-parent-option{\nborder: 0;\n}\n*/</style>", "selector": "head", "dependencies": [], "type": "append", "id": "A289BE7B-1243-4A7E-A7C7-961173A00B44"}]}], "name": "Variation #2"}, {"id": "22117930962", "actions": [{"viewId": "22142190200", "changes": [{"dependencies": [], "type": "custom_code", "id": "89E60E39-A75E-43B1-85D2-31A885F5C1F2", "value": function($){var utils = window.optimizely.get('utils');

function initialLoading(pod){
    if(!pod){
        hideControlPods();
    }
var spinner = '<div id="ccx-num-spinner-container"> <span id="ccx-num-spinner"></span></div>';
if(pod){
    document.querySelector('[data-test-id="contact-option-community"] [data-test-id="contact-option-cta"]').insertAdjacentHTML('afterend', spinner);

} else {
    document.querySelector(' [class^="contact-option__CardContainer-gatekeeper-lib"]').insertAdjacentHTML('beforebegin', spinner);
}

}

function removeLoader(){
  if(document.querySelector('#ccx-num-spinner-container')){
    document.querySelector('#ccx-num-spinner-container').remove();
  }
}

var resultItems = false;
var contactUsCopy = false;
var queryBuilder = window.__opty_gatekeeper_community__roundTwo.queryBuilder;
var fetchApi = window.__opty_gatekeeper_community__roundTwo.fetchApi;
var getMetaData = window.__opty_gatekeeper_community__roundTwo.getMetaData;
var pushGenEvar7 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar7;
var pushGenEvar18 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar18;



var genHtml = function(extras,items){
var selectorID = 'opty-community-api';
if(extras){
    selectorID = selectorID + '-extras';
}

var svgBubble = '<svg viewBox="0 0 32 32" class="opty-svg-bubble" role="presentation" aria-hidden="true" data-test-id="contact-option-icon"><g id="linear-chat2"><path d="M19.125 3a3 3 0 0 1 3 3v5.42H28a3 3 0 0 1 3 3v7.013a3 3 0 0 1-3 3h-.708v4.565a1 1 0 0 1-1.708.707l-5.272-5.272h-7.437a3 3 0 0 1-3-3v-3.547l-3.459 3.46a1 1 0 0 1-1.708-.707v-4.565H4a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3zM28 13.42H12.875c-.551 0-1 .449-1 1v7.013c0 .551.449 1 1 1h8.266l4.151 4.151v-4.151H28c.551 0 1-.449 1-1V14.42c0-.551-.449-1-1-1zM19.125 5H4c-.551 0-1 .449-1 1v7.074c0 .551.449 1 1 1h2.708v4.151l3.167-3.167v-.638a3 3 0 0 1 3-3h7.25V6c0-.551-.449-1-1-1z" id="Icon"></path></g></svg>';
var solvedBubble = '<div class="opty-solved-bubble">Solved</div>';

var html = '<div id="'+selectorID+'">';
html+='<h2 class="opty-header">We found some answers that might help</h2>';
html+= '<div class="opty-intro"><p>Here are some discussions by other customers related to this issue, which have been answered and you may find useful:</p></div>';
for(var i=0;i<items.length;i++){
var theAnswer =   items[i];

html+= '<div class="opty-single-answer">';

html+=  '<div class="opty-single-header">';
html+=  '<div class="opty-single-header-left">';  
html+= svgBubble;
html+= '<a class="title-link" href="'+theAnswer.view_href+'" target="_blank">'+theAnswer.subject+'</a>';
html+= '</div>'; //end header-left
html+=  '<div class="opty-single-header-right">';    
html+= '<span class="span-local-date">'+theAnswer.post_time_friendly+'</span>';
html+= solvedBubble;
html+= '</div>'; //end header-right  
html+= '</div>'; //end header 

html+=  '<div class="opty-single-body">'; 
html+= '<p>'+theAnswer.search_snippet+'</p>';   
html+= '</div>'; //end body  
html+= '</div>'; //end single
}

html+= '</div>';

return html;
};

var buildUI = function(extras, items){

    var html = genHtml(extras, items);

    var selectorID = 'opty-community-api';
    var ref = 'div';
if(extras){
    selectorID = selectorID + '-extras';
    ref = '[data-test-id="contact-option-community"] [data-test-id="contact-option-cta"]';
}

utils.observeSelector(ref,function (domRef) {
   if(document.querySelector('[data-test-id="tree-node"]  .c-breadcrumbs-no-background')){
if(!document.querySelector('#'+selectorID)){
    domRef.insertAdjacentHTML('afterend', html);  
} 
   removeLoader();
   }

});
    pushGenEvar18('462: Community x Gatekeeper API round2: Variation#3');
};

//////////////////////////

 if(resultItems !== false){
   initialLoading("pod");
  buildUI(true,resultItems);
   removeLoader();
 } else {
  initialLoading("pod");
var columns_list_arr = ['board.id', 'board.view_href', 'post_time_friendly', 'view_href', 'subject', 'search_snippet', 'conversation.solved'];
var subject_matches_arrThree = getMetaData(3);
var body_matches_arrThree =getMetaData(3);
var isSolved = true;
var limit = 3;

var urlQueryThree =  queryBuilder(columns_list_arr, subject_matches_arrThree, body_matches_arrThree, isSolved, limit);

var fetchThree = fetchApi(urlQueryThree);

fetchThree.then(function(itemsThree){
  if(Array.isArray(itemsThree)){
  if(itemsThree.length == 0){

var subject_matches_arrTitle = getMetaData(0,true);
var body_matches_arrTitle =getMetaData(0,true);  
var urlQueryTitle =  queryBuilder(columns_list_arr, subject_matches_arrTitle, body_matches_arrTitle, isSolved, limit);
var fetchTitle = fetchApi(urlQueryTitle);
fetchTitle.then(function(itemsTitle){
    if(Array.isArray(itemsTitle)){
  if(itemsTitle.length == 0){

var subject_matches_arrTwo = getMetaData(2);
var body_matches_arrTwo =getMetaData(2);  
var urlQueryTwo =  queryBuilder(columns_list_arr, subject_matches_arrTwo, body_matches_arrTwo, isSolved, limit);   
var fetchTwo = fetchApi(urlQueryTwo);
     fetchTwo.then(function(itemsTwo){
    if(Array.isArray(itemsTwo)){
  if(itemsTwo.length == 0){   

var subject_matches_arrOne = getMetaData(1);
var body_matches_arrOne =getMetaData(1);  
var urlQueryOne =  queryBuilder(columns_list_arr, subject_matches_arrOne, body_matches_arrOne, isSolved, limit);   
var fetchOne = fetchApi(urlQueryOne);   
     fetchOne.then(function(itemsOne){
           if(Array.isArray(itemsOne)){
  if(itemsOne.length > 0){


  resultItems = itemsOne;
   
   buildUI(true,itemsOne);
  }  else {
    /*08-2022*/
  // removetempStyle();
  // clearAll(); 

    removeLoader();
  }
             
  }         
       
       
       
     });
    
    
    
  } else {
    resultItems = itemsTwo;
     buildUI(true,itemsTwo);
  }
    }
       
     });
    
  } else {
  resultItems = itemsTitle;
   buildUI(true,itemsTitle);
  }
    }
   
   
   
   
 
 }).catch(function(e){
 //removetempStyle();
// clearAll(); 
  removeLoader();
console.log('error', e);
});   
    
    
    
    
  } else {
  resultItems = itemsThree;
  buildUI(true,itemsThree);
  }
  }

}).catch(function(e){
//removetempStyle();
//clearAll(); 
removeLoader();  
console.log('error', e);
}); 
 }  


 utils.observeSelector('.opty-single-answer .title-link',function () {
   document.querySelectorAll('.opty-single-answer .title-link').forEach(function(l){
   l.addEventListener('click', function(){
           pushGenEvar7();
         });
   });
  });

//Add previous
 utils.observeSelector('.ctn-previous',function (prev) {
  var parentPrev = prev.parentElement;
     parentPrev.style.display = 'none'; 
   if(!document.querySelector('#opty-previous-container')){
      parentPrev.insertAdjacentHTML('afterend', '<div id="opty-previous-container"> <svg viewBox="0 0 32 32" aria-hidden="true"> <g id="linear-arrow-left"> <path d="M22.333 6.032C22.128 5.785 21.523 5 21.07 5c-.198.008-.366.087-.53.248L10.274 15.512a.934.934 0 0 0 0 1.32L20.54 27.098c.164.162.332.24.53.248.452 0 1.057-.784 1.262-1.032l.11-.137-10.002-10.003L22.444 6.17l-.111-.138" id="Icon"></path> </g> </svg> <button data-test-id="back-contact-tree-link">Previous step</button> </div>');
     //.c-breadcrumbs-no-background button
     if(document.querySelector('#opty-previous-container button')){
     document.querySelector('#opty-previous-container button').addEventListener('click', function(){
     document.querySelectorAll('.c-breadcrumbs-no-background button')[document.querySelectorAll('.c-breadcrumbs-no-background button').length -1 ].click();
     });
     }
   }

  });

utils.observeSelector('[id ^="opty-community-api"]',function () {
   removeLoader();
});
}}, {"value": "<style>#ccx-num-spinner-container {\nwidth: 30px;\nmargin: auto;\n}\n\n[data-test-id=\"contact-option-community\"] #ccx-num-spinner-container {\nmargin: 0;\nwidth: 50px;  \n}\n\n#ccx-num-spinner {\nanimation: 1s linear 0s infinite normal none running GLFYz;\n    border-color: currentcolor currentcolor currentcolor transparent;\n    border-radius: 50%;\n    border-style: solid;\n    border-width: 1px;\n    position: relative;\n  display:inline-block;\n    height: 24px;\n    width: 24px;\ncolor: rgb(77, 77, 77);\nmargin-top: 7px;\n}\n@keyframes GLFYz{\n100% {\n    transform: rotate(360deg);\n}\n}\n\n.hidden-opty-control{\ndisplay: none !important;\n}\n\n#opty-community-api-extras{\nmax-width: 522px;\nmargin-top: 13px;  \n}\n\n#opty-community-api-extras .opty-single-body p {\n      text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\nmax-width: 400px;\n}\n\n#opty-community-api-extras .opty-single-answer {\n    border-radius: 4px;\n    border: 1px solid #CCCCCC;\n  margin-bottom: 13px;\n  padding-top: 12px;\n  padding-left:25px;\n  padding-right: 16px;\n  padding-bottom: 20px;\n}\n\n@media (min-width: 660px) and (max-width: 710px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 340;\n}\n#opty-community-api-extras .opty-single-answer {\n    border-radius: 4px;\n    border: 1px solid #CCCCCC;\n    margin-bottom: 13px;\n    padding-top: 12px;\n    padding-left: 12px;\n    padding-right: 16px;\n    padding-bottom: 14px;\n}\n}\n@media (min-width: 439px) and (max-width: 639px){\n #opty-community-api-extras .opty-single-answer{\n  padding-left:15px;\n  padding-right:15px;\n    padding-bottom: 18px;\n}\n}\n@media (min-width: 640px) and (max-width: 659px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 315px;\n}\n}\n@media (min-width: 500px) and (max-width: 639px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 400px;\n}\n}\n\n@media (min-width: 439px) and (max-width: 499px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 340px;\n}\n}\n\n@media (min-width: 0px) and (max-width: 438px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 280px;\n}\n  \n#opty-community-api-extras .opty-single-answer {\n  padding-left: 8px;\n    padding-right: 2px;\n    padding-bottom: 13px;\n  }\n}\n\n@media (max-width: 354px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 220px;\n}\n}\n\n#opty-community-api .opty-intro, #opty-community-api-extras .opty-intro {\nmargin-bottom: 13px;\n}\n\n\n\n#opty-community-api .opty-header{\ncolor: inherit;\nfont-weight: bold;\n margin-bottom: 20px;\n}\n#opty-community-api-extras .opty-header{\ncolor: inherit;\nfont-weight: bold;\n margin-bottom: 13px;\n}\n\n#opty-community-api .opty-single-answer{\n    border-radius: 4px;\n    border: 1px solid #CCCCCC;\n  margin-bottom: 13px;\n  padding-top: 12px;\n  padding-left:25px;\n  padding-right: 16px;\n  padding-bottom: 20px;\n}\n\n#opty-community-api .opty-single-header, #opty-community-api-extras .opty-single-header{\n  display: flex;\n}\n#opty-community-api .opty-single-header-left, #opty-community-api-extras .opty-single-header-left{\n    display: flex;\n  mmax-width:400px;\n}\n#opty-community-api .opty-single-header-right, #opty-community-api-extras .opty-single-header-right{\n display: flex;\n    min-width: 130px;\n  justify-content: space-between;\n   flex-grow: 100;\n}\n\n#opty-community-api .opty-solved-bubble, #opty-community-api-extras .opty-solved-bubble{\n width: 60px;\nheight: 19px;\nfont-size: 14px;\nbackground: #046714;\nborder-radius: 40px;\ndisplay: flex;\ncolor: #ffffff;\njustify-content: center;\nfont-weight: bold;  \nmargin-top: 2px;  \n}\n\n#opty-community-api .title-link, #opty-community-api-extras .title-link{\nfont-weight: bold;\nfont-size: 20px;\nwwhite-space: nowrap;  \n}\n\n#opty-community-api .span-local-date, #opty-community-api-extras .span-local-date{\nfont-size: 13px;\nline-height: 15px;\n  color: #4D4D4D;\n  word-break: break-word;\n    word-wrap: break-word;\n  margin-left: 14px;\n  margin-top: 6px;\n}\n\n\n#opty-community-api .opty-single-body p{\npadding-left: 45px;\nmax-width: 692px;\nwhite-space: nowrap;\noverflow: hidden;\ntext-overflow: ellipsis;  \n}\n\n\n\n#opty-community-api .opty-single-body p, #opty-community-api .opty-intro p, #opty-community-api-extras .opty-single-body p, #opty-community-api-extras .opty-intro p{\nfont-size: 16px;\n}\n\n.opty-prefer-contact h3 {\nfont-size: 28px;\n}\n\n@media (min-width: 640px){\n#opty-community-api .opty-header, #opty-community-api-extras .opty-header {\n    font-size: 28px;\n    line-height: 32px;\n}\n  #opty-community-api .opty-svg-bubble, #opty-community-api-extras .opty-svg-bubble{\n  flex: 0 0 32px;\n    margin-bottom: 8px;\n    height: 32px;\n    width: 32px;\n    fill: #000FBE;\n    margin-right: 13px;\n  }\n  #opty-community-api .opty-single-header, #opty-community-api-extras .opty-single-header{\n  width: 100%;\n  }\n}\n\n@media (min-width: 0px) and (max-width: 639px){\n#opty-community-api .opty-single-answer, #opty-community-api-extras .opty-single-answer{\n  padding-left:15px;\n  padding-right:15px;\n    padding-bottom: 18px;\n}\n  \n#opty-community-api .opty-single-header, #opty-community-api-extras .opty-single-header{\n    flex-direction: column;\n}\n  \n#opty-community-api .opty-header, #opty-community-api-extras .opty-header{\n    font-size: 24px;\n    line-height: 28px;\n}\n  \n    #opty-community-api .opty-svg-bubble, #opty-community-api-extras .opty-svg-bubble{\n    flex: 0 0 24px;\n    margin-right: 12px;\n      height: 24px;\n    width: 24px;\n    fill: #000FBE;\n    margin-right: 11px;  \n  }\n  #opty-community-api .title-link, #opty-community-api-extras .title-link{\n\nfont-size: 16px;  \n}\n  #opty-community-api .opty-single-body p, #opty-community-api-extras .opty-single-body p{\n     padding-left: 0;\n}\n  #opty-community-api .opty-single-header-right, #opty-community-api-extras .opty-single-header-right{\n    justify-content: left;\n    flex-direction: row-reverse;\n    padding-left: 35px;\n}\n  .opty-prefer-contact h3 {\nfont-size: 24px;\n}\n\n}\n\n\n\n\n#opty-prefer-contact{-webkit-box-align:center;align-items:center;border:2px solid rgb(0, 15, 245);border-radius:4px;cursor:pointer;display:inline-flex;flex-shrink:0;font-size:18px;font-weight:bold;-webkit-box-pack:center;justify-content:center;line-height:24px;outline:none;padding:8px 16px;position:relative;text-align:center;transition-duration:300ms;transition-property:background, color, box-shadow;transition-timing-function:ease;background-color:rgb(255, 255, 255);color:rgb(0, 15, 245);}\n#opty-prefer-contact:hover{text-decoration:none; background-color: rgb(242, 243, 255);}\n#opty-prefer-contact:disabled{background-color:rgb(204, 204, 204);background-image:none;border-color:transparent;color:rgb(255, 255, 255);cursor:not-allowed;}\n#opty-prefer-contact::after{border:1px solid rgb(0, 151, 245);border-radius:6px;inset:-5px;content:\"\";opacity:0;pointer-events:none;position:absolute;transition:opacity 150ms linear 0s;}\n#opty-prefer-contact:focus::after{opacity:1;}\n@media (min-width:0px) and (max-width:639px){\n#opty-prefer-contact{font-size:18px;line-height:22px;}\n}\n@media (min-width:640px){\n#opty-prefer-contact{font-size:20px;line-height:24px;}\n}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n\n\n\n\n\n/* 04-10*/\n[data-test-id=\"contact-option-community\" ] [data-test-id=\"footer-text\"] {\ndisplay: none;\n}\n\n/*\n#opty-prefer-contact{color:inherit;font-weight:bold;color:#000FF5;}\n#opty-prefer-contact:hover{-webkit-text-decoration:none;text-decoration:none;}\n@media (min-width:0px) and (max-width:639px){\n#opty-prefer-contact{font-size:18px;line-height:22px;}\n}\n@media (min-width:640px){\n#opty-prefer-contact{font-size:20px;line-height:24px;}\n}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n\n\n#opty-prefer-contact{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row no-wrap;-ms-flex-flow:row no-wrap;flex-flow:row no-wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#FFFFFF;border:1px solid #CCCCCC;padding:8px 24px;border-bottom:2px solid #000FF5#00D2FF;border-radius:22px;cursor:pointer;-webkit-transition:background-color 0.3s ease,border-color 0.3s ease;transition:background-color 0.3s ease,border-color 0.3s ease;}\n#opty-prefer-contact:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#000FF5;border-color:#000FF5;}\n#opty-prefer-contact:hover span{color:#FFFFFF;}\n#opty-prefer-contact:focus{box-shadow:0 0 0 7px rgba(0,115,197,0.2);outline:none;}\n#opty-prefer-contact span{white-space:nowrap;-webkit-transition:color 0.3s ease;transition:color 0.3s ease;}\n#opty-prefer-contact{margin:calc(12px * 0.5);}\n*/\n\n/*****/\n\n/*\n.opty-show-on [data-test-id=\"node-heading\"], .opty-show-on div[data-test-id^=\"contact-option-\"], .opty-show-on .opty-parent-title{\ndisplay: none;\n}\n.opty-show-on .opty-parent-option{\nborder: 0;\n}\n*/</style>", "selector": "head", "dependencies": [], "type": "append", "id": "BB9F2B57-E035-4423-AC92-535CD3274714"}]}], "name": "Variation #3"}, {"id": "22167010264", "actions": [{"viewId": "22142190200", "changes": [{"dependencies": [], "type": "custom_code", "id": "E144544E-8280-4696-A792-A4DAF9F2666A", "value": function($){var utils = window.optimizely.get('utils');

    function initialLoading(pod){
        if(!pod){
            hideControlPods();
        }
    var spinner = '<div id="ccx-num-spinner-container"> <span id="ccx-num-spinner"></span></div>';
    if(pod){
        document.querySelector('[data-test-id="contact-option-community"] [data-test-id="contact-option-cta"]').insertAdjacentHTML('afterend', spinner);
    
    } else {
        document.querySelector(' [class^="contact-option__CardContainer-gatekeeper-lib"]').insertAdjacentHTML('beforebegin', spinner);
    }
    
    }
    
    function removeLoader(){
      if(document.querySelector('#ccx-num-spinner-container')){
        document.querySelector('#ccx-num-spinner-container').remove();
      }
    }
    
function showControlPods(){
    document.querySelectorAll('.hidden-opty-control').forEach(controlPod => 
        controlPod.classList.remove('hidden-opty-control')); 
    }


function hideControlPods(){

    document.querySelector('[class^="ContactTreeHeader__Wrapper-gatekeeper-lib"]').classList.add('hidden-opty-control');
    document.querySelectorAll('[class^="contact-option__CardContainer-gatekeeper-lib"]').forEach(controlPod => 
        controlPod.classList.add('hidden-opty-control')); 
}

function clearAll(){
  /*
document.querySelectorAll('[class*="opty-"]').forEach(function(elem){
elem.classList.remove('opty-show-on');
elem.classList.remove('opty-parent-title');
elem.classList.remove('opty-parent-option');  
});
*/  
      if(document.querySelector('#opty-community-api')){
      document.querySelector('#opty-community-api').remove();
      }  
      
      if(document.querySelector('#opty-router-screen')){
      document.querySelector('#opty-router-screen').remove();
      }  
 
      // for var3 & 4
//   if(document.querySelector('#opty-community-api-extra')){
//     document.querySelector('#opty-community-api-extra').remove();
// } 
  
showControlPods();
}


    var resultItems = false;
    var contactUsCopy = false;
    var queryBuilder = window.__opty_gatekeeper_community__roundTwo.queryBuilder;
    var fetchApi = window.__opty_gatekeeper_community__roundTwo.fetchApi;
    var getMetaData = window.__opty_gatekeeper_community__roundTwo.getMetaData;
    var pushGenEvar7 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar7;
var pushGenEvar18 = window.__opty_gatekeeper_community__roundTwo.pushGenEvar18;


    
    function updateBreadCrumbs(showContact){
      if(document.querySelector('.c-breadcrumbs-no-background')){
        
        if( showContact == 'answers'){
           var newB = '<div id="opty-breadcrumb-community" class="c-breadcrumbs__crumb c-breadcrumbs__crumb--no-margin" data-test-id="breadcrumbs-breadcrumb-onclick"><button type="button" aria-label="Return to Ask Sky Community" class="c-link" data-test-id="toolkit-link"><span data-test-id="toolkit-clickable-text" class="" aria-hidden="true">Ask Sky Community</span></button><svg viewBox="0 0 32 32" class="icon__Svg-sc-6w188g-0 egIReE c-icon" aria-hidden="true"><g id="linear-arrow-right"><path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path></g></svg></div>';
         if(document.querySelector('.c-breadcrumbs-no-link')){
      document.querySelector('.c-breadcrumbs-no-link').innerText = 'Sky Community Help';
           if(!document.querySelector('#opty-breadcrumb-community')){
             document.querySelector('.c-breadcrumbs-no-link').insertAdjacentHTML('beforebegin', newB);
             document.querySelector('#opty-breadcrumb-community button').addEventListener('click', function(){
                 if(document.querySelector('#opty-community-api')){
           document.querySelector('#opty-community-api').style.display = 'none';
           }
          if(document.querySelector('#opty-router-screen')){
           document.querySelector('#opty-router-screen').removeAttribute('style');
           }
                updateBreadCrumbs(); 
             });
           }
      }   
        } else {
        
         if(!showContact){
      if(document.querySelector('.c-breadcrumbs-no-link')){
    if(contactUsCopy === false){
       contactUsCopy =  document.querySelector('.c-breadcrumbs-no-link').innerText;
    }
    
         document.querySelector('.c-breadcrumbs-no-link').innerText = 'Ask Sky Community';
        if(document.querySelector('#opty-breadcrumb-community')){
        document.querySelector('#opty-breadcrumb-community').remove();
        }
    
      }
      
      } else {
      //contact
          var newB = '<div id="opty-breadcrumb-community" class="c-breadcrumbs__crumb c-breadcrumbs__crumb--no-margin" data-test-id="breadcrumbs-breadcrumb-onclick"><button type="button" aria-label="Return to Ask Sky Community" class="c-link" data-test-id="toolkit-link"><span data-test-id="toolkit-clickable-text" class="" aria-hidden="true">Ask Sky Community</span></button><svg viewBox="0 0 32 32" class="icon__Svg-sc-6w188g-0 egIReE c-icon" aria-hidden="true"><g id="linear-arrow-right"><path d="M10.111 6.032L10 6.169l10.004 10.003L10 26.176l.111.137c.205.247.81 1.033 1.263 1.033.198-.009.365-.088.529-.249L22.17 16.833a.934.934 0 0 0 0-1.321L11.903 5.248c-.164-.162-.331-.241-.529-.248-.453 0-1.058.784-1.263 1.032z" id="Icon"></path></g></svg></div>';
         if(document.querySelector('.c-breadcrumbs-no-link')){
      document.querySelector('.c-breadcrumbs-no-link').innerText = contactUsCopy;
           if(!document.querySelector('#opty-breadcrumb-community')){
             document.querySelector('.c-breadcrumbs-no-link').insertAdjacentHTML('beforebegin', newB);
             document.querySelector('#opty-breadcrumb-community button').addEventListener('click', function(){
                 updateBreadCrumbs();  
                   buildUI(resultItems);
               buildUIPod(resultItems);
             });
           }
      }
      } 
        }
        
    
    
      
    
    }
    
    }
    var buildUI = function(items){
    
      var routerScreen = '<div id="opty-router-screen"><h2>Ask Sky Community</h2><p>Didn\'t find what you were looking for? Why not ask the Sky Community? Chat with other customers and Sky experts and get help with your products. To write a post, you need to sign in with your Sky iD.</p><div><button id="opty-ask-community" aria-label="Ask Sky Community" class="opty-btn-style"><span>Ask Sky Community</span></button><button id="opty-prefer-contact" aria-label="I’d prefer to get in touch ☎️" class="opty-btn-style"><span>I’d prefer to get in touch ☎️</span></button></div></div>';  
      var titleLink = 'Sky Q Remote';
      var dateAnswer = '20 Jul 2021';
      var bodyAnswer = 'I purchased a touch remote from eBay a few weeks ago to replace a puppy dog thinking our sky sky sky';
      
      var svgBubble = '<svg viewBox="0 0 32 32" class="opty-svg-bubble" role="presentation" aria-hidden="true" data-test-id="contact-option-icon"><g id="linear-chat2"><path d="M19.125 3a3 3 0 0 1 3 3v5.42H28a3 3 0 0 1 3 3v7.013a3 3 0 0 1-3 3h-.708v4.565a1 1 0 0 1-1.708.707l-5.272-5.272h-7.437a3 3 0 0 1-3-3v-3.547l-3.459 3.46a1 1 0 0 1-1.708-.707v-4.565H4a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3zM28 13.42H12.875c-.551 0-1 .449-1 1v7.013c0 .551.449 1 1 1h8.266l4.151 4.151v-4.151H28c.551 0 1-.449 1-1V14.42c0-.551-.449-1-1-1zM19.125 5H4c-.551 0-1 .449-1 1v7.074c0 .551.449 1 1 1h2.708v4.151l3.167-3.167v-.638a3 3 0 0 1 3-3h7.25V6c0-.551-.449-1-1-1z" id="Icon"></path></g></svg>';
      
      var solvedBubble = '<div class="opty-solved-bubble">Solved</div>';
      
      var getInTouch = '<div class="opty-prefer-contact"><h3>Not quite what you’re looking for?</h3><button id="opty-prefer-contact" aria-label="I’d prefer to get in touch ☎️"><span>I’d prefer to get in touch ☎️</span></button></div>';
      var html = routerScreen + '<div id="opty-community-api" style="display: none;">';
      html+='<h2 class="opty-header">Sky Community - What other people are asking</h2>';
      html+= '<div class="opty-intro"><p>Interact with a community of customers sharing experiences and helping each other with advice.</p></div>';
      for(var i=0;i<items.length;i++){
      var theAnswer =   items[i];
        
      html+= '<div class="opty-single-answer">';
     
      html+=  '<div class="opty-single-header">';
      html+=  '<div class="opty-single-header-left">';  
      html+= svgBubble;
      html+= '<a class="title-link" href="'+theAnswer.view_href+'" target="_blank">'+theAnswer.subject+'</a>';
      html+= '</div>'; //end header-left
      html+=  '<div class="opty-single-header-right">';    
      html+= '<span class="span-local-date">'+theAnswer.post_time_friendly+'</span>';
      html+= solvedBubble;
      html+= '</div>'; //end header-right  
      html+= '</div>'; //end header 
      
      html+=  '<div class="opty-single-body">'; 
      html+= '<p>'+theAnswer.search_snippet+'</p>';   
      html+= '</div>'; //end body  
      html+= '</div>'; //end single
      }
    //  html+= getInTouch;
      html+= '</div>';
      
      utils.observeSelector('[data-test-id="tree-node"] [data-test-id="node-heading"]',function (title) {
        if(document.querySelector('[data-test-id="tree-node"]  .c-breadcrumbs-no-background')){
            var parentTitle = title.parentElement;
      if(!document.querySelector('#opty-community-api')){
      parentTitle.insertAdjacentHTML('afterend', html);  
     // addCommunityCss(parentTitle); 
      hideControlPods();  
      updateBreadCrumbs();  
      }
        }
        
    
      });
        pushGenEvar18('462: Community x Gatekeeper API round2: Variation#4');
    };
    
     if(resultItems !== false){
      // removetempStyle();
      buildUI(resultItems);
      buildUIPod(resultItems); 
       removeLoader();
     } else {
       //Mo
       initialLoading();
       //Mo
    var columns_list_arr = ['board.id', 'board.view_href', 'post_time_friendly', 'view_href', 'subject', 'search_snippet', 'conversation.solved'];
    var subject_matches_arrThree = getMetaData(3);
    var body_matches_arrThree =getMetaData(3);
    var isSolved = true;
    var limit = 3;
    
    var urlQueryThree =  queryBuilder(columns_list_arr, subject_matches_arrThree, body_matches_arrThree, isSolved, limit);

    var fetchThree = fetchApi(urlQueryThree);
    fetchThree.then(function(itemsThree){

      if(Array.isArray(itemsThree)){
      if(itemsThree.length == 0){
      // check title
    var subject_matches_arrTitle = getMetaData(0,true);
    var body_matches_arrTitle =getMetaData(0,true);  
    var urlQueryTitle =  queryBuilder(columns_list_arr, subject_matches_arrTitle, body_matches_arrTitle, isSolved, limit);

     
    var fetchTitle = fetchApi(urlQueryTitle);
     fetchTitle.then(function(itemsTitle){

        if(Array.isArray(itemsTitle)){
      if(itemsTitle.length == 0){
         // check two
    var subject_matches_arrTwo = getMetaData(2);
    var body_matches_arrTwo =getMetaData(2);  
    var urlQueryTwo =  queryBuilder(columns_list_arr, subject_matches_arrTwo, body_matches_arrTwo, isSolved, limit); 
      
    var fetchTwo = fetchApi(urlQueryTwo);
         fetchTwo.then(function(itemsTwo){

        if(Array.isArray(itemsTwo)){
      if(itemsTwo.length == 0){
        
          // check one
    var subject_matches_arrOne = getMetaData(1);
    var body_matches_arrOne =getMetaData(1);  
    var urlQueryOne =  queryBuilder(columns_list_arr, subject_matches_arrOne, body_matches_arrOne, isSolved, limit); 
      
    var fetchOne = fetchApi(urlQueryOne);   
         fetchOne.then(function(itemsOne){

               if(Array.isArray(itemsOne)){
      if(itemsOne.length > 0){
      resultItems = itemsOne;
//        removetempStyle();
       buildUI(itemsOne);
       buildUIPod(itemsOne);  
     removeLoader();
      } else {
        /*08-2022*/
       //removetempStyle();
      removeLoader();
       clearAll(); 
      }
                 
      }         
           
           
           
         });
        
        
        
      } else {
        resultItems = itemsTwo;
       // removetempStyle();
         buildUI(itemsTwo);
            buildUIPod(itemsTwo);  
        removeLoader();
      }
        }
           
         });
        
      } else {
        
      resultItems = itemsTitle;
      // removetempStyle();
        buildUI(itemsTitle);
         buildUIPod(itemsTitle);  
        removeLoader();
      }
        }
       
       
       
       
     
     }).catch(function(e){
    //removetempStyle();
       clearAll();  
     removeLoader();
     
    console.log('error', e);
    });   
        
        
        
        
      } else {
      resultItems = itemsThree;
    //  removetempStyle();  
      buildUI(itemsThree);
       buildUIPod(itemsThree);    
      removeLoader();  
      }
      }
    
    }).catch(function(e){
   // removetempStyle();
       clearAll();
      removeLoader(); 
      
    console.log('error', e);
    }); 
     }  
    
    
    
     /*
      utils.observeSelector('[data-test-id^="contact-option-"]',function () {
        addCommunityCss(); 
      });
      */
      utils.observeSelector('[data-test-id^="node-button"]',function () {
        clearAll(); 
      });
      utils.observeSelector('#opty-prefer-contact',function (btn) {
        btn.addEventListener('click', function(){
            clearAll(); 
            updateBreadCrumbs(true); 
    
        });
      });
      utils.observeSelector('#opty-ask-community',function (btn) {
        btn.addEventListener('click', function(){
           if(document.querySelector('#opty-community-api')){
           document.querySelector('#opty-community-api').removeAttribute('style');
           }
          if(document.querySelector('#opty-router-screen')){
           document.querySelector('#opty-router-screen').style.display = 'none';
           }
         updateBreadCrumbs('answers'); 
    
        });
      });
    
     utils.observeSelector('.opty-single-answer .title-link',function () {
       document.querySelectorAll('.opty-single-answer .title-link').forEach(function(l){
       l.addEventListener('click', function(){
               pushGenEvar7();
             });
       });
      });
    
    
    //Add previous
     utils.observeSelector('.ctn-previous',function (prev) {
      var parentPrev = prev.parentElement;
         parentPrev.style.display = 'none'; 
       if(!document.querySelector('#opty-previous-container')){
          parentPrev.insertAdjacentHTML('afterend', '<div id="opty-previous-container"> <svg viewBox="0 0 32 32" aria-hidden="true"> <g id="linear-arrow-left"> <path d="M22.333 6.032C22.128 5.785 21.523 5 21.07 5c-.198.008-.366.087-.53.248L10.274 15.512a.934.934 0 0 0 0 1.32L20.54 27.098c.164.162.332.24.53.248.452 0 1.057-.784 1.262-1.032l.11-.137-10.002-10.003L22.444 6.17l-.111-.138" id="Icon"></path> </g> </svg> <button data-test-id="back-contact-tree-link">Previous step</button> </div>');
         //.c-breadcrumbs-no-background button
         if(document.querySelector('#opty-previous-container button')){
         document.querySelector('#opty-previous-container button').addEventListener('click', function(){
         document.querySelectorAll('.c-breadcrumbs-no-background button')[document.querySelectorAll('.c-breadcrumbs-no-background button').length -1 ].click();
         });
         }
       }
    
      });
     



var genHtml = function(items){
var selectorID = 'opty-community-api-extras';

var svgBubble = '<svg viewBox="0 0 32 32" class="opty-svg-bubble" role="presentation" aria-hidden="true" data-test-id="contact-option-icon"><g id="linear-chat2"><path d="M19.125 3a3 3 0 0 1 3 3v5.42H28a3 3 0 0 1 3 3v7.013a3 3 0 0 1-3 3h-.708v4.565a1 1 0 0 1-1.708.707l-5.272-5.272h-7.437a3 3 0 0 1-3-3v-3.547l-3.459 3.46a1 1 0 0 1-1.708-.707v-4.565H4a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3zM28 13.42H12.875c-.551 0-1 .449-1 1v7.013c0 .551.449 1 1 1h8.266l4.151 4.151v-4.151H28c.551 0 1-.449 1-1V14.42c0-.551-.449-1-1-1zM19.125 5H4c-.551 0-1 .449-1 1v7.074c0 .551.449 1 1 1h2.708v4.151l3.167-3.167v-.638a3 3 0 0 1 3-3h7.25V6c0-.551-.449-1-1-1z" id="Icon"></path></g></svg>';
var solvedBubble = '<div class="opty-solved-bubble">Solved</div>';

var html = '<div id="'+selectorID+'">';
html+='<h2 class="opty-header">We found some answers that might help</h2>';
html+= '<div class="opty-intro"><p>Here are some discussions by other customers related to this issue, which have been answered and you may find useful:</p></div>';
for(var i=0;i<items.length;i++){
var theAnswer =   items[i];

html+= '<div class="opty-single-answer">';

html+=  '<div class="opty-single-header">';
html+=  '<div class="opty-single-header-left">';  
html+= svgBubble;
html+= '<a class="title-link" href="'+theAnswer.view_href+'" target="_blank">'+theAnswer.subject+'</a>';
html+= '</div>'; //end header-left
html+=  '<div class="opty-single-header-right">';    
html+= '<span class="span-local-date">'+theAnswer.post_time_friendly+'</span>';
html+= solvedBubble;
html+= '</div>'; //end header-right  
html+= '</div>'; //end header 

html+=  '<div class="opty-single-body">'; 
html+= '<p>'+theAnswer.search_snippet+'</p>';   
html+= '</div>'; //end body  
html+= '</div>'; //end single
}

html+= '</div>';

return html;
};

var buildUIPod = function(items){

    var html = genHtml(items);

    var selectorID = 'opty-community-api-extras';
    var ref = '[data-test-id="contact-option-community"] [data-test-id="contact-option-cta"]';

utils.observeSelector(ref,function (domRef) {
   if(document.querySelector('[data-test-id="tree-node"]  .c-breadcrumbs-no-background')){
if(!document.querySelector('#'+selectorID)){
    domRef.insertAdjacentHTML('afterend', html);  
} 
   }

});
};
}}, {"value": "<style>#ccx-num-spinner-container {\nwidth: 30px;\nmargin: auto;\n}\n\n[data-test-id=\"contact-option-community\"] #ccx-num-spinner-container {\nmargin: 0;\nwidth: 50px;  \n}\n\n#ccx-num-spinner {\nanimation: 1s linear 0s infinite normal none running GLFYz;\n    border-color: currentcolor currentcolor currentcolor transparent;\n    border-radius: 50%;\n    border-style: solid;\n    border-width: 1px;\n    position: relative;\n  display:inline-block;\n    height: 24px;\n    width: 24px;\ncolor: rgb(77, 77, 77);\nmargin-top: 7px;\n}\n@keyframes GLFYz{\n100% {\n    transform: rotate(360deg);\n}\n}\n\n.hidden-opty-control{\ndisplay: none !important;\n}\n\n\n#opty-community-api-extras{\nmax-width: 522px;\nmargin-top: 13px;  \n}\n\n#opty-community-api-extras .opty-single-body p {\n      text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\nmax-width: 400px;\n}\n\n#opty-community-api-extras .opty-single-answer {\n    border-radius: 4px;\n    border: 1px solid #CCCCCC;\n  margin-bottom: 13px;\n  padding-top: 12px;\n  padding-left:25px;\n  padding-right: 16px;\n  padding-bottom: 20px;\n}\n\n@media (min-width: 660px) and (max-width: 710px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 340;\n}\n#opty-community-api-extras .opty-single-answer {\n    border-radius: 4px;\n    border: 1px solid #CCCCCC;\n    margin-bottom: 13px;\n    padding-top: 12px;\n    padding-left: 12px;\n    padding-right: 16px;\n    padding-bottom: 14px;\n}\n}\n@media (min-width: 439px) and (max-width: 639px){\n #opty-community-api-extras .opty-single-answer{\n  padding-left:15px;\n  padding-right:15px;\n    padding-bottom: 18px;\n}\n}\n@media (min-width: 640px) and (max-width: 659px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 315px;\n}\n}\n@media (min-width: 500px) and (max-width: 639px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 400px;\n}\n}\n\n@media (min-width: 439px) and (max-width: 499px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 340px;\n}\n}\n\n@media (min-width: 0px) and (max-width: 438px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 280px;\n}\n  \n#opty-community-api-extras .opty-single-answer {\n  padding-left: 8px;\n    padding-right: 2px;\n    padding-bottom: 13px;\n  }\n}\n\n@media (max-width: 354px){\n#opty-community-api-extras .opty-single-body p {\nmax-width: 220px;\n}\n}\n\n\n\n#opty-community-api .opty-header{\ncolor: inherit;\nfont-weight: bold;\n margin-bottom: 20px;\n}\n#opty-community-api-extras .opty-header{\ncolor: inherit;\nfont-weight: bold;\n margin-bottom: 13px;\n}\n\n#opty-community-api .opty-single-answer{\n    border-radius: 4px;\n    border: 1px solid #CCCCCC;\n  margin-bottom: 13px;\n  padding-top: 12px;\n  padding-left:25px;\n  padding-right: 16px;\n  padding-bottom: 20px;\n}\n\n#opty-community-api .opty-single-header, #opty-community-api-extras .opty-single-header{\n  display: flex;\n}\n#opty-community-api .opty-single-header-left, #opty-community-api-extras .opty-single-header-left{\n    display: flex;\n  mmax-width:400px;\n}\n#opty-community-api .opty-single-header-right, #opty-community-api-extras .opty-single-header-right{\n display: flex;\n    min-width: 130px;\n  justify-content: space-between;\n   flex-grow: 100;\n}\n\n#opty-community-api .opty-solved-bubble, #opty-community-api-extras .opty-solved-bubble{\n width: 60px;\nheight: 19px;\nfont-size: 14px;\nbackground: #046714;\nborder-radius: 40px;\ndisplay: flex;\ncolor: #ffffff;\njustify-content: center;\nfont-weight: bold;  \nmargin-top: 2px;  \n}\n\n#opty-community-api .title-link, #opty-community-api-extras .title-link{\nfont-weight: bold;\nfont-size: 20px;\nwwhite-space: nowrap;  \n}\n\n#opty-community-api .span-local-date, #opty-community-api-extras .span-local-date{\nfont-size: 13px;\nline-height: 15px;\n  color: #4D4D4D;\n  word-break: break-word;\n    word-wrap: break-word;\n  margin-left: 14px;\n  margin-top: 6px;\n}\n\n\n#opty-community-api .opty-single-body p{\npadding-left: 45px;\nmax-width: 692px;\nwhite-space: nowrap;\noverflow: hidden;\ntext-overflow: ellipsis;  \n  \n}\n\n#opty-community-api .opty-single-body p, #opty-community-api .opty-intro p, #opty-community-api-extras .opty-single-body p, #opty-community-api-extras .opty-intro p{\nfont-size: 16px;\n}\n\n.opty-prefer-contact h3 {\nfont-size: 28px;\n}\n\n@media (min-width: 640px){\n#opty-community-api .opty-header, #opty-community-api-extras .opty-header  {\n    font-size: 28px;\n    line-height: 32px;\n}\n  #opty-community-api .opty-svg-bubble,  #opty-community-api-extras .opty-svg-bubble{\n  flex: 0 0 32px;\n    margin-bottom: 8px;\n    height: 32px;\n    width: 32px;\n    fill: #000FBE;\n    margin-right: 13px;\n  }\n  #opty-community-api .opty-single-header, #opty-community-api-extras .opty-single-header{\n  width: 100%;\n  }\n  /********/\n#opty-router-screen > div {\ndisplay: flex;\n}\n  #opty-router-screen h2{\n  font-size:28px;\n  font-weight: bold;  \n  }\n}\n\n@media (min-width: 0px) and (max-width: 639px){\n#opty-community-api .opty-single-answer, #opty-community-api-extras .opty-single-answer{\n  padding-left:15px;\n  padding-right:15px;\n    padding-bottom: 18px;\n}\n  \n#opty-community-api .opty-single-header, #opty-community-api-extras .opty-single-header{\n    flex-direction: column;\n}\n  \n#opty-community-api .opty-header, #opty-community-api-extras .opty-header{\n    font-size: 24px;\n    line-height: 28px;\n}\n  \n   #opty-community-api .opty-svg-bubble, #opty-community-api-extras .opty-svg-bubble{\n    flex: 0 0 24px;\n    margin-right: 12px;\n      height: 24px;\n    width: 24px;\n    fill: #000FBE;\n    margin-right: 11px;  \n  }\n  #opty-community-api .title-link, #opty-community-api-extras .title-link{\n\nfont-size: 16px;  \n}\n  #opty-community-api .opty-single-body p, #opty-community-api-extras .opty-single-body p{\n     padding-left: 0;\n}\n  #opty-community-api .opty-single-header-right, #opty-community-api-extras .opty-single-header-right{\n    justify-content: left;\n    flex-direction: row-reverse;\n    padding-left: 35px;\n}\n  .opty-prefer-contact h3 {\nfont-size: 24px;\nfont-weight: bold;\n}\n    /********/\n#opty-router-screen button{\nwidth: 100%;\n}\n  #opty-router-screen h2{\n  font-size:24px;\n  }\n}\n\n\n\n\n\n.opty-btn-style{color:inherit;font-weight:bold;color:#000FF5;}\n.opty-btn-style:hover{-webkit-text-decoration:none;text-decoration:none;}\n@media (min-width:0px) and (max-width:639px){\n.opty-btn-style{font-size:18px;line-height:22px;}\n}\n@media (min-width:640px){\n.opty-btn-style{font-size:20px;line-height:24px;}\n}\n.opty-btn-style{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row no-wrap;-ms-flex-flow:row no-wrap;flex-flow:row no-wrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#FFFFFF;border:1px solid #CCCCCC;padding:8px 24px;border-bottom:2px solid #000FF5#00D2FF;border-radius:22px;cursor:pointer;-webkit-transition:background-color 0.3s ease,border-color 0.3s ease;transition:background-color 0.3s ease,border-color 0.3s ease;}\n.opty-btn-style:hover{-webkit-text-decoration:none;text-decoration:none;background-color:#000FF5;border-color:#000FF5;}\n.opty-btn-style:hover span{color:#FFFFFF;}\n.opty-btn-style:focus{box-shadow:0 0 0 7px rgba(0,115,197,0.2);outline:none;}\n.opty-btn-style span{white-space:nowrap;-webkit-transition:color 0.3s ease;transition:color 0.3s ease;}\n.opty-btn-style{margin:calc(12px * 0.5);}\n\n\n/*****/\n.opty-show-on [data-test-id=\"node-heading\"], .opty-show-on div[data-test-id^=\"contact-option-\"], .opty-show-on .opty-parent-title{\ndisplay: none;\n}\n.opty-show-on .opty-parent-option{\nborder: 0;\n}\n\n\n\n/* 04-10*/\n[data-test-id=\"contact-option-community\" ] [data-test-id=\"footer-text\"] {\ndisplay: none;\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "557974FB-80FC-4723-91D0-5CBE57475DB8"}]}], "name": "Variation #4"}], "audienceIds": null, "changes": null, "id": "22120440948", "integrationSettings": null}], "id": "22133800646", "weightDistributions": null, "name": "462: Community x Gatekeeper API round 2", "groupId": null, "commitId": "22283941324", "decisionMetadata": null, "policy": "single_experiment", "changes": [{"value": "<style>#opty-previous-container button{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0;}\n#opty-previous-container button{overflow:visible;}\n#opty-previous-container button{text-transform:none;}\n#opty-previous-container button{-webkit-appearance:button;}\n#opty-previous-container button::-moz-focus-inner{border-style:none;padding:0;}\n#opty-previous-container button:-moz-focusring{outline:1px dotted ButtonText;}\n#opty-previous-container button{font:inherit;}\n/*! CSS Used from: Embedded */\n#opty-previous-container svg{fill:currentColor;-webkit-flex:none;-ms-flex:none;flex:none;height:24px;width:24px;}\n#opty-previous-container button{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:transparent;border-radius:4px;border:1px solid transparent;cursor:pointer;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-weight:bold;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;line-height:24px;outline:none;position:relative;text-align:center;-webkit-transition-duration:300ms;transition-duration:300ms;-webkit-transition-property:background,color,box-shadow;transition-property:background,color,box-shadow;-webkit-transition-timing-function:ease;transition-timing-function:ease;color:#000FF5;font-size:16px;padding:8px 12px;}\n#opty-previous-container button:hover{-webkit-text-decoration:none;text-decoration:none;}\n#opty-previous-container button:disabled{background-color:#CCCCCC;background-image:none;border-color:transparent;color:#FFFFFF;cursor:not-allowed;}\n#opty-previous-container button::after{content:'';border:2px solid #00A0FF;border-radius:8px;bottom:-5px;left:-5px;opacity:0;pointer-events:none;position:absolute;right:-5px;top:-5px;-webkit-transition:opacity 150ms linear;transition:opacity 150ms linear;}\n#opty-previous-container button:focus::after{opacity:1;}\n@media (max-width:639px){\n#opty-previous-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row nowrap;-ms-flex-direction:row nowrap;flex-direction:row nowrap;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}\n#opty-previous-container button{padding:0;}\n#opty-previous-container svg{margin-left:-8px;}\n#opty-previous-container svg path{fill:#000FF5;}\n}\n#opty-previous-container svg path{fill:#000FF5;}\n@media (min-width:639px){\n#opty-previous-container{display:none;}\n}\n.opty-single-header-left .title-link { color: #000FF5 !important; }</style>", "selector": "head", "dependencies": [], "type": "append", "id": "d4c409e345484db1820e45e437931419"}, {"dependencies": [], "type": "custom_code", "id": "fba709a8cd874fbd83e69193b24e9aa5", "value": function($){window.__opty_gatekeeper_community__roundTwo = {

    queryBuilder: function(columns_list_arr, subject_matches_arr, body_matches_arr, isSolved, limit){
    var endPoint = 'https://helpforum.sky.com/api/2.0/search';  
    var columns_list_string = columns_list_arr.toString();
    var subject_matches_string = subject_matches_arr.toString();
    var body_matches_string = body_matches_arr.toString();    
    var query = endPoint+'?q=SELECT '+columns_list_string+' FROM messages WHERE subject MATCHES ('+subject_matches_string+')  OR body MATCHES ('+body_matches_string+')  AND depth = 0 AND conversation.solved = '+isSolved+'  LIMIT '+limit+'';
    
    return query;
    },
    fetchApi: function(url){
    
    
        return new Promise(function (resolve, reject) {
          var apiReq = new XMLHttpRequest();
          apiReq.open("GET", url, true);
         apiReq.onload = function(){
        if (apiReq.status === 200) {  
         var respJson = JSON.parse(apiReq.response); 
        //   if(respJson && respJson.data &&  respJson.data.items && respJson.data.items.length > 0){
        //      } 
        resolve(respJson.data.items);
        } else {
          reject(false);
        return false;
        } 
        };
        apiReq.onerror = function(e){
          reject(false);
        };
        apiReq.send();
        });
      },
      getMetaData: function(keywordsNum, useTitle){
        if(!useTitle){
         var metaDataKeywords = ''; 
        metaDataKeywords =   (Array.from(document.getElementsByTagName('meta')).find(el => el.name === 'keywords') && Array.from(document.getElementsByTagName('meta')).find(el => el.name === 'keywords')['content']) ? Array.from(document.getElementsByTagName('meta')).find(el => el.name === 'keywords')['content'] : '';
          
          if(metaDataKeywords.split(',').length > 0){
    
      var shortArrThree =  metaDataKeywords.split(',').slice(0,keywordsNum);
      var shortWithQuotes = shortArrThree.map(function(v){
    return "'"+v+"'";
    });
        
        return shortWithQuotes;
        
      }
        } else {
          const getMetaDataFromHead = () => {
      const metaData = {};
      document.head.children.forEach(child => {
        if (child instanceof HTMLMetaElement) {
          if (['description', 'keywords', 'robots'].includes(child.name)) {
            metaData[child.name] = child.content;
          }
        } else if (child instanceof HTMLTitleElement) {
          metaData.title = child.text;
        }
      });
      return metaData;
    };
    var metaDataFromHead = getMetaDataFromHead();
    
    if(metaDataFromHead && metaDataFromHead.title){
    
        var firstTitle = metaDataFromHead.title.split('|')[0];
         return ["'"+firstTitle.trim()+"'"];
    }
       
           
        
        }
        
    
      
    
      },
      pushGenEvar7: function(){
      window.targetEvar = function(options) {
            options.dataLayer.map(function(s) {
                if (typeof s.tl !== 'undefined') {
                    s.linkTrackVars = 'eVar7';
                    s.linkTrackEvents = '';
                    s.eVar7 = options.val;
                    s.tl(true, 'o', 'page load');
                }
            });
          };
        
         targetEvar({
    dataLayer:s_c_il,
    val:'community-gatekeeper-thread|click'
       });
      
      },
       pushGenEvar18: function(val){
      window.targetEvar = function(options) {
            options.dataLayer.map(function(s) {
                if (typeof s.tl !== 'undefined') {
                    s.linkTrackVars = 'eVar18';
                    s.linkTrackEvents = '';
                    s.eVar18 = options.val;
                    s.tl(true, 'o', 'page load');
                }
            });
          };
        
         targetEvar({
    dataLayer:s_c_il,
    val:val
       });
      
      }
  
    };
}}]}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22197820591"], "experiments": [{"weightDistributions": [{"entityId": "22195361147", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "Glass Disco p1 - new headline", "bucketingStrategy": null, "variations": [{"id": "22195361147", "actions": [{"viewId": "22197820591", "changes": [{"selector": "h1", "dependencies": [], "attributes": {"html": "Sky Glass 4K TV.<br>Includes 3 MONTHS FREE <br>Sky TV & Netflix"}, "type": "attribute", "id": "C2D63103-4212-42EC-A3FA-756716E39974", "css": {}}]}], "name": "Original"}, {"id": "22174500978", "actions": [], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22189900879", "integrationSettings": null}], "id": "22158600951", "weightDistributions": null, "name": "Glass Disco p1 - new headline", "groupId": null, "commitId": "22239511006", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22160852030"], "experiments": [{"weightDistributions": [{"entityId": "22185732633", "endOfRange": 5000}, {"entityId": "22199042725", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "AC - Service checker link in BB diagnostic", "bucketingStrategy": null, "variations": [{"id": "22185732633", "actions": [], "name": "Original"}, {"id": "22199042725", "actions": [{"viewId": "22160852030", "changes": [{"dest": "https://www.sky.com/help/articles/broadband-diagnostic-start-v1", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "A5D33F3F-F0E9-4EF4-9AA5-8BA3FBFFDF23"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22168482332", "integrationSettings": null}], "id": "22158672918", "weightDistributions": null, "name": "AC - Service checker link in BB diagnostic", "groupId": null, "commitId": "22191652497", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22184122636"], "experiments": [{"weightDistributions": [{"entityId": "22209292052", "endOfRange": 9500}, {"entityId": "22158382411", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "NS - contact us MVP test", "bucketingStrategy": null, "variations": [{"id": "22209292052", "actions": [], "name": "Original"}, {"id": "22158382411", "actions": [{"viewId": "22184122636", "changes": [{"dest": "https://www.sky.com/help/articles/contact-us-t1", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "169D3291-CBFC-40CD-9C68-789B1678F17D"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22180072900", "integrationSettings": null}], "id": "22242140400", "weightDistributions": null, "name": "NS - contact us MVP test", "groupId": null, "commitId": "22214630707", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22258470655"], "experiments": [{"weightDistributions": [{"entityId": "22296840061", "endOfRange": 5000}, {"entityId": "22295310844", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "AC - Reschedule TV engineer", "bucketingStrategy": null, "variations": [{"id": "22296840061", "actions": [], "name": "Original"}, {"id": "22295310844", "actions": [{"viewId": "22258470655", "changes": [{"dest": "https://www.sky.com/help/articles/reschedule-your-sky-tv-engineer-appointment-v2", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "a9fff487ed444ae9834b8a76b28fe94b"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22300800297", "integrationSettings": null}], "id": "22260770775", "weightDistributions": null, "name": "AC - Reschedule TV engineer", "groupId": null, "commitId": "22330010029", "decisionMetadata": null, "policy": "single_experiment", "changes": null}, {"holdback": 0, "activation": {}, "integrationSettings": {"clicktale": {}, "contentsquare": {}}, "integrationStringVersion": 2, "viewIds": ["22289420984"], "experiments": [{"weightDistributions": [{"entityId": "22281760576", "endOfRange": 5000}, {"entityId": "22295080705", "endOfRange": 10000}], "audienceName": "Everyone else", "name": "AC - Book TV engineer", "bucketingStrategy": null, "variations": [{"id": "22281760576", "actions": [], "name": "Original"}, {"id": "22295080705", "actions": [{"viewId": "22289420984", "changes": [{"dest": "https://www.sky.com/help/articles/book-engineer-sky-q-v2", "allowAdditionalRedirect": false, "dependencies": [], "preserveParameters": true, "type": "redirect", "id": "715CAE97-81B1-4C47-AB4A-3CBF2FC38BE6"}]}], "name": "Variation #1"}], "audienceIds": null, "changes": null, "id": "22283640756", "integrationSettings": null}], "id": "22287200626", "weightDistributions": null, "name": "AC - Book TV engineer", "groupId": null, "commitId": "22316100247", "decisionMetadata": null, "policy": "single_experiment", "changes": null}], "visitorIdLocator": null, "listTargetingKeys": [], "groups": [], "views": [{"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/ordertracking", "match": "simple"}, {"type": "url", "value": "https://sky-pages-master-e05.cf.dev-paas.bskyb.com/ordertracking", "match": "simple"}], ["or", {"type": "custom_code", "value": /**
 * Sample JavaScript Condition
 * This function is called after the page is triggered. It should return true
 * when the page is ready to activate.
 */

function jsCondition() {
  return document.querySelector('[data-test-id="order-tracking-no-orders-container"] > h2') && document.querySelector('[data-test-id="order-tracking-no-orders-container"] > h2').innerText === 'No orders in progress';
}
}]], "activationType": "dom_changed", "name": "Order Tracking", "apiName": "8156242263_order_tracking_2", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "16339980099"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "/help/expert/", "match": "substring"}], ["or", {"type": "element_present", "value": "#onehelp-expert-id"}], ["or", {"type": "element_present", "value": "#onehelp-expert-opti-bucket"}], ["or", {"type": "custom_code", "value": /**
 * Sample JavaScript Condition
 * This function is called after the page is triggered. It should return true
 * when the page is ready to activate.
 */

function jsCondition() { return true;
  return document.readyState == "complete";
}
}]], "activationType": "dom_changed", "name": "URL Targeting for Onehelp expert - Routing", "apiName": "8156242263_url_targeting_for_onehelp_expert__routing", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "19255812295"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/live-chat/comeback", "match": "simple"}], ["or", {"type": "element_present", "value": "div.c-live-chat__item-left"}]], "activationType": "dom_changed", "name": "URL Targeting for Messaging - LC AB test - Comeback", "apiName": "8156242263_url_targeting_for_messaging__lc_ab_test_poc", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "20132636282"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/live-chat/missed-payment", "match": "simple"}], ["or", {"type": "element_present", "value": "div.c-live-chat__item-left"}]], "activationType": "dom_changed", "name": "URL Targeting for Messaging - LC AB test - Missed Payment", "apiName": "8156242263_url_targeting_for_messaging__lc_ab_test__missed_payme", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "20180056507"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/live-chat/pending-cancel-tv", "match": "simple"}], ["or", {"type": "element_present", "value": "div.c-live-chat__item-left"}]], "activationType": "dom_changed", "name": "URL Targeting for Messaging - LC AB test - Pending Cancel tv", "apiName": "8156242263_url_targeting_for_messaging__lc_ab_test__pending_canc", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "20181838066"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://papps-product-settings-tv-master.cf.dev-paas.bskyb.com/activate", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/productsettings/tv/activate", "match": "simple"}]], "activationType": "dom_changed", "name": "URL Targeting for 325: Glass - Add Tooltip to Activate Page", "apiName": "8156242263_url_targeting_for_325_glass__add_tooltip_to_activate_", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "21024280531"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/broadband/buy/glass", "match": "simple"}]], "activationType": "dom_changed", "name": "URL Targeting for Contextual CTA Broadband Test", "apiName": "8156242263_url_targeting_for_contextual_cta_broadband_test", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": true, "id": "21569670495"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://pages-apps-bill-master-u01.cf.dev-paas.bskyb.com/bill/streaming-tv/future", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/bill/streaming-tv/future", "match": "simple"}]], "activationType": "dom_changed", "name": "URL Targeting for 398: Glass - Future Bill List Add Key Actions", "apiName": "8156242263_url_targeting_for_398_glass__future_bill_list_add_key", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "21610410599"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "www.sky.com", "match": "substring"}], ["or", {"type": "custom_code", "value": function jsCondition() {
  return document.cookie.indexOf('opty-masthead-408-variation') > -1;
}
}]], "activationType": "manual", "name": "URL Targeting for 408-adding-dropdown-to-help (UI)", "apiName": "8156242263_url_targeting_for_408addingdropdowntohelp", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "21783361616"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com", "match": "substring"}], ["or", {"type": "custom_code", "value": function jsCondition() {
  return document.cookie.indexOf('opty-masthead-408-variation') === -1;
}
}], ["or", {"type": "element_present", "value": ".footer-wrapper .extra-link-wrapper:last-child"}]], "activationType": "dom_changed", "name": "URL Targeting for 408-adding-dropdown-to-help (Router)", "apiName": "8156242263_url_targeting_for_408addingdropdowntohelp_router", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "21792710185"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/help/home", "match": "exact"}], ["or", {"type": "element_present", "value": ".c-btn.c-btn--secondary[aria-label=\"Create a Sky iD\"]"}]], "activationType": "dom_changed", "name": "URL Targeting for AC - Change link on 'Create Sky Id' button", "apiName": "8156242263_url_targeting_for_ac__change_link_on_create_sky_id_bu", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "21851217303"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/myaccount/bill/future", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/myaccount/bill/", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/myaccount/bill/current", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/myaccount/bill/previous", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/myaccount/bill/pay", "match": "simple"}]], "activationType": "dom_changed", "name": "URL Targeting for 433: Tripleplay - Future Bill Add Key Actions", "apiName": "8156242263_url_targeting_for_tp_future_bill_list__transaction_li", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "21863612954"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/mobile-bill/future", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/mobile-bill/", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/mobile-bill/current", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/mobile-bill/previous", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/mobile-bill/pay", "match": "simple"}]], "activationType": "dom_changed", "name": "URL Targeting for 434: Mobile Bill - Future Bill Add Key Actions", "apiName": "8156242263_url_targeting_for_copy_of_433_tripleplay__future_bill", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "21902410416"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "com/bill/streaming-tv/change-payment-due-date", "match": "substring"}], ["or", {"type": "element_present", "value": "svg #linear-tick-circle"}], ["or", {"type": "element_present", "value": "[data-test-id=\"button-back\" ]"}]], "activationType": "dom_changed", "name": "URL Targeting for 445: Glass bill - future bill CTA on change payment date success", "apiName": "8156242263_url_targeting_for_445_glass_bill__future_bill_cta_on_", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "21987690607"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "articles/understanding-my-bills", "match": "substring"}], ["not", ["or", {"type": "url", "value": "/expert/", "match": "substring"}, {"type": "url", "value": "https://www.sky.com/help/articles/understanding-my-bills-bwm-t1", "match": "simple"}]]], "activationType": "dom_changed", "name": "understanding my bills", "apiName": "8156242263_understanding_my_bills", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22009305579"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/myaccount/bill/pay", "match": "simple"}, {"type": "url", "value": "https://ds-sky-pages-master-e05.cf.dev-paas.bskyb.com/myaccount/bill/pay", "match": "simple"}]], "activationType": "dom_changed", "name": "URL Targeting for 450: Triple play bill - future bill (individual) show next best actions(Pay)", "apiName": "8156242263_url_targeting_for_450_triple_play_bill__future_bill_1", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "22012122935"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "com/myaccount/bill/future/2022-", "match": "substring"}], ["or", {"type": "element_present", "value": ".tripleplay-bill-container"}]], "activationType": "dom_changed", "name": "URL Targeting for 450: Triple play bill - future bill (individual) show next best actions", "apiName": "8156242263_url_targeting_for_450_triple_play_bill__future_bill_i", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "22022392699"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "com/myaccount/bill/pay", "match": "substring"}], ["or", {"type": "element_present", "value": "#linear-tick-circle,svg #linear-alert"}]], "activationType": "dom_changed", "name": "449:Triple play bill - show next best actions across manage payment journeys (make-payment)", "apiName": "8156242263_ttttemmpp", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22024160802"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "/help/articles/contact-us-t1", "match": "substring"}]], "activationType": "dom_changed", "name": "URL Targeting for 454: Re-design of contact us page", "apiName": "8156242263_url_targeting_for_454_redesign_of_contact_us_page", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22026747698"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "articles/on-screen-message", "match": "substring"}], ["not", ["or", {"type": "url", "value": "/expert/", "match": "substring"}, {"type": "url", "value": "https://www.sky.com/help/articles/on-screen-message-v2", "match": "simple"}]]], "activationType": "dom_changed", "name": "URL Targeting for AC - On screen error message ", "apiName": "8156242263_url_targeting_for_ac__on_screen_error_message_", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22027598186"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": ".+articles\\/home-move-start$", "match": "regex"}], ["not", ["or", {"type": "url", "value": "/expert/", "match": "substring"}]]], "activationType": "dom_changed", "name": "URL Targeting for NS - New HM test", "apiName": "8156242263_url_targeting_for_ns__new_hm_test", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22028680634"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "com/myaccount/bill/change-payment-date", "match": "substring"}], ["or", {"type": "custom_code", "value": /**
 * Sample JavaScript Condition
 * This function is called after the page is triggered.
 * It should return true when the page is ready to activate.
 *
 * Editor now supports ES6 compliant code. Note that adding ES6
 * specific code to an experiment will break for users running
 * ES5-only browsers as code entered is not transpiled down to ES5.
 */

function jsCondition() { return true;
  if(document.querySelector('[data-test-id="blocked-message"]')){
if(document.querySelector('[data-test-id="blocked-message"]').innerText.indexOf('You can only change your payment date once a month') > -1){
return false;
} else {
return true;
}
}
  return true;
}
}], ["or", {"type": "element_present", "value": "svg.success-tick,svg #linear-alert"}]], "activationType": "dom_changed", "name": "Triple play bill - show next best actions across manage payment journeys(change date)", "apiName": "8156242263_triple_play_bill__show_next_best_actions_across_manag", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22030900606"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "com/bill/streaming-tv/change-payment-method", "match": "substring"}], ["or", {"type": "element_present", "value": "svg #linear-cross-circle,svg #linear-tick-circle"}], ["or", {"type": "element_present", "value": "[data-test-id=\"button-back\" ]"}]], "activationType": "dom_changed", "name": "URL Targeting for 446:Glass bill - show next best actions across manage payment journeys (payment method)", "apiName": "8156242263_url_targeting_for_446glass_bill__show_next_best_act_2", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "22032340099"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "com/bill/streaming-tv/change-payment-due-date", "match": "substring"}], ["or", {"type": "element_present", "value": "svg #linear-cross-circle,svg #linear-tick-circle"}], ["or", {"type": "element_present", "value": "[data-test-id=\"button-back\" ]"}], ["or", {"type": "custom_code", "value": /**
 * Sample JavaScript Condition
 * This function is called after the page is triggered.
 * It should return true when the page is ready to activate.
 *
 * Editor now supports ES6 compliant code. Note that adding ES6
 * specific code to an experiment will break for users running
 * ES5-only browsers as code entered is not transpiled down to ES5.
 */

function jsCondition() {
  if(document.querySelector('[data-test-id="blocked-message"]')){
if(document.querySelector('[data-test-id="blocked-message"]').innerText.indexOf('You can only change your payment date once a month') > -1){
return false;
} else {
return true;
}
}
  return true;
}
}]], "activationType": "dom_changed", "name": "URL Targeting for 446:Glass bill - show next best actions across manage payment journeys (Date)", "apiName": "8156242263_url_targeting_for_446glass_bill__show_next_best_actio", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "22035230274"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "com/bill/streaming-tv/make-payment", "match": "substring"}], ["or", {"type": "element_present", "value": "svg #linear-cross-circle,svg #linear-tick-circle"}], ["or", {"type": "element_present", "value": "[data-test-id=\"button-back\" ]"}]], "activationType": "dom_changed", "name": "URL Targeting for 446:Glass bill - show next best actions across manage payment journeys (make-payment)", "apiName": "8156242263_url_targeting_for_446glass_bill__show_next_best_act_1", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "22043201512"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/bill/streaming-tv/make-payment", "match": "simple"}, {"type": "url", "value": "https://pages-apps-bill-master-u01.cf.dev-paas.bskyb.com/bill/streaming-tv/make-payment", "match": "simple"}]], "activationType": "dom_changed", "name": "URL Targeting for 398: Glass - Future Bill List Add Key Actions(payment copy)", "apiName": "8156242263_url_targeting_for_398_glass__future_bill_list_add_k_1", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "22045007557"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "com/myaccount/bill/change-payment-method", "match": "substring"}], ["or", {"type": "element_present", "value": "#linear-tick-circle,svg #linear-alert"}]], "activationType": "dom_changed", "name": "449:Triple play bill - show next best actions across manage payment journeys (payment-method)", "apiName": "8156242263_449triple_play_bill__show_next_best_actions_across_ma", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22063030086"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "articles/bill-not-as-expected-not-sure", "match": "substring"}], ["not", ["or", {"type": "url", "value": "/expert/", "match": "substring"}, {"type": "url", "value": "https://www.sky.com/help/articles/bill-not-as-expected-not-sure-bwm-t1", "match": "simple"}]]], "activationType": "dom_changed", "name": "not as expected", "apiName": "8156242263_not_as_expected", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22094200480"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "articles/been-overcharged", "match": "substring"}], ["not", ["or", {"type": "url", "value": "/expert/", "match": "simple"}, {"type": "url", "value": "https://www.sky.com/help/articles/been-overcharged-bwm-t1", "match": "simple"}]]], "activationType": "dom_changed", "name": "been overcharged", "apiName": "8156242263_url_targeting_for_ac__messaging_in_billing", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22105650832"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "/help/", "match": "substring"}], ["or", {"type": "element_present", "value": "[data-test-id=\"contact-option-community\"]"}], ["or", {"type": "element_present", "value": "[data-test-id=\"tree-node\"] [data-test-id=\"breadcrumbs\"]"}], ["or", {"type": "custom_code", "value": /**
 * Sample JavaScript Condition
 * This function is called after the page is triggered.
 * It should return true when the page is ready to activate.
 *
 * Editor now supports ES6 compliant code. Note that adding ES6
 * specific code to an experiment will break for users running
 * ES5-only browsers as code entered is not transpiled down to ES5.
 */

function jsCondition() { return true;
  return document.readyState === 'complete';
}
}], ["not", ["or", {"type": "url", "value": "home-move", "match": "substring"}, {"type": "url", "value": "cancel", "match": "substring"}, {"type": "url", "value": "cancelling", "match": "substring"}, {"type": "url", "value": "cancellation", "match": "substring"}, {"type": "url", "value": "downgrade", "match": "substring"}, {"type": "url", "value": "/how-to-make-a-complaint", "match": "substring"}, {"type": "url", "value": "/sky-customer-complaints-code-of-practice", "match": "substring"}]]], "activationType": "dom_changed", "name": "URL Targeting for 462: Community x Gatekeeper API round 2", "apiName": "8156242263_url_targeting_for_copy_of_462_community_x_gatekeeper_", "tags": [], "undoOnDeactivation": true, "deactivationEnabled": true, "id": "22142190200"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "/articles/broadband-diagnostic-start", "match": "substring"}], ["not", ["or", {"type": "url", "value": "/expert/", "match": "substring"}]]], "activationType": "dom_changed", "name": "URL Targeting for AC - Service checker link in BB diagnostic", "apiName": "8156242263_url_targeting_for_ac__service_checker_link_in_bb_diag", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22160852030"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "/articles/contacting-sky", "match": "substring"}], ["not", ["or", {"type": "url", "value": "https://www.sky.com/help/expert", "match": "substring"}, {"type": "url", "value": "https://www.sky.com/help/expert/home", "match": "substring"}]]], "name": "URL Targeting for NS - contact us MVP test", "apiName": "8156242263_url_targeting_for_ns__contact_us_mvp_test", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22184122636"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": "https://www.sky.com/glass", "match": "simple"}]], "name": "URL Targeting for Glass Disco p1 - new headline", "apiName": "8156242263_url_targeting_for_glass_disco_p1__new_headline", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22197820591"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": ".+articles\\/reschedule-your-sky-tv-engineer-appointment$", "match": "regex"}], ["not", ["or", {"type": "url", "value": "/expert/", "match": "substring"}]]], "activationType": "dom_changed", "name": "URL Targeting for AC - Reschedule TV engineer", "apiName": "8156242263_url_targeting_for_copy_of_ac__book_tv_engineer", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22258470655"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": ".+articles\\/bills-and-payments-management$", "match": "regex"}], ["not", ["or", {"type": "url", "value": "https://www.sky.com/help/articles/bills-and-payments-management-bwm-t1", "match": "simple"}, {"type": "url", "value": "/expert/", "match": "simple"}]]], "activationType": "dom_changed", "name": "payment mngmt", "apiName": "8156242263_payment_mngmt", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22266250491"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": ".+articles\\/book-engineer-sky-q$", "match": "regex"}], ["not", ["or", {"type": "url", "value": "/expert/", "match": "substring"}]]], "activationType": "dom_changed", "name": "URL Targeting for AC - Book TV engineer", "apiName": "8156242263_url_targeting_for_ac__book_tv_engineer", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22289420984"}, {"category": "other", "staticConditions": ["and", ["or", {"type": "url", "value": ".+articles\\/billing-and-debt-management$", "match": "regex"}], ["not", ["or", {"type": "url", "value": "https://www.sky.com/help/articles/billing-and-debt-management-bwm-t1", "match": "simple"}, {"type": "url", "value": "/expert/", "match": "substring"}]]], "activationType": "dom_changed", "name": "debt mngmt", "apiName": "8156242263_debt_mngmt", "tags": [], "undoOnDeactivation": false, "deactivationEnabled": false, "id": "22298890066"}], "projectId": "8156242263", "namespace": "a2900460605", "tagGroups": [], "integrationSettings": [], "interestGroups": [], "dimensions": [], "audiences": [], "anonymizeIP": true, "projectJS": function(){/**
 * For Masthead tests across Sky.com - to bucket user manually if they have already been bucketed in DCLabs Project version of the experiment
 * @param  {String} pageName page name
 * @param  {String} experimentID experiment ID
 * @param  {Object} variation variations mapping  i.e. {original: '1234', variation1: '5678', variation2: ..   } 
 * @param  {String} cookieName cookie to store the variationID
 * @param  {Boolean} qa run the experiement only for users with "optimizely__QA" cookie 
 */

function mastheadTestSetup(pageName, experimentID, variations, cookieName, qa){

if(qa){
   if(!(document.cookie.indexOf('optimizely__QA=test') > -1)){
   return false;

   }

}

var getCookie = function(cname){
var name = cname + "=";
var ca = document.cookie.split(';');
for(var i = 0; i < ca.length; i++) {
   var c = ca[i];
   while (c.charAt(0) == ' ') {
       c = c.substring(1);
   }
   if (c.indexOf(name) == 0) { 
       return c.substring(name.length, c.length);
   }
}
return "";

};


if(getCookie(cookieName)){

var cookieVal = getCookie(cookieName);
 var pageName = pageName;
 var experimentID = experimentID;
 var currentVariation = variations[cookieVal]; 

 window["optimizely"] = window["optimizely"] || [];

 window["optimizely"].push({
 "type": "bucketVisitor",
 "experimentId": experimentID,
 "variationId": currentVariation
 });

 window['optimizely'].push({
 type: "page",
 pageName: pageName
 });

}

}

/*
/Test 301: Changing my details on masthead

mastheadTestSetup('8156242263_url_targeting_for_aa_mastheaddev', '20920290149', {original: '20902601173', variation1: '20896831287', variation2: '20886361134'}, 'opty-masthead-variation', false);
*/

/*
/Test 304: Masthead search - FAV editorial tile results
*/
mastheadTestSetup('Url_304_Masthead_search_FAV_editorial_tile_results_ui', '20894921468', {original: '20904672232', variation1: '20914230214'}, 'opty-masthead-304-variation', false);

/*
/ Test 130: Search - Dropdown No Results Next Best Action
*/
mastheadTestSetup('URL_Targeting_for_RW_Search_Dropdown_No_results_Copy_Change_UI', '19936547292', {original: '19944280813', variation1: '19967232195', variation2: '19922667247', variation3: '19940325784'}, 'opty-masthead-130-variation', false);

/*
/Test 350: Removing complaints when searching Live Chat
*/
mastheadTestSetup('8156242263_url_targeting_for_350_removing_references_to_complain', '21222253808', {original: '21215943140', variation1: '21234213755'}, 'opty-masthead-350-variation', false);

/*
347: Masthead Search - Editorial tile Round 2
*/
mastheadTestSetup('8156242263_url_targeting_for_347_masthead_search__editorial_tile', '21224882411', {original: '21229313075', variation1: '21226551482'}, 'opty-masthead-347-variation', false);

/*
408-adding-dropdown-to-help
*/
mastheadTestSetup('8156242263_url_targeting_for_408addingdropdowntohelp', '21774231202', {original: '21774301230', variation1: '21777751923'}, 'opty-masthead-408-variation', false);
}, "visitorAttributes": [], "enableForceParameters": true, "accountId": "2900460605", "events": [{"category": "other", "name": "Clicktale - excessiveReloads", "eventType": "custom", "viewId": null, "apiName": "excessiveReloads", "id": "16836720277", "eventFilter": null}, {"category": "other", "name": "Clicktale - excessivePastes", "eventType": "custom", "viewId": null, "apiName": "excessivePastes", "id": "16844170218", "eventFilter": null}, {"category": "other", "name": "Clicktale - constantHovering", "eventType": "custom", "viewId": null, "apiName": "constantHovering", "id": "16844640460", "eventFilter": null}, {"category": "other", "name": "Clicktale - repeatedScrolling", "eventType": "custom", "viewId": null, "apiName": "repeatedScrolling", "id": "16849690575", "eventFilter": null}, {"category": "other", "name": "Clicktale - rjsErrorOnClick", "eventType": "custom", "viewId": null, "apiName": "jsErrorOnClick", "id": "16849950179", "eventFilter": null}, {"category": "other", "name": "Clicktale - rageClick", "eventType": "custom", "viewId": null, "apiName": "rageClick", "id": "16853660233", "eventFilter": null}, {"category": "other", "name": "Clicktale - consecutiveClick", "eventType": "custom", "viewId": null, "apiName": "consecutiveClick", "id": "16853890148", "eventFilter": null}, {"category": "other", "name": "Live chat main CTA 1", "eventType": "click", "viewId": "20132636282", "apiName": "8156242263_live_chat_main_cta_1", "id": "20213890171", "eventFilter": {"filterType": "target_selector", "selector": "a.c-height-small.live-chat__btn.c-btn.c-btn--primary.opty-elem.u-margin-bottom-small"}}, {"category": "other", "name": "live chat main CTA", "eventType": "click", "viewId": "20132636282", "apiName": "8156242263_live_chat_main_cta", "id": "20217480607", "eventFilter": {"filterType": "target_selector", "selector": ".c-height-small"}}, {"category": "other", "name": "L0_HERO_Clicks", "eventType": "custom", "viewId": null, "apiName": "L0_HERO_Clicks", "id": "20499465743", "eventFilter": null}], "experimental": {"trimPages": true}, "revision": "83586"},f=__webpack_require__(4714),l="initializeOptimizelyPreview";if(f.initGlobalStore(c),u.populateDirectiveData(),r.clientHasAlreadyInitialized())i.warn("Main / Disabling because Optimizely has already initialized on this page load. Are there multiple snippets on the page?");else if(r.shouldBailForDesktopApp())i.log("Main / Disabling because of desktop app.");else if(r.conflictInObservingChanges())i.log("Main / Disabling: Observe Changes Indefinitely is on, but browser does not support it.");else{if(r.shouldLoadInnie())a.registerFunction("getProjectId",(function(){return c.projectId})),a.registerFunction("getAccountId",(function(){return c.accountId})),s.addScriptAsync("https://app.optimizely.com/js/innie.js"),i.log("Main / Disabling in favor of the editor client.");else if(r.shouldLoadPreview())(r.isSlave()?window.optimizely:window.optimizely=window.optimizely||[]).push({type:"load",data:c}),i.log("Main / Disabling in favor of the preview client."),__webpack_require__(127).setupPreviewGlobal(),__webpack_require__(127).pushToPreviewGlobal({type:"pushPreviewData",name:"liveCommitData",data:c}),r.isSlave()||(a.registerFunction("getProjectId",(function(){return c.projectId})),s.addScriptSync("https://cdn-assets-prod.s3.amazonaws.com/js/preview2/8156242263.js"));else if(r.shouldBootstrapDataForPreview()){a.registerFunction(l,(function(t){n(),a.unregisterFunction(l)}));var d=r.isSlave()?PROJECT_ID_FOR_SLAVE_PREVIEW:a.getFunction("getProjectId")();h=r.getProjectToken(),v=d,p=r.getPreviewLayerIds(),o="/dist/preview_data.js?token=__TOKEN__&preview_layer_ids=__PREVIEW_LAYER_IDS__".replace("__TOKEN__",h).replace("__PROJECT_ID__",v).replace("__PREVIEW_LAYER_IDS__",p.join(",")).replace("__GET_ONLY_PREVIEW_LAYERS__",!0),s.addScriptSync(o),__webpack_require__(127).setupPreviewGlobal(),s.addScriptAsync("/dist/js/preview_ui.js")}else r.shouldBootstrapDataForEditor()?(a.registerFunction(l,(function(t){n(),a.unregisterFunction(l)})),s.addScriptAsync(window.optimizely_editor_data_endpoint)):r.shouldInitialize()&&n();var h,v,p;t.timeEnd("block")}}()}catch(n){try{__webpack_require__(6236).handleError(n)}catch(t){console.log(t)}}}()})();