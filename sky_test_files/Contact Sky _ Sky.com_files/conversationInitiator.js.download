window.lpTag=window.lpTag||{},lpTag.taglets=lpTag.taglets||{},function(){function a(a,b){this.start(a,b)}function b(){var b=a,c="prototype";"function"==typeof lpTag.taglets.baseOffer&&b[c].extended!==!0&&(b[c]=new lpTag.taglets.baseOffer,b[c].constructor=a,b[c].start=function(a,b){a.isOffline=a.forceOffline===!0,this.engData=a,this.offerId=a.engagementId,this.conf=b||{},this.conf.channel=this.conf.channel||this.CHANNELS.CHAT,this.conf.skillName=this.conf.skillName||a.skillName,this.conf.language=this.conf.language||a.language,this.startChat()},b[c].extended=!0)}lpTag.taglets.conversationInitiator=function(){function c(){}function d(c,d){return b(),new a(c,d)}var e="0.1",f="conversationInitiator";return{v:e,name:f,init:c,createInstance:d}}()}(),window.lpTag=window.lpTag||{},lpTag.taglets=lpTag.taglets||{},lpTag.taglets.baseOffer=function(){},function(a){function b(){return this.conf.channel===this.CHANNELS.CHAT}function c(a,b){var c=p(t.CLICK,a,b);n.call(this,c)}function d(){var a=C.LEGACY,c="external app";return b.call(this)&&(this.conf.windowConf=this.conf.windowConf||{},this.conf.windowConf.json=this.conf.windowConf.json||{},this.conf.windowConf.type===c&&this.conf.windowConf.json.externalConfiguration?a=C.CUSTOM:A&&"function"==typeof A.clicked&&(a=C.UNIFIED_WINDOW)),a}function e(){var a={};return b.call(this)?(a.env="",a.domain=lpTag.csds.getDomain(w.CHAT),a.params=y,a.target=(z+lpTag.site).replace(/[^a-z0-9]/gi,"_"),("hc1"===a.domain||"hc1.dev.lprnd.net"===a.domain)&&(a.domain="hc1.dev.lprnd.net",a.env="qa")):(a.params=x,a.target=k.call(this).target),a}function f(a,b,c,e,f){var i=d.call(this,b);C.CUSTOM===i?g.call(this,a,b,c,e):C.UNIFIED_WINDOW===i?h.call(this,a,b,c,e,f):l.call(this,a,b,c,e)}function g(a,b,d,e){var f=this,g={configuration:this.conf.windowConf.json.externalConfiguration,args:B.getClickObject(a,b,d),errorCallback:function(){f.errorLog("Error while opening an external channel")}};try{lpTag.taglets.lpUtil.runCallbackByObject(g.configuration,g.args,g.errorCallback),c.call(this,a,e)}catch(h){this.errorLog("Exception while opening an external channel: "+h.message)}}function h(a,b,d,e,f){f?A.startFlow(B.getClickObject(a,b,d)):(A.clicked(B.getClickObject(a,b,d)),c.call(this,a,e))}function i(a,b){lpTag.log(a+". offer: "+this.engData.tglName+". offerId="+this.offerId,b,s)}function j(a){var b=this.conf.displayInstances||[];return b[a]||{_isInvalid:!0}}function k(){var a={target:"",url:""},b=j.call(this,this.engData.state);return b._isInvalid?a:(b.events&&b.events.click&&b.events.click.enabled&&(a.target=b.events.click.target,a.url=b.events.click.url),a)}function l(a,d,e,f){var g=b.call(this)?m.call(this,a,d,e):k.call(this).url;switch(e.target){case"_self":c.call(this,a,f),g&&setTimeout(function(){window.location.href=g},50);break;case"_parent":case"_top":c.call(this,a,f),g&&window.open(g,e.target,e.params);break;default:g&&window.open(g,e.target?e.target:"_blank",e.params),c.call(this,this.engData,f)}}function m(a,b,c){var d="https://"+c.domain+"/hcp/lewindow/index.html?lpNumber="+lpTag.site+"&site="+lpTag.site+"&domain="+c.domain;return c.env&&(d+="&env="+c.env),d=lpTag.taglets.lp_monitoringSDK.appendCtx(d),d+="&scid="+encodeURIComponent(a.contextId),d+="&cid="+encodeURIComponent(a.campaignId),d+="&eid="+encodeURIComponent(a.engagementId),b.skillName&&(d+="&skill="+encodeURIComponent(b.skillName)),b.windowId&&(d+="&lewid="+encodeURIComponent(b.windowId)),b.language&&(d+="&lang="+encodeURIComponent(b.language)),d}function n(a,b){lpTag.sdes&&"function"==typeof lpTag.sdes.send&&a&&(b?lpTag.sdes.push(a):lpTag.sdes.send(a),this.infoLog("Sent SMT event: "+a.type+", campaignID: "+a.campaign+", engagementId: "+a.engId))}function o(a,b,c){var d,e=[],f=q(a,b);if(c){if(f.expanded=c.expanded,f.userInit=c.userInit===!1?!1:!0,Array.isArray(c.actionableItems))for(var g=0;g<c.actionableItems.length;g++)d=c.actionableItems[g],(d.id||d.type||d.description)&&e.push({id:d.id||"",itemType:D[d.type]?d.type:"",name:d.description});f.actionableItems=e}return f}function p(a,b,c){var d=q(a,b);return c&&(d.actionableItem={id:c.id||"",itemType:D[c.type]?c.type:"",name:c.description||"",searchWord:c.searchKeywords||""}),b.multiChannelEngagementSelection&&(d.channel=b.multiChannelEngagementSelection),d}function q(a,b){return b&&a?{type:a,campaign:b.campaignId,engId:b.engagementId,revision:b.engagementRevision,eContext:[{type:"engagementContext",id:b.contextId}]}:null}var r="prototype",s="baseOffer",t={IMPRESSION:"impDisplay",EXPANDED:"impExpanded",CLOSED:"impClose",TIMEOUT:"impTimeout",CLICK:"impAccept"},u="LP_OFFERS",v={IMPRESSION:"OFFER_IMPRESSION",EXPANDED:"OFFER_EXPANDED",CLOSED:"OFFER_CLOSED",TIMEOUT:"OFFER_TIMEOUT",CLICK:"OFFER_CLICK",ERROR:"OFFER_ERROR"},w={CHAT:"adminArea",ACCDN:"acCdnDomain",LPCDN:"leCdnDomain"},x="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",y="height=650,width=330,menubar=no,resizable=no",z="LiveEngageChat_",A=lpTag.taglets.lpUnifiedWindow,B=lpTag.taglets.rendererStub,C={UNIFIED_WINDOW:0,CUSTOM:1,LEGACY:2},D={LINK:1,BUTTON:2,SEARCH_KEYWORD:3};a[r].CHANNELS={CHAT:1,CONTENT:100},a[r].init=function(a,b){this.offerId=a&&a.engagementId,this.engData=a,this.conf=b},a[r].onImpression=function(){n.call(this,q(t.IMPRESSION,this.engData)),this.trigger(v.IMPRESSION)},a[r].onTimeout=function(){n.call(this,q(t.TIMEOUT,this.engData)),this.trigger(v.TIMEOUT)},a[r].onClose=function(){n.call(this,q(t.CLOSED,this.engData)),this.trigger(v.CLOSED)},a[r].onError=function(){this.trigger(v.ERROR)},a[r].onClick=function(a){c.call(this,this.engData,a),this.trigger(v.CLICK,!0)},a[r].click=function(a){this.trigger(v.CLICK,!0),f.call(this,this.engData,this.conf,e.call(this),a)},a[r].startChat=function(){f.call(this,this.engData,this.conf,e.call(this),null,!0)},a[r].onExpanded=function(a){n.call(this,o(t.EXPANDED,this.engData,a)),this.trigger(v.EXPANDED)},a[r].trigger=function(a,b){lpTag.events.trigger({appName:u,eventName:a,data:this.engData,aSync:b||!1}),this.infoLog("Trigger event: app="+u+", name="+s)},a[r].bind=function(a,b){return lpTag.events.bind({appName:u,eventName:a,func:b,context:this})},a[r].infoLog=function(a){i.call(this,a,"INFO")},a[r].errorLog=function(a){i.call(this,a,"ERROR")},a[r].debugLog=function(a){i.call(this,a,"DEBUG")}}(lpTag.taglets.baseOffer);